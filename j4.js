!function(){var a,b,c;!function(d){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.split("/"),o=s.map,p=o&&o["*"]||{};if(a&&"."===a.charAt(0))if(b){for(n=n.slice(0,n.length-1),a=a.split("/"),g=a.length-1,s.nodeIdCompat&&w.test(a[g])&&(a[g]=a[g].replace(w,"")),a=n.concat(a),k=0;k<a.length;k+=1)if(m=a[k],"."===m)a.splice(k,1),k-=1;else if(".."===m){if(1===k&&(".."===a[2]||".."===a[0]))break;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((n||p)&&o){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),n)for(l=n.length;l>0;l-=1)if(e=o[n.slice(0,l).join("/")],e&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&p&&p[d]&&(i=p[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function g(a,b){return function(){return n.apply(d,v.call(arguments,0).concat([a,b]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(a){if(e(r,a)){var b=r[a];delete r[a],t[a]=!0,m.apply(d,b)}if(!e(q,a)&&!e(t,a))throw new Error("No "+a);return q[a]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice,w=/\.js$/;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(a,b,c,f){var h,k,l,m,n,s,u=[],v=typeof c;if(f=f||a,"undefined"===v||"function"===v){for(b=!b.length&&c.length?["require","exports","module"]:b,n=0;n<b.length;n+=1)if(m=o(b[n],f),k=m.f,"require"===k)u[n]=p.require(a);else if("exports"===k)u[n]=p.exports(a),s=!0;else if("module"===k)h=u[n]=p.module(a);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(a+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=c?c.apply(q[a],u):void 0,a&&(h&&h.exports!==d&&h.exports!==q[a]?q[a]=h.exports:l===d&&s||(q[a]=l))}else a&&(q[a]=c)},a=b=n=function(a,b,c,e,f){if("string"==typeof a)return p[a]?p[a](b):j(o(a,b).f);if(!a.splice){if(s=a,s.deps&&n(s.deps,s.callback),!b)return;b.splice?(a=b,b=c,c=null):a=d}return b=b||function(){},"function"==typeof c&&(c=e,e=f),e?m(d,a,b,c):setTimeout(function(){m(d,a,b,c)},4),n},n.config=function(a){return n(a)},a._defined=q,c=function(a,b,c){b.splice||(c=b,b=[]),!e(q,a)&&!e(r,a)&&(r[a]=[a,b,c])},c.amd={jQuery:!0}}(),c("../bower_components/js/almond/almond",function(){}),function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){function d(a){var b="length"in a&&a.length,c=fa.type(a);return"function"!==c&&!fa.isWindow(a)&&(!(1!==a.nodeType||!b)||("array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a))}function e(a,b,c){if(fa.isFunction(b))return fa.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return fa.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(na.test(b))return fa.filter(b,a,c);b=fa.filter(b,a)}return fa.grep(a,function(a){return fa.inArray(a,b)>=0!==c})}function f(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}function g(a){var b=va[a]={};return fa.each(a.match(ua)||[],function(a,c){b[c]=!0}),b}function h(){pa.addEventListener?(pa.removeEventListener("DOMContentLoaded",i,!1),a.removeEventListener("load",i,!1)):(pa.detachEvent("onreadystatechange",i),a.detachEvent("onload",i))}function i(){(pa.addEventListener||"load"===event.type||"complete"===pa.readyState)&&(h(),fa.ready())}function j(a,b,c){if(void 0===c&&1===a.nodeType){var d="data-"+b.replace(Aa,"-$1").toLowerCase();if(c=a.getAttribute(d),"string"==typeof c){try{c="true"===c||"false"!==c&&("null"===c?null:+c+""===c?+c:za.test(c)?fa.parseJSON(c):c)}catch(a){}fa.data(a,b,c)}else c=void 0}return c}function k(a){var b;for(b in a)if(("data"!==b||!fa.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function l(a,b,c,d){if(fa.acceptData(a)){var e,f,g=fa.expando,h=a.nodeType,i=h?fa.cache:a,j=h?a[g]:a[g]&&g;if(j&&i[j]&&(d||i[j].data)||void 0!==c||"string"!=typeof b)return j||(j=h?a[g]=X.pop()||fa.guid++:g),i[j]||(i[j]=h?{}:{toJSON:fa.noop}),"object"!=typeof b&&"function"!=typeof b||(d?i[j]=fa.extend(i[j],b):i[j].data=fa.extend(i[j].data,b)),f=i[j],d||(f.data||(f.data={}),f=f.data),void 0!==c&&(f[fa.camelCase(b)]=c),"string"==typeof b?(e=f[b],null==e&&(e=f[fa.camelCase(b)])):e=f,e}}function m(a,b,c){if(fa.acceptData(a)){var d,e,f=a.nodeType,g=f?fa.cache:a,h=f?a[fa.expando]:fa.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){fa.isArray(b)?b=b.concat(fa.map(b,fa.camelCase)):b in d?b=[b]:(b=fa.camelCase(b),b=b in d?[b]:b.split(" ")),e=b.length;for(;e--;)delete d[b[e]];if(c?!k(d):!fa.isEmptyObject(d))return}(c||(delete g[h].data,k(g[h])))&&(f?fa.cleanData([a],!0):da.deleteExpando||g!=g.window?delete g[h]:g[h]=null)}}}function n(){return!0}function o(){return!1}function p(){try{return pa.activeElement}catch(a){}}function q(a){var b=La.split("|"),c=a.createDocumentFragment();if(c.createElement)for(;b.length;)c.createElement(b.pop());return c}function r(a,b){var c,d,e=0,f=typeof a.getElementsByTagName!==ya?a.getElementsByTagName(b||"*"):typeof a.querySelectorAll!==ya?a.querySelectorAll(b||"*"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||fa.nodeName(d,b)?f.push(d):fa.merge(f,r(d,b));return void 0===b||b&&fa.nodeName(a,b)?fa.merge([a],f):f}function s(a){Fa.test(a.type)&&(a.defaultChecked=a.checked)}function t(a,b){return fa.nodeName(a,"table")&&fa.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function u(a){return a.type=(null!==fa.find.attr(a,"type"))+"/"+a.type,a}function v(a){var b=Wa.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function w(a,b){for(var c,d=0;null!=(c=a[d]);d++)fa._data(c,"globalEval",!b||fa._data(b[d],"globalEval"))}function x(a,b){if(1===b.nodeType&&fa.hasData(a)){var c,d,e,f=fa._data(a),g=fa._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;d<e;d++)fa.event.add(b,c,h[c][d])}g.data&&(g.data=fa.extend({},g.data))}}function y(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!da.noCloneEvent&&b[fa.expando]){e=fa._data(b);for(d in e.events)fa.removeEvent(b,d,e.handle);b.removeAttribute(fa.expando)}"script"===c&&b.text!==a.text?(u(b).text=a.text,v(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),da.html5Clone&&a.innerHTML&&!fa.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&Fa.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}}function z(b,c){var d,e=fa(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:fa.css(e[0],"display");return e.detach(),f}function A(a){var b=pa,c=ab[a];return c||(c=z(a,b),"none"!==c&&c||(_a=(_a||fa("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=(_a[0].contentWindow||_a[0].contentDocument).document,b.write(),b.close(),c=z(a,b),_a.detach()),ab[a]=c),c}function B(a,b){return{get:function(){var c=a();if(null!=c)return c?void delete this.get:(this.get=b).apply(this,arguments)}}}function C(a,b){if(b in a)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=nb.length;e--;)if(b=nb[e]+c,b in a)return b;return d}function D(a,b){for(var c,d,e,f=[],g=0,h=a.length;g<h;g++)d=a[g],d.style&&(f[g]=fa._data(d,"olddisplay"),c=d.style.display,b?(!f[g]&&"none"===c&&(d.style.display=""),""===d.style.display&&Da(d)&&(f[g]=fa._data(d,"olddisplay",A(d.nodeName)))):(e=Da(d),(c&&"none"!==c||!e)&&fa._data(d,"olddisplay",e?c:fa.css(d,"display"))));for(g=0;g<h;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function E(a,b,c){var d=jb.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function F(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;f<4;f+=2)"margin"===c&&(g+=fa.css(a,c+Ca[f],!0,e)),d?("content"===c&&(g-=fa.css(a,"padding"+Ca[f],!0,e)),"margin"!==c&&(g-=fa.css(a,"border"+Ca[f]+"Width",!0,e))):(g+=fa.css(a,"padding"+Ca[f],!0,e),"padding"!==c&&(g+=fa.css(a,"border"+Ca[f]+"Width",!0,e)));return g}function G(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=bb(a),g=da.boxSizing&&"border-box"===fa.css(a,"boxSizing",!1,f);if(e<=0||null==e){if(e=cb(a,b,f),(e<0||null==e)&&(e=a.style[b]),eb.test(e))return e;d=g&&(da.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+F(a,b,c||(g?"border":"content"),d,f)+"px"}function H(a,b,c,d,e){return new H.prototype.init(a,b,c,d,e)}function I(){return setTimeout(function(){ob=void 0}),ob=fa.now()}function J(a,b){var c,d={height:a},e=0;for(b=b?1:0;e<4;e+=2-b)c=Ca[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function K(a,b,c){for(var d,e=(ub[b]||[]).concat(ub["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function L(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},n=a.style,o=a.nodeType&&Da(a),p=fa._data(a,"fxshow");c.queue||(h=fa._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,fa.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[n.overflow,n.overflowX,n.overflowY],j=fa.css(a,"display"),k="none"===j?fa._data(a,"olddisplay")||A(a.nodeName):j,"inline"===k&&"none"===fa.css(a,"float")&&(da.inlineBlockNeedsLayout&&"inline"!==A(a.nodeName)?n.zoom=1:n.display="inline-block")),c.overflow&&(n.overflow="hidden",da.shrinkWrapBlocks()||l.always(function(){n.overflow=c.overflow[0],n.overflowX=c.overflow[1],n.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],qb.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(o?"hide":"show")){if("show"!==e||!p||void 0===p[d])continue;o=!0}m[d]=p&&p[d]||fa.style(a,d)}else j=void 0;if(fa.isEmptyObject(m))"inline"===("none"===j?A(a.nodeName):j)&&(n.display=j);else{p?"hidden"in p&&(o=p.hidden):p=fa._data(a,"fxshow",{}),f&&(p.hidden=!o),o?fa(a).show():l.done(function(){fa(a).hide()}),l.done(function(){var b;fa._removeData(a,"fxshow");for(b in m)fa.style(a,b,m[b])});for(d in m)g=K(o?p[d]:0,d,l),d in p||(p[d]=g.start,o&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function M(a,b){var c,d,e,f,g;for(c in a)if(d=fa.camelCase(c),e=b[d],f=a[c],fa.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=fa.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function N(a,b,c){var d,e,f=0,g=tb.length,h=fa.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=ob||I(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;g<i;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),f<1&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:fa.extend({},b),opts:fa.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:ob||I(),duration:c.duration,tweens:[],createTween:function(b,c){var d=fa.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;c<d;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(M(k,j.opts.specialEasing);f<g;f++)if(d=tb[f].call(j,a,k,j.opts))return d;return fa.map(k,K,j),fa.isFunction(j.opts.start)&&j.opts.start.call(a,j),fa.fx.timer(fa.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function O(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(ua)||[];if(fa.isFunction(c))for(;d=f[e++];)"+"===d.charAt(0)?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function P(a,b,c,d){function e(h){var i;return f[h]=!0,fa.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===Sb;return e(b.dataTypes[0])||!f["*"]&&e("*")}function Q(a,b){var c,d,e=fa.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&fa.extend(!0,a,c),a}function R(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader("Content-Type"));if(e)for(g in h)if(h[g]&&h[g].test(e)){i.unshift(g);break}if(i[0]in c)f=i[0];else{for(g in c){if(!i[0]||a.converters[g+" "+i[0]]){f=g;break}d||(d=g)}f=f||d}if(f)return f!==i[0]&&i.unshift(f),c[f]}function S(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift(),f)if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a.throws)b=g(b);else try{b=g(b)}catch(a){return{state:"parsererror",error:g?a:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function T(a,b,c,d){var e;if(fa.isArray(b))fa.each(b,function(b,e){c||Vb.test(a)?d(a,e):T(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==fa.type(b))d(a,b);else for(e in b)T(a+"["+e+"]",b[e],c,d)}function U(){try{return new a.XMLHttpRequest}catch(a){}}function V(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}function W(a){return fa.isWindow(a)?a:9===a.nodeType&&(a.defaultView||a.parentWindow)}var X=[],Y=X.slice,Z=X.concat,$=X.push,_=X.indexOf,aa={},ba=aa.toString,ca=aa.hasOwnProperty,da={},ea="1.11.3",fa=function(a,b){return new fa.fn.init(a,b)},ga=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ha=/^-ms-/,ia=/-([\da-z])/gi,ja=function(a,b){return b.toUpperCase()};fa.fn=fa.prototype={jquery:ea,constructor:fa,selector:"",length:0,toArray:function(){return Y.call(this)},get:function(a){return null!=a?a<0?this[a+this.length]:this[a]:Y.call(this)},pushStack:function(a){var b=fa.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return fa.each(this,a,b)},map:function(a){return this.pushStack(fa.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(Y.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(a<0?b:0);return this.pushStack(c>=0&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:$,sort:X.sort,splice:X.splice},fa.extend=fa.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"!=typeof g&&!fa.isFunction(g)&&(g={}),h===i&&(g=this,h--);h<i;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(j&&c&&(fa.isPlainObject(c)||(b=fa.isArray(c)))?(b?(b=!1,f=a&&fa.isArray(a)?a:[]):f=a&&fa.isPlainObject(a)?a:{},g[d]=fa.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},fa.extend({expando:"jQuery"+(ea+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===fa.type(a)},isArray:Array.isArray||function(a){return"array"===fa.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!fa.isArray(a)&&a-parseFloat(a)+1>=0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||"object"!==fa.type(a)||a.nodeType||fa.isWindow(a))return!1;try{if(a.constructor&&!ca.call(a,"constructor")&&!ca.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(a){return!1}if(da.ownLast)for(b in a)return ca.call(a,b);for(b in a);return void 0===b||ca.call(a,b)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?aa[ba.call(a)]||"object":typeof a},globalEval:function(b){b&&fa.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(ha,"ms-").replace(ia,ja)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var e,f=0,g=a.length,h=d(a);if(c){if(h)for(;f<g&&(e=b.apply(a[f],c),e!==!1);f++);else for(f in a)if(e=b.apply(a[f],c),e===!1)break}else if(h)for(;f<g&&(e=b.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=b.call(a[f],f,a[f]),e===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(ga,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(d(Object(a))?fa.merge(c,"string"==typeof a?[a]:a):$.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(_)return _.call(b,a,c);for(d=b.length,c=c?c<0?Math.max(0,d+c):c:0;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;)a[e++]=b[d++];if(c!==c)for(;void 0!==b[d];)a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;f<g;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var e,f=0,g=a.length,h=d(a),i=[];if(h)for(;f<g;f++)e=b(a[f],f,c),null!=e&&i.push(e);else for(f in a)e=b(a[f],f,c),null!=e&&i.push(e);return Z.apply([],i)},guid:1,proxy:function(a,b){var c,d,e;return"string"==typeof b&&(e=a[b],b=a,a=e),fa.isFunction(a)?(c=Y.call(arguments,2),d=function(){return a.apply(b||this,c.concat(Y.call(arguments)))},d.guid=a.guid=a.guid||fa.guid++,d):void 0},now:function(){return+new Date},support:da}),fa.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){aa["[object "+b+"]"]=b.toLowerCase()});var ka=function(a){function b(a,b,c,d){var e,f,g,h,i,j,l,n,o,p;if((b?b.ownerDocument||b:O)!==G&&F(b),b=b||G,c=c||[],h=b.nodeType,"string"!=typeof a||!a||1!==h&&9!==h&&11!==h)return c;if(!d&&I){if(11!==h&&(e=sa.exec(a)))if(g=e[1]){if(9===h){if(f=b.getElementById(g),!f||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&M(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return $.apply(c,b.getElementsByTagName(a)),c;if((g=e[3])&&v.getElementsByClassName)return $.apply(c,b.getElementsByClassName(g)),c}if(v.qsa&&(!J||!J.test(a))){if(n=l=N,o=b,p=1!==h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(j=z(a),(l=b.getAttribute("id"))?n=l.replace(ua,"\\$&"):b.setAttribute("id",n),n="[id='"+n+"'] ",i=j.length;i--;)j[i]=n+m(j[i]);o=ta.test(a)&&k(b.parentNode)||b,p=j.join(",")}if(p)try{return $.apply(c,o.querySelectorAll(p)),c}catch(a){}finally{l||b.removeAttribute("id")}}}return B(a.replace(ia,"$1"),b,c,d)}function c(){function a(c,d){return b.push(c+" ")>w.cacheLength&&delete a[b.shift()],a[c+" "]=d}var b=[];return a}function d(a){return a[N]=!0,a}function e(a){var b=G.createElement("div");try{return!!a(b)}catch(a){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function f(a,b){for(var c=a.split("|"),d=a.length;d--;)w.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||V)-(~a.sourceIndex||V);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function h(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function i(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function j(a){return d(function(b){return b=+b,d(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function k(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}function l(){}function m(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function n(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=Q++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[P,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(i=b[N]||(b[N]={}),(h=i[d])&&h[0]===P&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function o(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function p(a,c,d){for(var e=0,f=c.length;e<f;e++)b(a,c[e],d);return d}function q(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function r(a,b,c,e,f,g){return e&&!e[N]&&(e=r(e)),f&&!f[N]&&(f=r(f,g)),d(function(d,g,h,i){var j,k,l,m=[],n=[],o=g.length,r=d||p(b||"*",h.nodeType?[h]:h,[]),s=!a||!d&&b?r:q(r,m,a,h,i),t=c?f||(d?a:o||e)?[]:g:s;if(c&&c(s,t,h,i),e)for(j=q(t,n),e(j,[],h,i),k=j.length;k--;)(l=j[k])&&(t[n[k]]=!(s[n[k]]=l));if(d){if(f||a){if(f){for(j=[],k=t.length;k--;)(l=t[k])&&j.push(s[k]=l);f(null,t=[],j,i)}for(k=t.length;k--;)(l=t[k])&&(j=f?aa(d,l):m[k])>-1&&(d[j]=!(g[j]=l))}}else t=q(t===g?t.splice(o,t.length):t),f?f(null,g,t,i):$.apply(g,t)})}function s(a){for(var b,c,d,e=a.length,f=w.relative[a[0].type],g=f||w.relative[" "],h=f?1:0,i=n(function(a){return a===b},g,!0),j=n(function(a){return aa(b,a)>-1},g,!0),k=[function(a,c,d){var e=!f&&(d||c!==C)||((b=c).nodeType?i(a,c,d):j(a,c,d));return b=null,e}];h<e;h++)if(c=w.relative[a[h].type])k=[n(o(k),c)];else{if(c=w.filter[a[h].type].apply(null,a[h].matches),c[N]){for(d=++h;d<e&&!w.relative[a[d].type];d++);return r(h>1&&o(k),h>1&&m(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(ia,"$1"),c,h<d&&s(a.slice(h,d)),d<e&&s(a=a.slice(d)),d<e&&m(a))}k.push(c)}return o(k)}function t(a,c){var e=c.length>0,f=a.length>0,g=function(d,g,h,i,j){var k,l,m,n=0,o="0",p=d&&[],r=[],s=C,t=d||f&&w.find.TAG("*",j),u=P+=null==s?1:Math.random()||.1,v=t.length;for(j&&(C=g!==G&&g);o!==v&&null!=(k=t[o]);o++){if(f&&k){for(l=0;m=a[l++];)if(m(k,g,h)){i.push(k);break}j&&(P=u)}e&&((k=!m&&k)&&n--,d&&p.push(k))}if(n+=o,e&&o!==n){for(l=0;m=c[l++];)m(p,r,g,h);if(d){if(n>0)for(;o--;)!p[o]&&!r[o]&&(r[o]=Y.call(i));r=q(r)}$.apply(i,r),j&&!d&&r.length>0&&n+c.length>1&&b.uniqueSort(i)}return j&&(P=u,C=s),p};return e?d(g):g}var u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N="sizzle"+1*new Date,O=a.document,P=0,Q=0,R=c(),S=c(),T=c(),U=function(a,b){return a===b&&(E=!0),0},V=1<<31,W={}.hasOwnProperty,X=[],Y=X.pop,Z=X.push,$=X.push,_=X.slice,aa=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},ba="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ca="[\\x20\\t\\r\\n\\f]",da="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ea=da.replace("w","w#"),fa="\\["+ca+"*("+da+")(?:"+ca+"*([*^$|!~]?=)"+ca+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ea+"))|)"+ca+"*\\]",ga=":("+da+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+fa+")*)|.*)\\)|)",ha=new RegExp(ca+"+","g"),ia=new RegExp("^"+ca+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ca+"+$","g"),ja=new RegExp("^"+ca+"*,"+ca+"*"),ka=new RegExp("^"+ca+"*([>+~]|"+ca+")"+ca+"*"),la=new RegExp("="+ca+"*([^\\]'\"]*?)"+ca+"*\\]","g"),ma=new RegExp(ga),na=new RegExp("^"+ea+"$"),oa={ID:new RegExp("^#("+da+")"),CLASS:new RegExp("^\\.("+da+")"),TAG:new RegExp("^("+da.replace("w","w*")+")"),ATTR:new RegExp("^"+fa),PSEUDO:new RegExp("^"+ga),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ca+"*(even|odd|(([+-]|)(\\d*)n|)"+ca+"*(?:([+-]|)"+ca+"*(\\d+)|))"+ca+"*\\)|)","i"),bool:new RegExp("^(?:"+ba+")$","i"),needsContext:new RegExp("^"+ca+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ca+"*((?:-\\d)?\\d*)"+ca+"*\\)|)(?=[^-]|$)","i")},pa=/^(?:input|select|textarea|button)$/i,qa=/^h\d$/i,ra=/^[^{]+\{\s*\[native \w/,sa=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ta=/[+~]/,ua=/'|\\/g,va=new RegExp("\\\\([\\da-f]{1,6}"+ca+"?|("+ca+")|.)","ig"),wa=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:d<0?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},xa=function(){F()};try{$.apply(X=_.call(O.childNodes),O.childNodes),X[O.childNodes.length].nodeType}catch(a){$={apply:X.length?function(a,b){Z.apply(a,_.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}v=b.support={},y=b.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},F=b.setDocument=function(a){var b,c,d=a?a.ownerDocument||a:O;return d!==G&&9===d.nodeType&&d.documentElement?(G=d,H=d.documentElement,c=d.defaultView,c&&c!==c.top&&(c.addEventListener?c.addEventListener("unload",xa,!1):c.attachEvent&&c.attachEvent("onunload",xa)),I=!y(d),v.attributes=e(function(a){return a.className="i",!a.getAttribute("className")}),v.getElementsByTagName=e(function(a){return a.appendChild(d.createComment("")),!a.getElementsByTagName("*").length}),v.getElementsByClassName=ra.test(d.getElementsByClassName),v.getById=e(function(a){return H.appendChild(a).id=N,!d.getElementsByName||!d.getElementsByName(N).length}),v.getById?(w.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&I){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},w.filter.ID=function(a){var b=a.replace(va,wa);return function(a){return a.getAttribute("id")===b}}):(delete w.find.ID,w.filter.ID=function(a){var b=a.replace(va,wa);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),w.find.TAG=v.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):v.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},w.find.CLASS=v.getElementsByClassName&&function(a,b){if(I)return b.getElementsByClassName(a)},K=[],J=[],(v.qsa=ra.test(d.querySelectorAll))&&(e(function(a){H.appendChild(a).innerHTML="<a id='"+N+"'></a><select id='"+N+"-\f]' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&J.push("[*^$]="+ca+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||J.push("\\["+ca+"*(?:value|"+ba+")"),a.querySelectorAll("[id~="+N+"-]").length||J.push("~="),a.querySelectorAll(":checked").length||J.push(":checked"),a.querySelectorAll("a#"+N+"+*").length||J.push(".#.+[+~]")}),e(function(a){var b=d.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&J.push("name"+ca+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||J.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),J.push(",.*:")})),(v.matchesSelector=ra.test(L=H.matches||H.webkitMatchesSelector||H.mozMatchesSelector||H.oMatchesSelector||H.msMatchesSelector))&&e(function(a){v.disconnectedMatch=L.call(a,"div"),L.call(a,"[s!='']:x"),K.push("!=",ga)}),J=J.length&&new RegExp(J.join("|")),K=K.length&&new RegExp(K.join("|")),b=ra.test(H.compareDocumentPosition),M=b||ra.test(H.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!!d&&1===d.nodeType&&!!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},U=b?function(a,b){if(a===b)return E=!0,0;var c=!a.compareDocumentPosition-!b.compareDocumentPosition;return c?c:(c=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&c||!v.sortDetached&&b.compareDocumentPosition(a)===c?a===d||a.ownerDocument===O&&M(O,a)?-1:b===d||b.ownerDocument===O&&M(O,b)?1:D?aa(D,a)-aa(D,b):0:4&c?-1:1)}:function(a,b){if(a===b)return E=!0,0;var c,e=0,f=a.parentNode,h=b.parentNode,i=[a],j=[b];if(!f||!h)return a===d?-1:b===d?1:f?-1:h?1:D?aa(D,a)-aa(D,b):0;if(f===h)return g(a,b);for(c=a;c=c.parentNode;)i.unshift(c);for(c=b;c=c.parentNode;)j.unshift(c);for(;i[e]===j[e];)e++;return e?g(i[e],j[e]):i[e]===O?-1:j[e]===O?1:0},d):G},b.matches=function(a,c){return b(a,null,null,c)},b.matchesSelector=function(a,c){if((a.ownerDocument||a)!==G&&F(a),c=c.replace(la,"='$1']"),v.matchesSelector&&I&&(!K||!K.test(c))&&(!J||!J.test(c)))try{var d=L.call(a,c);if(d||v.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(a){}return b(c,G,null,[a]).length>0},b.contains=function(a,b){return(a.ownerDocument||a)!==G&&F(a),M(a,b)},b.attr=function(a,b){(a.ownerDocument||a)!==G&&F(a);var c=w.attrHandle[b.toLowerCase()],d=c&&W.call(w.attrHandle,b.toLowerCase())?c(a,b,!I):void 0;return void 0!==d?d:v.attributes||!I?a.getAttribute(b):(d=a.getAttributeNode(b))&&d.specified?d.value:null},b.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},b.uniqueSort=function(a){var b,c=[],d=0,e=0;if(E=!v.detectDuplicates,D=!v.sortStable&&a.slice(0),a.sort(U),E){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return D=null,a},x=b.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=x(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d++];)c+=x(b);return c},w=b.selectors={cacheLength:50,createPseudo:d,match:oa,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(va,wa),a[3]=(a[3]||a[4]||a[5]||"").replace(va,wa),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return oa.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&ma.test(c)&&(b=z(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(va,wa).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=R[a+" "];return b||(b=new RegExp("(^|"+ca+")"+a+"("+ca+"|$)"))&&R(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,c,d){return function(e){var f=b.attr(e,a);return null==f?"!="===c:!c||(f+="","="===c?f===d:"!="===c?f!==d:"^="===c?d&&0===f.indexOf(d):"*="===c?d&&f.indexOf(d)>-1:"$="===c?d&&f.slice(-d.length)===d:"~="===c?(" "+f.replace(ha," ")+" ").indexOf(d)>-1:"|="===c&&(f===d||f.slice(0,d.length+1)===d+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(k=q[N]||(q[N]={}),j=k[a]||[],n=j[0]===P&&j[1],m=j[0]===P&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[P,n,m];break}}else if(s&&(j=(b[N]||(b[N]={}))[a])&&j[0]===P)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[N]||(l[N]={}))[a]=[P,m]),l!==b)););return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,c){var e,f=w.pseudos[a]||w.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[N]?f(c):f.length>1?(e=[a,a,"",c],w.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){
for(var d,e=f(a,c),g=e.length;g--;)d=aa(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=A(a.replace(ia,"$1"));return e[N]?d(function(a,b,c,d){for(var f,g=e(a,null,d,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,d,f){return b[0]=a,e(b,null,f,c),b[0]=null,!c.pop()}}),has:d(function(a){return function(c){return b(a,c).length>0}}),contains:d(function(a){return a=a.replace(va,wa),function(b){return(b.textContent||b.innerText||x(b)).indexOf(a)>-1}}),lang:d(function(a){return na.test(a||"")||b.error("unsupported lang: "+a),a=a.replace(va,wa).toLowerCase(),function(b){var c;do if(c=I?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===H},focus:function(a){return a===G.activeElement&&(!G.hasFocus||G.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!w.pseudos.empty(a)},header:function(a){return qa.test(a.nodeName)},input:function(a){return pa.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:j(function(){return[0]}),last:j(function(a,b){return[b-1]}),eq:j(function(a,b,c){return[c<0?c+b:c]}),even:j(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:j(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:j(function(a,b,c){for(var d=c<0?c+b:c;--d>=0;)a.push(d);return a}),gt:j(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}},w.pseudos.nth=w.pseudos.eq;for(u in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[u]=h(u);for(u in{submit:!0,reset:!0})w.pseudos[u]=i(u);return l.prototype=w.filters=w.pseudos,w.setFilters=new l,z=b.tokenize=function(a,c){var d,e,f,g,h,i,j,k=S[a+" "];if(k)return c?0:k.slice(0);for(h=a,i=[],j=w.preFilter;h;){d&&!(e=ja.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=ka.exec(h))&&(d=e.shift(),f.push({value:d,type:e[0].replace(ia," ")}),h=h.slice(d.length));for(g in w.filter)(e=oa[g].exec(h))&&(!j[g]||(e=j[g](e)))&&(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return c?h.length:h?b.error(a):S(a,i).slice(0)},A=b.compile=function(a,b){var c,d=[],e=[],f=T[a+" "];if(!f){for(b||(b=z(a)),c=b.length;c--;)f=s(b[c]),f[N]?d.push(f):e.push(f);f=T(a,t(e,d)),f.selector=a}return f},B=b.select=function(a,b,c,d){var e,f,g,h,i,j="function"==typeof a&&a,l=!d&&z(a=j.selector||a);if(c=c||[],1===l.length){if(f=l[0]=l[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&v.getById&&9===b.nodeType&&I&&w.relative[f[1].type]){if(b=(w.find.ID(g.matches[0].replace(va,wa),b)||[])[0],!b)return c;j&&(b=b.parentNode),a=a.slice(f.shift().value.length)}for(e=oa.needsContext.test(a)?0:f.length;e--&&(g=f[e],!w.relative[h=g.type]);)if((i=w.find[h])&&(d=i(g.matches[0].replace(va,wa),ta.test(f[0].type)&&k(b.parentNode)||b))){if(f.splice(e,1),a=d.length&&m(f),!a)return $.apply(c,d),c;break}}return(j||A(a,l))(d,b,!I,c,ta.test(a)&&k(b.parentNode)||b),c},v.sortStable=N.split("").sort(U).join("")===N,v.detectDuplicates=!!E,F(),v.sortDetached=e(function(a){return 1&a.compareDocumentPosition(G.createElement("div"))}),e(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),(!v.attributes||!e(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")}))&&f("value",function(a,b,c){if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue}),e(function(a){return null==a.getAttribute("disabled")})||f(ba,function(a,b,c){var d;if(!c)return a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),b}(a);fa.find=ka,fa.expr=ka.selectors,fa.expr[":"]=fa.expr.pseudos,fa.unique=ka.uniqueSort,fa.text=ka.getText,fa.isXMLDoc=ka.isXML,fa.contains=ka.contains;var la=fa.expr.match.needsContext,ma=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,na=/^.[^:#\[\.,]*$/;fa.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?fa.find.matchesSelector(d,a)?[d]:[]:fa.find.matches(a,fa.grep(b,function(a){return 1===a.nodeType}))},fa.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(fa(a).filter(function(){for(b=0;b<e;b++)if(fa.contains(d[b],this))return!0}));for(b=0;b<e;b++)fa.find(a,d[b],c);return c=this.pushStack(e>1?fa.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},filter:function(a){return this.pushStack(e(this,a||[],!1))},not:function(a){return this.pushStack(e(this,a||[],!0))},is:function(a){return!!e(this,"string"==typeof a&&la.test(a)?fa(a):a||[],!1).length}});var oa,pa=a.document,qa=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ra=fa.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:qa.exec(a),c&&(c[1]||!b)){if(c[1]){if(b=b instanceof fa?b[0]:b,fa.merge(this,fa.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:pa,!0)),ma.test(c[1])&&fa.isPlainObject(b))for(c in b)fa.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}if(d=pa.getElementById(c[2]),d&&d.parentNode){if(d.id!==c[2])return oa.find(a);this.length=1,this[0]=d}return this.context=pa,this.selector=a,this}return!b||b.jquery?(b||oa).find(a):this.constructor(b).find(a)}return a.nodeType?(this.context=this[0]=a,this.length=1,this):fa.isFunction(a)?"undefined"!=typeof oa.ready?oa.ready(a):a(fa):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),fa.makeArray(a,this))};ra.prototype=fa.fn,oa=fa(pa);var sa=/^(?:parents|prev(?:Until|All))/,ta={children:!0,contents:!0,next:!0,prev:!0};fa.extend({dir:function(a,b,c){for(var d=[],e=a[b];e&&9!==e.nodeType&&(void 0===c||1!==e.nodeType||!fa(e).is(c));)1===e.nodeType&&d.push(e),e=e[b];return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),fa.fn.extend({has:function(a){var b,c=fa(a,this),d=c.length;return this.filter(function(){for(b=0;b<d;b++)if(fa.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=la.test(a)||"string"!=typeof a?fa(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&fa.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?fa.unique(f):f)},index:function(a){return a?"string"==typeof a?fa.inArray(this[0],fa(a)):fa.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(fa.unique(fa.merge(this.get(),fa(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),fa.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return fa.dir(a,"parentNode")},parentsUntil:function(a,b,c){return fa.dir(a,"parentNode",c)},next:function(a){return f(a,"nextSibling")},prev:function(a){return f(a,"previousSibling")},nextAll:function(a){return fa.dir(a,"nextSibling")},prevAll:function(a){return fa.dir(a,"previousSibling")},nextUntil:function(a,b,c){return fa.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return fa.dir(a,"previousSibling",c)},siblings:function(a){return fa.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return fa.sibling(a.firstChild)},contents:function(a){return fa.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:fa.merge([],a.childNodes)}},function(a,b){fa.fn[a]=function(c,d){var e=fa.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=fa.filter(d,e)),this.length>1&&(ta[a]||(e=fa.unique(e)),sa.test(a)&&(e=e.reverse())),this.pushStack(e)}});var ua=/\S+/g,va={};fa.Callbacks=function(a){a="string"==typeof a?va[a]||g(a):fa.extend({},a);var b,c,d,e,f,h,i=[],j=!a.once&&[],k=function(g){for(c=a.memory&&g,d=!0,f=h||0,h=0,e=i.length,b=!0;i&&f<e;f++)if(i[f].apply(g[0],g[1])===!1&&a.stopOnFalse){c=!1;break}b=!1,i&&(j?j.length&&k(j.shift()):c?i=[]:l.disable())},l={add:function(){if(i){var d=i.length;!function b(c){fa.each(c,function(c,d){var e=fa.type(d);"function"===e?(!a.unique||!l.has(d))&&i.push(d):d&&d.length&&"string"!==e&&b(d)})}(arguments),b?e=i.length:c&&(h=d,k(c))}return this},remove:function(){return i&&fa.each(arguments,function(a,c){for(var d;(d=fa.inArray(c,i,d))>-1;)i.splice(d,1),b&&(d<=e&&e--,d<=f&&f--)}),this},has:function(a){return a?fa.inArray(a,i)>-1:!!i&&!!i.length},empty:function(){return i=[],e=0,this},disable:function(){return i=j=c=void 0,this},disabled:function(){return!i},lock:function(){return j=void 0,c||l.disable(),this},locked:function(){return!j},fireWith:function(a,c){return i&&(!d||j)&&(c=c||[],c=[a,c.slice?c.slice():c],b?j.push(c):k(c)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!d}};return l},fa.extend({Deferred:function(a){var b=[["resolve","done",fa.Callbacks("once memory"),"resolved"],["reject","fail",fa.Callbacks("once memory"),"rejected"],["notify","progress",fa.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return fa.Deferred(function(c){fa.each(b,function(b,f){var g=fa.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&fa.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?fa.extend(a,d):d}},e={};return d.pipe=d.then,fa.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=Y.call(arguments),g=f.length,h=1!==g||a&&fa.isFunction(a.promise)?g:0,i=1===h?a:fa.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?Y.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);e<g;e++)f[e]&&fa.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}});var wa;fa.fn.ready=function(a){return fa.ready.promise().done(a),this},fa.extend({isReady:!1,readyWait:1,holdReady:function(a){a?fa.readyWait++:fa.ready(!0)},ready:function(a){if(a===!0?!--fa.readyWait:!fa.isReady){if(!pa.body)return setTimeout(fa.ready);fa.isReady=!0,a!==!0&&--fa.readyWait>0||(wa.resolveWith(pa,[fa]),fa.fn.triggerHandler&&(fa(pa).triggerHandler("ready"),fa(pa).off("ready")))}}}),fa.ready.promise=function(b){if(!wa)if(wa=fa.Deferred(),"complete"===pa.readyState)setTimeout(fa.ready);else if(pa.addEventListener)pa.addEventListener("DOMContentLoaded",i,!1),a.addEventListener("load",i,!1);else{pa.attachEvent("onreadystatechange",i),a.attachEvent("onload",i);var c=!1;try{c=null==a.frameElement&&pa.documentElement}catch(a){}c&&c.doScroll&&function a(){if(!fa.isReady){try{c.doScroll("left")}catch(b){return setTimeout(a,50)}h(),fa.ready()}}()}return wa.promise(b)};var xa,ya="undefined";for(xa in fa(da))break;da.ownLast="0"!==xa,da.inlineBlockNeedsLayout=!1,fa(function(){var a,b,c,d;c=pa.getElementsByTagName("body")[0],c&&c.style&&(b=pa.createElement("div"),d=pa.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),typeof b.style.zoom!==ya&&(b.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",da.inlineBlockNeedsLayout=a=3===b.offsetWidth,a&&(c.style.zoom=1)),c.removeChild(d))}),function(){var a=pa.createElement("div");if(null==da.deleteExpando){da.deleteExpando=!0;try{delete a.test}catch(a){da.deleteExpando=!1}}a=null}(),fa.acceptData=function(a){var b=fa.noData[(a.nodeName+" ").toLowerCase()],c=+a.nodeType||1;return(1===c||9===c)&&(!b||b!==!0&&a.getAttribute("classid")===b)};var za=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Aa=/([A-Z])/g;fa.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return a=a.nodeType?fa.cache[a[fa.expando]]:a[fa.expando],!!a&&!k(a)},data:function(a,b,c){return l(a,b,c)},removeData:function(a,b){return m(a,b)},_data:function(a,b,c){return l(a,b,c,!0)},_removeData:function(a,b){return m(a,b,!0)}}),fa.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=fa.data(f),1===f.nodeType&&!fa._data(f,"parsedAttrs"))){for(c=g.length;c--;)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=fa.camelCase(d.slice(5)),j(f,d,e[d])));fa._data(f,"parsedAttrs",!0)}return e}return"object"==typeof a?this.each(function(){fa.data(this,a)}):arguments.length>1?this.each(function(){fa.data(this,a,b)}):f?j(f,a,fa.data(f,a)):void 0},removeData:function(a){return this.each(function(){fa.removeData(this,a)})}}),fa.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=fa._data(a,b),c&&(!d||fa.isArray(c)?d=fa._data(a,b,fa.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=fa.queue(a,b),d=c.length,e=c.shift(),f=fa._queueHooks(a,b),g=function(){fa.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return fa._data(a,c)||fa._data(a,c,{empty:fa.Callbacks("once memory").add(function(){fa._removeData(a,b+"queue"),fa._removeData(a,c)})})}}),fa.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?fa.queue(this[0],a):void 0===b?this:this.each(function(){var c=fa.queue(this,a,b);fa._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&fa.dequeue(this,a)})},dequeue:function(a){return this.each(function(){fa.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=fa.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)c=fa._data(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var Ba=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ca=["Top","Right","Bottom","Left"],Da=function(a,b){return a=b||a,"none"===fa.css(a,"display")||!fa.contains(a.ownerDocument,a)},Ea=fa.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===fa.type(c)){e=!0;for(h in c)fa.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,fa.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(fa(a),c)})),b))for(;h<i;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},Fa=/^(?:checkbox|radio)$/i;!function(){var a=pa.createElement("input"),b=pa.createElement("div"),c=pa.createDocumentFragment();if(b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",da.leadingWhitespace=3===b.firstChild.nodeType,da.tbody=!b.getElementsByTagName("tbody").length,da.htmlSerialize=!!b.getElementsByTagName("link").length,da.html5Clone="<:nav></:nav>"!==pa.createElement("nav").cloneNode(!0).outerHTML,a.type="checkbox",a.checked=!0,c.appendChild(a),da.appendChecked=a.checked,b.innerHTML="<textarea>x</textarea>",da.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue,c.appendChild(b),b.innerHTML="<input type='radio' checked='checked' name='t'/>",da.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,da.noCloneEvent=!0,b.attachEvent&&(b.attachEvent("onclick",function(){da.noCloneEvent=!1}),b.cloneNode(!0).click()),null==da.deleteExpando){da.deleteExpando=!0;try{delete b.test}catch(a){da.deleteExpando=!1}}}(),function(){var b,c,d=pa.createElement("div");for(b in{submit:!0,change:!0,focusin:!0})c="on"+b,(da[b+"Bubbles"]=c in a)||(d.setAttribute(c,"t"),da[b+"Bubbles"]=d.attributes[c].expando===!1);d=null}();var Ga=/^(?:input|select|textarea)$/i,Ha=/^key/,Ia=/^(?:mouse|pointer|contextmenu)|click/,Ja=/^(?:focusinfocus|focusoutblur)$/,Ka=/^([^.]*)(?:\.(.+)|)$/;fa.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=fa._data(a);if(q){for(c.handler&&(i=c,c=i.handler,e=i.selector),c.guid||(c.guid=fa.guid++),(g=q.events)||(g=q.events={}),(k=q.handle)||(k=q.handle=function(a){return typeof fa===ya||a&&fa.event.triggered===a.type?void 0:fa.event.dispatch.apply(k.elem,arguments)},k.elem=a),b=(b||"").match(ua)||[""],h=b.length;h--;)f=Ka.exec(b[h])||[],n=p=f[1],o=(f[2]||"").split(".").sort(),n&&(j=fa.event.special[n]||{},n=(e?j.delegateType:j.bindType)||n,j=fa.event.special[n]||{},l=fa.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&fa.expr.match.needsContext.test(e),namespace:o.join(".")},i),(m=g[n])||(m=g[n]=[],m.delegateCount=0,j.setup&&j.setup.call(a,d,o,k)!==!1||(a.addEventListener?a.addEventListener(n,k,!1):a.attachEvent&&a.attachEvent("on"+n,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,l):m.push(l),fa.event.global[n]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=fa.hasData(a)&&fa._data(a);if(q&&(k=q.events)){for(b=(b||"").match(ua)||[""],j=b.length;j--;)if(h=Ka.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=fa.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=k[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=m.length;f--;)g=m[f],(e||p===g.origType)&&(!c||c.guid===g.guid)&&(!h||h.test(g.namespace))&&(!d||d===g.selector||"**"===d&&g.selector)&&(m.splice(f,1),g.selector&&m.delegateCount--,l.remove&&l.remove.call(a,g));i&&!m.length&&((!l.teardown||l.teardown.call(a,o,q.handle)===!1)&&fa.removeEvent(a,n,q.handle),delete k[n])}else for(n in k)fa.event.remove(a,n+b[j],c,d,!0);fa.isEmptyObject(k)&&(delete q.handle,fa._removeData(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,j,k,l,m=[d||pa],n=ca.call(b,"type")?b.type:b,o=ca.call(b,"namespace")?b.namespace.split("."):[];if(h=k=d=d||pa,3!==d.nodeType&&8!==d.nodeType&&!Ja.test(n+fa.event.triggered)&&(n.indexOf(".")>=0&&(o=n.split("."),n=o.shift(),o.sort()),g=n.indexOf(":")<0&&"on"+n,b=b[fa.expando]?b:new fa.Event(n,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=o.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:fa.makeArray(c,[b]),j=fa.event.special[n]||{},e||!j.trigger||j.trigger.apply(d,c)!==!1)){if(!e&&!j.noBubble&&!fa.isWindow(d)){for(i=j.delegateType||n,Ja.test(i+n)||(h=h.parentNode);h;h=h.parentNode)m.push(h),k=h;k===(d.ownerDocument||pa)&&m.push(k.defaultView||k.parentWindow||a)}for(l=0;(h=m[l++])&&!b.isPropagationStopped();)b.type=l>1?i:j.bindType||n,f=(fa._data(h,"events")||{})[b.type]&&fa._data(h,"handle"),f&&f.apply(h,c),f=g&&h[g],f&&f.apply&&fa.acceptData(h)&&(b.result=f.apply(h,c),b.result===!1&&b.preventDefault());if(b.type=n,!e&&!b.isDefaultPrevented()&&(!j._default||j._default.apply(m.pop(),c)===!1)&&fa.acceptData(d)&&g&&d[n]&&!fa.isWindow(d)){k=d[g],k&&(d[g]=null),fa.event.triggered=n;try{d[n]()}catch(a){}fa.event.triggered=void 0,k&&(d[g]=k)}return b.result}},dispatch:function(a){a=fa.event.fix(a);var b,c,d,e,f,g=[],h=Y.call(arguments),i=(fa._data(this,"events")||{})[a.type]||[],j=fa.event.special[a.type]||{};if(h[0]=a,a.delegateTarget=this,!j.preDispatch||j.preDispatch.call(this,a)!==!1){for(g=fa.event.handlers.call(this,a,i),b=0;(e=g[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,f=0;(d=e.handlers[f++])&&!a.isImmediatePropagationStopped();)a.namespace_re&&!a.namespace_re.test(d.namespace)||(a.handleObj=d,a.data=d.data,c=((fa.event.special[d.origType]||{}).handle||d.handler).apply(e.elem,h),void 0!==c&&(a.result=c)===!1&&(a.preventDefault(),a.stopPropagation()));return j.postDispatch&&j.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(i.disabled!==!0||"click"!==a.type)){for(e=[],f=0;f<h;f++)d=b[f],c=d.selector+" ",void 0===e[c]&&(e[c]=d.needsContext?fa(c,this).index(i)>=0:fa.find(c,this,null,[i]).length),e[c]&&e.push(d);e.length&&g.push({elem:i,handlers:e})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[fa.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=Ia.test(e)?this.mouseHooks:Ha.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new fa.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||pa),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||pa,e=d.documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),!a.which&&void 0!==f&&(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==p()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){if(this===p()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(fa.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(a){return fa.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=fa.extend(new fa.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?fa.event.trigger(e,null,b):fa.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},fa.removeEvent=pa.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]===ya&&(a[d]=null),a.detachEvent(d,c))},fa.Event=function(a,b){return this instanceof fa.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?n:o):this.type=a,b&&fa.extend(this,b),this.timeStamp=a&&a.timeStamp||fa.now(),this[fa.expando]=!0,void 0):new fa.Event(a,b)},fa.Event.prototype={isDefaultPrevented:o,isPropagationStopped:o,isImmediatePropagationStopped:o,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=n,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=n,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=n,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},fa.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){fa.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||fa.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),da.submitBubbles||(fa.event.special.submit={setup:function(){return!fa.nodeName(this,"form")&&void fa.event.add(this,"click._submit keypress._submit",function(a){var b=a.target,c=fa.nodeName(b,"input")||fa.nodeName(b,"button")?b.form:void 0;c&&!fa._data(c,"submitBubbles")&&(fa.event.add(c,"submit._submit",function(a){a._submit_bubble=!0}),fa._data(c,"submitBubbles",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&fa.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return!fa.nodeName(this,"form")&&void fa.event.remove(this,"._submit")}}),da.changeBubbles||(fa.event.special.change={setup:function(){return Ga.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(fa.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),fa.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),fa.event.simulate("change",this,a,!0)})),!1):void fa.event.add(this,"beforeactivate._change",function(a){var b=a.target;Ga.test(b.nodeName)&&!fa._data(b,"changeBubbles")&&(fa.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&fa.event.simulate("change",this.parentNode,a,!0)}),fa._data(b,"changeBubbles",!0))})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type)return a.handleObj.handler.apply(this,arguments)},teardown:function(){return fa.event.remove(this,"._change"),!Ga.test(this.nodeName)}}),da.focusinBubbles||fa.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){fa.event.simulate(b,a.target,fa.event.fix(a),!0)};fa.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=fa._data(d,b);e||d.addEventListener(a,c,!0),fa._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=fa._data(d,b)-1;e?fa._data(d,b,e):(d.removeEventListener(a,c,!0),fa._removeData(d,b))}}}),fa.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(f in a)this.on(f,b,c,a[f],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=o;else if(!d)return this;return 1===e&&(g=d,d=function(a){return fa().off(a),g.apply(this,arguments)},d.guid=g.guid||(g.guid=fa.guid++)),this.each(function(){fa.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,fa(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return b!==!1&&"function"!=typeof b||(c=b,b=void 0),c===!1&&(c=o),this.each(function(){fa.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){fa.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return fa.event.trigger(a,b,c,!0)}});var La="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Ma=/ jQuery\d+="(?:null|\d+)"/g,Na=new RegExp("<(?:"+La+")[\\s/>]","i"),Oa=/^\s+/,Pa=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Qa=/<([\w:]+)/,Ra=/<tbody/i,Sa=/<|&#?\w+;/,Ta=/<(?:script|style|link)/i,Ua=/checked\s*(?:[^=]|=\s*.checked.)/i,Va=/^$|\/(?:java|ecma)script/i,Wa=/^true\/(.*)/,Xa=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ya={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:da.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Za=q(pa),$a=Za.appendChild(pa.createElement("div"));Ya.optgroup=Ya.option,Ya.tbody=Ya.tfoot=Ya.colgroup=Ya.caption=Ya.thead,Ya.th=Ya.td,fa.extend({clone:function(a,b,c){var d,e,f,g,h,i=fa.contains(a.ownerDocument,a);if(da.html5Clone||fa.isXMLDoc(a)||!Na.test("<"+a.nodeName+">")?f=a.cloneNode(!0):($a.innerHTML=a.outerHTML,$a.removeChild(f=$a.firstChild)),!(da.noCloneEvent&&da.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||fa.isXMLDoc(a)))for(d=r(f),h=r(a),g=0;null!=(e=h[g]);++g)d[g]&&y(e,d[g]);if(b)if(c)for(h=h||r(a),d=d||r(f),g=0;null!=(e=h[g]);g++)x(e,d[g]);else x(a,f);return d=r(f,"script"),d.length>0&&w(d,!i&&r(a,"script")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k,l=a.length,m=q(b),n=[],o=0;o<l;o++)if(f=a[o],f||0===f)if("object"===fa.type(f))fa.merge(n,f.nodeType?[f]:f);else if(Sa.test(f)){for(h=h||m.appendChild(b.createElement("div")),i=(Qa.exec(f)||["",""])[1].toLowerCase(),k=Ya[i]||Ya._default,h.innerHTML=k[1]+f.replace(Pa,"<$1></$2>")+k[2],e=k[0];e--;)h=h.lastChild;if(!da.leadingWhitespace&&Oa.test(f)&&n.push(b.createTextNode(Oa.exec(f)[0])),!da.tbody)for(f="table"!==i||Ra.test(f)?"<table>"!==k[1]||Ra.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;e--;)fa.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j);for(fa.merge(n,h.childNodes),h.textContent="";h.firstChild;)h.removeChild(h.firstChild);h=m.lastChild}else n.push(b.createTextNode(f));for(h&&m.removeChild(h),da.appendChecked||fa.grep(r(n,"input"),s),o=0;f=n[o++];)if((!d||fa.inArray(f,d)===-1)&&(g=fa.contains(f.ownerDocument,f),h=r(m.appendChild(f),"script"),g&&w(h),c))for(e=0;f=h[e++];)Va.test(f.type||"")&&c.push(f);return h=null,m},cleanData:function(a,b){for(var c,d,e,f,g=0,h=fa.expando,i=fa.cache,j=da.deleteExpando,k=fa.event.special;null!=(c=a[g]);g++)if((b||fa.acceptData(c))&&(e=c[h],f=e&&i[e])){if(f.events)for(d in f.events)k[d]?fa.event.remove(c,d):fa.removeEvent(c,d,f.handle);i[e]&&(delete i[e],j?delete c[h]:typeof c.removeAttribute!==ya?c.removeAttribute(h):c[h]=null,X.push(e))}}}),fa.fn.extend({text:function(a){return Ea(this,function(a){return void 0===a?fa.text(this):this.empty().append((this[0]&&this[0].ownerDocument||pa).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=t(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=t(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?fa.filter(a,this):this,e=0;null!=(c=d[e]);e++)!b&&1===c.nodeType&&fa.cleanData(r(c)),c.parentNode&&(b&&fa.contains(c.ownerDocument,c)&&w(r(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){for(1===a.nodeType&&fa.cleanData(r(a,!1));a.firstChild;)a.removeChild(a.firstChild);a.options&&fa.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null!=a&&a,b=null==b?a:b,this.map(function(){return fa.clone(this,a,b)})},html:function(a){return Ea(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(Ma,""):void 0;if("string"==typeof a&&!Ta.test(a)&&(da.htmlSerialize||!Na.test(a))&&(da.leadingWhitespace||!Oa.test(a))&&!Ya[(Qa.exec(a)||["",""])[1].toLowerCase()]){
a=a.replace(Pa,"<$1></$2>");try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(fa.cleanData(r(b,!1)),b.innerHTML=a);b=0}catch(a){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,fa.cleanData(r(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=Z.apply([],a);var c,d,e,f,g,h,i=0,j=this.length,k=this,l=j-1,m=a[0],n=fa.isFunction(m);if(n||j>1&&"string"==typeof m&&!da.checkClone&&Ua.test(m))return this.each(function(c){var d=k.eq(c);n&&(a[0]=m.call(this,c,d.html())),d.domManip(a,b)});if(j&&(h=fa.buildFragment(a,this[0].ownerDocument,!1,this),c=h.firstChild,1===h.childNodes.length&&(h=c),c)){for(f=fa.map(r(h,"script"),u),e=f.length;i<j;i++)d=h,i!==l&&(d=fa.clone(d,!0,!0),e&&fa.merge(f,r(d,"script"))),b.call(this[i],d,i);if(e)for(g=f[f.length-1].ownerDocument,fa.map(f,v),i=0;i<e;i++)d=f[i],Va.test(d.type||"")&&!fa._data(d,"globalEval")&&fa.contains(g,d)&&(d.src?fa._evalUrl&&fa._evalUrl(d.src):fa.globalEval((d.text||d.textContent||d.innerHTML||"").replace(Xa,"")));h=c=null}return this}}),fa.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){fa.fn[a]=function(a){for(var c,d=0,e=[],f=fa(a),g=f.length-1;d<=g;d++)c=d===g?this:this.clone(!0),fa(f[d])[b](c),$.apply(e,c.get());return this.pushStack(e)}});var _a,ab={};!function(){var a;da.shrinkWrapBlocks=function(){if(null!=a)return a;a=!1;var b,c,d;return c=pa.getElementsByTagName("body")[0],c&&c.style?(b=pa.createElement("div"),d=pa.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),typeof b.style.zoom!==ya&&(b.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",b.appendChild(pa.createElement("div")).style.width="5px",a=3!==b.offsetWidth),c.removeChild(d),a):void 0}}();var bb,cb,db=/^margin/,eb=new RegExp("^("+Ba+")(?!px)[a-z%]+$","i"),fb=/^(top|right|bottom|left)$/;a.getComputedStyle?(bb=function(b){return b.ownerDocument.defaultView.opener?b.ownerDocument.defaultView.getComputedStyle(b,null):a.getComputedStyle(b,null)},cb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||bb(a),g=c?c.getPropertyValue(b)||c[b]:void 0,c&&(""===g&&!fa.contains(a.ownerDocument,a)&&(g=fa.style(a,b)),eb.test(g)&&db.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0===g?g:g+""}):pa.documentElement.currentStyle&&(bb=function(a){return a.currentStyle},cb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||bb(a),g=c?c[b]:void 0,null==g&&h&&h[b]&&(g=h[b]),eb.test(g)&&!fb.test(b)&&(d=h.left,e=a.runtimeStyle,f=e&&e.left,f&&(e.left=a.currentStyle.left),h.left="fontSize"===b?"1em":g,g=h.pixelLeft+"px",h.left=d,f&&(e.left=f)),void 0===g?g:g+""||"auto"}),function(){function b(){var b,c,d,e;c=pa.getElementsByTagName("body")[0],c&&c.style&&(b=pa.createElement("div"),d=pa.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),b.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",f=g=!1,i=!0,a.getComputedStyle&&(f="1%"!==(a.getComputedStyle(b,null)||{}).top,g="4px"===(a.getComputedStyle(b,null)||{width:"4px"}).width,e=b.appendChild(pa.createElement("div")),e.style.cssText=b.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",b.style.width="1px",i=!parseFloat((a.getComputedStyle(e,null)||{}).marginRight),b.removeChild(e)),b.innerHTML="<table><tr><td></td><td>t</td></tr></table>",e=b.getElementsByTagName("td"),e[0].style.cssText="margin:0;border:0;padding:0;display:none",h=0===e[0].offsetHeight,h&&(e[0].style.display="",e[1].style.display="none",h=0===e[0].offsetHeight),c.removeChild(d))}var c,d,e,f,g,h,i;c=pa.createElement("div"),c.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=c.getElementsByTagName("a")[0],d=e&&e.style,d&&(d.cssText="float:left;opacity:.5",da.opacity="0.5"===d.opacity,da.cssFloat=!!d.cssFloat,c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",da.clearCloneStyle="content-box"===c.style.backgroundClip,da.boxSizing=""===d.boxSizing||""===d.MozBoxSizing||""===d.WebkitBoxSizing,fa.extend(da,{reliableHiddenOffsets:function(){return null==h&&b(),h},boxSizingReliable:function(){return null==g&&b(),g},pixelPosition:function(){return null==f&&b(),f},reliableMarginRight:function(){return null==i&&b(),i}}))}(),fa.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var gb=/alpha\([^)]*\)/i,hb=/opacity\s*=\s*([^)]*)/,ib=/^(none|table(?!-c[ea]).+)/,jb=new RegExp("^("+Ba+")(.*)$","i"),kb=new RegExp("^([+-])=("+Ba+")","i"),lb={position:"absolute",visibility:"hidden",display:"block"},mb={letterSpacing:"0",fontWeight:"400"},nb=["Webkit","O","Moz","ms"];fa.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=cb(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:da.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=fa.camelCase(b),i=a.style;if(b=fa.cssProps[h]||(fa.cssProps[h]=C(i,h)),g=fa.cssHooks[b]||fa.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if(f=typeof c,"string"===f&&(e=kb.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(fa.css(a,b)),f="number"),null!=c&&c===c&&("number"===f&&!fa.cssNumber[h]&&(c+="px"),!da.clearCloneStyle&&""===c&&0===b.indexOf("background")&&(i[b]="inherit"),!(g&&"set"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]=c}catch(a){}}},css:function(a,b,c,d){var e,f,g,h=fa.camelCase(b);return b=fa.cssProps[h]||(fa.cssProps[h]=C(a.style,h)),g=fa.cssHooks[b]||fa.cssHooks[h],g&&"get"in g&&(f=g.get(a,!0,c)),void 0===f&&(f=cb(a,b,d)),"normal"===f&&b in mb&&(f=mb[b]),""===c||c?(e=parseFloat(f),c===!0||fa.isNumeric(e)?e||0:f):f}}),fa.each(["height","width"],function(a,b){fa.cssHooks[b]={get:function(a,c,d){if(c)return ib.test(fa.css(a,"display"))&&0===a.offsetWidth?fa.swap(a,lb,function(){return G(a,b,d)}):G(a,b,d)},set:function(a,c,d){var e=d&&bb(a);return E(a,c,d?F(a,b,d,da.boxSizing&&"border-box"===fa.css(a,"boxSizing",!1,e),e):0)}}}),da.opacity||(fa.cssHooks.opacity={get:function(a,b){return hb.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=fa.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===fa.trim(f.replace(gb,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=gb.test(f)?f.replace(gb,e):f+" "+e)}}),fa.cssHooks.marginRight=B(da.reliableMarginRight,function(a,b){if(b)return fa.swap(a,{display:"inline-block"},cb,[a,"marginRight"])}),fa.each({margin:"",padding:"",border:"Width"},function(a,b){fa.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];d<4;d++)e[a+Ca[d]+b]=f[d]||f[d-2]||f[0];return e}},db.test(a)||(fa.cssHooks[a+b].set=E)}),fa.fn.extend({css:function(a,b){return Ea(this,function(a,b,c){var d,e,f={},g=0;if(fa.isArray(b)){for(d=bb(a),e=b.length;g<e;g++)f[b[g]]=fa.css(a,b[g],!1,d);return f}return void 0!==c?fa.style(a,b,c):fa.css(a,b)},a,b,arguments.length>1)},show:function(){return D(this,!0)},hide:function(){return D(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){Da(this)?fa(this).show():fa(this).hide()})}}),fa.Tween=H,H.prototype={constructor:H,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(fa.cssNumber[c]?"":"px")},cur:function(){var a=H.propHooks[this.prop];return a&&a.get?a.get(this):H.propHooks._default.get(this)},run:function(a){var b,c=H.propHooks[this.prop];return this.options.duration?this.pos=b=fa.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):H.propHooks._default.set(this),this}},H.prototype.init.prototype=H.prototype,H.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=fa.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){fa.fx.step[a.prop]?fa.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[fa.cssProps[a.prop]]||fa.cssHooks[a.prop])?fa.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},H.propHooks.scrollTop=H.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},fa.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},fa.fx=H.prototype.init,fa.fx.step={};var ob,pb,qb=/^(?:toggle|show|hide)$/,rb=new RegExp("^(?:([+-])=|)("+Ba+")([a-z%]*)$","i"),sb=/queueHooks$/,tb=[L],ub={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=rb.exec(b),f=e&&e[3]||(fa.cssNumber[a]?"":"px"),g=(fa.cssNumber[a]||"px"!==f&&+d)&&rb.exec(fa.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,fa.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};fa.Animation=fa.extend(N,{tweener:function(a,b){fa.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;d<e;d++)c=a[d],ub[c]=ub[c]||[],ub[c].unshift(b)},prefilter:function(a,b){b?tb.unshift(a):tb.push(a)}}),fa.speed=function(a,b,c){var d=a&&"object"==typeof a?fa.extend({},a):{complete:c||!c&&b||fa.isFunction(a)&&a,duration:a,easing:c&&b||b&&!fa.isFunction(b)&&b};return d.duration=fa.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in fa.fx.speeds?fa.fx.speeds[d.duration]:fa.fx.speeds._default,null!=d.queue&&d.queue!==!0||(d.queue="fx"),d.old=d.complete,d.complete=function(){fa.isFunction(d.old)&&d.old.call(this),d.queue&&fa.dequeue(this,d.queue)},d},fa.fn.extend({fadeTo:function(a,b,c,d){return this.filter(Da).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=fa.isEmptyObject(a),f=fa.speed(b,c,d),g=function(){var b=N(this,fa.extend({},a),f);(e||fa._data(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=fa.timers,g=fa._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&sb.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem===this&&(null==a||f[e].queue===a)&&(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&fa.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=fa._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=fa.timers,g=d?d.length:0;for(c.finish=!0,fa.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<g;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),fa.each(["toggle","show","hide"],function(a,b){var c=fa.fn[b];fa.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(J(b,!0),a,d,e)}}),fa.each({slideDown:J("show"),slideUp:J("hide"),slideToggle:J("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){fa.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),fa.timers=[],fa.fx.tick=function(){var a,b=fa.timers,c=0;for(ob=fa.now();c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||fa.fx.stop(),ob=void 0},fa.fx.timer=function(a){fa.timers.push(a),a()?fa.fx.start():fa.timers.pop()},fa.fx.interval=13,fa.fx.start=function(){pb||(pb=setInterval(fa.fx.tick,fa.fx.interval))},fa.fx.stop=function(){clearInterval(pb),pb=null},fa.fx.speeds={slow:600,fast:200,_default:400},fa.fn.delay=function(a,b){return a=fa.fx?fa.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a,b,c,d,e;b=pa.createElement("div"),b.setAttribute("className","t"),b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",d=b.getElementsByTagName("a")[0],c=pa.createElement("select"),e=c.appendChild(pa.createElement("option")),a=b.getElementsByTagName("input")[0],d.style.cssText="top:1px",da.getSetAttribute="t"!==b.className,da.style=/top/.test(d.getAttribute("style")),da.hrefNormalized="/a"===d.getAttribute("href"),da.checkOn=!!a.value,da.optSelected=e.selected,da.enctype=!!pa.createElement("form").enctype,c.disabled=!0,da.optDisabled=!e.disabled,a=pa.createElement("input"),a.setAttribute("value",""),da.input=""===a.getAttribute("value"),a.value="t",a.setAttribute("type","radio"),da.radioValue="t"===a.value}();var vb=/\r/g;fa.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=fa.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,fa(this).val()):a,null==e?e="":"number"==typeof e?e+="":fa.isArray(e)&&(e=fa.map(e,function(a){return null==a?"":a+""})),b=fa.valHooks[this.type]||fa.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=fa.valHooks[e.type]||fa.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(vb,""):null==c?"":c)}}}),fa.extend({valHooks:{option:{get:function(a){var b=fa.find.attr(a,"value");return null!=b?b:fa.trim(fa.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||e<0,g=f?null:[],h=f?e+1:d.length,i=e<0?h:f?e:0;i<h;i++)if(c=d[i],(c.selected||i===e)&&(da.optDisabled?!c.disabled:null===c.getAttribute("disabled"))&&(!c.parentNode.disabled||!fa.nodeName(c.parentNode,"optgroup"))){if(b=fa(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=fa.makeArray(b),g=e.length;g--;)if(d=e[g],fa.inArray(fa.valHooks.option.get(d),f)>=0)try{d.selected=c=!0}catch(a){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),fa.each(["radio","checkbox"],function(){fa.valHooks[this]={set:function(a,b){if(fa.isArray(b))return a.checked=fa.inArray(fa(a).val(),b)>=0}},da.checkOn||(fa.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var wb,xb,yb=fa.expr.attrHandle,zb=/^(?:checked|selected)$/i,Ab=da.getSetAttribute,Bb=da.input;fa.fn.extend({attr:function(a,b){return Ea(this,fa.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){fa.removeAttr(this,a)})}}),fa.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===ya?fa.prop(a,b,c):(1===f&&fa.isXMLDoc(a)||(b=b.toLowerCase(),d=fa.attrHooks[b]||(fa.expr.match.bool.test(b)?xb:wb)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=fa.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void fa.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(ua);if(f&&1===a.nodeType)for(;c=f[e++];)d=fa.propFix[c]||c,fa.expr.match.bool.test(c)?Bb&&Ab||!zb.test(c)?a[d]=!1:a[fa.camelCase("default-"+c)]=a[d]=!1:fa.attr(a,c,""),a.removeAttribute(Ab?c:d)},attrHooks:{type:{set:function(a,b){if(!da.radioValue&&"radio"===b&&fa.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),xb={set:function(a,b,c){return b===!1?fa.removeAttr(a,c):Bb&&Ab||!zb.test(c)?a.setAttribute(!Ab&&fa.propFix[c]||c,c):a[fa.camelCase("default-"+c)]=a[c]=!0,c}},fa.each(fa.expr.match.bool.source.match(/\w+/g),function(a,b){var c=yb[b]||fa.find.attr;yb[b]=Bb&&Ab||!zb.test(b)?function(a,b,d){var e,f;return d||(f=yb[b],yb[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,yb[b]=f),e}:function(a,b,c){if(!c)return a[fa.camelCase("default-"+b)]?b.toLowerCase():null}}),Bb&&Ab||(fa.attrHooks.value={set:function(a,b,c){return fa.nodeName(a,"input")?void(a.defaultValue=b):wb&&wb.set(a,b,c)}}),Ab||(wb={set:function(a,b,c){var d=a.getAttributeNode(c);if(d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+="","value"===c||b===a.getAttribute(c))return b}},yb.id=yb.name=yb.coords=function(a,b,c){var d;if(!c)return(d=a.getAttributeNode(b))&&""!==d.value?d.value:null},fa.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);if(c&&c.specified)return c.value},set:wb.set},fa.attrHooks.contenteditable={set:function(a,b,c){wb.set(a,""!==b&&b,c)}},fa.each(["width","height"],function(a,b){fa.attrHooks[b]={set:function(a,c){if(""===c)return a.setAttribute(b,"auto"),c}}})),da.style||(fa.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+""}});var Cb=/^(?:input|select|textarea|button|object)$/i,Db=/^(?:a|area)$/i;fa.fn.extend({prop:function(a,b){return Ea(this,fa.prop,a,b,arguments.length>1)},removeProp:function(a){return a=fa.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(a){}})}}),fa.extend({propFix:{for:"htmlFor",class:"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!fa.isXMLDoc(a),f&&(b=fa.propFix[b]||b,e=fa.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=fa.find.attr(a,"tabindex");return b?parseInt(b,10):Cb.test(a.nodeName)||Db.test(a.nodeName)&&a.href?0:-1}}}}),da.hrefNormalized||fa.each(["href","src"],function(a,b){fa.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),da.optSelected||(fa.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}),fa.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){fa.propFix[this.toLowerCase()]=this}),da.enctype||(fa.propFix.enctype="encoding");var Eb=/[\t\r\n\f]/g;fa.fn.extend({addClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j="string"==typeof a&&a;if(fa.isFunction(a))return this.each(function(b){fa(this).addClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(ua)||[];h<i;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Eb," "):" ")){for(f=0;e=b[f++];)d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=fa.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=0===arguments.length||"string"==typeof a&&a;if(fa.isFunction(a))return this.each(function(b){fa(this).removeClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(ua)||[];h<i;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Eb," "):"")){for(f=0;e=b[f++];)for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");g=a?fa.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):fa.isFunction(a)?this.each(function(c){fa(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var b,d=0,e=fa(this),f=a.match(ua)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else c!==ya&&"boolean"!==c||(this.className&&fa._data(this,"__className__",this.className),this.className=this.className||a===!1?"":fa._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;c<d;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(Eb," ").indexOf(b)>=0)return!0;return!1}}),fa.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){fa.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),fa.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var Fb=fa.now(),Gb=/\?/,Hb=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;fa.parseJSON=function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b+"");var c,d=null,e=fa.trim(b+"");return e&&!fa.trim(e.replace(Hb,function(a,b,e,f){return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,"")}))?Function("return "+e)():fa.error("Invalid JSON: "+b)},fa.parseXML=function(b){var c,d;if(!b||"string"!=typeof b)return null;try{a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b))}catch(a){c=void 0}return(!c||!c.documentElement||c.getElementsByTagName("parsererror").length)&&fa.error("Invalid XML: "+b),c};var Ib,Jb,Kb=/#.*$/,Lb=/([?&])_=[^&]*/,Mb=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Nb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ob=/^(?:GET|HEAD)$/,Pb=/^\/\//,Qb=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Rb={},Sb={},Tb="*/".concat("*");try{Jb=location.href}catch(a){Jb=pa.createElement("a"),Jb.href="",Jb=Jb.href}Ib=Qb.exec(Jb.toLowerCase())||[],fa.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Jb,type:"GET",isLocal:Nb.test(Ib[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Tb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":fa.parseJSON,"text xml":fa.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Q(Q(a,fa.ajaxSettings),b):Q(fa.ajaxSettings,a)},ajaxPrefilter:O(Rb),ajaxTransport:O(Sb),ajax:function(a,b){function c(a,b,c,d){var e,k,r,s,u,w=b;2!==t&&(t=2,h&&clearTimeout(h),j=void 0,g=d||"",v.readyState=a>0?4:0,e=a>=200&&a<300||304===a,c&&(s=R(l,v,c)),s=S(l,s,v,e),e?(l.ifModified&&(u=v.getResponseHeader("Last-Modified"),u&&(fa.lastModified[f]=u),u=v.getResponseHeader("etag"),u&&(fa.etag[f]=u)),204===a||"HEAD"===l.type?w="nocontent":304===a?w="notmodified":(w=s.state,k=s.data,r=s.error,e=!r)):(r=w,!a&&w||(w="error",a<0&&(a=0))),v.status=a,v.statusText=(b||w)+"",e?o.resolveWith(m,[k,w,v]):o.rejectWith(m,[v,w,r]),v.statusCode(q),q=void 0,i&&n.trigger(e?"ajaxSuccess":"ajaxError",[v,l,e?k:r]),p.fireWith(m,[v,w]),i&&(n.trigger("ajaxComplete",[v,l]),--fa.active||fa.event.trigger("ajaxStop")))}"object"==typeof a&&(b=a,a=void 0),b=b||{};var d,e,f,g,h,i,j,k,l=fa.ajaxSetup({},b),m=l.context||l,n=l.context&&(m.nodeType||m.jquery)?fa(m):fa.event,o=fa.Deferred(),p=fa.Callbacks("once memory"),q=l.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!k)for(k={};b=Mb.exec(g);)k[b[1].toLowerCase()]=b[2];b=k[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?g:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(l.mimeType=a),this},statusCode:function(a){var b;if(a)if(t<2)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return j&&j.abort(b),c(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,l.url=((a||l.url||Jb)+"").replace(Kb,"").replace(Pb,Ib[1]+"//"),l.type=b.method||b.type||l.method||l.type,l.dataTypes=fa.trim(l.dataType||"*").toLowerCase().match(ua)||[""],null==l.crossDomain&&(d=Qb.exec(l.url.toLowerCase()),l.crossDomain=!(!d||d[1]===Ib[1]&&d[2]===Ib[2]&&(d[3]||("http:"===d[1]?"80":"443"))===(Ib[3]||("http:"===Ib[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=fa.param(l.data,l.traditional)),P(Rb,l,b,v),2===t)return v;i=fa.event&&l.global,i&&0===fa.active++&&fa.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!Ob.test(l.type),f=l.url,l.hasContent||(l.data&&(f=l.url+=(Gb.test(f)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=Lb.test(f)?f.replace(Lb,"$1_="+Fb++):f+(Gb.test(f)?"&":"?")+"_="+Fb++)),l.ifModified&&(fa.lastModified[f]&&v.setRequestHeader("If-Modified-Since",fa.lastModified[f]),fa.etag[f]&&v.setRequestHeader("If-None-Match",fa.etag[f])),(l.data&&l.hasContent&&l.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",l.contentType),v.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+Tb+"; q=0.01":""):l.accepts["*"]);for(e in l.headers)v.setRequestHeader(e,l.headers[e]);if(!l.beforeSend||l.beforeSend.call(m,v,l)!==!1&&2!==t){u="abort";for(e in{success:1,error:1,complete:1})v[e](l[e]);if(j=P(Sb,l,b,v)){v.readyState=1,i&&n.trigger("ajaxSend",[v,l]),l.async&&l.timeout>0&&(h=setTimeout(function(){v.abort("timeout")},l.timeout));try{t=1,j.send(r,c)}catch(a){if(!(t<2))throw a;c(-1,a)}}else c(-1,"No Transport");return v}return v.abort()},getJSON:function(a,b,c){return fa.get(a,b,c,"json")},getScript:function(a,b){return fa.get(a,void 0,b,"script")}}),fa.each(["get","post"],function(a,b){fa[b]=function(a,c,d,e){return fa.isFunction(c)&&(e=e||d,d=c,c=void 0),fa.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),fa._evalUrl=function(a){return fa.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},fa.fn.extend({wrapAll:function(a){if(fa.isFunction(a))return this.each(function(b){fa(this).wrapAll(a.call(this,b))});if(this[0]){var b=fa(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return fa.isFunction(a)?this.each(function(b){fa(this).wrapInner(a.call(this,b))}):this.each(function(){var b=fa(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=fa.isFunction(a);return this.each(function(c){fa(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){fa.nodeName(this,"body")||fa(this).replaceWith(this.childNodes)}).end()}}),fa.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0||!da.reliableHiddenOffsets()&&"none"===(a.style&&a.style.display||fa.css(a,"display"))},fa.expr.filters.visible=function(a){return!fa.expr.filters.hidden(a)};var Ub=/%20/g,Vb=/\[\]$/,Wb=/\r?\n/g,Xb=/^(?:submit|button|image|reset|file)$/i,Yb=/^(?:input|select|textarea|keygen)/i;fa.param=function(a,b){var c,d=[],e=function(a,b){b=fa.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=fa.ajaxSettings&&fa.ajaxSettings.traditional),fa.isArray(a)||a.jquery&&!fa.isPlainObject(a))fa.each(a,function(){e(this.name,this.value)});else for(c in a)T(c,a[c],b,e);return d.join("&").replace(Ub,"+")},fa.fn.extend({serialize:function(){return fa.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=fa.prop(this,"elements");return a?fa.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!fa(this).is(":disabled")&&Yb.test(this.nodeName)&&!Xb.test(a)&&(this.checked||!Fa.test(a))}).map(function(a,b){var c=fa(this).val();return null==c?null:fa.isArray(c)?fa.map(c,function(a){return{name:b.name,value:a.replace(Wb,"\r\n")}}):{name:b.name,value:c.replace(Wb,"\r\n")}}).get()}}),fa.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&U()||V()}:U;var Zb=0,$b={},_b=fa.ajaxSettings.xhr();a.attachEvent&&a.attachEvent("onunload",function(){for(var a in $b)$b[a](void 0,!0)}),da.cors=!!_b&&"withCredentials"in _b,_b=da.ajax=!!_b,_b&&fa.ajaxTransport(function(a){if(!a.crossDomain||da.cors){var b;return{send:function(c,d){var e,f=a.xhr(),g=++Zb;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),!a.crossDomain&&!c["X-Requested-With"]&&(c["X-Requested-With"]="XMLHttpRequest");for(e in c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+"");f.send(a.hasContent&&a.data||null),b=function(c,e){var h,i,j;if(b&&(e||4===f.readyState))if(delete $b[g],b=void 0,f.onreadystatechange=fa.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,"string"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(a){i=""}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=$b[g]=b:b()},abort:function(){b&&b(void 0,!0)}}}}),fa.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return fa.globalEval(a),a}}}),fa.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),fa.ajaxTransport("script",function(a){if(a.crossDomain){var b,c=pa.head||fa("head")[0]||pa.documentElement;return{send:function(d,e){b=pa.createElement("script"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var ac=[],bc=/(=)\?(?=&|$)|\?\?/;fa.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=ac.pop()||fa.expando+"_"+Fb++;return this[a]=!0,a}}),fa.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(bc.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&bc.test(b.data)&&"data");if(h||"jsonp"===b.dataTypes[0])return e=b.jsonpCallback=fa.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(bc,"$1"+e):b.jsonp!==!1&&(b.url+=(Gb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||fa.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,ac.push(e)),g&&fa.isFunction(f)&&f(g[0]),g=f=void 0}),"script"}),fa.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||pa;var d=ma.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=fa.buildFragment([a],b,e),e&&e.length&&fa(e).remove(),fa.merge([],d.childNodes))};var cc=fa.fn.load;fa.fn.load=function(a,b,c){if("string"!=typeof a&&cc)return cc.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=fa.trim(a.slice(h,a.length)),a=a.slice(0,h)),fa.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(f="POST"),g.length>0&&fa.ajax({url:a,type:f,dataType:"html",data:b}).done(function(a){e=arguments,g.html(d?fa("<div>").append(fa.parseHTML(a)).find(d):a);
}).complete(c&&function(a,b){g.each(c,e||[a.responseText,b,a])}),this},fa.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){fa.fn[b]=function(a){return this.on(b,a)}}),fa.expr.filters.animated=function(a){return fa.grep(fa.timers,function(b){return a===b.elem}).length};var dc=a.document.documentElement;fa.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=fa.css(a,"position"),l=fa(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=fa.css(a,"top"),i=fa.css(a,"left"),j=("absolute"===k||"fixed"===k)&&fa.inArray("auto",[f,i])>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),fa.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},fa.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){fa.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=this[0],f=e&&e.ownerDocument;if(f)return b=f.documentElement,fa.contains(b,e)?(typeof e.getBoundingClientRect!==ya&&(d=e.getBoundingClientRect()),c=W(f),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===fa.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),fa.nodeName(a[0],"html")||(c=a.offset()),c.top+=fa.css(a[0],"borderTopWidth",!0),c.left+=fa.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-fa.css(d,"marginTop",!0),left:b.left-c.left-fa.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||dc;a&&!fa.nodeName(a,"html")&&"static"===fa.css(a,"position");)a=a.offsetParent;return a||dc})}}),fa.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c=/Y/.test(b);fa.fn[a]=function(d){return Ea(this,function(a,d,e){var f=W(a);return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void(f?f.scrollTo(c?fa(f).scrollLeft():e,c?e:fa(f).scrollTop()):a[d]=e)},a,d,arguments.length,null)}}),fa.each(["top","left"],function(a,b){fa.cssHooks[b]=B(da.pixelPosition,function(a,c){if(c)return c=cb(a,b),eb.test(c)?fa(a).position()[b]+"px":c})}),fa.each({Height:"height",Width:"width"},function(a,b){fa.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){fa.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return Ea(this,function(b,c,d){var e;return fa.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?fa.css(b,c,g):fa.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),fa.fn.size=function(){return this.length},fa.fn.andSelf=fa.fn.addBack,"function"==typeof c&&c.amd&&c("jquery",[],function(){return fa});var ec=a.jQuery,fc=a.$;return fa.noConflict=function(b){return a.$===fa&&(a.$=fc),b&&a.jQuery===fa&&(a.jQuery=ec),fa},typeof b===ya&&(a.jQuery=a.$=fa),fa}),function(a,b,c){"use strict";function d(a){return function(){var b,c,d=arguments[0],e="["+(a?a+":":"")+d+"] ",f=arguments[1],g=arguments,h=function(a){return"function"==typeof a?a.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof a?"undefined":"string"!=typeof a?JSON.stringify(a):a};for(b=e+f.replace(/\{\d+\}/g,function(a){var b,c=+a.slice(1,-1);return c+2<g.length?(b=g[c+2],"function"==typeof b?b.toString().replace(/ ?\{[\s\S]*$/,""):"undefined"==typeof b?"undefined":"string"!=typeof b?Q(b):b):a}),b=b+"\nhttp://errors.angularjs.org/1.2.32/"+(a?a+"/":"")+d,c=2;c<arguments.length;c++)b=b+(2==c?"?":"&")+"p"+(c-2)+"="+encodeURIComponent(h(arguments[c]));return new Error(b)}}function e(a){if(null==a||z(a))return!1;var b=a.length;return!(1!==a.nodeType||!b)||(u(a)||Gc(a)||0===b||"number"==typeof b&&b>0&&b-1 in a)}function f(a,b,c){var d;if(a)if(x(a))for(d in a)"prototype"!=d&&"length"!=d&&"name"!=d&&(!a.hasOwnProperty||a.hasOwnProperty(d))&&b.call(c,a[d],d);else if(Gc(a)||e(a))for(d=0;d<a.length;d++)b.call(c,a[d],d);else if(a.forEach&&a.forEach!==f)a.forEach(b,c);else for(d in a)a.hasOwnProperty(d)&&b.call(c,a[d],d);return a}function g(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b.sort()}function h(a,b,c){for(var d=g(a),e=0;e<d.length;e++)b.call(c,a[d[e]],d[e]);return d}function i(a){return function(b,c){a(c,b)}}function j(){for(var a,b=Fc.length;b;){if(b--,a=Fc[b].charCodeAt(0),57==a)return Fc[b]="A",Fc.join("");if(90!=a)return Fc[b]=String.fromCharCode(a+1),Fc.join("");Fc[b]="0"}return Fc.unshift("0"),Fc.join("")}function k(a,b){b?a.$$hashKey=b:delete a.$$hashKey}function l(a){var b=a.$$hashKey;return f(arguments,function(b){b!==a&&f(b,function(b,c){a[c]=b})}),k(a,b),a}function m(a){return parseInt(a,10)}function n(a,b){return l(new(l(function(){},{prototype:a})),b)}function o(){}function p(a){return a}function q(a){return function(){return a}}function r(a){return"undefined"==typeof a}function s(a){return"undefined"!=typeof a}function t(a){return null!=a&&"object"==typeof a}function u(a){return"string"==typeof a}function v(a){return"number"==typeof a}function w(a){return"[object Date]"===Cc.call(a)}function x(a){return"function"==typeof a}function y(a){return"[object RegExp]"===Cc.call(a)}function z(a){return a&&a.document&&a.location&&a.alert&&a.setInterval}function A(a){return a&&a.$evalAsync&&a.$watch}function B(a){return"[object File]"===Cc.call(a)}function C(a){return"[object Blob]"===Cc.call(a)}function D(a){return a&&x(a.then)}function E(a){return!!a&&!!(a.nodeName||a.prop&&a.attr&&a.find)}function F(a,b,c){var d=[];return f(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d}function G(a,b){return H(a,b)!=-1}function H(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(b===a[c])return c;return-1}function I(a,b){var c=H(a,b);return c>=0&&a.splice(c,1),b}function J(a,b,c,d){if(z(a)||A(a))throw Dc("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");if(b){if(a===b)throw Dc("cpi","Can't copy! Source and destination are identical.");if(c=c||[],d=d||[],t(a)){var e=H(c,a);if(e!==-1)return d[e];c.push(a),d.push(b)}var g;if(Gc(a)){b.length=0;for(var h=0;h<a.length;h++)g=J(a[h],null,c,d),t(a[h])&&(c.push(a[h]),d.push(g)),b.push(g)}else{var i=b.$$hashKey;Gc(b)?b.length=0:f(b,function(a,c){delete b[c]});for(var j in a)g=J(a[j],null,c,d),t(a[j])&&(c.push(a[j]),d.push(g)),b[j]=g;k(b,i)}}else b=a,a&&(Gc(a)?b=J(a,[],c,d):w(a)?b=new Date(a.getTime()):y(a)?(b=new RegExp(a.source,a.toString().match(/[^\/]*$/)[0]),b.lastIndex=a.lastIndex):t(a)&&(b=J(a,{},c,d)));return b}function K(a,b){if(Gc(a)){b=b||[];for(var c=0;c<a.length;c++)b[c]=a[c]}else if(t(a)){b=b||{};for(var d in a)rc.call(a,d)&&("$"!==d.charAt(0)||"$"!==d.charAt(1))&&(b[d]=a[d])}return b||a}function L(a,b){if(a===b)return!0;if(null===a||null===b)return!1;if(a!==a&&b!==b)return!0;var d,e,f,g=typeof a,h=typeof b;if(g==h&&"object"==g){if(!Gc(a)){if(w(a))return!!w(b)&&(isNaN(a.getTime())&&isNaN(b.getTime())||a.getTime()===b.getTime());if(y(a)&&y(b))return a.toString()==b.toString();if(A(a)||A(b)||z(a)||z(b)||Gc(b))return!1;f={};for(e in a)if("$"!==e.charAt(0)&&!x(a[e])){if(!L(a[e],b[e]))return!1;f[e]=!0}for(e in b)if(!f.hasOwnProperty(e)&&"$"!==e.charAt(0)&&b[e]!==c&&!x(b[e]))return!1;return!0}if(!Gc(b))return!1;if((d=a.length)==b.length){for(e=0;e<d;e++)if(!L(a[e],b[e]))return!1;return!0}}return!1}function M(a,b,c){return a.concat(Ac.call(b,c))}function N(a,b){return Ac.call(a,b||0)}function O(a,b){var c=arguments.length>2?N(arguments,2):[];return!x(b)||b instanceof RegExp?b:c.length?function(){return arguments.length?b.apply(a,c.concat(Ac.call(arguments,0))):b.apply(a,c)}:function(){return arguments.length?b.apply(a,arguments):b.call(a)}}function P(a,d){var e=d;return"string"==typeof a&&"$"===a.charAt(0)?e=c:z(d)?e="$WINDOW":d&&b===d?e="$DOCUMENT":A(d)&&(e="$SCOPE"),e}function Q(a,b){return"undefined"==typeof a?c:JSON.stringify(a,P,b?"  ":null)}function R(a){return u(a)?JSON.parse(a):a}function S(a){if("function"==typeof a)a=!0;else if(a&&0!==a.length){var b=qc(""+a);a="f"!=b&&"0"!=b&&"false"!=b&&"no"!=b&&"n"!=b&&"[]"!=b}else a=!1;return a}function T(a){a=wc(a).clone();try{a.empty()}catch(a){}var b=3,c=wc("<div>").append(a).html();try{return a[0].nodeType===b?qc(c):c.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(a,b){return"<"+qc(b)})}catch(a){return qc(c)}}function U(a){try{return decodeURIComponent(a)}catch(a){}}function V(a){var b,c,d={};return f((a||"").split("&"),function(a){if(a&&(b=a.replace(/\+/g,"%20").split("="),c=U(b[0]),s(c))){var e=!s(b[1])||U(b[1]);rc.call(d,c)?Gc(d[c])?d[c].push(e):d[c]=[d[c],e]:d[c]=e}}),d}function W(a){var b=[];return f(a,function(a,c){Gc(a)?f(a,function(a){b.push(Y(c,!0)+(a===!0?"":"="+Y(a,!0)))}):b.push(Y(c,!0)+(a===!0?"":"="+Y(a,!0)))}),b.length?b.join("&"):""}function X(a){return Y(a,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function Y(a,b){return encodeURIComponent(a).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,b?"%20":"+")}function Z(a,c){function d(a){a&&h.push(a)}var e,g,h=[a],i=["ng:app","ng-app","x-ng-app","data-ng-app"],j=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;f(i,function(c){i[c]=!0,d(b.getElementById(c)),c=c.replace(":","\\:"),a.querySelectorAll&&(f(a.querySelectorAll("."+c),d),f(a.querySelectorAll("."+c+"\\:"),d),f(a.querySelectorAll("["+c+"]"),d))}),f(h,function(a){if(!e){var b=" "+a.className+" ",c=j.exec(b);c?(e=a,g=(c[2]||"").replace(/\s+/g,",")):f(a.attributes,function(b){!e&&i[b.name]&&(e=a,g=b.value)})}}),e&&c(e,g?[g]:[])}function $(c,d){var e=function(){if(c=wc(c),c.injector()){var a=c[0]===b?"document":T(c);throw Dc("btstrpd","App Already Bootstrapped with this Element '{0}'",a.replace(/</,"&lt;").replace(/>/,"&gt;"))}d=d||[],d.unshift(["$provide",function(a){a.value("$rootElement",c)}]),d.unshift("ng");var e=Ha(d);return e.invoke(["$rootScope","$rootElement","$compile","$injector","$animate",function(a,b,c,d,e){a.$apply(function(){b.data("$injector",d),c(b)(a)})}]),e},g=/^NG_DEFER_BOOTSTRAP!/;return a&&!g.test(a.name)?e():(a.name=a.name.replace(g,""),void(Ec.resumeBootstrap=function(a){f(a,function(a){d.push(a)}),e()}))}function _(a,b){return b=b||"_",a.replace(Jc,function(a,c){return(c?b:"")+a.toLowerCase()})}function aa(){xc=a.jQuery,xc&&xc.fn.on?(wc=xc,l(xc.fn,{scope:Xc.scope,isolateScope:Xc.isolateScope,controller:Xc.controller,injector:Xc.injector,inheritedData:Xc.inheritedData}),ka("remove",!0,!0,!1),ka("empty",!1,!1,!1),ka("html",!1,!1,!0)):wc=oa,Ec.element=wc}function ba(a,b,c){if(!a)throw Dc("areq","Argument '{0}' is {1}",b||"?",c||"required");return a}function ca(a,b,c){return c&&Gc(a)&&(a=a[a.length-1]),ba(x(a),b,"not a function, got "+(a&&"object"==typeof a?a.constructor.name||"Object":typeof a)),a}function da(a,b){if("hasOwnProperty"===a)throw Dc("badname","hasOwnProperty is not a valid {0} name",b)}function ea(a,b,c){if(!b)return a;for(var d,e=b.split("."),f=a,g=e.length,h=0;h<g;h++)d=e[h],a&&(a=(f=a)[d]);return!c&&x(a)?O(f,a):a}function fa(a){var b=a[0],c=a[a.length-1];if(b===c)return wc(b);var d=b,e=[d];do{if(d=d.nextSibling,!d)break;e.push(d)}while(d!==c);return wc(e)}function ga(a){function b(a,b,c){return a[b]||(a[b]=c())}var c=d("$injector"),e=d("ng"),f=b(a,"angular",Object);return f.$$minErr=f.$$minErr||d,b(f,"module",function(){var a={};return function(d,f,g){var h=function(a,b){if("hasOwnProperty"===a)throw e("badname","hasOwnProperty is not a valid {0} name",b)};return h(d,"module"),f&&a.hasOwnProperty(d)&&(a[d]=null),b(a,d,function(){function a(a,c,d){return function(){return b[d||"push"]([a,c,arguments]),i}}if(!f)throw c("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",d);var b=[],e=[],h=a("$injector","invoke"),i={_invokeQueue:b,_runBlocks:e,requires:f,name:d,provider:a("$provide","provider"),factory:a("$provide","factory"),service:a("$provide","service"),value:a("$provide","value"),constant:a("$provide","constant","unshift"),animation:a("$animateProvider","register"),filter:a("$filterProvider","register"),controller:a("$controllerProvider","register"),directive:a("$compileProvider","directive"),config:h,run:function(a){return e.push(a),this}};return g&&h(g),i})}})}function ha(b){l(b,{bootstrap:$,copy:J,extend:l,equals:L,element:wc,forEach:f,injector:Ha,noop:o,bind:O,toJson:Q,fromJson:R,identity:p,isUndefined:r,isDefined:s,isString:u,isFunction:x,isObject:t,isNumber:v,isElement:E,isArray:Gc,version:Kc,isDate:w,lowercase:qc,uppercase:sc,callbacks:{counter:0},$$minErr:d,$$csp:Ic}),yc=ga(a);try{yc("ngLocale")}catch(a){yc("ngLocale",[]).provider("$locale",cb)}yc("ng",["ngLocale"],["$provide",function(a){a.provider({$$sanitizeUri:Gb}),a.provider("$compile",Oa).directive({a:Hd,input:Sd,textarea:Sd,form:Ld,script:Ae,select:De,style:Fe,option:Ee,ngBind:ce,ngBindHtml:ee,ngBindTemplate:de,ngClass:fe,ngClassEven:he,ngClassOdd:ge,ngCloak:ie,ngController:je,ngForm:Md,ngHide:ue,ngIf:me,ngInclude:ne,ngInit:pe,ngNonBindable:qe,ngPluralize:re,ngRepeat:se,ngShow:te,ngStyle:ve,ngSwitch:we,ngSwitchWhen:xe,ngSwitchDefault:ye,ngOptions:Ce,ngTransclude:ze,ngModel:Yd,ngList:_d,ngChange:Zd,required:$d,ngRequired:$d,ngValue:be}).directive({ngInclude:oe}).directive(Id).directive(ke),a.provider({$anchorScroll:Ia,$animate:ed,$browser:La,$cacheFactory:Ma,$controller:Ra,$document:Sa,$exceptionHandler:Ta,$filter:Rb,$interpolate:ab,$interval:bb,$http:Ya,$httpBackend:$a,$location:qb,$log:rb,$parse:Bb,$rootScope:Fb,$q:Cb,$sce:Lb,$sceDelegate:Kb,$sniffer:Mb,$templateCache:Na,$timeout:Nb,$window:Qb,$$rAF:Eb,$$asyncCallback:Ja})}])}function ia(){return++Mc}function ja(a){return a.replace(Pc,function(a,b,c,d){return d?c.toUpperCase():c}).replace(Qc,"Moz$1")}function ka(a,b,c,d){function e(a){var e,g,h,i,j,k,l,m=c&&a?[this.filter(a)]:[this],n=b;if(!d||null!=a)for(;m.length;)for(e=m.shift(),g=0,h=e.length;g<h;g++)for(i=wc(e[g]),n?i.triggerHandler("$destroy"):n=!n,j=0,k=(l=i.children()).length;j<k;j++)m.push(xc(l[j]));return f.apply(this,arguments)}var f=xc.fn[a];f=f.$original||f,e.$original=f,xc.fn[a]=e}function la(a){return!Tc.test(a)}function ma(a,b){var c,d,e,f,g,h,i=b.createDocumentFragment(),j=[];if(la(a))j.push(b.createTextNode(a));else{for(c=i.appendChild(b.createElement("div")),d=(Uc.exec(a)||["",""])[1].toLowerCase(),e=Wc[d]||Wc._default,c.innerHTML="<div>&#160;</div>"+e[1]+a.replace(Vc,"<$1></$2>")+e[2],c.removeChild(c.firstChild),f=e[0];f--;)c=c.lastChild;for(g=0,h=c.childNodes.length;g<h;++g)j.push(c.childNodes[g]);c=i.firstChild,c.textContent=""}return i.textContent="",i.innerHTML="",j}function na(a,c){c=c||b;var d;return(d=Sc.exec(a))?[c.createElement(d[1])]:ma(a,c)}function oa(a){if(a instanceof oa)return a;if(u(a)&&(a=Hc(a)),!(this instanceof oa)){if(u(a)&&"<"!=a.charAt(0))throw Rc("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new oa(a)}if(u(a)){ya(this,na(a));var c=wc(b.createDocumentFragment());c.append(this)}else ya(this,a)}function pa(a){return a.cloneNode(!0)}function qa(a){sa(a);for(var b=0,c=a.childNodes||[];b<c.length;b++)qa(c[b])}function ra(a,b,c,d){if(s(d))throw Rc("offargs","jqLite#off() does not support the `selector` argument");var e=ta(a,"events"),g=ta(a,"handle");g&&(r(b)?f(e,function(b,c){Oc(a,c,b),delete e[c]}):f(b.split(" "),function(b){r(c)?(Oc(a,b,e[b]),delete e[b]):I(e[b]||[],c)}))}function sa(a,b){var d=a.ng339,e=Lc[d];if(e){if(b)return void delete Lc[d].data[b];e.handle&&(e.events.$destroy&&e.handle({},"$destroy"),ra(a)),delete Lc[d],a.ng339=c}}function ta(a,b,c){var d=a.ng339,e=Lc[d||-1];return s(c)?(e||(a.ng339=d=ia(),e=Lc[d]={}),void(e[b]=c)):e&&e[b]}function ua(a,b,c){var d=ta(a,"data"),e=s(c),f=!e&&s(b),g=f&&!t(b);if(!d&&!g&&ta(a,"data",d={}),e)d[b]=c;else{if(!f)return d;if(g)return d&&d[b];l(d,b)}}function va(a,b){return!!a.getAttribute&&(" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+b+" ")>-1}function wa(a,b){b&&a.setAttribute&&f(b.split(" "),function(b){a.setAttribute("class",Hc((" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+Hc(b)+" "," ")))})}function xa(a,b){if(b&&a.setAttribute){var c=(" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");f(b.split(" "),function(a){a=Hc(a),c.indexOf(" "+a+" ")===-1&&(c+=a+" ")}),a.setAttribute("class",Hc(c))}}function ya(a,b){if(b){b=b.nodeName||!s(b.length)||z(b)?[b]:b;for(var c=0;c<b.length;c++)a.push(b[c])}}function za(a,b){return Aa(a,"$"+(b||"ngController")+"Controller")}function Aa(a,b,d){9==a.nodeType&&(a=a.documentElement);for(var e=Gc(b)?b:[b];a;){for(var f=0,g=e.length;f<g;f++)if((d=wc.data(a,e[f]))!==c)return d;a=a.parentNode||11===a.nodeType&&a.host}}function Ba(a){for(var b=0,c=a.childNodes;b<c.length;b++)qa(c[b]);for(;a.firstChild;)a.removeChild(a.firstChild)}function Ca(a,b){var c=Yc[b.toLowerCase()];return c&&Zc[a.nodeName]&&c}function Da(a,c){var d=function(d,e){if(d.preventDefault||(d.preventDefault=function(){d.returnValue=!1}),d.stopPropagation||(d.stopPropagation=function(){d.cancelBubble=!0}),d.target||(d.target=d.srcElement||b),r(d.defaultPrevented)){var g=d.preventDefault;d.preventDefault=function(){d.defaultPrevented=!0,g.call(d)},d.defaultPrevented=!1}d.isDefaultPrevented=function(){return d.defaultPrevented||d.returnValue===!1};var h=K(c[e||d.type]||[]);f(h,function(b){b.call(a,d)}),vc<=8?(d.preventDefault=null,d.stopPropagation=null,d.isDefaultPrevented=null):(delete d.preventDefault,delete d.stopPropagation,delete d.isDefaultPrevented)};return d.elem=a,d}function Ea(a,b){var d,e=typeof a;return"function"==e||"object"==e&&null!==a?"function"==typeof(d=a.$$hashKey)?d=a.$$hashKey():d===c&&(d=a.$$hashKey=(b||j)()):d=a,e+":"+d}function Fa(a,b){if(b){var c=0;this.nextUid=function(){return++c}}f(a,this.put,this)}function Ga(a){var b,c,d,e;return"function"==typeof a?(b=a.$inject)||(b=[],a.length&&(c=a.toString().replace(bd,""),d=c.match($c),f(d[1].split(_c),function(a){a.replace(ad,function(a,c,d){b.push(d)})})),a.$inject=b):Gc(a)?(e=a.length-1,ca(a[e],"fn"),b=a.slice(0,e)):ca(a,"fn",!0),b}function Ha(a){function b(a){return function(b,c){return t(b)?void f(b,i(a)):a(b,c)}}function c(a,b){if(da(a,"service"),(x(b)||Gc(b))&&(b=v.instantiate(b)),!b.$get)throw cd("pget","Provider '{0}' must define $get factory method.",a);return s[a+n]=b}function d(a,b){return c(a,{$get:b})}function e(a,b){return d(a,["$injector",function(a){return a.instantiate(b)}])}function g(a,b){return d(a,q(b))}function h(a,b){da(a,"constant"),s[a]=b,w[a]=b}function j(a,b){var c=v.get(a+n),d=c.$get;c.$get=function(){var a=y.invoke(d,c);return y.invoke(b,null,{$delegate:a})}}function k(a){var b,c,d,e,g=[];return f(a,function(a){if(!r.get(a)){r.put(a,!0);try{if(u(a))for(b=yc(a),g=g.concat(k(b.requires)).concat(b._runBlocks),c=b._invokeQueue,d=0,e=c.length;d<e;d++){var f=c[d],h=v.get(f[0]);h[f[1]].apply(h,f[2])}else x(a)?g.push(v.invoke(a)):Gc(a)?g.push(v.invoke(a)):ca(a,"module")}catch(b){throw Gc(a)&&(a=a[a.length-1]),b.message&&b.stack&&b.stack.indexOf(b.message)==-1&&(b=b.message+"\n"+b.stack),cd("modulerr","Failed to instantiate module {0} due to:\n{1}",a,b.stack||b.message||b)}}}),g}function l(a,b){function c(c){if(a.hasOwnProperty(c)){if(a[c]===m)throw cd("cdep","Circular dependency found: {0}",c+" <- "+p.join(" <- "));return a[c]}try{return p.unshift(c),a[c]=m,a[c]=b(c)}catch(b){throw a[c]===m&&delete a[c],b}finally{p.shift()}}function d(a,b,d){var e,f,g,h=[],i=Ga(a);for(f=0,e=i.length;f<e;f++){if(g=i[f],"string"!=typeof g)throw cd("itkn","Incorrect injection token! Expected service name as string, got {0}",g);h.push(d&&d.hasOwnProperty(g)?d[g]:c(g))}return Gc(a)&&(a=a[e]),a.apply(b,h)}function e(a,b){var c,e,f=function(){};return f.prototype=(Gc(a)?a[a.length-1]:a).prototype,c=new f,e=d(a,c,b),t(e)||x(e)?e:c}return{invoke:d,instantiate:e,get:c,annotate:Ga,has:function(b){return s.hasOwnProperty(b+n)||a.hasOwnProperty(b)}}}var m={},n="Provider",p=[],r=new Fa([],!0),s={$provide:{provider:b(c),factory:b(d),service:b(e),value:b(g),constant:b(h),decorator:j}},v=s.$injector=l(s,function(){throw cd("unpr","Unknown provider: {0}",p.join(" <- "))}),w={},y=w.$injector=l(w,function(a){var b=v.get(a+n);return y.invoke(b.$get,b)});return f(k(a),function(a){y.invoke(a||o)}),y}function Ia(){var a=!0;this.disableAutoScrolling=function(){a=!1},this.$get=["$window","$location","$rootScope",function(b,c,d){function e(a){var b=null;return f(a,function(a){!b&&"a"===qc(a.nodeName)&&(b=a)}),b}function g(){var a,d=c.hash();d?(a=h.getElementById(d))?a.scrollIntoView():(a=e(h.getElementsByName(d)))?a.scrollIntoView():"top"===d&&b.scrollTo(0,0):b.scrollTo(0,0)}var h=b.document;return a&&d.$watch(function(){return c.hash()},function(){d.$evalAsync(g)}),g}]}function Ja(){this.$get=["$$rAF","$timeout",function(a,b){return a.supported?function(b){return a(b)}:function(a){return b(a,0,!1)}}]}function Ka(a,b,d,e){function g(a){try{a.apply(null,N(arguments,1))}finally{if(t--,0===t)for(;v.length;)try{v.pop()()}catch(a){d.error(a)}}}function h(a){var b=a.indexOf("#");return b===-1?"":a.substr(b+1)}function i(a,b){!function c(){f(x,function(a){a()}),w=b(c,a)}()}function j(){y!=k.url()&&(y=k.url(),f(B,function(a){a(k.url())}))}var k=this,l=b[0],m=a.location,n=a.history,p=a.setTimeout,q=a.clearTimeout,s={};k.isMock=!1;var t=0,v=[];k.$$completeOutstandingRequest=g,k.$$incOutstandingRequestCount=function(){t++},k.notifyWhenNoOutstandingRequests=function(a){f(x,function(a){a()}),0===t?a():v.push(a)};var w,x=[];k.addPollFn=function(a){return r(w)&&i(100,p),x.push(a),a};var y=m.href,z=b.find("base"),A=null;k.url=function(b,c){if(m!==a.location&&(m=a.location),n!==a.history&&(n=a.history),b){if(y==b)return;var d=y&&hb(y)===hb(b);return y=b,!d&&e.history?c?n.replaceState(null,"",b):(n.pushState(null,"",b),z.attr("href",z.attr("href"))):(d||(A=b),c?m.replace(b):d?m.hash=h(b):m.href=b),k}return A||m.href.replace(/%27/g,"'")};var B=[],C=!1;k.onUrlChange=function(b){return C||(e.history&&wc(a).on("popstate",j),e.hashchange?wc(a).on("hashchange",j):k.addPollFn(j),C=!0),B.push(b),b},k.$$checkUrlChange=j,k.baseHref=function(){var a=z.attr("href");return a?a.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var D={},E="",F=k.baseHref();k.cookies=function(a,b){var e,f,g,h,i;if(!a){if(l.cookie!==E)for(E=l.cookie,f=E.split("; "),D={},h=0;h<f.length;h++)g=f[h],i=g.indexOf("="),i>0&&(a=unescape(g.substring(0,i)),D[a]===c&&(D[a]=unescape(g.substring(i+1))));return D}b===c?l.cookie=escape(a)+"=;path="+F+";expires=Thu, 01 Jan 1970 00:00:00 GMT":u(b)&&(e=(l.cookie=escape(a)+"="+escape(b)+";path="+F).length+1,e>4096&&d.warn("Cookie '"+a+"' possibly not set or overflowed because it was too large ("+e+" > 4096 bytes)!"))},k.defer=function(a,b){var c;return t++,c=p(function(){delete s[c],g(a)},b||0),s[c]=!0,c},k.defer.cancel=function(a){return!!s[a]&&(delete s[a],q(a),g(o),!0)}}function La(){this.$get=["$window","$log","$sniffer","$document",function(a,b,c,d){return new Ka(a,d,b,c)}]}function Ma(){this.$get=function(){function a(a,c){function e(a){a!=m&&(n?n==a&&(n=a.n):n=a,f(a.n,a.p),f(a,m),m=a,m.n=null)}function f(a,b){a!=b&&(a&&(a.p=b),b&&(b.n=a))}if(a in b)throw d("$cacheFactory")("iid","CacheId '{0}' is already taken!",a);var g=0,h=l({},c,{id:a}),i={},j=c&&c.capacity||Number.MAX_VALUE,k={},m=null,n=null;return b[a]={put:function(a,b){if(j<Number.MAX_VALUE){var c=k[a]||(k[a]={key:a});e(c)}if(!r(b))return a in i||g++,i[a]=b,g>j&&this.remove(n.key),b},get:function(a){if(j<Number.MAX_VALUE){var b=k[a];if(!b)return;e(b)}return i[a]},remove:function(a){if(j<Number.MAX_VALUE){var b=k[a];if(!b)return;b==m&&(m=b.p),b==n&&(n=b.n),f(b.n,b.p),delete k[a]}delete i[a],g--},removeAll:function(){i={},g=0,k={},m=n=null},destroy:function(){i=null,h=null,k=null,delete b[a]},info:function(){return l({},h,{size:g})}}}var b={};return a.info=function(){var a={};return f(b,function(b,c){a[c]=b.info()}),a},a.get=function(a){return b[a]},a}}function Na(){this.$get=["$cacheFactory",function(a){return a("templates")}]}function Oa(a,d){var e={},g="Directive",h=/^\s*directive\:\s*([\d\w_\-]+)\s+(.*)$/,j=/(([\d\w_\-]+)(?:\:([^;]+))?;?)/,k=/^(on[a-z]+|formaction)$/;this.directive=function b(c,d){return da(c,"directive"),u(c)?(ba(d,"directiveFactory"),e.hasOwnProperty(c)||(e[c]=[],a.factory(c+g,["$injector","$exceptionHandler",function(a,b){var d=[];return f(e[c],function(e,f){try{var g=a.invoke(e);x(g)?g={compile:q(g)}:!g.compile&&g.link&&(g.compile=q(g.link)),g.priority=g.priority||0,g.index=f,g.name=g.name||c,g.require=g.require||g.controller&&g.name,g.restrict=g.restrict||"A",d.push(g)}catch(a){b(a)}}),d}])),e[c].push(d)):f(c,i(b)),this},this.aHrefSanitizationWhitelist=function(a){return s(a)?(d.aHrefSanitizationWhitelist(a),this):d.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(a){return s(a)?(d.imgSrcSanitizationWhitelist(a),this):d.imgSrcSanitizationWhitelist()},this.$get=["$injector","$interpolate","$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function(a,d,i,m,o,q,r,s,v,w,y,z){function A(a,b,c,d,e){a instanceof wc||(a=wc(a)),f(a,function(b,c){3==b.nodeType&&b.nodeValue.match(/\S+/)&&(a[c]=b=wc(b).wrap("<span></span>").parent()[0])});var g=C(a,b,a,c,d,e);return B(a,"ng-scope"),function(b,c,d,e){ba(b,"scope");var h=c?Xc.clone.call(a):a;f(d,function(a,b){h.data("$"+b+"Controller",a)});for(var i=0,j=h.length;i<j;i++){var k=h[i],l=k.nodeType;(1===l||9===l)&&h.eq(i).data("$scope",b)}return c&&c(h,b),g&&g(b,h,h,e),h}}function B(a,b){try{a.addClass(b)}catch(a){}}function C(a,b,d,e,f,g){function h(a,d,e,f){var g,h,i,j,k,l,m,n,p=d.length,q=new Array(p);for(k=0;k<p;k++)q[k]=d[k];for(k=0,m=0,l=o.length;k<l;m++)i=q[m],g=o[k++],h=o[k++],g?(g.scope?(j=a.$new(),wc.data(i,"$scope",j)):j=a,n=g.transcludeOnThisElement?D(a,g.transclude,f):!g.templateOnThisElement&&f?f:!f&&b?D(a,b):null,g(h,j,i,e,n)):h&&h(a,i.childNodes,c,f)}for(var i,j,k,l,m,n,o=[],p=0;p<a.length;p++)i=new X,j=E(a[p],[],i,0===p?e:c,f),k=j.length?H(j,a[p],i,b,d,null,[],[],g):null,k&&k.scope&&B(i.$$element,"ng-scope"),m=k&&k.terminal||!(l=a[p].childNodes)||!l.length?null:C(l,k?(k.transcludeOnThisElement||!k.templateOnThisElement)&&k.transclude:b),o.push(k,m),n=n||k||m,g=null;return n?h:null}function D(a,b,c){var d=function(d,e,f){var g=!1;d||(d=a.$new(),d.$$transcluded=!0,g=!0);var h=b(d,e,f,c);return g&&h.on("$destroy",function(){d.$destroy()}),h};return d}function E(a,b,c,d,e){var f,g,i,k=a.nodeType,l=c.$attr;switch(k){case 1:g=zc(a).toLowerCase(),J(b,Pa(g),"E",d,e);for(var m,n,o,p,q,r,s=a.attributes,t=0,v=s&&s.length;t<v;t++){var w=!1,x=!1;if(m=s[t],!vc||vc>=8||m.specified){n=m.name,q=Hc(m.value),p=Pa(n),(r=aa.test(p))&&(n=_(p.substr(6),"-"));var y=p.replace(/(Start|End)$/,"");p===y+"Start"&&(w=n,x=n.substr(0,n.length-5)+"end",n=n.substr(0,n.length-6)),o=Pa(n.toLowerCase()),l[o]=n,!r&&c.hasOwnProperty(o)||(c[o]=q,Ca(a,o)&&(c[o]=!0)),U(a,b,q,o),J(b,o,"A",d,e,w,x)}}if("input"===g&&"hidden"===a.getAttribute("type")&&a.setAttribute("autocomplete","off"),i=a.className,u(i)&&""!==i)for(;f=j.exec(i);)o=Pa(f[2]),J(b,o,"C",d,e)&&(c[o]=Hc(f[3])),i=i.substr(f.index+f[0].length);break;case 3:if(11===vc)for(;a.parentNode&&a.nextSibling&&3===a.nextSibling.nodeType;)a.nodeValue=a.nodeValue+a.nextSibling.nodeValue,a.parentNode.removeChild(a.nextSibling);R(b,a.nodeValue);break;case 8:try{f=h.exec(a.nodeValue),f&&(o=Pa(f[1]),J(b,o,"M",d,e)&&(c[o]=Hc(f[2])))}catch(a){}}return b.sort(P),b}function F(a,b,c){var d=[],e=0;if(b&&a.hasAttribute&&a.hasAttribute(b)){do{if(!a)throw fd("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",b,c);1==a.nodeType&&(a.hasAttribute(b)&&e++,a.hasAttribute(c)&&e--),d.push(a),a=a.nextSibling}while(e>0)}else d.push(a);return wc(d)}function G(a,b,c){return function(d,e,f,g,h){return e=F(e[0],b,c),a(d,e,f,g,h)}}function H(a,e,g,h,j,k,l,m,n){function o(a,b,c,d){a&&(c&&(a=G(a,c,d)),a.require=w.require,a.directiveName=y,(P===w||w.$$isolateScope)&&(a=W(a,{isolateScope:!0})),l.push(a)),b&&(c&&(b=G(b,c,d)),b.require=w.require,b.directiveName=y,(P===w||w.$$isolateScope)&&(b=W(b,{isolateScope:!0})),m.push(b))}function p(a,b,c,d){var e,g="data",h=!1;if(u(b)){for(;"^"==(e=b.charAt(0))||"?"==e;)b=b.substr(1),"^"==e&&(g="inheritedData"),h=h||"?"==e;if(e=null,d&&"data"===g&&(e=d[b]),e=e||c[g]("$"+b+"Controller"),!e&&!h)throw fd("ctreq","Controller '{0}', required by directive '{1}', can't be found!",b,a);return e}return Gc(b)&&(e=[],f(b,function(b){e.push(p(a,b,c,d))})),e}function s(a,b,h,j,k){function n(a,b){var d;return arguments.length<2&&(b=a,a=c),Z&&(d=z),k(a,b,d)}var o,s,t,u,v,w,x,y,z={};if(o=e===h?g:K(g,new X(wc(h),g.$attr)),s=o.$$element,P){var A=/^\s*([@=&])(\??)\s*(\w*)\s*$/;x=b.$new(!0),!R||R!==P&&R!==P.$$originalDirective?s.data("$isolateScopeNoTemplate",x):s.data("$isolateScope",x),B(s,"ng-isolate-scope"),f(P.scope,function(a,c){var e,f,g,h,i=a.match(A)||[],j=i[3]||c,k="?"==i[2],l=i[1];switch(x.$$isolateBindings[c]=l+j,l){case"@":o.$observe(j,function(a){x[c]=a}),o.$$observers[j].$$scope=b,o[j]&&(x[c]=d(o[j])(b));break;case"=":if(k&&!o[j])return;f=q(o[j]),h=f.literal?L:function(a,b){return a===b||a!==a&&b!==b},g=f.assign||function(){throw e=x[c]=f(b),fd("nonassign","Expression '{0}' used with directive '{1}' is non-assignable!",o[j],P.name)},e=x[c]=f(b),x.$watch(function(){var a=f(b);return h(a,x[c])||(h(a,e)?g(b,a=x[c]):x[c]=a),e=a},null,f.literal);break;case"&":f=q(o[j]),x[c]=function(a){return f(b,a)};break;default:throw fd("iscp","Invalid isolate scope definition for directive '{0}'. Definition: {... {1}: '{2}' ...}",P.name,c,a)}})}for(y=k&&n,J&&f(J,function(a){var c,d={$scope:a===P||a.$$isolateScope?x:b,$element:s,$attrs:o,$transclude:y};w=a.controller,"@"==w&&(w=o[a.name]),c=r(w,d),z[a.name]=c,Z||s.data("$"+a.name+"Controller",c),a.controllerAs&&(d.$scope[a.controllerAs]=c)}),t=0,u=l.length;t<u;t++)try{(v=l[t])(v.isolateScope?x:b,s,o,v.require&&p(v.directiveName,v.require,s,z),y)}catch(a){i(a,T(s))}var C=b;for(P&&(P.template||null===P.templateUrl)&&(C=x),a&&a(C,h.childNodes,c,k),t=m.length-1;t>=0;t--)try{(v=m[t])(v.isolateScope?x:b,s,o,v.require&&p(v.directiveName,v.require,s,z),y)}catch(a){i(a,T(s))}}n=n||{};for(var v,w,y,z,C,D,H=-Number.MAX_VALUE,J=n.controllerDirectives,P=n.newIsolateScopeDirective,R=n.templateDirective,S=n.nonTlbTranscludeDirective,U=!1,Y=!1,Z=n.hasElementTranscludeDirective,_=g.$$element=wc(e),aa=k,ba=h,ca=0,da=a.length;ca<da;ca++){w=a[ca];var ea=w.$$start,fa=w.$$end;if(ea&&(_=F(e,ea,fa)),z=c,H>w.priority)break;if((D=w.scope)&&(v=v||w,w.templateUrl||(Q("new/isolated scope",P,w,_),t(D)&&(P=w))),y=w.name,!w.templateUrl&&w.controller&&(D=w.controller,J=J||{},Q("'"+y+"' controller",J[y],w,_),J[y]=w),(D=w.transclude)&&(U=!0,w.$$tlb||(Q("transclusion",S,w,_),S=w),"element"==D?(Z=!0,H=w.priority,z=_,_=g.$$element=wc(b.createComment(" "+y+": "+g[y]+" ")),e=_[0],V(j,N(z),e),ba=A(z,h,H,aa&&aa.name,{nonTlbTranscludeDirective:S})):(z=wc(pa(e)).contents(),_.empty(),ba=A(z,h))),w.template)if(Y=!0,Q("template",R,w,_),R=w,D=x(w.template)?w.template(_,g):w.template,D=$(D),w.replace){if(aa=w,z=la(D)?[]:wc(Hc(D)),e=z[0],1!=z.length||1!==e.nodeType)throw fd("tplrt","Template for directive '{0}' must have exactly one root element. {1}",y,"");V(j,_,e);var ga={$attr:{}},ha=E(e,[],ga),ia=a.splice(ca+1,a.length-(ca+1));P&&I(ha),a=a.concat(ha).concat(ia),M(g,ga),da=a.length}else _.html(D);if(w.templateUrl)Y=!0,Q("template",R,w,_),R=w,w.replace&&(aa=w),s=O(a.splice(ca,a.length-ca),_,g,j,U&&ba,l,m,{controllerDirectives:J,newIsolateScopeDirective:P,templateDirective:R,nonTlbTranscludeDirective:S}),da=a.length;else if(w.compile)try{C=w.compile(_,g,ba),x(C)?o(null,C,ea,fa):C&&o(C.pre,C.post,ea,fa)}catch(a){i(a,T(_))}w.terminal&&(s.terminal=!0,H=Math.max(H,w.priority));
}return s.scope=v&&v.scope===!0,s.transcludeOnThisElement=U,s.templateOnThisElement=Y,s.transclude=ba,n.hasElementTranscludeDirective=Z,s}function I(a){for(var b=0,c=a.length;b<c;b++)a[b]=n(a[b],{$$isolateScope:!0})}function J(b,d,f,h,j,k,l){if(d===j)return null;var m=null;if(e.hasOwnProperty(d))for(var o,p=a.get(d+g),q=0,r=p.length;q<r;q++)try{o=p[q],(h===c||h>o.priority)&&o.restrict.indexOf(f)!=-1&&(k&&(o=n(o,{$$start:k,$$end:l})),b.push(o),m=o)}catch(a){i(a)}return m}function M(a,b){var c=b.$attr,d=a.$attr,e=a.$$element;f(a,function(d,e){"$"!=e.charAt(0)&&(b[e]&&b[e]!==d&&(d+=("style"===e?";":" ")+b[e]),a.$set(e,d,!0,c[e]))}),f(b,function(b,f){"class"==f?(B(e,b),a.class=(a.class?a.class+" ":"")+b):"style"==f?(e.attr("style",e.attr("style")+";"+b),a.style=(a.style?a.style+";":"")+b):"$"!=f.charAt(0)&&!a.hasOwnProperty(f)&&(a[f]=b,d[f]=c[f])})}function O(a,b,c,d,e,g,h,i){var j,k,n=[],p=b[0],q=a.shift(),r=l({},q,{templateUrl:null,transclude:null,replace:null,$$originalDirective:q}),s=x(q.templateUrl)?q.templateUrl(b,c):q.templateUrl;return b.empty(),m.get(w.getTrustedResourceUrl(s),{cache:o}).success(function(l){var m,o,u,v;if(l=$(l),q.replace){if(u=la(l)?[]:wc(Hc(l)),m=u[0],1!=u.length||1!==m.nodeType)throw fd("tplrt","Template for directive '{0}' must have exactly one root element. {1}",q.name,s);o={$attr:{}},V(d,b,m);var w=E(m,[],o);t(q.scope)&&I(w),a=w.concat(a),M(c,o)}else m=p,b.html(l);for(a.unshift(r),j=H(a,m,c,e,b,q,g,h,i),f(d,function(a,c){a==m&&(d[c]=b[0])}),k=C(b[0].childNodes,e);n.length;){var x=n.shift(),y=n.shift(),z=n.shift(),A=n.shift(),F=b[0];if(y!==p){var G=y.className;i.hasElementTranscludeDirective&&q.replace||(F=pa(m)),V(z,wc(y),F),B(wc(F),G)}v=j.transcludeOnThisElement?D(x,j.transclude,A):A,j(k,x,F,d,v)}n=null}).error(function(a,b,c,d){throw fd("tpload","Failed to load template: {0}",d.url)}),function(a,b,c,d,e){var f=e;n?(n.push(b),n.push(c),n.push(d),n.push(f)):(j.transcludeOnThisElement&&(f=D(b,j.transclude,e)),j(k,b,c,d,f))}}function P(a,b){var c=b.priority-a.priority;return 0!==c?c:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function Q(a,b,c,d){if(b)throw fd("multidir","Multiple directives [{0}, {1}] asking for {2} on: {3}",b.name,c.name,a,T(d))}function R(a,b){var c=d(b,!0);c&&a.push({priority:0,compile:function(a){var b=a.parent(),d=b.length;return d&&B(a.parent(),"ng-binding"),function(a,b){var e=b.parent(),f=e.data("$binding")||[];f.push(c),e.data("$binding",f),d||B(e,"ng-binding"),a.$watch(c,function(a){b[0].nodeValue=a})}}})}function S(a,b){if("srcdoc"==b)return w.HTML;var c=zc(a);return"xlinkHref"==b||"FORM"==c&&"action"==b||"LINK"==c&&"href"==b||"IMG"!=c&&("src"==b||"ngSrc"==b)?w.RESOURCE_URL:void 0}function U(a,b,c,e){var f=d(c,!0);if(f){if("multiple"===e&&"SELECT"===zc(a))throw fd("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",T(a));b.push({priority:100,compile:function(){return{pre:function(b,c,g){var h=g.$$observers||(g.$$observers={});if(k.test(e))throw fd("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");f=d(g[e],!0,S(a,e)),f&&(g[e]=f(b),(h[e]||(h[e]=[])).$$inter=!0,(g.$$observers&&g.$$observers[e].$$scope||b).$watch(f,function(a,b){"class"===e&&a!=b?g.$updateClass(a,b):g.$set(e,a)}))}}}})}}function V(a,c,d){var e,f,g=c[0],h=c.length,i=g.parentNode;if(a)for(e=0,f=a.length;e<f;e++)if(a[e]==g){a[e++]=d;for(var j=e,k=j+h-1,l=a.length;j<l;j++,k++)k<l?a[j]=a[k]:delete a[j];a.length-=h-1;break}i&&i.replaceChild(d,g);var m=b.createDocumentFragment();m.appendChild(g),d[wc.expando]=g[wc.expando];for(var n=1,o=c.length;n<o;n++){var p=c[n];wc(p).remove(),m.appendChild(p),delete c[n]}c[0]=d,c.length=1}function W(a,b){return l(function(){return a.apply(null,arguments)},a,b)}var X=function(a,b){this.$$element=a,this.$attr=b||{}};X.prototype={$normalize:Pa,$addClass:function(a){a&&a.length>0&&y.addClass(this.$$element,a)},$removeClass:function(a){a&&a.length>0&&y.removeClass(this.$$element,a)},$updateClass:function(a,b){var c=Qa(a,b),d=Qa(b,a);0===c.length?y.removeClass(this.$$element,d):0===d.length?y.addClass(this.$$element,c):y.setClass(this.$$element,c,d)},$set:function(a,b,d,e){var g,h=Ca(this.$$element[0],a);h&&(this.$$element.prop(a,b),e=h),this[a]=b,e?this.$attr[a]=e:(e=this.$attr[a],e||(this.$attr[a]=e=_(a,"-"))),g=zc(this.$$element).toUpperCase(),("A"===g&&("href"===a||"xlinkHref"===a)||"IMG"===g&&"src"===a)&&(this[a]=b=z(b,"src"===a)),d!==!1&&(null===b||b===c?this.$$element.removeAttr(e):this.$$element.attr(e,b));var j=this.$$observers;j&&f(j[a],function(a){try{a(b)}catch(a){i(a)}})},$observe:function(a,b){var c=this,d=c.$$observers||(c.$$observers={}),e=d[a]||(d[a]=[]);return e.push(b),s.$evalAsync(function(){e.$$inter||b(c[a])}),b}};var Y=d.startSymbol(),Z=d.endSymbol(),$="{{"==Y||"}}"==Z?p:function(a){return a.replace(/\{\{/g,Y).replace(/}}/g,Z)},aa=/^ngAttr[A-Z]/;return A}]}function Pa(a){return ja(a.replace(gd,""))}function Qa(a,b){var c="",d=a.split(/\s+/),e=b.split(/\s+/);a:for(var f=0;f<d.length;f++){for(var g=d[f],h=0;h<e.length;h++)if(g==e[h])continue a;c+=(c.length>0?" ":"")+g}return c}function Ra(){var a={},b=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(b,c){da(b,"controller"),t(b)?l(a,b):a[b]=c},this.$get=["$injector","$window",function(c,e){return function(f,g){var h,i,j,k;if(u(f)&&(i=f.match(b),j=i[1],k=i[3],f=a.hasOwnProperty(j)?a[j]:ea(g.$scope,j,!0)||ea(e,j,!0),ca(f,j,!0)),h=c.instantiate(f,g),k){if(!g||"object"!=typeof g.$scope)throw d("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",j||f.name,k);g.$scope[k]=h}return h}}]}function Sa(){this.$get=["$window",function(a){return wc(a.document)}]}function Ta(){this.$get=["$log",function(a){return function(b,c){a.error.apply(a,arguments)}}]}function Ua(a){var b,c,d,e={};return a?(f(a.split("\n"),function(a){d=a.indexOf(":"),b=qc(Hc(a.substr(0,d))),c=Hc(a.substr(d+1)),b&&(e[b]=e[b]?e[b]+", "+c:c)}),e):e}function Va(a){var b=t(a)?a:c;return function(c){return b||(b=Ua(a)),c?b[qc(c)]||null:b}}function Wa(a,b,c){return x(c)?c(a,b):(f(c,function(c){a=c(a,b)}),a)}function Xa(a){return 200<=a&&a<300}function Ya(){var a=/^\s*(\[|\{[^\{])/,b=/[\}\]]\s*$/,d=/^\)\]\}',?\n/,e={"Content-Type":"application/json;charset=utf-8"},g=this.defaults={transformResponse:[function(c){return u(c)&&(c=c.replace(d,""),a.test(c)&&b.test(c)&&(c=R(c))),c}],transformRequest:[function(a){return!t(a)||B(a)||C(a)?a:Q(a)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:K(e),put:K(e),patch:K(e)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},i=this.interceptors=[],j=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function(a,b,d,e,k,m){function n(a){function b(a){var b=l({},a,{data:Wa(a.data,a.headers,e.transformResponse)});return Xa(a.status)?b:k.reject(b)}function d(a){function b(a){var b;f(a,function(c,d){x(c)&&(b=c(),null!=b?a[d]=b:delete a[d])})}var c,d,e,h=g.headers,i=l({},a.headers);h=l({},h.common,h[qc(a.method)]);a:for(c in h){d=qc(c);for(e in i)if(qc(e)===d)continue a;i[c]=h[c]}return b(i),i}var e={method:"get",transformRequest:g.transformRequest,transformResponse:g.transformResponse},h=d(a);l(e,a),e.headers=h,e.method=sc(e.method);var i=function(a){h=a.headers;var c=Wa(a.data,Va(h),a.transformRequest);return r(c)&&f(h,function(a,b){"content-type"===qc(b)&&delete h[b]}),r(a.withCredentials)&&!r(g.withCredentials)&&(a.withCredentials=g.withCredentials),q(a,c,h).then(b,b)},j=[i,c],m=k.when(e);for(f(z,function(a){(a.request||a.requestError)&&j.unshift(a.request,a.requestError),(a.response||a.responseError)&&j.push(a.response,a.responseError)});j.length;){var n=j.shift(),o=j.shift();m=m.then(n,o)}return m.success=function(a){return m.then(function(b){a(b.data,b.status,b.headers,e)}),m},m.error=function(a){return m.then(null,function(b){a(b.data,b.status,b.headers,e)}),m},m}function o(a){f(arguments,function(a){n[a]=function(b,c){return n(l(c||{},{method:a,url:b}))}})}function p(a){f(arguments,function(a){n[a]=function(b,c,d){return n(l(d||{},{method:a,url:b,data:c}))}})}function q(d,f,h){function i(a,b,c,d){m&&(Xa(a)?m.put(u,[a,b,Ua(c),d]):m.remove(u)),j(b,a,c,d),e.$$phase||e.$apply()}function j(a,b,c,e){b=Math.max(b,0),(Xa(b)?p.resolve:p.reject)({data:a,status:b,headers:Va(c),config:d,statusText:e})}function l(){var a=H(n.pendingRequests,d);a!==-1&&n.pendingRequests.splice(a,1)}var m,o,p=k.defer(),q=p.promise,u=v(d.url,d.params);if(n.pendingRequests.push(d),q.then(l,l),(d.cache||g.cache)&&d.cache!==!1&&("GET"===d.method||"JSONP"===d.method)&&(m=t(d.cache)?d.cache:t(g.cache)?g.cache:y),m)if(o=m.get(u),s(o)){if(D(o))return o.then(l,l),o;Gc(o)?j(o[1],o[0],K(o[2]),o[3]):j(o,200,{},"OK")}else m.put(u,q);if(r(o)){var w=Pb(d.url)?b.cookies()[d.xsrfCookieName||g.xsrfCookieName]:c;w&&(h[d.xsrfHeaderName||g.xsrfHeaderName]=w),a(d.method,u,f,i,h,d.timeout,d.withCredentials,d.responseType)}return q}function v(a,b){if(!b)return a;var c=[];return h(b,function(a,b){null===a||r(a)||(Gc(a)||(a=[a]),f(a,function(a){t(a)&&(a=w(a)?a.toISOString():Q(a)),c.push(Y(b)+"="+Y(a))}))}),c.length>0&&(a+=(a.indexOf("?")==-1?"?":"&")+c.join("&")),a}var y=d("$http"),z=[];return f(i,function(a){z.unshift(u(a)?m.get(a):m.invoke(a))}),f(j,function(a,b){var c=u(a)?m.get(a):m.invoke(a);z.splice(b,0,{response:function(a){return c(k.when(a))},responseError:function(a){return c(k.reject(a))}})}),n.pendingRequests=[],o("get","delete","head","jsonp"),p("post","put","patch"),n.defaults=g,n}]}function Za(b){if(vc<=8&&(!b.match(/^(get|post|head|put|delete|options)$/i)||!a.XMLHttpRequest))return new a.ActiveXObject("Microsoft.XMLHTTP");if(a.XMLHttpRequest)return new a.XMLHttpRequest;throw d("$httpBackend")("noxhr","This browser does not support XMLHttpRequest.")}function $a(){this.$get=["$browser","$window","$document",function(a,b,c){return _a(a,Za,a.defer,b.angular.callbacks,c[0])}]}function _a(a,b,c,d,e){function g(a,b,c){var f=e.createElement("script"),g=null;return f.type="text/javascript",f.src=a,f.async=!0,g=function(a){Oc(f,"load",g),Oc(f,"error",g),e.body.removeChild(f),f=null;var h=-1,i="unknown";a&&("load"===a.type&&!d[b].called&&(a={type:"error"}),i=a.type,h="error"===a.type?404:200),c&&c(h,i)},Nc(f,"load",g),Nc(f,"error",g),vc<=8&&(f.onreadystatechange=function(){u(f.readyState)&&/loaded|complete/.test(f.readyState)&&(f.onreadystatechange=null,g({type:"load"}))}),e.body.appendChild(f),g}var h=-1;return function(e,i,j,k,l,m,n,p){function q(){t=h,v&&v(),w&&w.abort()}function r(b,d,e,f,g){x&&c.cancel(x),v=w=null,0===d&&(d=e?200:"file"==Ob(i).protocol?404:0),d=1223===d?204:d,g=g||"",b(d,e,f,g),a.$$completeOutstandingRequest(o)}var t;if(a.$$incOutstandingRequestCount(),i=i||a.url(),"jsonp"==qc(e)){var u="_"+(d.counter++).toString(36);d[u]=function(a){d[u].data=a,d[u].called=!0};var v=g(i.replace("JSON_CALLBACK","angular.callbacks."+u),u,function(a,b){r(k,a,d[u].data,"",b),d[u]=o})}else{var w=b(e);if(w.open(e,i,!0),f(l,function(a,b){s(a)&&w.setRequestHeader(b,a)}),w.onreadystatechange=function(){if(w&&4==w.readyState){var a=null,b=null,c="";t!==h&&(a=w.getAllResponseHeaders(),b="response"in w?w.response:w.responseText),t===h&&vc<10||(c=w.statusText),r(k,t||w.status,b,a,c)}},n&&(w.withCredentials=!0),p)try{w.responseType=p}catch(a){if("json"!==p)throw a}w.send(j||null)}if(m>0)var x=c(q,m);else D(m)&&m.then(q)}}function ab(){var a="{{",b="}}";this.startSymbol=function(b){return b?(a=b,this):a},this.endSymbol=function(a){return a?(b=a,this):b},this.$get=["$parse","$exceptionHandler","$sce",function(c,d,e){function f(f,i,j){for(var k,l,m,n,o=0,p=[],q=f.length,r=!1,s=[];o<q;)(k=f.indexOf(a,o))!=-1&&(l=f.indexOf(b,k+g))!=-1?(o!=k&&p.push(f.substring(o,k)),p.push(m=c(n=f.substring(k+g,l))),m.exp=n,o=l+h,r=!0):(o!=q&&p.push(f.substring(o)),o=q);if((q=p.length)||(p.push(""),q=1),j&&p.length>1)throw hd("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",f);if(!i||r)return s.length=q,m=function(a){try{for(var b,c=0,g=q;c<g;c++){if("function"==typeof(b=p[c]))if(b=b(a),b=j?e.getTrusted(j,b):e.valueOf(b),null==b)b="";else switch(typeof b){case"string":break;case"number":b=""+b;break;default:b=Q(b)}s[c]=b}return s.join("")}catch(a){var h=hd("interr","Can't interpolate: {0}\n{1}",f,a.toString());d(h)}},m.exp=f,m.parts=p,m}var g=a.length,h=b.length;return f.startSymbol=function(){return a},f.endSymbol=function(){return b},f}]}function bb(){this.$get=["$rootScope","$window","$q",function(a,b,c){function d(d,f,g,h){var i=b.setInterval,j=b.clearInterval,k=c.defer(),l=k.promise,m=0,n=s(h)&&!h;return g=s(g)?g:0,l.then(null,null,d),l.$$intervalId=i(function(){k.notify(m++),g>0&&m>=g&&(k.resolve(m),j(l.$$intervalId),delete e[l.$$intervalId]),n||a.$apply()},f),e[l.$$intervalId]=k,l}var e={};return d.cancel=function(a){return!!(a&&a.$$intervalId in e)&&(e[a.$$intervalId].reject("canceled"),b.clearInterval(a.$$intervalId),delete e[a.$$intervalId],!0)},d}]}function cb(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"¤",posSuf:"",negPre:"(¤",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),SHORTMONTH:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),DAY:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),SHORTDAY:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a",short:"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(a){return 1===a?"one":"other"}}}}function db(a){for(var b=a.split("/"),c=b.length;c--;)b[c]=X(b[c]);return b.join("/")}function eb(a,b,c){var d=Ob(a,c);b.$$protocol=d.protocol,b.$$host=d.hostname,b.$$port=m(d.port)||jd[d.protocol]||null}function fb(a,b,c){var d="/"!==a.charAt(0);d&&(a="/"+a);var e=Ob(a,c);b.$$path=decodeURIComponent(d&&"/"===e.pathname.charAt(0)?e.pathname.substring(1):e.pathname),b.$$search=V(e.search),b.$$hash=decodeURIComponent(e.hash),b.$$path&&"/"!=b.$$path.charAt(0)&&(b.$$path="/"+b.$$path)}function gb(a,b){if(0===b.indexOf(a))return b.substr(a.length)}function hb(a){var b=a.indexOf("#");return b==-1?a:a.substr(0,b)}function ib(a){return a.replace(/(#.+)|#$/,"$1")}function jb(a){return a.substr(0,hb(a).lastIndexOf("/")+1)}function kb(a){return a.substring(0,a.indexOf("/",a.indexOf("//")+2))}function lb(a,b){this.$$html5=!0,b=b||"";var d=jb(a);eb(a,this,a),this.$$parse=function(b){var c=gb(d,b);if(!u(c))throw kd("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',b,d);fb(c,this,a),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var a=W(this.$$search),b=this.$$hash?"#"+X(this.$$hash):"";this.$$url=db(this.$$path)+(a?"?"+a:"")+b,this.$$absUrl=d+this.$$url.substr(1)},this.$$parseLinkUrl=function(e,f){var g,h,i;return(g=gb(a,e))!==c?(h=g,i=(g=gb(b,g))!==c?d+(gb("/",g)||g):a+h):(g=gb(d,e))!==c?i=d+g:d==e+"/"&&(i=d),i&&this.$$parse(i),!!i}}function mb(a,b){var c=jb(a);eb(a,this,a),this.$$parse=function(d){function e(a,b,c){var d,e=/^\/[A-Z]:(\/.*)/;return 0===b.indexOf(c)&&(b=b.replace(c,"")),e.exec(b)?a:(d=e.exec(a),d?d[1]:a)}var f=gb(a,d)||gb(c,d),g="#"==f.charAt(0)?gb(b,f):this.$$html5?f:"";if(!u(g))throw kd("ihshprfx",'Invalid url "{0}", missing hash prefix "{1}".',d,b);fb(g,this,a),this.$$path=e(this.$$path,g,a),this.$$compose()},this.$$compose=function(){var c=W(this.$$search),d=this.$$hash?"#"+X(this.$$hash):"";this.$$url=db(this.$$path)+(c?"?"+c:"")+d,this.$$absUrl=a+(this.$$url?b+this.$$url:"")},this.$$parseLinkUrl=function(b,c){return hb(a)==hb(b)&&(this.$$parse(b),!0)}}function nb(a,b){this.$$html5=!0,mb.apply(this,arguments);var c=jb(a);this.$$parseLinkUrl=function(d,e){var f,g;return a==hb(d)?f=d:(g=gb(c,d))?f=a+b+g:c===d+"/"&&(f=c),f&&this.$$parse(f),!!f},this.$$compose=function(){var c=W(this.$$search),d=this.$$hash?"#"+X(this.$$hash):"";this.$$url=db(this.$$path)+(c?"?"+c:"")+d,this.$$absUrl=a+b+this.$$url}}function ob(a){return function(){return this[a]}}function pb(a,b){return function(c){return r(c)?this[a]:(this[a]=b(c),this.$$compose(),this)}}function qb(){var b="",c=!1;this.hashPrefix=function(a){return s(a)?(b=a,this):b},this.html5Mode=function(a){return s(a)?(c=a,this):c},this.$get=["$rootScope","$browser","$sniffer","$rootElement",function(d,e,f,g){function h(a){d.$broadcast("$locationChangeSuccess",i.absUrl(),a)}var i,j,k,l=e.baseHref(),m=e.url();c?(k=kb(m)+(l||"/"),j=f.history?lb:nb):(k=hb(m),j=mb),i=new j(k,"#"+b),i.$$parseLinkUrl(m,m);var n=/^\s*(javascript|mailto):/i;g.on("click",function(b){if(!b.ctrlKey&&!b.metaKey&&2!=b.which){for(var c=wc(b.target);"a"!==qc(c[0].nodeName);)if(c[0]===g[0]||!(c=c.parent())[0])return;var f=c.prop("href"),h=c.attr("href")||c.attr("xlink:href");t(f)&&"[object SVGAnimatedString]"===f.toString()&&(f=Ob(f.animVal).href),n.test(f)||f&&!c.attr("target")&&!b.isDefaultPrevented()&&i.$$parseLinkUrl(f,h)&&(b.preventDefault(),i.absUrl()!=e.url()&&(d.$apply(),a.angular["ff-684208-preventDefault"]=!0))}}),i.absUrl()!=m&&e.url(i.absUrl(),!0),e.onUrlChange(function(a){i.absUrl()!=a&&(d.$evalAsync(function(){var b=i.absUrl();i.$$parse(a),d.$broadcast("$locationChangeStart",a,b).defaultPrevented?(i.$$parse(b),e.url(b)):h(b)}),d.$$phase||d.$digest())});var o=0;return d.$watch(function(){var a=ib(e.url()),b=ib(i.absUrl()),c=i.$$replace;return o&&a==b||(o++,d.$evalAsync(function(){d.$broadcast("$locationChangeStart",i.absUrl(),a).defaultPrevented?i.$$parse(a):(e.url(i.absUrl(),c),h(a))})),i.$$replace=!1,o}),i}]}function rb(){var a=!0,b=this;this.debugEnabled=function(b){return s(b)?(a=b,this):a},this.$get=["$window",function(c){function d(a){return a instanceof Error&&(a.stack?a=a.message&&a.stack.indexOf(a.message)===-1?"Error: "+a.message+"\n"+a.stack:a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line)),a}function e(a){var b=c.console||{},e=b[a]||b.log||o,g=!1;try{g=!!e.apply}catch(a){}return g?function(){var a=[];return f(arguments,function(b){a.push(d(b))}),e.apply(b,a)}:function(a,b){e(a,null==b?"":b)}}return{log:e("log"),info:e("info"),warn:e("warn"),error:e("error"),debug:function(){var c=e("debug");return function(){a&&c.apply(b,arguments)}}()}}]}function sb(a,b){if("__defineGetter__"===a||"__defineSetter__"===a||"__lookupGetter__"===a||"__lookupSetter__"===a||"__proto__"===a)throw md("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",b);return a}function tb(a,b){if(a+="",!u(a))throw md("iseccst","Cannot convert object to primitive value! Expression: {0}",b);return a}function ub(a,b){if(a){if(a.constructor===a)throw md("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",b);if(a.document&&a.location&&a.alert&&a.setInterval)throw md("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",b);if(a.children&&(a.nodeName||a.prop&&a.attr&&a.find))throw md("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",b);if(a===Object)throw md("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",b)}return a}function vb(a,b){if(a){if(a.constructor===a)throw md("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",b);if(a===od||a===pd||qd&&a===qd)throw md("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",b)}}function wb(a,b,d,e,f){ub(a,e),f=f||{};for(var g,h=b.split("."),i=0;h.length>1;i++){g=sb(h.shift(),e);var j=ub(a[g],e);j||(j={},a[g]=j),a=j,a.then&&f.unwrapPromises&&(ld(e),"$$v"in a||function(a){a.then(function(b){a.$$v=b})}(a),a.$$v===c&&(a.$$v={}),a=a.$$v)}return g=sb(h.shift(),e),ub(a[g],e),a[g]=d,d}function xb(a){return"constructor"==a}function yb(a,b,d,e,f,g,h){sb(a,g),sb(b,g),sb(d,g),sb(e,g),sb(f,g);var i=function(a){return ub(a,g)},j=h.expensiveChecks,k=j||xb(a)?i:p,l=j||xb(b)?i:p,m=j||xb(d)?i:p,n=j||xb(e)?i:p,o=j||xb(f)?i:p;return h.unwrapPromises?function(h,i){var j,p=i&&i.hasOwnProperty(a)?i:h;return null==p?p:(p=k(p[a]),p&&p.then&&(ld(g),"$$v"in p||(j=p,j.$$v=c,j.then(function(a){j.$$v=k(a)})),p=k(p.$$v)),b?null==p?c:(p=l(p[b]),p&&p.then&&(ld(g),"$$v"in p||(j=p,j.$$v=c,j.then(function(a){j.$$v=l(a)})),p=l(p.$$v)),d?null==p?c:(p=m(p[d]),p&&p.then&&(ld(g),"$$v"in p||(j=p,j.$$v=c,j.then(function(a){j.$$v=m(a)})),p=m(p.$$v)),e?null==p?c:(p=n(p[e]),p&&p.then&&(ld(g),"$$v"in p||(j=p,j.$$v=c,j.then(function(a){j.$$v=n(a)})),p=n(p.$$v)),f?null==p?c:(p=o(p[f]),p&&p.then&&(ld(g),"$$v"in p||(j=p,j.$$v=c,j.then(function(a){j.$$v=o(a)})),p=o(p.$$v)),p):p):p):p):p)}:function(g,h){var i=h&&h.hasOwnProperty(a)?h:g;return null==i?i:(i=k(i[a]),b?null==i?c:(i=l(i[b]),d?null==i?c:(i=m(i[d]),e?null==i?c:(i=n(i[e]),f?null==i?c:i=o(i[f]):i):i):i):i)}}function zb(a,b){return function(c,d){return a(c,d,ld,ub,b)}}function Ab(a,b,d){var e=b.expensiveChecks,g=e?wd:vd;if(g.hasOwnProperty(a))return g[a];var h,i=a.split("."),j=i.length;if(b.csp)h=j<6?yb(i[0],i[1],i[2],i[3],i[4],d,b):function(a,e){var f,g=0;do f=yb(i[g++],i[g++],i[g++],i[g++],i[g++],d,b)(a,e),e=c,a=f;while(g<j);return f};else{var k="var p;\n";e&&(k+="s = eso(s, fe);\nl = eso(l, fe);\n");var l=e;f(i,function(a,c){sb(a,d);var f=(c?"s":'((l&&l.hasOwnProperty("'+a+'"))?l:s)')+'["'+a+'"]',g=e||xb(a);g&&(f="eso("+f+", fe)",l=!0),k+="if(s == null) return undefined;\ns="+f+";\n",b.unwrapPromises&&(k+='if (s && s.then) {\n pw("'+d.replace(/(["\r\n])/g,"\\$1")+'");\n if (!("$$v" in s)) {\n p=s;\n p.$$v = undefined;\n p.then(function(v) {p.$$v='+(g?"eso(v)":"v")+";});\n}\n s="+(g?"eso(s.$$v)":"s.$$v")+"\n}\n")}),k+="return s;";var m=new Function("s","l","pw","eso","fe",k);m.toString=q(k),(l||b.unwrapPromises)&&(m=zb(m,d)),h=m}return"hasOwnProperty"!==a&&(g[a]=h),h}function Bb(){var a={},b={},c={csp:!1,unwrapPromises:!1,logPromiseWarnings:!0,expensiveChecks:!1};this.unwrapPromises=function(a){return s(a)?(c.unwrapPromises=!!a,this):c.unwrapPromises},this.logPromiseWarnings=function(a){return s(a)?(c.logPromiseWarnings=a,this):c.logPromiseWarnings},this.$get=["$filter","$sniffer","$log",function(d,e,f){c.csp=e.csp;var g={csp:c.csp,unwrapPromises:c.unwrapPromises,logPromiseWarnings:c.logPromiseWarnings,expensiveChecks:!0};return ld=function(a){c.logPromiseWarnings&&!nd.hasOwnProperty(a)&&(nd[a]=!0,f.warn("[$parse] Promise found in the expression `"+a+"`. Automatic unwrapping of promises in Angular expressions is deprecated."))},function(e,f){var h;switch(typeof e){case"string":var i=f?b:a;if(i.hasOwnProperty(e))return i[e];var j=f?g:c,k=new td(j),l=new ud(k,d,j);return h=l.parse(e),"hasOwnProperty"!==e&&(i[e]=h),h;case"function":return e;default:return o}}}]}function Cb(){this.$get=["$rootScope","$exceptionHandler",function(a,b){return Db(function(b){a.$evalAsync(b)},b)}]}function Db(a,b){function d(a){return a}function e(a){return j(a)}function g(a){var b=h(),c=0,d=Gc(a)?[]:{};return f(a,function(a,e){c++,i(a).then(function(a){d.hasOwnProperty(e)||(d[e]=a,--c||b.resolve(d))},function(a){d.hasOwnProperty(e)||b.reject(a)})}),0===c&&b.resolve(d),b.promise}var h=function(){var f,g,j=[];return g={resolve:function(b){if(j){var d=j;j=c,f=i(b),d.length&&a(function(){for(var a,b=0,c=d.length;b<c;b++)a=d[b],f.then(a[0],a[1],a[2])})}},reject:function(a){g.resolve(k(a))},notify:function(b){if(j){var c=j;j.length&&a(function(){for(var a,d=0,e=c.length;d<e;d++)a=c[d],a[2](b)})}},promise:{then:function(a,c,g){var i=h(),k=function(c){try{i.resolve((x(a)?a:d)(c))}catch(a){i.reject(a),b(a)}},l=function(a){try{i.resolve((x(c)?c:e)(a))}catch(a){i.reject(a),b(a)}},m=function(a){try{i.notify((x(g)?g:d)(a))}catch(a){b(a)}};return j?j.push([k,l,m]):f.then(k,l,m),i.promise},catch:function(a){return this.then(null,a)},finally:function(a){function b(a,b){var c=h();return b?c.resolve(a):c.reject(a),c.promise}function c(c,e){var f=null;try{f=(a||d)()}catch(a){return b(a,!1)}return D(f)?f.then(function(){return b(c,e)},function(a){return b(a,!1)}):b(c,e)}return this.then(function(a){return c(a,!0)},function(a){return c(a,!1)})}}}},i=function(b){return D(b)?b:{then:function(c){var d=h();return a(function(){d.resolve(c(b))}),d.promise}}},j=function(a){var b=h();return b.reject(a),b.promise},k=function(c){return{then:function(d,f){var g=h();return a(function(){try{g.resolve((x(f)?f:e)(c))}catch(a){g.reject(a),b(a)}}),g.promise}}},l=function(c,f,g,k){var l,m=h(),n=function(a){try{return(x(f)?f:d)(a)}catch(a){return b(a),j(a)}},o=function(a){try{return(x(g)?g:e)(a)}catch(a){return b(a),j(a)}},p=function(a){try{return(x(k)?k:d)(a)}catch(a){b(a)}};return a(function(){i(c).then(function(a){l||(l=!0,m.resolve(i(a).then(n,o,p)))},function(a){l||(l=!0,m.resolve(o(a)))},function(a){l||m.notify(p(a))})}),m.promise};return{defer:h,reject:j,when:l,all:g}}function Eb(){this.$get=["$window","$timeout",function(a,b){var c=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame,d=a.cancelAnimationFrame||a.webkitCancelAnimationFrame||a.mozCancelAnimationFrame||a.webkitCancelRequestAnimationFrame,e=!!c,f=e?function(a){var b=c(a);return function(){d(b)}}:function(a){var c=b(a,16.66,!1);return function(){b.cancel(c)}};return f.supported=e,f}]}function Fb(){var a=10,b=d("$rootScope"),c=null;this.digestTtl=function(b){return arguments.length&&(a=b),a},this.$get=["$injector","$exceptionHandler","$parse","$browser",function(d,g,h,i){function k(){this.$id=j(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.this=this.$root=this,this.$$destroyed=!1,this.$$asyncQueue=[],this.$$postDigestQueue=[],this.$$listeners={},this.$$listenerCount={},this.$$isolateBindings={}}function l(a){if(r.$$phase)throw b("inprog","{0} already in progress",r.$$phase);r.$$phase=a}function m(){r.$$phase=null}function n(a,b){var c=h(a);return ca(c,b),c}function p(a,b,c){do a.$$listenerCount[c]-=b,0===a.$$listenerCount[c]&&delete a.$$listenerCount[c];while(a=a.$parent)}function q(){}k.prototype={constructor:k,$new:function(a){var b;return a?(b=new k,b.$root=this.$root,b.$$asyncQueue=this.$$asyncQueue,b.$$postDigestQueue=this.$$postDigestQueue):(this.$$childScopeClass||(this.$$childScopeClass=function(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$id=j(),this.$$childScopeClass=null},this.$$childScopeClass.prototype=this),b=new this.$$childScopeClass),b.this=b,b.$parent=this,b.$$prevSibling=this.$$childTail,this.$$childHead?(this.$$childTail.$$nextSibling=b,this.$$childTail=b):this.$$childHead=this.$$childTail=b,b},$watch:function(a,b,d){var e=this,f=n(a,"watch"),g=e.$$watchers,h={fn:b,last:q,get:f,exp:a,eq:!!d};if(c=null,!x(b)){var i=n(b||o,"listener");h.fn=function(a,b,c){i(c)}}if("string"==typeof a&&f.constant){var j=h.fn;h.fn=function(a,b,c){j.call(this,a,b,c),I(g,h)}}return g||(g=e.$$watchers=[]),g.unshift(h),function(){I(g,h),c=null}},$watchCollection:function(a,b){function c(){f=m(j);var a,b,c;if(t(f))if(e(f)){g!==n&&(g=n,q=g.length=0,l++),a=f.length,q!==a&&(l++,g.length=q=a);for(var d=0;d<a;d++)c=g[d]!==g[d]&&f[d]!==f[d],!c&&g[d]!==f[d]&&(l++,g[d]=f[d])}else{g!==o&&(g=o={},q=0,l++),a=0;for(b in f)f.hasOwnProperty(b)&&(a++,g.hasOwnProperty(b)?(c=g[b]!==g[b]&&f[b]!==f[b],!c&&g[b]!==f[b]&&(l++,g[b]=f[b])):(q++,g[b]=f[b],l++));if(q>a){l++;for(b in g)g.hasOwnProperty(b)&&!f.hasOwnProperty(b)&&(q--,delete g[b])}}else g!==f&&(g=f,l++);return l}function d(){if(p?(p=!1,b(f,f,j)):b(f,i,j),k)if(t(f))if(e(f)){i=new Array(f.length);for(var a=0;a<f.length;a++)i[a]=f[a]}else{i={};for(var c in f)rc.call(f,c)&&(i[c]=f[c])}else i=f}var f,g,i,j=this,k=b.length>1,l=0,m=h(a),n=[],o={},p=!0,q=0;return this.$watch(c,d)},$digest:function(){var d,e,f,h,j,k,n,o,p,r,s,t=this.$$asyncQueue,u=this.$$postDigestQueue,v=a,w=this,y=[];l("$digest"),i.$$checkUrlChange(),c=null;do{for(k=!1,o=w;t.length;){try{s=t.shift(),s.scope.$eval(s.expression)}catch(a){m(),g(a)}c=null}a:do{if(h=o.$$watchers)for(j=h.length;j--;)try{if(d=h[j])if((e=d.get(o))===(f=d.last)||(d.eq?L(e,f):"number"==typeof e&&"number"==typeof f&&isNaN(e)&&isNaN(f))){if(d===c){k=!1;break a}}else k=!0,c=d,d.last=d.eq?J(e,null):e,d.fn(e,f===q?e:f,o),v<5&&(p=4-v,y[p]||(y[p]=[]),r=x(d.exp)?"fn: "+(d.exp.name||d.exp.toString()):d.exp,r+="; newVal: "+Q(e)+"; oldVal: "+Q(f),y[p].push(r))}catch(a){m(),g(a)}if(!(n=o.$$childHead||o!==w&&o.$$nextSibling))for(;o!==w&&!(n=o.$$nextSibling);)o=o.$parent}while(o=n);if((k||t.length)&&!v--)throw m(),b("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",a,Q(y))}while(k||t.length);for(m();u.length;)try{u.shift()()}catch(a){g(a)}},$destroy:function(){if(!this.$$destroyed){var a=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this!==r&&(f(this.$$listenerCount,O(null,p,this)),a.$$childHead==this&&(a.$$childHead=this.$$nextSibling),a.$$childTail==this&&(a.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=null,this.$$listeners={},this.$$watchers=this.$$asyncQueue=this.$$postDigestQueue=[],this.$destroy=this.$digest=this.$apply=o,this.$on=this.$watch=function(){return o})}},$eval:function(a,b){return h(a)(this,b)},$evalAsync:function(a){!r.$$phase&&!r.$$asyncQueue.length&&i.defer(function(){r.$$asyncQueue.length&&r.$digest()}),this.$$asyncQueue.push({scope:this,expression:a})},$$postDigest:function(a){this.$$postDigestQueue.push(a)},$apply:function(a){try{return l("$apply"),this.$eval(a)}catch(a){g(a)}finally{m();try{r.$digest()}catch(a){throw g(a),a}}},$on:function(a,b){var c=this.$$listeners[a];c||(this.$$listeners[a]=c=[]),c.push(b);var d=this;do d.$$listenerCount[a]||(d.$$listenerCount[a]=0),d.$$listenerCount[a]++;while(d=d.$parent);var e=this;return function(){var d=H(c,b);d!==-1&&(c[d]=null,p(e,1,a))}},$emit:function(a,b){var c,d,e,f=[],h=this,i=!1,j={name:a,targetScope:h,stopPropagation:function(){i=!0},preventDefault:function(){j.defaultPrevented=!0},defaultPrevented:!1},k=M([j],arguments,1);do{for(c=h.$$listeners[a]||f,j.currentScope=h,d=0,e=c.length;d<e;d++)if(c[d])try{c[d].apply(null,k)}catch(a){g(a)}else c.splice(d,1),d--,e--;if(i)return j;h=h.$parent}while(h);return j},$broadcast:function(a,b){for(var c,d,e,f=this,h=f,i=f,j={name:a,targetScope:f,preventDefault:function(){j.defaultPrevented=!0},defaultPrevented:!1},k=M([j],arguments,1);h=i;){for(j.currentScope=h,c=h.$$listeners[a]||[],d=0,e=c.length;d<e;d++)if(c[d])try{c[d].apply(null,k)}catch(a){g(a)}else c.splice(d,1),d--,e--;if(!(i=h.$$listenerCount[a]&&h.$$childHead||h!==f&&h.$$nextSibling))for(;h!==f&&!(i=h.$$nextSibling);)h=h.$parent}return j}};var r=new k;return r}]}function Gb(){var a=/^\s*(https?|ftp|mailto|tel|file):/,b=/^\s*((https?|ftp|file):|data:image\/)/;this.aHrefSanitizationWhitelist=function(b){return s(b)?(a=b,this):a},this.imgSrcSanitizationWhitelist=function(a){return s(a)?(b=a,this):b},this.$get=function(){return function(c,d){var e,f=d?b:a;return vc&&!(vc>=8)||(e=Ob(c).href,""===e||e.match(f))?c:"unsafe:"+e}}}function Hb(a){return a.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")}function Ib(a){if("self"===a)return a;if(u(a)){if(a.indexOf("***")>-1)throw xd("iwcard","Illegal sequence *** in string matcher.  String: {0}",a);return a=Hb(a).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+a+"$")}if(y(a))return new RegExp("^"+a.source+"$");
throw xd("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function Jb(a){var b=[];return s(a)&&f(a,function(a){b.push(Ib(a))}),b}function Kb(){this.SCE_CONTEXTS=yd;var a=["self"],b=[];this.resourceUrlWhitelist=function(b){return arguments.length&&(a=Jb(b)),a},this.resourceUrlBlacklist=function(a){return arguments.length&&(b=Jb(a)),b},this.$get=["$injector",function(d){function e(a,b){return"self"===a?Pb(b):!!a.exec(b.href)}function f(c){var d,f,g=Ob(c.toString()),h=!1;for(d=0,f=a.length;d<f;d++)if(e(a[d],g)){h=!0;break}if(h)for(d=0,f=b.length;d<f;d++)if(e(b[d],g)){h=!1;break}return h}function g(a){var b=function(a){this.$$unwrapTrustedValue=function(){return a}};return a&&(b.prototype=new a),b.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},b.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},b}function h(a,b){var d=m.hasOwnProperty(a)?m[a]:null;if(!d)throw xd("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",a,b);if(null===b||b===c||""===b)return b;if("string"!=typeof b)throw xd("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",a);return new d(b)}function i(a){return a instanceof l?a.$$unwrapTrustedValue():a}function j(a,b){if(null===b||b===c||""===b)return b;var d=m.hasOwnProperty(a)?m[a]:null;if(d&&b instanceof d)return b.$$unwrapTrustedValue();if(a===yd.RESOURCE_URL){if(f(b))return b;throw xd("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",b.toString())}if(a===yd.HTML)return k(b);throw xd("unsafe","Attempting to use an unsafe value in a safe context.")}var k=function(a){throw xd("unsafe","Attempting to use an unsafe value in a safe context.")};d.has("$sanitize")&&(k=d.get("$sanitize"));var l=g(),m={};return m[yd.HTML]=g(l),m[yd.CSS]=g(l),m[yd.URL]=g(l),m[yd.JS]=g(l),m[yd.RESOURCE_URL]=g(m[yd.URL]),{trustAs:h,getTrusted:j,valueOf:i}}]}function Lb(){var a=!0;this.enabled=function(b){return arguments.length&&(a=!!b),a},this.$get=["$parse","$sniffer","$sceDelegate",function(b,c,d){if(a&&c.msie&&c.msieDocumentMode<8)throw xd("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 9 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var e=K(yd);e.isEnabled=function(){return a},e.trustAs=d.trustAs,e.getTrusted=d.getTrusted,e.valueOf=d.valueOf,a||(e.trustAs=e.getTrusted=function(a,b){return b},e.valueOf=p),e.parseAs=function(a,c){var d=b(c);return d.literal&&d.constant?d:function(b,c){return e.getTrusted(a,d(b,c))}};var g=e.parseAs,h=e.getTrusted,i=e.trustAs;return f(yd,function(a,b){var c=qc(b);e[ja("parse_as_"+c)]=function(b){return g(a,b)},e[ja("get_trusted_"+c)]=function(b){return h(a,b)},e[ja("trust_as_"+c)]=function(b){return i(a,b)}}),e}]}function Mb(){this.$get=["$window","$document",function(a,b){var c,d,e={},f=m((/android (\d+)/.exec(qc((a.navigator||{}).userAgent))||[])[1]),g=/Boxee/i.test((a.navigator||{}).userAgent),h=b[0]||{},i=h.documentMode,j=/^(Moz|webkit|O|ms)(?=[A-Z])/,k=h.body&&h.body.style,l=!1,n=!1;if(k){for(var o in k)if(d=j.exec(o)){c=d[0],c=c.substr(0,1).toUpperCase()+c.substr(1);break}c||(c="WebkitOpacity"in k&&"webkit"),l="transition"in k||c+"Transition"in k,n="animation"in k||c+"Animation"in k,f&&(!l||!n)&&(l=u(h.body.style.webkitTransition),n=u(h.body.style.webkitAnimation))}return{history:!(!a.history||!a.history.pushState||f<4||g),hashchange:"onhashchange"in a&&(!i||i>7),hasEvent:function(a){if("input"==a&&9==vc)return!1;if(r(e[a])){var b=h.createElement("div");e[a]="on"+a in b}return e[a]},csp:Ic(),vendorPrefix:c,transitions:l,animations:n,android:f,msie:vc,msieDocumentMode:i}}]}function Nb(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function(a,b,c,d){function e(e,g,h){var i,j=c.defer(),k=j.promise,l=s(h)&&!h;return i=b.defer(function(){try{j.resolve(e())}catch(a){j.reject(a),d(a)}finally{delete f[k.$$timeoutId]}l||a.$apply()},g),k.$$timeoutId=i,f[i]=j,k}var f={};return e.cancel=function(a){return!!(a&&a.$$timeoutId in f)&&(f[a.$$timeoutId].reject("canceled"),delete f[a.$$timeoutId],b.defer.cancel(a.$$timeoutId))},e}]}function Ob(a,b){var c=a;return vc&&(zd.setAttribute("href",c),c=zd.href),zd.setAttribute("href",c),{href:zd.href,protocol:zd.protocol?zd.protocol.replace(/:$/,""):"",host:zd.host,search:zd.search?zd.search.replace(/^\?/,""):"",hash:zd.hash?zd.hash.replace(/^#/,""):"",hostname:zd.hostname,port:zd.port,pathname:"/"===zd.pathname.charAt(0)?zd.pathname:"/"+zd.pathname}}function Pb(a){var b=u(a)?Ob(a):a;return b.protocol===Ad.protocol&&b.host===Ad.host}function Qb(){this.$get=q(a)}function Rb(a){function b(d,e){if(t(d)){var g={};return f(d,function(a,c){g[c]=b(c,a)}),g}return a.factory(d+c,e)}var c="Filter";this.register=b,this.$get=["$injector",function(a){return function(b){return a.get(b+c)}}],b("currency",Tb),b("date",_b),b("filter",Sb),b("json",ac),b("limitTo",bc),b("lowercase",Fd),b("number",Ub),b("orderBy",cc),b("uppercase",Gd)}function Sb(){return function(a,b,c){if(!Gc(a))return a;var d=typeof c,e=[];e.check=function(a){for(var b=0;b<e.length;b++)if(!e[b](a))return!1;return!0},"function"!==d&&(c="boolean"===d&&c?function(a,b){return Ec.equals(a,b)}:function(a,b){if(a&&b&&"object"==typeof a&&"object"==typeof b){for(var d in a)if("$"!==d.charAt(0)&&rc.call(a,d)&&c(a[d],b[d]))return!0;return!1}return b=(""+b).toLowerCase(),(""+a).toLowerCase().indexOf(b)>-1});var f=function(a,b){if("string"==typeof b&&"!"===b.charAt(0))return!f(a,b.substr(1));switch(typeof a){case"boolean":case"number":case"string":return c(a,b);case"object":switch(typeof b){case"object":return c(a,b);default:for(var d in a)if("$"!==d.charAt(0)&&f(a[d],b))return!0}return!1;case"array":for(var e=0;e<a.length;e++)if(f(a[e],b))return!0;return!1;default:return!1}};switch(typeof b){case"boolean":case"number":case"string":b={$:b};case"object":for(var g in b)(function(a){"undefined"!=typeof b[a]&&e.push(function(c){return f("$"==a?c:c&&c[a],b[a])})})(g);break;case"function":e.push(b);break;default:return a}for(var h=[],i=0;i<a.length;i++){var j=a[i];e.check(j)&&h.push(j)}return h}}function Tb(a){var b=a.NUMBER_FORMATS;return function(a,c){return r(c)&&(c=b.CURRENCY_SYM),Vb(a,b.PATTERNS[1],b.GROUP_SEP,b.DECIMAL_SEP,2).replace(/\u00A4/g,c)}}function Ub(a){var b=a.NUMBER_FORMATS;return function(a,c){return Vb(a,b.PATTERNS[0],b.GROUP_SEP,b.DECIMAL_SEP,c)}}function Vb(a,b,c,d,e){if(null==a||!isFinite(a)||t(a))return"";var f=a<0;a=Math.abs(a);var g=a+"",h="",i=[],j=!1;if(g.indexOf("e")!==-1){var k=g.match(/([\d\.]+)e(-?)(\d+)/);k&&"-"==k[2]&&k[3]>e+1?(g="0",a=0):(h=g,j=!0)}if(j)e>0&&a>-1&&a<1&&(h=a.toFixed(e));else{var l=(g.split(Bd)[1]||"").length;r(e)&&(e=Math.min(Math.max(b.minFrac,l),b.maxFrac)),a=+(Math.round(+(a.toString()+"e"+e)).toString()+"e"+-e),0===a&&(f=!1);var m=(""+a).split(Bd),n=m[0];m=m[1]||"";var o,p=0,q=b.lgSize,s=b.gSize;if(n.length>=q+s)for(p=n.length-q,o=0;o<p;o++)(p-o)%s===0&&0!==o&&(h+=c),h+=n.charAt(o);for(o=p;o<n.length;o++)(n.length-o)%q===0&&0!==o&&(h+=c),h+=n.charAt(o);for(;m.length<e;)m+="0";e&&"0"!==e&&(h+=d+m.substr(0,e))}return i.push(f?b.negPre:b.posPre),i.push(h),i.push(f?b.negSuf:b.posSuf),i.join("")}function Wb(a,b,c){var d="";for(a<0&&(d="-",a=-a),a=""+a;a.length<b;)a="0"+a;return c&&(a=a.substr(a.length-b)),d+a}function Xb(a,b,c,d){return c=c||0,function(e){var f=e["get"+a]();return(c>0||f>-c)&&(f+=c),0===f&&c==-12&&(f=12),Wb(f,b,d)}}function Yb(a,b){return function(c,d){var e=c["get"+a](),f=sc(b?"SHORT"+a:a);return d[f][e]}}function Zb(a){var b=-1*a.getTimezoneOffset(),c=b>=0?"+":"";return c+=Wb(Math[b>0?"floor":"ceil"](b/60),2)+Wb(Math.abs(b%60),2)}function $b(a,b){return a.getHours()<12?b.AMPMS[0]:b.AMPMS[1]}function _b(a){function b(a){var b;if(b=a.match(c)){var d=new Date(0),e=0,f=0,g=b[8]?d.setUTCFullYear:d.setFullYear,h=b[8]?d.setUTCHours:d.setHours;b[9]&&(e=m(b[9]+b[10]),f=m(b[9]+b[11])),g.call(d,m(b[1]),m(b[2])-1,m(b[3]));var i=m(b[4]||0)-e,j=m(b[5]||0)-f,k=m(b[6]||0),l=Math.round(1e3*parseFloat("0."+(b[7]||0)));return h.call(d,i,j,k,l),d}return a}var c=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(c,d){var e,g,h="",i=[];if(d=d||"mediumDate",d=a.DATETIME_FORMATS[d]||d,u(c)&&(c=Ed.test(c)?m(c):b(c)),v(c)&&(c=new Date(c)),!w(c))return c;for(;d;)g=Dd.exec(d),g?(i=M(i,g,1),d=i.pop()):(i.push(d),d=null);return f(i,function(b){e=Cd[b],h+=e?e(c,a.DATETIME_FORMATS):b.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),h}}function ac(){return function(a){return Q(a,!0)}}function bc(){return function(a,b){return Gc(a)||u(a)?(b=Math.abs(Number(b))===1/0?Number(b):m(b),b?b>0?a.slice(0,b):a.slice(b):u(a)?"":[]):a}}function cc(a){return function(b,c,d){function f(a,b){for(var d=0;d<c.length;d++){var e=c[d](a,b);if(0!==e)return e}return 0}function g(a,b){return S(b)?function(b,c){return a(c,b)}:a}function h(a,b){var c=typeof a,d=typeof b;return c==d?(w(a)&&w(b)&&(a=a.valueOf(),b=b.valueOf()),"string"==c&&(a=a.toLowerCase(),b=b.toLowerCase()),a===b?0:a<b?-1:1):c<d?-1:1}return e(b)?(c=Gc(c)?c:[c],0===c.length&&(c=["+"]),c=F(c,function(b){var c=!1,d=b||p;if(u(b)){if("+"!=b.charAt(0)&&"-"!=b.charAt(0)||(c="-"==b.charAt(0),b=b.substring(1)),""===b)return g(function(a,b){return h(a,b)},c);if(d=a(b),d.constant){var e=d();return g(function(a,b){return h(a[e],b[e])},c)}}return g(function(a,b){return h(d(a),d(b))},c)}),Ac.call(b).sort(g(f,d))):b}}function dc(a){return x(a)&&(a={link:a}),a.restrict=a.restrict||"AC",q(a)}function ec(a,b,c,d){function e(b,c){c=c?"-"+_(c,"-"):"",d.setClass(a,(b?Td:Ud)+c,(b?Ud:Td)+c)}var g=this,h=a.parent().controller("form")||Jd,i=0,j=g.$error={},k=[];g.$name=b.name||b.ngForm,g.$dirty=!1,g.$pristine=!0,g.$valid=!0,g.$invalid=!1,h.$addControl(g),a.addClass(Vd),e(!0),g.$addControl=function(a){da(a.$name,"input"),k.push(a),a.$name&&(g[a.$name]=a)},g.$removeControl=function(a){a.$name&&g[a.$name]===a&&delete g[a.$name],f(j,function(b,c){g.$setValidity(c,!0,a)}),I(k,a)},g.$setValidity=function(a,b,c){var d=j[a];if(b)d&&(I(d,c),d.length||(i--,i||(e(b),g.$valid=!0,g.$invalid=!1),j[a]=!1,e(!0,a),h.$setValidity(a,!0,g)));else{if(i||e(b),d){if(G(d,c))return}else j[a]=d=[],i++,e(!1,a),h.$setValidity(a,!1,g);d.push(c),g.$valid=!1,g.$invalid=!0}},g.$setDirty=function(){d.removeClass(a,Vd),d.addClass(a,Wd),g.$dirty=!0,g.$pristine=!1,h.$setDirty()},g.$setPristine=function(){d.removeClass(a,Wd),d.addClass(a,Vd),g.$dirty=!1,g.$pristine=!0,f(k,function(a){a.$setPristine()})}}function fc(a,b,d,e){return a.$setValidity(b,d),d?e:c}function gc(a,b){var c,d;if(b)for(c=0;c<b.length;++c)if(d=b[c],a[d])return!0;return!1}function hc(a,b,c,d,e){if(t(e)){a.$$hasNativeValidators=!0;var f=function(f){return a.$error[b]||gc(e,d)||!gc(e,c)?f:void a.$setValidity(b,!1)};a.$parsers.push(f)}}function ic(a,b,c,e,f,g){var h=b.prop(pc),i=b[0].placeholder,j={},k=qc(b[0].type);if(e.$$validityState=h,!f.android){var l=!1;b.on("compositionstart",function(a){l=!0}),b.on("compositionend",function(){l=!1,n()})}var n=function(d){if(!l){var f=b.val();if(vc&&"input"===(d||j).type&&b[0].placeholder!==i)return void(i=b[0].placeholder);"password"!==k&&S(c.ngTrim||"T")&&(f=Hc(f));var g=h&&e.$$hasNativeValidators;(e.$viewValue!==f||""===f&&g)&&(a.$root.$$phase?e.$setViewValue(f):a.$apply(function(){e.$setViewValue(f)}))}};if(f.hasEvent("input"))b.on("input",n);else{var o,p=function(){o||(o=g.defer(function(){n(),o=null}))};b.on("keydown",function(a){var b=a.keyCode;91===b||15<b&&b<19||37<=b&&b<=40||p()}),f.hasEvent("paste")&&b.on("paste cut",p)}b.on("change",n),e.$render=function(){b.val(e.$isEmpty(e.$viewValue)?"":e.$viewValue)};var q,r,s=c.ngPattern;if(s){var t=function(a,b){return fc(e,"pattern",e.$isEmpty(b)||a.test(b),b)};r=s.match(/^\/(.*)\/([gim]*)$/),r?(s=new RegExp(r[1],r[2]),q=function(a){return t(s,a)}):q=function(c){var e=a.$eval(s);if(!e||!e.test)throw d("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",s,e,T(b));return t(e,c)},e.$formatters.push(q),e.$parsers.push(q)}if(c.ngMinlength){var u=m(c.ngMinlength),v=function(a){return fc(e,"minlength",e.$isEmpty(a)||a.length>=u,a)};e.$parsers.push(v),e.$formatters.push(v)}if(c.ngMaxlength){var w=m(c.ngMaxlength),x=function(a){return fc(e,"maxlength",e.$isEmpty(a)||a.length<=w,a)};e.$parsers.push(x),e.$formatters.push(x)}}function jc(a,b,d,e,f,g){if(ic(a,b,d,e,f,g),e.$parsers.push(function(a){var b=e.$isEmpty(a);return b||Pd.test(a)?(e.$setValidity("number",!0),""===a?null:b?a:parseFloat(a)):(e.$setValidity("number",!1),c)}),hc(e,"number",Rd,null,e.$$validityState),e.$formatters.push(function(a){return e.$isEmpty(a)?"":""+a}),d.min){var h=function(a){var b=parseFloat(d.min);return fc(e,"min",e.$isEmpty(a)||a>=b,a)};e.$parsers.push(h),e.$formatters.push(h)}if(d.max){var i=function(a){var b=parseFloat(d.max);return fc(e,"max",e.$isEmpty(a)||a<=b,a)};e.$parsers.push(i),e.$formatters.push(i)}e.$formatters.push(function(a){return fc(e,"number",e.$isEmpty(a)||v(a),a)})}function kc(a,b,c,d,e,f){ic(a,b,c,d,e,f);var g=function(a){return fc(d,"url",d.$isEmpty(a)||Nd.test(a),a)};d.$formatters.push(g),d.$parsers.push(g)}function lc(a,b,c,d,e,f){ic(a,b,c,d,e,f);var g=function(a){return fc(d,"email",d.$isEmpty(a)||Od.test(a),a)};d.$formatters.push(g),d.$parsers.push(g)}function mc(a,b,c,d){r(c.name)&&b.attr("name",j()),b.on("click",function(){b[0].checked&&a.$apply(function(){d.$setViewValue(c.value)})}),d.$render=function(){var a=c.value;b[0].checked=a==d.$viewValue},c.$observe("value",d.$render)}function nc(a,b,c,d){var e=c.ngTrueValue,f=c.ngFalseValue;u(e)||(e=!0),u(f)||(f=!1),b.on("click",function(){a.$apply(function(){d.$setViewValue(b[0].checked)})}),d.$render=function(){b[0].checked=d.$viewValue},d.$isEmpty=function(a){return a!==e},d.$formatters.push(function(a){return a===e}),d.$parsers.push(function(a){return a?e:f})}function oc(a,b){return a="ngClass"+a,["$animate",function(c){function d(a,b){var c=[];a:for(var d=0;d<a.length;d++){for(var e=a[d],f=0;f<b.length;f++)if(e==b[f])continue a;c.push(e)}return c}function e(a){if(Gc(a))return a;if(u(a))return a.split(" ");if(t(a)){var b=[];return f(a,function(a,c){a&&(b=b.concat(c.split(" ")))}),b}return a}return{restrict:"AC",link:function(g,h,i){function j(a){var b=l(a,1);i.$addClass(b)}function k(a){var b=l(a,-1);i.$removeClass(b)}function l(a,b){var c=h.data("$classCounts")||{},d=[];return f(a,function(a){(b>0||c[a])&&(c[a]=(c[a]||0)+b,c[a]===+(b>0)&&d.push(a))}),h.data("$classCounts",c),d.join(" ")}function m(a,b){var e=d(b,a),f=d(a,b);f=l(f,-1),e=l(e,1),0===e.length?c.removeClass(h,f):0===f.length?c.addClass(h,e):c.setClass(h,e,f)}function n(a){if(b===!0||g.$index%2===b){var c=e(a||[]);if(o){if(!L(a,o)){var d=e(o);m(d,c)}}else j(c)}o=K(a)}var o;g.$watch(i[a],n,!0),i.$observe("class",function(b){n(g.$eval(i[a]))}),"ngClass"!==a&&g.$watch("$index",function(c,d){var f=1&c;if(f!==(1&d)){var h=e(g.$eval(i[a]));f===b?j(h):k(h)}})}}}]}var pc="validity",qc=function(a){return u(a)?a.toLowerCase():a},rc=Object.prototype.hasOwnProperty,sc=function(a){return u(a)?a.toUpperCase():a},tc=function(a){return u(a)?a.replace(/[A-Z]/g,function(a){return String.fromCharCode(32|a.charCodeAt(0))}):a},uc=function(a){return u(a)?a.replace(/[a-z]/g,function(a){return String.fromCharCode(a.charCodeAt(0)&-33)}):a};"i"!=="I".toLowerCase()&&(qc=tc,sc=uc);var vc,wc,xc,yc,zc,Ac=[].slice,Bc=[].push,Cc=Object.prototype.toString,Dc=d("ng"),Ec=a.angular||(a.angular={}),Fc=["0","0","0"];vc=m((/msie (\d+)/.exec(qc(navigator.userAgent))||[])[1]),isNaN(vc)&&(vc=m((/trident\/.*; rv:(\d+)/.exec(qc(navigator.userAgent))||[])[1])),o.$inject=[],p.$inject=[];var Gc=function(){return x(Array.isArray)?Array.isArray:function(a){return"[object Array]"===Cc.call(a)}}(),Hc=function(){return String.prototype.trim?function(a){return u(a)?a.trim():a}:function(a){return u(a)?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}();zc=vc<9?function(a){return a=a.nodeName?a:a[0],a.scopeName&&"HTML"!=a.scopeName?sc(a.scopeName+":"+a.nodeName):a.nodeName}:function(a){return a.nodeName?a.nodeName:a[0].nodeName};var Ic=function(){if(s(Ic.isActive_))return Ic.isActive_;var a=!!b.querySelector("[ng-csp]")||!!b.querySelector("[data-ng-csp]");if(!a)try{new Function("")}catch(b){a=!0}return Ic.isActive_=a},Jc=/[A-Z]/g,Kc={full:"1.2.32",major:1,minor:2,dot:32,codeName:"alternation-intention"};oa.expando="ng339";var Lc=oa.cache={},Mc=1,Nc=a.document.addEventListener?function(a,b,c){a.addEventListener(b,c,!1)}:function(a,b,c){a.attachEvent("on"+b,c)},Oc=a.document.removeEventListener?function(a,b,c){a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent("on"+b,c)},Pc=(oa._data=function(a){return this.cache[a[this.expando]]||{}},/([\:\-\_]+(.))/g),Qc=/^moz([A-Z])/,Rc=d("jqLite"),Sc=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Tc=/<|&#?\w+;/,Uc=/<([\w:]+)/,Vc=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Wc={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Wc.optgroup=Wc.option,Wc.tbody=Wc.tfoot=Wc.colgroup=Wc.caption=Wc.thead,Wc.th=Wc.td;var Xc=oa.prototype={ready:function(c){function d(){e||(e=!0,c())}var e=!1;"complete"===b.readyState?setTimeout(d):(this.on("DOMContentLoaded",d),oa(a).on("load",d))},toString:function(){var a=[];return f(this,function(b){a.push(""+b)}),"["+a.join(", ")+"]"},eq:function(a){return wc(a>=0?this[a]:this[this.length+a])},length:0,push:Bc,sort:[].sort,splice:[].splice},Yc={};f("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(a){Yc[qc(a)]=a});var Zc={};f("input,select,option,textarea,button,form,details".split(","),function(a){Zc[sc(a)]=!0}),f({data:ua,removeData:sa},function(a,b){oa[b]=a}),f({data:ua,inheritedData:Aa,scope:function(a){return wc.data(a,"$scope")||Aa(a.parentNode||a,["$isolateScope","$scope"])},isolateScope:function(a){return wc.data(a,"$isolateScope")||wc.data(a,"$isolateScopeNoTemplate")},controller:za,injector:function(a){return Aa(a,"$injector")},removeAttr:function(a,b){a.removeAttribute(b)},hasClass:va,css:function(a,b,d){if(b=ja(b),!s(d)){var e;return vc<=8&&(e=a.currentStyle&&a.currentStyle[b],""===e&&(e="auto")),e=e||a.style[b],vc<=8&&(e=""===e?c:e),e}a.style[b]=d},attr:function(a,b,d){var e=qc(b);if(Yc[e]){if(!s(d))return a[b]||(a.attributes.getNamedItem(b)||o).specified?e:c;d?(a[b]=!0,a.setAttribute(b,e)):(a[b]=!1,a.removeAttribute(e))}else if(s(d))a.setAttribute(b,d);else if(a.getAttribute){var f=a.getAttribute(b,2);return null===f?c:f}},prop:function(a,b,c){return s(c)?void(a[b]=c):a[b]},text:function(){function a(a,c){var d=b[a.nodeType];return r(c)?d?a[d]:"":void(a[d]=c)}var b=[];return vc<9?(b[1]="innerText",b[3]="nodeValue"):b[1]=b[3]="textContent",a.$dv="",a}(),val:function(a,b){if(r(b)){if("SELECT"===zc(a)&&a.multiple){var c=[];return f(a.options,function(a){a.selected&&c.push(a.value||a.text)}),0===c.length?null:c}return a.value}a.value=b},html:function(a,b){if(r(b))return a.innerHTML;for(var c=0,d=a.childNodes;c<d.length;c++)qa(d[c]);a.innerHTML=b},empty:Ba},function(a,b){oa.prototype[b]=function(b,d){var e,f,g=this.length;if(a!==Ba&&(2==a.length&&a!==va&&a!==za?b:d)===c){if(t(b)){for(e=0;e<g;e++)if(a===ua)a(this[e],b);else for(f in b)a(this[e],f,b[f]);return this}for(var h=a.$dv,i=h===c?Math.min(g,1):g,j=0;j<i;j++){var k=a(this[j],b,d);h=h?h+k:k}return h}for(e=0;e<g;e++)a(this[e],b,d);return this}}),f({removeData:sa,dealoc:qa,on:function a(c,d,e,g){if(s(g))throw Rc("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");var h=ta(c,"events"),i=ta(c,"handle");h||ta(c,"events",h={}),i||ta(c,"handle",i=Da(c,h)),f(d.split(" "),function(d){var f=h[d];if(!f){if("mouseenter"==d||"mouseleave"==d){var g=b.body.contains||b.body.compareDocumentPosition?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!!d&&1===d.nodeType&&!!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1};h[d]=[];var j={mouseleave:"mouseout",mouseenter:"mouseover"};a(c,j[d],function(a){var b=this,c=a.relatedTarget;(!c||c!==b&&!g(b,c))&&i(a,d)})}else Nc(c,d,i),h[d]=[];f=h[d]}f.push(e)})},off:ra,one:function(a,b,c){a=wc(a),a.on(b,function d(){a.off(b,c),a.off(b,d)}),a.on(b,c)},replaceWith:function(a,b){var c,d=a.parentNode;qa(a),f(new oa(b),function(b){c?d.insertBefore(b,c.nextSibling):d.replaceChild(b,a),c=b})},children:function(a){var b=[];return f(a.childNodes,function(a){1===a.nodeType&&b.push(a)}),b},contents:function(a){return a.contentDocument||a.childNodes||[]},append:function(a,b){f(new oa(b),function(b){(1===a.nodeType||11===a.nodeType)&&a.appendChild(b)})},prepend:function(a,b){if(1===a.nodeType){var c=a.firstChild;f(new oa(b),function(b){a.insertBefore(b,c)})}},wrap:function(a,b){b=wc(b)[0];var c=a.parentNode;c&&c.replaceChild(b,a),b.appendChild(a)},remove:function(a){qa(a);var b=a.parentNode;b&&b.removeChild(a)},after:function(a,b){var c=a,d=a.parentNode;f(new oa(b),function(a){d.insertBefore(a,c.nextSibling),c=a})},addClass:xa,removeClass:wa,toggleClass:function(a,b,c){b&&f(b.split(" "),function(b){var d=c;r(d)&&(d=!va(a,b)),(d?xa:wa)(a,b)})},parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},next:function(a){if(a.nextElementSibling)return a.nextElementSibling;for(var b=a.nextSibling;null!=b&&1!==b.nodeType;)b=b.nextSibling;return b},find:function(a,b){return a.getElementsByTagName?a.getElementsByTagName(b):[]},clone:pa,triggerHandler:function(a,b,c){var d,e,g,h=b.type||b,i=(ta(a,"events")||{})[h];i&&(d={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return this.defaultPrevented===!0},stopPropagation:o,type:h,target:a},b.type&&(d=l(d,b)),e=K(i),g=c?[d].concat(c):[d],f(e,function(b){b.apply(a,g)}))}},function(a,b){oa.prototype[b]=function(b,c,d){for(var e,f=0;f<this.length;f++)r(e)?(e=a(this[f],b,c,d),s(e)&&(e=wc(e))):ya(e,a(this[f],b,c,d));return s(e)?e:this},oa.prototype.bind=oa.prototype.on,oa.prototype.unbind=oa.prototype.off}),Fa.prototype={put:function(a,b){this[Ea(a,this.nextUid)]=b},get:function(a){return this[Ea(a,this.nextUid)]},remove:function(a){var b=this[a=Ea(a,this.nextUid)];return delete this[a],b}};var $c=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,_c=/,/,ad=/^\s*(_?)(\S+?)\1\s*$/,bd=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,cd=d("$injector"),dd=d("$animate"),ed=["$provide",function(a){this.$$selectors={},this.register=function(b,c){var d=b+"-animation";if(b&&"."!=b.charAt(0))throw dd("notcsel","Expecting class selector starting with '.' got '{0}'.",b);this.$$selectors[b.substr(1)]=d,a.factory(d,c)},this.classNameFilter=function(a){return 1===arguments.length&&(this.$$classNameFilter=a instanceof RegExp?a:null),this.$$classNameFilter},this.$get=["$timeout","$$asyncCallback",function(a,b){function c(a){a&&b(a)}return{enter:function(a,b,d,e){d?d.after(a):(b&&b[0]||(b=d.parent()),b.append(a)),c(e)},leave:function(a,b){a.remove(),c(b)},move:function(a,b,c,d){this.enter(a,b,c,d)},addClass:function(a,b,d){b=u(b)?b:Gc(b)?b.join(" "):"",f(a,function(a){xa(a,b)}),c(d)},removeClass:function(a,b,d){b=u(b)?b:Gc(b)?b.join(" "):"",f(a,function(a){wa(a,b)}),c(d)},setClass:function(a,b,d,e){f(a,function(a){xa(a,b),wa(a,d)}),c(e)},enabled:o}}]}],fd=d("$compile");Oa.$inject=["$provide","$$sanitizeUriProvider"];var gd=/^(x[\:\-_]|data[\:\-_])/i,hd=d("$interpolate"),id=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,jd={http:80,https:443,ftp:21},kd=d("$location");nb.prototype=mb.prototype=lb.prototype={$$html5:!1,$$replace:!1,absUrl:ob("$$absUrl"),url:function(a){if(r(a))return this.$$url;var b=id.exec(a);return b[1]&&this.path(decodeURIComponent(b[1])),(b[2]||b[1])&&this.search(b[3]||""),this.hash(b[5]||""),this},protocol:ob("$$protocol"),host:ob("$$host"),port:ob("$$port"),path:pb("$$path",function(a){return a=null!==a?a.toString():"","/"==a.charAt(0)?a:"/"+a}),search:function(a,b){switch(arguments.length){case 0:return this.$$search;case 1:if(u(a)||v(a))a=a.toString(),this.$$search=V(a);else{if(!t(a))throw kd("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");f(a,function(b,c){null==b&&delete a[c]}),this.$$search=a}break;default:r(b)||null===b?delete this.$$search[a]:this.$$search[a]=b}return this.$$compose(),this},hash:pb("$$hash",function(a){return null!==a?a.toString():""}),replace:function(){return this.$$replace=!0,this}};var ld,md=d("$parse"),nd={},od=Function.prototype.call,pd=Function.prototype.apply,qd=Function.prototype.bind,rd={null:function(){return null},true:function(){return!0},false:function(){return!1},undefined:o,"+":function(a,b,d,e){return d=d(a,b),e=e(a,b),s(d)?s(e)?d+e:d:s(e)?e:c},"-":function(a,b,c,d){return c=c(a,b),d=d(a,b),(s(c)?c:0)-(s(d)?d:0)},"*":function(a,b,c,d){return c(a,b)*d(a,b)},"/":function(a,b,c,d){return c(a,b)/d(a,b)},"%":function(a,b,c,d){return c(a,b)%d(a,b)},"^":function(a,b,c,d){return c(a,b)^d(a,b)},"=":o,"===":function(a,b,c,d){return c(a,b)===d(a,b)},"!==":function(a,b,c,d){return c(a,b)!==d(a,b)},"==":function(a,b,c,d){return c(a,b)==d(a,b)},"!=":function(a,b,c,d){return c(a,b)!=d(a,b)},"<":function(a,b,c,d){return c(a,b)<d(a,b)},">":function(a,b,c,d){return c(a,b)>d(a,b)},"<=":function(a,b,c,d){return c(a,b)<=d(a,b)},">=":function(a,b,c,d){return c(a,b)>=d(a,b)},"&&":function(a,b,c,d){return c(a,b)&&d(a,b)},"||":function(a,b,c,d){return c(a,b)||d(a,b)},"&":function(a,b,c,d){return c(a,b)&d(a,b)},"|":function(a,b,c,d){return d(a,b)(a,b,c(a,b))},"!":function(a,b,c){return!c(a,b)}},sd={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},td=function(a){this.options=a};td.prototype={constructor:td,lex:function(a){for(this.text=a,this.index=0,this.ch=c,this.lastCh=":",this.tokens=[];this.index<this.text.length;){if(this.ch=this.text.charAt(this.index),this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent();else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch}),this.index++;else{if(this.isWhitespace(this.ch)){this.index++;continue}var b=this.ch+this.peek(),d=b+this.peek(2),e=rd[this.ch],f=rd[b],g=rd[d];g?(this.tokens.push({index:this.index,text:d,fn:g}),this.index+=3):f?(this.tokens.push({index:this.index,text:b,fn:f}),this.index+=2):e?(this.tokens.push({index:this.index,text:this.ch,fn:e}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}this.lastCh=this.ch}return this.tokens},is:function(a){return a.indexOf(this.ch)!==-1},was:function(a){return a.indexOf(this.lastCh)!==-1},peek:function(a){var b=a||1;return this.index+b<this.text.length&&this.text.charAt(this.index+b)},isNumber:function(a){return"0"<=a&&a<="9"},isWhitespace:function(a){return" "===a||"\r"===a||"\t"===a||"\n"===a||"\v"===a||" "===a},isIdent:function(a){return"a"<=a&&a<="z"||"A"<=a&&a<="Z"||"_"===a||"$"===a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,b,c){c=c||this.index;var d=s(b)?"s "+b+"-"+this.index+" ["+this.text.substring(b,c)+"]":" "+c;throw md("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",a,d,this.text)},readNumber:function(){for(var a="",b=this.index;this.index<this.text.length;){var c=qc(this.text.charAt(this.index));if("."==c||this.isNumber(c))a+=c;else{var d=this.peek();if("e"==c&&this.isExpOperator(d))a+=c;else if(this.isExpOperator(c)&&d&&this.isNumber(d)&&"e"==a.charAt(a.length-1))a+=c;else{if(!this.isExpOperator(c)||d&&this.isNumber(d)||"e"!=a.charAt(a.length-1))break;this.throwError("Invalid exponent")}}this.index++}a=1*a,this.tokens.push({index:b,text:a,literal:!0,constant:!0,fn:function(){return a}})},readIdent:function(){for(var a,b,c,d,e=this,f="",g=this.index;this.index<this.text.length&&(d=this.text.charAt(this.index),"."===d||this.isIdent(d)||this.isNumber(d));)"."===d&&(a=this.index),f+=d,this.index++;if(a)for(b=this.index;b<this.text.length;){if(d=this.text.charAt(b),"("===d){c=f.substr(a-g+1),f=f.substr(0,a-g),this.index=b;break}if(!this.isWhitespace(d))break;b++}var h={index:g,text:f};if(rd.hasOwnProperty(f))h.fn=rd[f],h.literal=!0,h.constant=!0;else{var i=Ab(f,this.options,this.text);h.fn=l(function(a,b){return i(a,b)},{assign:function(a,b){return wb(a,f,b,e.text,e.options)}})}this.tokens.push(h),c&&(this.tokens.push({index:a,text:"."}),this.tokens.push({index:a+1,text:c}))},readString:function(a){var b=this.index;this.index++;for(var c="",d=a,e=!1;this.index<this.text.length;){var f=this.text.charAt(this.index);if(d+=f,e){if("u"===f){var g=this.text.substring(this.index+1,this.index+5);g.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+g+"]"),this.index+=4,c+=String.fromCharCode(parseInt(g,16))}else{var h=sd[f];c+=h||f}e=!1}else if("\\"===f)e=!0;else{if(f===a)return this.index++,void this.tokens.push({index:b,text:d,string:c,literal:!0,constant:!0,fn:function(){return c}});c+=f}this.index++}this.throwError("Unterminated quote",b)}};var ud=function(a,b,c){this.lexer=a,this.$filter=b,this.options=c};ud.ZERO=l(function(){return 0},{constant:!0}),ud.prototype={constructor:ud,parse:function(a){this.text=a,this.tokens=this.lexer.lex(a);var b=this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),b.literal=!!b.literal,b.constant=!!b.constant,b},primary:function(){var a;if(this.expect("("))a=this.filterChain(),this.consume(")");else if(this.expect("["))a=this.arrayDeclaration();else if(this.expect("{"))a=this.object();else{var b=this.expect();a=b.fn,a||this.throwError("not a primary expression",b),a.literal=!!b.literal,a.constant=!!b.constant}for(var c,d;c=this.expect("(","[",".");)"("===c.text?(a=this.functionCall(a,d),d=null):"["===c.text?(d=a,a=this.objectIndex(a)):"."===c.text?(d=a,a=this.fieldAccess(a)):this.throwError("IMPOSSIBLE");return a},throwError:function(a,b){throw md("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",b.text,a,b.index+1,this.text,this.text.substring(b.index))},peekToken:function(){if(0===this.tokens.length)throw md("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(a,b,c,d){if(this.tokens.length>0){var e=this.tokens[0],f=e.text;if(f===a||f===b||f===c||f===d||!a&&!b&&!c&&!d)return e}return!1},expect:function(a,b,c,d){var e=this.peek(a,b,c,d);return!!e&&(this.tokens.shift(),e)},consume:function(a){this.expect(a)||this.throwError("is unexpected, expecting ["+a+"]",this.peek())},unaryFn:function(a,b){return l(function(c,d){return a(c,d,b)},{constant:b.constant})},ternaryFn:function(a,b,c){return l(function(d,e){return a(d,e)?b(d,e):c(d,e)},{constant:a.constant&&b.constant&&c.constant})},binaryFn:function(a,b,c){return l(function(d,e){return b(d,e,a,c)},{constant:a.constant&&c.constant})},statements:function(){for(var a=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&a.push(this.filterChain()),!this.expect(";"))return 1===a.length?a[0]:function(b,c){for(var d,e=0;e<a.length;e++){var f=a[e];f&&(d=f(b,c))}return d}},filterChain:function(){for(var a,b=this.expression();;){if(!(a=this.expect("|")))return b;b=this.binaryFn(b,a.fn,this.filter())}},filter:function(){for(var a=this.expect(),b=this.$filter(a.text),c=[];;){if(!(a=this.expect(":"))){var d=function(a,d,e){for(var f=[e],g=0;g<c.length;g++)f.push(c[g](a,d));return b.apply(a,f)};return function(){return d}}c.push(this.expression())}},expression:function(){return this.assignment()},assignment:function(){var a,b,c=this.ternary();return(b=this.expect("="))?(c.assign||this.throwError("implies assignment but ["+this.text.substring(0,b.index)+"] can not be assigned to",b),a=this.ternary(),function(b,d){
return c.assign(b,a(b,d),d)}):c},ternary:function(){var a,b,c=this.logicalOR();return(b=this.expect("?"))?(a=this.assignment(),(b=this.expect(":"))?this.ternaryFn(c,a,this.assignment()):void this.throwError("expected :",b)):c},logicalOR:function(){for(var a,b=this.logicalAND();;){if(!(a=this.expect("||")))return b;b=this.binaryFn(b,a.fn,this.logicalAND())}},logicalAND:function(){var a,b=this.equality();return(a=this.expect("&&"))&&(b=this.binaryFn(b,a.fn,this.logicalAND())),b},equality:function(){var a,b=this.relational();return(a=this.expect("==","!=","===","!=="))&&(b=this.binaryFn(b,a.fn,this.equality())),b},relational:function(){var a,b=this.additive();return(a=this.expect("<",">","<=",">="))&&(b=this.binaryFn(b,a.fn,this.relational())),b},additive:function(){for(var a,b=this.multiplicative();a=this.expect("+","-");)b=this.binaryFn(b,a.fn,this.multiplicative());return b},multiplicative:function(){for(var a,b=this.unary();a=this.expect("*","/","%");)b=this.binaryFn(b,a.fn,this.unary());return b},unary:function(){var a;return this.expect("+")?this.primary():(a=this.expect("-"))?this.binaryFn(ud.ZERO,a.fn,this.unary()):(a=this.expect("!"))?this.unaryFn(a.fn,this.unary()):this.primary()},fieldAccess:function(a){var b=this,c=this.expect().text,d=Ab(c,this.options,this.text);return l(function(b,c,e){return d(e||a(b,c))},{assign:function(d,e,f){var g=a(d,f);return g||a.assign(d,g={}),wb(g,c,e,b.text,b.options)}})},objectIndex:function(a){var b=this,d=this.expression();return this.consume("]"),l(function(e,f){var g,h,i=a(e,f),j=tb(d(e,f),b.text);return sb(j,b.text),i?(g=ub(i[j],b.text),g&&g.then&&b.options.unwrapPromises&&(h=g,"$$v"in g||(h.$$v=c,h.then(function(a){h.$$v=a})),g=g.$$v),g):c},{assign:function(c,e,f){var g=sb(tb(d(c,f),b.text),b.text),h=ub(a(c,f),b.text);return h||a.assign(c,h={}),h[g]=e}})},functionCall:function(a,b){var c=[];if(")"!==this.peekToken().text)do c.push(this.expression());while(this.expect(","));this.consume(")");var d=this;return function(e,f){for(var g=[],h=b?b(e,f):e,i=0;i<c.length;i++)g.push(ub(c[i](e,f),d.text));var j=a(e,f,h)||o;ub(h,d.text),vb(j,d.text);var k=j.apply?j.apply(h,g):j(g[0],g[1],g[2],g[3],g[4]);return ub(k,d.text)}},arrayDeclaration:function(){var a=[],b=!0;if("]"!==this.peekToken().text)do{if(this.peek("]"))break;var c=this.expression();a.push(c),c.constant||(b=!1)}while(this.expect(","));return this.consume("]"),l(function(b,c){for(var d=[],e=0;e<a.length;e++)d.push(a[e](b,c));return d},{literal:!0,constant:b})},object:function(){var a=[],b=!0;if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var c=this.expect(),d=c.string||c.text;this.consume(":");var e=this.expression();a.push({key:d,value:e}),e.constant||(b=!1)}while(this.expect(","));return this.consume("}"),l(function(b,c){for(var d={},e=0;e<a.length;e++){var f=a[e];d[f.key]=f.value(b,c)}return d},{literal:!0,constant:b})}};var vd={},wd={},xd=d("$sce"),yd={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},zd=b.createElement("a"),Ad=Ob(a.location.href,!0);Rb.$inject=["$provide"],Tb.$inject=["$locale"],Ub.$inject=["$locale"];var Bd=".",Cd={yyyy:Xb("FullYear",4),yy:Xb("FullYear",2,0,!0),y:Xb("FullYear",1),MMMM:Yb("Month"),MMM:Yb("Month",!0),MM:Xb("Month",2,1),M:Xb("Month",1,1),dd:Xb("Date",2),d:Xb("Date",1),HH:Xb("Hours",2),H:Xb("Hours",1),hh:Xb("Hours",2,-12),h:Xb("Hours",1,-12),mm:Xb("Minutes",2),m:Xb("Minutes",1),ss:Xb("Seconds",2),s:Xb("Seconds",1),sss:Xb("Milliseconds",3),EEEE:Yb("Day"),EEE:Yb("Day",!0),a:$b,Z:Zb},Dd=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,Ed=/^\-?\d+$/;_b.$inject=["$locale"];var Fd=q(qc),Gd=q(sc);cc.$inject=["$parse"];var Hd=q({restrict:"E",compile:function(a,c){if(vc<=8&&(!c.href&&!c.name&&c.$set("href",""),a.append(b.createComment("IE fix"))),!c.href&&!c.xlinkHref&&!c.name)return function(a,b){var c="[object SVGAnimatedString]"===Cc.call(b.prop("href"))?"xlink:href":"href";b.on("click",function(a){b.attr(c)||a.preventDefault()})}}}),Id={};f(Yc,function(a,b){if("multiple"!=a){var c=Pa("ng-"+b);Id[c]=function(){return{priority:100,link:function(a,d,e){a.$watch(e[c],function(a){e.$set(b,!!a)})}}}}}),f(["src","srcset","href"],function(a){var b=Pa("ng-"+a);Id[b]=function(){return{priority:99,link:function(c,d,e){var f=a,g=a;"href"===a&&"[object SVGAnimatedString]"===Cc.call(d.prop("href"))&&(g="xlinkHref",e.$attr[g]="xlink:href",f=null),e.$observe(b,function(b){return b?(e.$set(g,b),void(vc&&f&&d.prop(f,e[g]))):void("href"===a&&e.$set(g,null))})}}}});var Jd={$addControl:o,$removeControl:o,$setValidity:o,$setDirty:o,$setPristine:o};ec.$inject=["$element","$attrs","$scope","$animate"];var Kd=function(a){return["$timeout",function(b){var d={name:"form",restrict:a?"EAC":"E",controller:ec,compile:function(){return{pre:function(a,d,e,f){if(!e.action){var g=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};Nc(d[0],"submit",g),d.on("$destroy",function(){b(function(){Oc(d[0],"submit",g)},0,!1)})}var h=d.parent().controller("form"),i=e.name||e.ngForm;i&&wb(a,i,f,i),h&&d.on("$destroy",function(){h.$removeControl(f),i&&wb(a,i,c,i),l(f,Jd)})}}}};return d}]},Ld=Kd(),Md=Kd(!0),Nd=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,Od=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,Pd=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,Qd={text:ic,number:jc,url:kc,email:lc,radio:mc,checkbox:nc,hidden:o,button:o,submit:o,reset:o,file:o},Rd=["badInput"],Sd=["$browser","$sniffer",function(a,b){return{restrict:"E",require:"?ngModel",link:function(c,d,e,f){f&&(Qd[qc(e.type)]||Qd.text)(c,d,e,f,b,a)}}}],Td="ng-valid",Ud="ng-invalid",Vd="ng-pristine",Wd="ng-dirty",Xd=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate",function(a,b,c,e,g,h){function i(a,b){b=b?"-"+_(b,"-"):"",h.removeClass(e,(a?Ud:Td)+b),h.addClass(e,(a?Td:Ud)+b)}this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$name=c.name;var j=g(c.ngModel),k=j.assign;if(!k)throw d("ngModel")("nonassign","Expression '{0}' is non-assignable. Element: {1}",c.ngModel,T(e));this.$render=o,this.$isEmpty=function(a){return r(a)||""===a||null===a||a!==a};var l=e.inheritedData("$formController")||Jd,m=0,n=this.$error={};e.addClass(Vd),i(!0),this.$setValidity=function(a,b){n[a]!==!b&&(b?(n[a]&&m--,m||(i(!0),this.$valid=!0,this.$invalid=!1)):(i(!1),this.$invalid=!0,this.$valid=!1,m++),n[a]=!b,i(b,a),l.$setValidity(a,b,this))},this.$setPristine=function(){this.$dirty=!1,this.$pristine=!0,h.removeClass(e,Wd),h.addClass(e,Vd)},this.$setViewValue=function(c){this.$viewValue=c,this.$pristine&&(this.$dirty=!0,this.$pristine=!1,h.removeClass(e,Vd),h.addClass(e,Wd),l.$setDirty()),f(this.$parsers,function(a){c=a(c)}),this.$modelValue!==c&&(this.$modelValue=c,k(a,c),f(this.$viewChangeListeners,function(a){try{a()}catch(a){b(a)}}))};var p=this;a.$watch(function(){var b=j(a);if(p.$modelValue!==b){var c=p.$formatters,d=c.length;for(p.$modelValue=b;d--;)b=c[d](b);p.$viewValue!==b&&(p.$viewValue=b,p.$render())}return b})}],Yd=function(){return{require:["ngModel","^?form"],controller:Xd,link:function(a,b,c,d){var e=d[0],f=d[1]||Jd;f.$addControl(e),a.$on("$destroy",function(){f.$removeControl(e)})}}},Zd=q({require:"ngModel",link:function(a,b,c,d){d.$viewChangeListeners.push(function(){a.$eval(c.ngChange)})}}),$d=function(){return{require:"?ngModel",link:function(a,b,c,d){if(d){c.required=!0;var e=function(a){return c.required&&d.$isEmpty(a)?void d.$setValidity("required",!1):(d.$setValidity("required",!0),a)};d.$formatters.push(e),d.$parsers.unshift(e),c.$observe("required",function(){e(d.$viewValue)})}}}},_d=function(){return{require:"ngModel",link:function(a,b,d,e){var g=/\/(.*)\//.exec(d.ngList),h=g&&new RegExp(g[1])||d.ngList||",",i=function(a){if(!r(a)){var b=[];return a&&f(a.split(h),function(a){a&&b.push(Hc(a))}),b}};e.$parsers.push(i),e.$formatters.push(function(a){return Gc(a)?a.join(", "):c}),e.$isEmpty=function(a){return!a||!a.length}}}},ae=/^(true|false|\d+)$/,be=function(){return{priority:100,compile:function(a,b){return ae.test(b.ngValue)?function(a,b,c){c.$set("value",a.$eval(c.ngValue))}:function(a,b,c){a.$watch(c.ngValue,function(a){c.$set("value",a)})}}}},ce=dc({compile:function(a){return a.addClass("ng-binding"),function(a,b,d){b.data("$binding",d.ngBind),a.$watch(d.ngBind,function(a){b.text(a==c?"":a)})}}}),de=["$interpolate",function(a){return function(b,c,d){var e=a(c.attr(d.$attr.ngBindTemplate));c.addClass("ng-binding").data("$binding",e),d.$observe("ngBindTemplate",function(a){c.text(a)})}}],ee=["$sce","$parse",function(a,b){return{compile:function(c){return c.addClass("ng-binding"),function(c,d,e){function f(){return(g(c)||"").toString()}d.data("$binding",e.ngBindHtml);var g=b(e.ngBindHtml);c.$watch(f,function(b){d.html(a.getTrustedHtml(g(c))||"")})}}}}],fe=oc("",!0),ge=oc("Odd",0),he=oc("Even",1),ie=dc({compile:function(a,b){b.$set("ngCloak",c),a.removeClass("ng-cloak")}}),je=[function(){return{scope:!0,controller:"@",priority:500}}],ke={},le={blur:!0,focus:!0};f("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(a){var b=Pa("ng-"+a);ke[b]=["$parse","$rootScope",function(c,d){return{compile:function(e,f){var g=c(f[b],!0);return function(b,c){c.on(a,function(c){var e=function(){g(b,{$event:c})};le[a]&&d.$$phase?b.$evalAsync(e):b.$apply(e)})}}}}]});var me=["$animate",function(a){return{transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(c,d,e,f,g){var h,i,j;c.$watch(e.ngIf,function(f){S(f)?i||(i=c.$new(),g(i,function(c){c[c.length++]=b.createComment(" end ngIf: "+e.ngIf+" "),h={clone:c},a.enter(c,d.parent(),d)})):(j&&(j.remove(),j=null),i&&(i.$destroy(),i=null),h&&(j=fa(h.clone),a.leave(j,function(){j=null}),h=null))})}}}],ne=["$http","$templateCache","$anchorScroll","$animate","$sce",function(a,b,c,d,e){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:Ec.noop,compile:function(f,g){var h=g.ngInclude||g.src,i=g.onload||"",j=g.autoscroll;return function(f,g,k,l,m){var n,o,p,q=0,r=function(){o&&(o.remove(),o=null),n&&(n.$destroy(),n=null),p&&(d.leave(p,function(){o=null}),o=p,p=null)};f.$watch(e.parseAsResourceUrl(h),function(e){var h=function(){s(j)&&(!j||f.$eval(j))&&c()},k=++q;e?(a.get(e,{cache:b}).success(function(a){if(k===q){var b=f.$new();l.template=a;var c=m(b,function(a){r(),d.enter(a,null,g,h)});n=b,p=c,n.$emit("$includeContentLoaded"),f.$eval(i)}}).error(function(){k===q&&r()}),f.$emit("$includeContentRequested")):(r(),l.template=null)})}}}}],oe=["$compile",function(a){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(b,c,d,e){c.html(e.template),a(c.contents())(b)}}}],pe=dc({priority:450,compile:function(){return{pre:function(a,b,c){a.$eval(c.ngInit)}}}}),qe=dc({terminal:!0,priority:1e3}),re=["$locale","$interpolate",function(a,b){var c=/{}/g;return{restrict:"EA",link:function(d,e,g){var h=g.count,i=g.$attr.when&&e.attr(g.$attr.when),j=g.offset||0,k=d.$eval(i)||{},l={},m=b.startSymbol(),n=b.endSymbol(),o=/^when(Minus)?(.+)$/;f(g,function(a,b){o.test(b)&&(k[qc(b.replace("when","").replace("Minus","-"))]=e.attr(g.$attr[b]))}),f(k,function(a,d){l[d]=b(a.replace(c,m+h+"-"+j+n))}),d.$watch(function(){var b=parseFloat(d.$eval(h));return isNaN(b)?"":(b in k||(b=a.pluralCat(b-j)),l[b](d,e,!0))},function(a){e.text(a)})}}}],se=["$parse","$animate",function(a,c){function g(a){return a.clone[0]}function h(a){return a.clone[a.clone.length-1]}var i="$$NG_REMOVED",j=d("ngRepeat");return{transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,link:function(d,k,l,m,n){var o,p,q,r,s,t,u,v,w,x=l.ngRepeat,y=x.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),z={$id:Ea};if(!y)throw j("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",x);if(t=y[1],u=y[2],o=y[3],o?(p=a(o),q=function(a,b,c){return w&&(z[w]=a),z[v]=b,z.$index=c,p(d,z)}):(r=function(a,b){return Ea(b)},s=function(a){return a}),y=t.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/),!y)throw j("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",t);v=y[3]||y[1],w=y[2];var A={};d.$watchCollection(u,function(a){var l,m,o,p,t,u,y,z,B,C,D,E,F=k[0],G={},H=[];if(e(a))C=a,B=q||r;else{B=q||s,C=[];for(u in a)a.hasOwnProperty(u)&&"$"!=u.charAt(0)&&C.push(u);C.sort()}for(p=C.length,m=H.length=C.length,l=0;l<m;l++)if(u=a===C?l:C[l],y=a[u],z=B(u,y,l),da(z,"`track by` id"),A.hasOwnProperty(z))D=A[z],delete A[z],G[z]=D,H[l]=D;else{if(G.hasOwnProperty(z))throw f(H,function(a){a&&a.scope&&(A[a.id]=a)}),j("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",x,z,Q(y));H[l]={id:z},G[z]=!1}for(u in A)A.hasOwnProperty(u)&&(D=A[u],E=fa(D.clone),c.leave(E),f(E,function(a){a[i]=!0}),D.scope.$destroy());for(l=0,m=C.length;l<m;l++){if(u=a===C?l:C[l],y=a[u],D=H[l],H[l-1]&&(F=h(H[l-1])),D.scope){t=D.scope,o=F;do o=o.nextSibling;while(o&&o[i]);g(D)!=o&&c.move(fa(D.clone),null,wc(F)),F=h(D)}else t=d.$new();t[v]=y,w&&(t[w]=u),t.$index=l,t.$first=0===l,t.$last=l===p-1,t.$middle=!t.$first&&!t.$last,t.$odd=!(t.$even=0===(1&l)),D.scope||n(t,function(a){a[a.length++]=b.createComment(" end ngRepeat: "+x+" "),c.enter(a,null,wc(F)),F=a,D.scope=t,D.clone=a,G[D.id]=D})}A=G})}}}],te=["$animate",function(a){return function(b,c,d){b.$watch(d.ngShow,function(b){a[S(b)?"removeClass":"addClass"](c,"ng-hide")})}}],ue=["$animate",function(a){return function(b,c,d){b.$watch(d.ngHide,function(b){a[S(b)?"addClass":"removeClass"](c,"ng-hide")})}}],ve=dc(function(a,b,c){a.$watch(c.ngStyle,function(a,c){c&&a!==c&&f(c,function(a,c){b.css(c,"")}),a&&b.css(a)},!0)}),we=["$animate",function(a){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(b,c,d,e){var g=d.ngSwitch||d.on,h=[],i=[],j=[],k=[];b.$watch(g,function(c){var g,l;for(g=0,l=j.length;g<l;++g)j[g].remove();for(j.length=0,g=0,l=k.length;g<l;++g){var m=i[g];k[g].$destroy(),j[g]=m,a.leave(m,function(){j.splice(g,1)})}i.length=0,k.length=0,(h=e.cases["!"+c]||e.cases["?"])&&(b.$eval(d.change),f(h,function(c){var d=b.$new();k.push(d),c.transclude(d,function(b){var d=c.element;i.push(b),a.enter(b,d.parent(),d)})}))})}}}],xe=dc({transclude:"element",priority:800,require:"^ngSwitch",link:function(a,b,c,d,e){d.cases["!"+c.ngSwitchWhen]=d.cases["!"+c.ngSwitchWhen]||[],d.cases["!"+c.ngSwitchWhen].push({transclude:e,element:b})}}),ye=dc({transclude:"element",priority:800,require:"^ngSwitch",link:function(a,b,c,d,e){d.cases["?"]=d.cases["?"]||[],d.cases["?"].push({transclude:e,element:b})}}),ze=dc({link:function(a,b,c,e,f){if(!f)throw d("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",T(b));f(function(a){b.empty(),b.append(a)})}}),Ae=["$templateCache",function(a){return{restrict:"E",terminal:!0,compile:function(b,c){if("text/ng-template"==c.type){var d=c.id,e=b[0].text;a.put(d,e)}}}}],Be=d("ngOptions"),Ce=q({terminal:!0}),De=["$compile","$parse",function(a,d){var e=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,h={$setViewValue:o};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function(a,b,c){var d,e,f=this,g={},i=h;f.databound=c.ngModel,f.init=function(a,b,c){i=a,d=b,e=c},f.addOption=function(b){da(b,'"option value"'),g[b]=!0,i.$viewValue==b&&(a.val(b),e.parent()&&e.remove())},f.removeOption=function(a){this.hasOption(a)&&(delete g[a],i.$viewValue==a&&this.renderUnknownOption(a))},f.renderUnknownOption=function(b){var c="? "+Ea(b)+" ?";e.val(c),a.prepend(e),a.val(c),e.prop("selected",!0)},f.hasOption=function(a){return g.hasOwnProperty(a)},b.$on("$destroy",function(){f.renderUnknownOption=o})}],link:function(h,i,j,k){function l(a,b,c,d){c.$render=function(){var a=c.$viewValue;d.hasOption(a)?(y.parent()&&y.remove(),b.val(a),""===a&&o.prop("selected",!0)):r(a)&&o?b.val(""):d.renderUnknownOption(a)},b.on("change",function(){a.$apply(function(){y.parent()&&y.remove(),c.$setViewValue(b.val())})})}function m(a,b,c){var d;c.$render=function(){var a=new Fa(c.$viewValue);f(b.find("option"),function(b){b.selected=s(a.get(b.value))})},a.$watch(function(){L(d,c.$viewValue)||(d=K(c.$viewValue),c.$render())}),b.on("change",function(){a.$apply(function(){var a=[];f(b.find("option"),function(b){b.selected&&a.push(b.value)}),c.$setViewValue(a)})})}function n(b,f,h){function i(){var a=!1;if(t){var c=h.$modelValue;if(z&&Gc(c)){a=new Fa([]);for(var d={},e=0;e<c.length;e++)d[m]=c[e],a.put(z(b,d),c[e])}else a=new Fa(c)}return a}function j(){var a,c,d,e,j,k,u,y,B,C,D,E,F,G,H,I={"":[]},J=[""],K=h.$modelValue,L=r(b)||[],M=n?g(L):L,N={},O=i();for(D=0;B=M.length,D<B;D++){if(u=D,n){if(u=M[D],"$"===u.charAt(0))continue;N[n]=u}if(N[m]=L[u],a=o(b,N)||"",(c=I[a])||(c=I[a]=[],J.push(a)),t)E=s(O.remove(z?z(b,N):q(b,N)));else{if(z){var P={};P[m]=K,E=z(b,P)===z(b,N)}else E=K===q(b,N);O=O||E}H=l(b,N),H=s(H)?H:"",c.push({id:z?z(b,N):n?M[D]:D,label:H,selected:E})}for(t||(v||null===K?I[""].unshift({id:"",label:"",selected:!O}):O||I[""].unshift({id:"?",label:"",selected:!0})),C=0,y=J.length;C<y;C++){for(a=J[C],c=I[a],A.length<=C?(e={element:x.clone().attr("label",a),label:c.label},j=[e],A.push(j),f.append(e.element)):(j=A[C],e=j[0],e.label!=a&&e.element.attr("label",e.label=a)),F=null,D=0,B=c.length;D<B;D++)d=c[D],(k=j[D+1])?(F=k.element,k.label!==d.label&&(F.text(k.label=d.label),F.prop("label",k.label)),k.id!==d.id&&F.val(k.id=d.id),F[0].selected!==d.selected&&(F.prop("selected",k.selected=d.selected),vc&&F.prop("selected",k.selected))):(""===d.id&&v?G=v:(G=w.clone()).val(d.id).prop("selected",d.selected).attr("selected",d.selected).prop("label",d.label).text(d.label),j.push(k={element:G,label:d.label,id:d.id,selected:d.selected}),p.addOption(d.label,G),F?F.after(G):e.element.append(G),F=G);for(D++;j.length>D;)d=j.pop(),p.removeOption(d.label),d.element.remove()}for(;A.length>C;)A.pop()[0].element.remove()}var k;if(!(k=u.match(e)))throw Be("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",u,T(f));var l=d(k[2]||k[1]),m=k[4]||k[6],n=k[5],o=d(k[3]||""),q=d(k[2]?k[1]:m),r=d(k[7]),y=k[8],z=y?d(k[8]):null,A=[[{element:f,label:""}]];v&&(a(v)(b),v.removeClass("ng-scope"),v.remove()),f.empty(),f.on("change",function(){b.$apply(function(){var a,d,e,g,i,k,l,o,p,s=r(b)||[],u={};if(t){for(e=[],k=0,o=A.length;k<o;k++)for(a=A[k],i=1,l=a.length;i<l;i++)if((g=a[i].element)[0].selected){if(d=g.val(),n&&(u[n]=d),z)for(p=0;p<s.length&&(u[m]=s[p],z(b,u)!=d);p++);else u[m]=s[d];e.push(q(b,u))}}else if(d=f.val(),"?"==d)e=c;else if(""===d)e=null;else if(z){for(p=0;p<s.length;p++)if(u[m]=s[p],z(b,u)==d){e=q(b,u);break}}else u[m]=s[d],n&&(u[n]=d),e=q(b,u);h.$setViewValue(e),j()})}),h.$render=j,b.$watchCollection(r,j),b.$watchCollection(function(){var a={},c=r(b);if(c){for(var d=new Array(c.length),e=0,f=c.length;e<f;e++)a[m]=c[e],d[e]=l(b,a);return d}},j),t&&b.$watchCollection(function(){return h.$modelValue},j)}if(k[1]){for(var o,p=k[0],q=k[1],t=j.multiple,u=j.ngOptions,v=!1,w=wc(b.createElement("option")),x=wc(b.createElement("optgroup")),y=w.clone(),z=0,A=i.children(),B=A.length;z<B;z++)if(""===A[z].value){o=v=A.eq(z);break}p.init(q,v,y),t&&(q.$isEmpty=function(a){return!a||0===a.length}),u?n(h,i,q):t?m(h,i,q):l(h,i,q,p)}}}}],Ee=["$interpolate",function(a){var b={addOption:o,removeOption:o};return{restrict:"E",priority:100,compile:function(c,d){if(r(d.value)){var e=a(c.text(),!0);e||d.$set("value",c.text())}return function(a,c,d){var f="$selectController",g=c.parent(),h=g.data(f)||g.parent().data(f);h&&h.databound?c.prop("selected",!1):h=b,e?a.$watch(e,function(a,b){d.$set("value",a),a!==b&&h.removeOption(b),h.addOption(a)}):h.addOption(d.value),c.on("$destroy",function(){h.removeOption(d.value)})}}}}],Fe=q({restrict:"E",terminal:!0});a.angular.bootstrap||(aa(),ha(Ec),wc(b).ready(function(){Z(b,$)}))}(window,document),!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\\:form{display:block;}.ng-animate-block-transitions{transition:0s all!important;-webkit-transition:0s all!important;}.ng-hide-add-active,.ng-hide-remove{display:block!important;}</style>'),c("angular",["jquery"],function(a){return function(){var b;return b||a.angular}}(this)),Object.size=function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},Object.keys||(Object.keys=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}),Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){if(void 0===this||null===this)throw new TypeError('"this" is null or not defined');var c=this.length>>>0;for(b=+b||0,Math.abs(b)===1/0&&(b=0),b<0&&(b+=c,b<0&&(b=0));b<c;b++)if(this[b]===a)return b;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(a){if(null==this)throw new TypeError;var b,c,d=Object(this),e=d.length>>>0;if(0===e)return-1;for(b=e,arguments.length>1&&(b=Number(arguments[1]),b!=b?b=0:0!=b&&b!=1/0&&b!=-(1/0)&&(b=(b>0||-1)*Math.floor(Math.abs(b)))),c=b>=0?Math.min(b,e-1):e-Math.abs(b);c>=0;c--)if(c in d&&d[c]===a)return c;return-1}),Array.prototype.some||(Array.prototype.some=function(a){if(null==this)throw new TypeError("Array.prototype.some called on null or undefined");if("function"!=typeof a)throw new TypeError;for(var b=Object(this),c=b.length>>>0,d=arguments.length>=2?arguments[1]:void 0,e=0;e<c;e++)if(e in b&&a.call(d,b[e],e,b))return!0;return!1}),function(){window.console||(window.console={});for(var a=["log","info","warn","error","debug","trace","dir","group","groupCollapsed","groupEnd","time","timeEnd","profile","profileEnd","dirxml","assert","count","markTimeline","timeStamp","clear"],b=0;b<a.length;b++)window.console[a[b]]||(window.console[a[b]]=function(){})}(),c("utils",function(){}),c("core/config/routes",[],function(){"use strict";var a=function(a,b){b.html5Mode(!0),a.when("/?",{controller:"TripCtrl",templateUrl:"/app/book/templates/trip.tpl.html",reloadOnSearch:!1,title:"Book a Flight - Plane Tickets & Airfares"}).when("/referral.php",{controller:"TripCtrl",templateUrl:"/app/book/templates/trip.tpl.html",reloadOnSearch:!1,title:"Book a Flight - Plane Tickets & Airfares"}).when("/book/:tripType?/:people?/:firstCityPair?/:secondCityPair?/:firstDate?/:secondDate?/:queryString?",{controller:"TripCtrl",templateUrl:"/app/book/templates/trip.tpl.html",reloadOnSearch:!1,title:"Book a Flight - Plane Tickets & Airfares"}).when("/purchase/?",{controller:"PurchaseCtrl",templateUrl:"/app/purchase/templates/purchase.tpl.html"}).when("/purchase/:section?",{controller:"PurchaseCtrl",templateUrl:"/app/purchase/templates/purchase.tpl.html"}).when("/success/?",{controller:"SuccessCtrl",templateUrl:"/app/success/templates/success.tpl.html"}).when("/flight-check-in/?",{controller:"CheckInCtrl",templateUrl:"/app/check-in/templates/check-in.tpl.html",title:"Online Flight Check-In - Print Boarding Pass"}).when("/flight-check-in/:section?",{controller:"CheckInCtrl",templateUrl:"/app/check-in/templates/check-in.tpl.html",title:"Online Flight Check-In - Print Boarding Pass"}).when("/flight-check-in/:pnrCode?/:lastName?",{controller:"CheckInCtrl",templateUrl:"/app/check-in/templates/check-in.tpl.html",title:"Online Flight Check-In - Print Boarding Pass"}).when("/change",{controller:"ChangeOptionsCtrl",templateUrl:"/app/change/templates/change-options.tpl.html"}).when("/change/trip/:tripType?/?:people?/?:firstCityPair?/?:secondCityPair?/?:firstDate?/?:secondDate?/?",{controller:"ChangeTripCtrl",templateUrl:"/app/change/templates/change-trip.tpl.html"}).when("/change/seats",{controller:"ChangeExistingCtrl",templateUrl:"/app/change/templates/change-existing.tpl.html"}).when("/change/extras",{controller:"ChangeExistingCtrl",templateUrl:"/app/change/templates/change-existing.tpl.html"}).when("/manage-itinerary/",{controller:"ManageCtrl",templateUrl:"/app/manage/templates/manage.tpl.html",title:"Manage Flights - Find My Flight Reservation"}).when("/manage-itinerary/?",{controller:"ManageCtrl",templateUrl:"/app/manage/templates/manage.tpl.html",title:"Manage Flights - Find My Flight Reservation"}).when("/manage-itinerary/:pnrCode?/:lastName?",{controller:"ManageCtrl",templateUrl:"/app/manage/templates/manage.tpl.html",title:"Manage Flights - Find My Flight Reservation"}).when("/cancel/?",{controller:"CancelCtrl",templateUrl:"/app/cancel/templates/cancel.tpl.html"}).when("/check-flight-status/",{controller:"FlightStatusCtrl",templateUrl:"/app/flight-status/templates/flight-status.tpl.html",title:"Check Flight Status - Flight Tracker"}).when("/check-flight-status/?",{controller:"FlightStatusCtrl",templateUrl:"/app/flight-status/templates/flight-status.tpl.html",title:"Check Flight Status - Flight Tracker"}).when("/get-flight-alerts/?",{controller:"FlightAlertsCtrl",templateUrl:"/app/flight-alerts/templates/flight-alerts.tpl.html",title:"Get Flight Alerts - Flight Alerts"}).when("/get-flight-alerts/unsubscribe",{controller:"FlightAlertsCtrl",templateUrl:"/app/flight-alerts/templates/flight-alerts-unsubscribe.tpl.html",title:"Unsubscribe - Flight Alerts"}).when("/elevate-frequent-flyer",{controller:"ElevateCtrl",templateUrl:"/app/elevate/templates/elevate-login.tpl.html",title:"Elevate Frequent Flyer Rewards Programs"}).when("/elevate-frequent-flyer/sign-up",{controller:"ElevateCtrl",templateUrl:"/app/elevate/templates/elevate-sign-up.tpl.html",title:"Elevate Frequent Flyer Rewards Programs - Sign Up"}).when("/elevate-frequent-flyer/my-account",{controller:"ElevateCtrl",templateUrl:"/app/elevate/templates/account-info.tpl.html",title:"Elevate Frequent Flyer Rewards Programs - My Account"}).when("/elevate-frequent-flyer/landing",{controller:"ElevateCtrl",templateUrl:"/app/elevate/templates/landing.tpl.html",title:"Elevate Frequent Flyer Rewards Programs"}).when("/elevate-frequent-flyer/landing-first-time",{controller:"ElevateCtrl",templateUrl:"/app/elevate/templates/landing.tpl.html",title:"Elevate Frequent Flyer Rewards Programs"}).when("/elevate-frequent-flyer/landing-logged",{controller:"ElevateCtrl",templateUrl:"/app/elevate/templates/landing.tpl.html",title:"Elevate Frequent Flyer Rewards Programs"}).when("/elevate-frequent-flyer/activity",{controller:"ElevateCtrl",templateUrl:"/app/elevate/templates/activity.tpl.html",title:"Elevate Frequent Flyer Rewards Programs - Activity"}).when("/elevate-frequent-flyer/reset-password",{controller:"ElevateCtrl",templateUrl:"/app/elevate/templates/reset-password.tpl.html",title:"Elevate Frequent Flyer Rewards Programs - Reset Password"}).when("/elevate-frequent-flyer/buy-gift-points",{controller:"ElevateCtrl",templateUrl:"/app/elevate/templates/buy-points.tpl.html",title:"Elevate Frequent Flyer Rewards Programs - Buy Gift Points"}).when("/elevate-frequent-flyer/credit-card",{controller:"ElevateCtrl",templateUrl:"/app/elevate/templates/credit-card.tpl.html",title:"Elevate Frequent Flyer Rewards Programs - Credit Card"}).when("/elevate-frequent-flyer/logout",{controller:"ElevateCtrl",templateUrl:"/app/elevate/templates/logout.tpl.html",title:"Elevate Frequent Flyer Rewards Programs - Log out"}).when("/elevate-frequent-flyer/reset-password",{templateUrl:"/app/elevate/templates/reset-password.tpl.html",title:"Elevate Frequent Flyer Rewards Programs - Reset Password"}).when("/elevate-frequent-flyer/fly-store",{redirectTo:function(){window.location.href="/cms/elevate-frequent-flyer/partners/shopping-partners/fly-store"}}).when("/shop-login",{controller:"ShopLoginCtrl",templateUrl:"/app/elevate/templates/elevate-login.tpl.html"}).when("/get-flight-alerts",{templateUrl:"/app/flight-alerts/templates/flight-alerts.tpl.html"}).when("/error",{templateUrl:"/app/core/templates/404.tpl.html"}).otherwise({controller:"TripCtrl",templateUrl:"/app/book/templates/trip.tpl.html",reloadOnSearch:!1,catchAll:!0})};return a.$inject=["$routeProvider","$locationProvider"],a}),c("core/factories/http-interceptor",["angular"],function(a){"use strict";var b=function(b,c,d,e,f,g){return{request:function(a){return a.url.indexOf(c.context("api").resourceURL)>=0&&(c.context("api").verbose&&void 0,a.headers["UI-Version"]=c.meta("uiVersion"),a.meta={startTime:(new Date).getTime()}),a},response:function(a){var g;if(a.config.url.indexOf("app-overlay.tpl.html")>=0&&f.setHeaderTime(a.headers("Date")),a.config.url.indexOf(c.context("api").resourceURL)>=0){f.setHeaderTime(a.headers("Date"));try{e.receivedAPIResponse(a.config.url,a.config.data,a.data)}catch(a){}c.context("api").verbose&&void 0,a.data.extrasPaymentInfo&&(a.data.response.extrasPaymentInfo=a.data.extrasPaymentInfo);var h=a.data&&a.data.status&&a.data.status.error;if(h&&h.code%1e4===3069&&(a.data={status:{status:"SUCCESS"},response:{emptyPayload:!0}},h=!1),h){var i=b.defer();d.trap(a.data.status.error).then(function(a){i.resolve(b.reject({trappedError:a}))},function(){c.context("api").verbose&&void 0,i.resolve(b.reject({untrappedError:a.data.status.error}))}),g=i.promise}else a.data&&a.data.status&&(a.data.status.warningList||a.data.response&&a.data.response.warningList)?(d.trapWarningList(a.data.response.warningList||a.data.status.warningList),g=a||b.when(a)):g=a||b.when(a)}else/\/app.*modals/i.test(a.config.url)?(e.UIEvent(e.EVENTS.MODAL_OPENED,{templateUrl:a.config.url}),g=a||b.when(a)):g=a||b.when(a);return g},responseError:function(c){var e;return 0===c.status&&null===c.data&&c.config&&a.isObject(c.config.meta)&&(e=c.config.url.replace(/\/api\/v\d\//,""),g.api.noErrorOnTimeout.indexOf(e)===-1&&d.trapTimeout()),b.reject(c)}}};return b.$inject=["$q","envService","errorHandlerService","adobeAnalyticsService","latestTimeService","ResourceBundle"],b}),c("core/config/http",["core/factories/http-interceptor"],function(a){"use strict";var b=function(b){b.interceptors.push(a)};return b.$inject=["$httpProvider"],b}),c("api/constants/api",[],function(){"use strict";var a={PERSISTENCE_TIMEOUT:3e4,VERSIONS:["v2"],RESOURCES:{v2:{config:{base:"/config",entryPoints:{state:"/state"}},ancillaries:{base:"/ancillaries",entryPoints:{retrieve:"/retrieve"}},booking:{base:"/booking",entryPoints:{checkAvailablePetc:"/check-available-petc",checkTravelInsurance:"/check-travel-insurance",dynamicAirRule:"/dynamic-air-rule",lockInventoryCabin:"/lock-inventory-cabin",releaseLockInventoryCabin:"/release-inventory",purchase:"/purchase",search:"/search",searchCodeShare:"/search-codeshare",seatmap:"/seatmap",travelBankLogin:"/travelbank-login",validatePromoCode:"/validate-promo-code",requestQuote:"/request-quote"}},environment:{base:"/environment",entryPoints:{info:"/info"}},buyGifts:{base:"/buygift",entryPoints:{transferPoints:"/transfer-points"}},cancel:{base:"/cancel",entryPoints:{complete:"/complete",requestQuote:"/request-quote"}},cart:{base:"/cart",entryPoints:{create:"/create",remove:"/remove",retrieve:"/retrieve",update:"/update"}},change:{base:"/change",entryPoints:{complete:"/complete",pnr:"/pnr",
requestQuote:"/request-quote"}},checkin:{base:"/checkin",entryPoints:{baggageFee:"/baggage-fee",boardingPass:"/boardingpass",complete:"/complete",express:"/express",extraOptions:"/extra-options",loungeOptions:"/lounge-options",loungePass:"/loungepass",passbookPass:"/passbookpass",pnr:"/pnr",seatmap:"/seatmap"}},elevate:{base:"/elevate",entryPoints:{forgotElevatePassword:"/forget-elevate-password",forgotElevatePasswordConfirm:"/forget-elevate-password-confirm",joinElevate:"/join-elevate",login:"/login",logout:"/logout",profileModify:"/profile-modify",profileDelete:"/profile-delete",resetElevatePasswordByAuthToken:"/reset-elevate-password-by-authtoken",resetElevatePasswordByIDPhone:"/reset-elevate-password-by-id-phone",retrieveAccountInfo:"/retrieve-account-info",validateElevateId:"/validate-elevate-id",validateFfpNumber:"/validate-ffp-number",tierDetails:"/tier-details",attachProfileToPnr:"/attach-profile-to-pnr",webFeedback:"/web-feedback",travelBankBalance:"/travel-bank-balance-by-authtoken",requestElevatePoints:"/request-elevate-points",expressJoin:"/express-join",MCSOptInEligibility:"/opt-in-eligibility"}},flightAlerts:{base:"/flightalerts",entryPoints:{flightStatus:"/flight-status",retrieveFlightList:"/retrieve-flight-list",subscribe:"/subscribe",unsubscribe:"/unsubscribe"}},manage:{base:"/manage",entryPoints:{complete:"/complete",attachProfileToPnr:"/attach-profile-to-pnr",emailChangedItinerary:"/email-changed-itinerary",addKtNumber:"/add-kt-number",pnr:"/pnr",updatePassport:"/update-passport",applyOptIn:"/apply-optin"}},flightStatus:{base:"/flightstatus",entryPoints:{flightStatus:"/flight-status",tailNumberInfo:"/tailnumber-info"}},calendar:{base:"/calendar",entryPoints:{ical:"/ical"}},seatmap:{base:"/seatmap",entryPoints:{retrieve:"/retrieve"}}}}};return a}),c("content/constants/content-bundle",[],function(){"use strict";var a={contentMap:{COMPARE_FARES:{size:"large",title:"Compare Fares",templateUrl:"/app/content/templates/inline/compare-fares.tpl.html"},BEST_FARES_GUARANTEED:{size:"medium",title:"Best Fares Guaranteed",templateUrl:"/app/content/templates/inline/best-fares-guaranteed.tpl.html",contentType:"best-fares"},FARE_RULES:{size:"medium",title:"Fare Rules",type:"default",templateUrl:"/app/content/templates/inline/fare-rules.tpl.html"},RESPONSIBILITIES:{size:"small",title:"Just FYI",templateUrl:"/app/content/templates/inline/responsibilities.tpl.html"},TAXES:{size:"medium",title:"Taxes and Fees",type:"default",templateUrl:"/app/content/templates/inline/taxes.tpl.html"},FREQUENT_FLYER_QUESTIONS:{size:"medium",title:"Information on optional fields",type:"default",templateUrl:"/app/content/templates/inline/frequent-flyer-questions.tpl.html"},TSA_NOTICE:{size:"small",title:"TSA Privacy Notice",templateUrl:"/app/common/templates/modals/tsa-notice.tpl.html"},SPECIAL_REQUESTS:{size:"medium",title:"Any special requests?",templateUrl:"/app/content/templates/inline/special-requests.tpl.html"},FLIGHT_PERFORMANCE:{size:"med-low",title:"Flight {{flightNum}} On-time performance*",type:"table",templateUrl:"/app/content/templates/inline/flight-performance.tpl.html"},FLIGHT_PERFORMANCE_ERROR:{size:"small",title:"No data available at this time.",template:"<p>We're sorry, but the performance data for this flight is currently unavailable. Please try again later.</p>"}}};return a}),c("core/controllers/core",["jquery","angular","api/constants/api","content/constants/content-bundle"],function(a,b,c,d){"use strict";var e=function(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){this._$scope=a,this._$timeout=c,this._$modal=i,this._locationService=j,this.ResourceBundle=g,this.FareInfoBundle=h,this._persistenceService=k,this._fareService=e,this._headerService=p,this._windowService=q,this._defaultPageTitle=document.title,b.extend(a,{core:{openSpecialServicesModal:this.openSpecialServicesModal.bind(this),openPrivacyModal:this.openPrivacyModal.bind(this),openPnrModal:this.openPnrModal.bind(this),openTSAModal:this.openTSAModal.bind(this),openEmailItineraryModal:this.openEmailItineraryModal.bind(this),openSaveToCalendarModal:this.openSaveToCalendarModal.bind(this),openFrequentFlierModal:this.openFrequentFlierModal.bind(this),openKnownTravelerModal:this.openKnownTravelerModal.bind(this),openCancelAwardsBookings:this.openCancelAwardsBookings.bind(this),openWrongEmailModal:this.openWrongEmailModal.bind(this),openFareInfoModal:this.openFareInfoModal.bind(this),openPassportInfoModal:this.openPassportInfoModal.bind(this),openFlightAlertModal:this.openFlightAlertModal.bind(this),openFlightAlertRuleModal:this.openFlightAlertRuleModal.bind(this)},context:{type:j.contexts,is:j.contextIs}}),a.$on("$locationChangeSuccess",function(){this._onLinkFocus(a,c),m.go("top",{duration:0})}.bind(this)),d.config.get(function(b){a.core.config=b}),d.info.get(function(b){a.core.info=b}),this._initServiceWorker(),this._getPersistenceData(),this._onAppClose(),this._updatePageTitle(),l.subscribe("core.openModal",function(a,b,c){this[a]&&this[a](b||"",c)}.bind(this))};return e.$inject=["$scope","$timeout","cms","fareService","observerService","ResourceBundle","FareInfoBundle","$modal","locationService","persistenceService","pubSubService","scrollService","appDynamicsService","ensightenService","headerService","windowService"],e.prototype._updatePageTitle=function(){this._$scope.$on("$routeChangeSuccess",function(a,b){b.hasOwnProperty("$$route")&&b.$$route.title?document.title=b.$$route.title+" | Virgin America":document.title=this._defaultPageTitle}.bind(this))},e.prototype._initServiceWorker=function(){"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/service-worker.js",{scope:"./"})})},e.prototype._onAppClose=function(){a(window).on("unload",function(){var b=this._fareService.getInventoryLocked();if(b){var d=c.ACTIVE_VERSION,e=c.RESOURCES[d],f=["/api/",d,"/booking",e.booking.entryPoints.releaseLockInventoryCabin].join("");a.ajax(f,{async:!1})}}.bind(this))},e.prototype.openSpecialServicesModal=function(){this._$modal.open(d.contentMap.SPECIAL_REQUESTS)},e.prototype.openFareInfoModal=function(a){var b=this._$scope.$new();a=this.ResourceBundle.cabinClassToTier[a],b.fareInfo=this.FareInfoBundle[a];var c=this.ResourceBundle.modal.fareInfo;this._$modal.open({contentType:c.TYPE,size:c.SIZE,title:c.TITLE,templateUrl:c.TEMPLATE_URL,scope:b})},e.prototype.openPrivacyModal=function(){var a=this.ResourceBundle.modal.privacyPolicy;this._$modal.open({size:a.SIZE,title:a.TITLE,templateUrl:a.TEMPLATE_URL})},e.prototype.openPnrModal=function(){var a=this._$scope.$new();a.context=this._locationService.getContext(),this._$modal.open({size:"small",title:"Trip Finder",templateUrl:"/app/common/templates/modals/locate-pnr.tpl.html",scope:a})},e.prototype.openTSAModal=function(){this._$modal.open(d.contentMap.TSA_NOTICE)},e.prototype.openEmailItineraryModal=function(a){var b=this._$scope.$new();b.pnr=a,this._$modal.open({size:"small",title:"Email Itinerary & Receipt",templateUrl:"/app/common/templates/modals/email-itinerary.tpl.html",controller:"EmailItineraryCtrl",contentType:"form",scope:b})},e.prototype.openSaveToCalendarModal=function(a){var b=this._$scope.$new();b.flightData=a.data,this._$modal.open({size:"small",title:"Save To Calendar",templateUrl:"/app/common/templates/modals/save-to-calendar.tpl.html",controller:"SaveToCalendarCtrl",contentType:"form",scope:b})},e.prototype.openFrequentFlierModal=function(a){var b=this._$scope.$new();b.traveler=a.traveler,b.pnr=a.pnr,this._$modal.open({size:"small",title:"Frequent Flyer",templateUrl:"/app/common/templates/modals/frequent-flier.tpl.html",controller:"FrequentFlierCtrl",contentType:"form",scope:b})},e.prototype.openKnownTravelerModal=function(a,b){var c=this._$scope.$new();c.travelers=a,c.pnr=b,this._$modal.open({size:"small",title:"Known Traveler",templateUrl:"/app/common/templates/modals/known-traveler.tpl.html",controller:"KnownTravelerCtrl",contentType:"form",scope:c})},e.prototype.openCancelAwardsBookings=function(){this._$modal.open({size:"med-low",title:"Need to cancel an Elevate reward reservation?",templateUrl:"/app/common/templates/modals/cancel-awards-bookings.tpl.html"})},e.prototype.openWrongEmailModal=function(a){var b=this._$scope.$new();b.currentEmail=a.email,this._$modal.open({size:"small",title:"Wrong Email?",templateUrl:"/app/common/templates/modals/wrong-email.tpl.html",controller:"WrongEmailCtrl",contentType:"form",scope:b})},e.prototype.openPassportInfoModal=function(a,b){var c=this._$scope.$new();c.travelers=a,c.pnr=b,this._$modal.open({size:"small",title:"Add Passport Info",templateUrl:"/app/common/templates/modals/add-passport-info.tpl.html",controller:"AddPassportInfoCtrl",contentType:"form",scope:c})},e.prototype._getPersistenceData=function(){this._persistenceService.retrieve()},e.prototype.openFlightAlertModal=function(a,b){var c=this._$scope.$new();c.modalContext={origin:a.origin,destination:a.destination,flightNumber:a.flightNum,departureDateTime:a.departureDateTime},b&&(c.modalContext.emailAddress=b.toLowerCase()),this._$modal.open({scope:c,size:"med-low",title:"Flight Alerts",templateUrl:"/app/common/templates/modals/flight-alerts.tpl.html",controller:"FlightAlertsModalCtrl",contentType:"form"})},e.prototype.openFlightAlertRuleModal=function(){var a=this.ResourceBundle.modal.flightAlertsRules;this._$modal.open({size:a.SIZE,title:a.TITLE,templateUrl:a.TEMPLATE_URL})},e.prototype.openAlaskaMileagePlan=function(a,b){var c=this._$scope.$new();c.linkCid=b.linkCid,c.pnr=a,this._$modal.open({contentType:"default",size:"small",showHeader:!1,templateUrl:"/app/success/templates/modals/alaska-mileage-plan.tpl.html",controller:"AlaskaMileagePlanModalCtrl",scope:c})},e.prototype.openJoinAlaskaMileagePlan=function(a){var b=this._$scope.$new();b.linkCid=a.linkCid,this._$modal.open({contentType:"default",size:"med-low",showHeader:!1,templateUrl:"/app/common/templates/modals/join-alaska-mileage-plan.tpl.html",controller:"JoinAlaskaMileagePlanModalCtrl",scope:b})},e.prototype.openManageMCSOptIn=function(a){var b=this._$scope.$new();b.pnr=a,this._$modal.open({contentType:"default",size:"small",showHeader:!1,templateUrl:"/app/manage/templates/modals/manage-mcs-opt-in.tpl.html",controller:"ManageMCSOptInModalCtrl",scope:b})},e.prototype.openElevateTurnDownModal=function(){this._$modal.open({contentType:"default",size:"med-low",showHeader:!1,templateUrl:"/app/common/templates/modals/elevate-turn-down.tpl.html",controller:"ElevateTurnDownModalCtrl"})},e.prototype.openElevatePointsBlockedModal=function(){this._$modal.open({contentType:"default",size:"small",showHeader:!1,templateUrl:"/app/common/templates/modals/elevate-points-blocked.tpl.html"})},e.prototype._onLinkFocus=function(){function b(b){var d=a(window),g=a(b),h=a(".banner__yts"),i=d.scrollTop(),j=g.offset().top,k=h.outerHeight(),l=f.ytsFixed()?k:0;a(".is-nav-expanded-active").find(c).index(g)<0&&e._header.setActive(!1),i+l>=j&&d.scrollTop(j-g.outerHeight()-l)}var c="a,input,select,label,span,li",d=a("body"),e=this._headerService,f=this._windowService;d.on("keyup",function(c){var d=a(c.target),e=d.is("a,input,select,label,span,li"),f=9===c.keyCode,g=c.shiftKey&&f||f;e&&g&&b(d)}),this._$scope.$on("$destroy",function(){d.off("keyup")})},e}),c("core/services/header",[],function(){"use strict";var a=function(a){function b(a){"undefined"==typeof a?d.navActive=!1:d.navActive=a,c.notify("changed")}var c=a.defer(),d={deferred:c,navActive:!1,setActive:b.bind(this)};return{_header:d}};return a.$inject=["$q"],a}),c("core/services/app-dynamics",[],function(){"use strict";var a=function(a,b){this._$window=a,this._env=b,this._hostTypes={DEVELOPMENT:"development",PRODUCTION:"production",QA:"quality-assurance"},this._keyMap={DEVELOPMENT:"AD-AAB-AAA-WYS",PRODUCTION:"AD-AAB-AAA-WZX",QA:"AD-AAB-AAA-WYS"};var c,d=this._env.meta("hostType");for(var e in this._hostTypes)this._hostTypes[e]===d&&(c=e);if("undefined"!=typeof c){this._$window["adrum-start-time"]=(new Date).getTime(),this._$window["adrum-app-key"]=this._keyMap[c];var f=document.createElement("script");f.async=!0,f.src="//de8of677fyt0b.cloudfront.net/adrum/adrum-latest.js",document.getElementsByTagName("head")[0].appendChild(f)}};return a.$inject=["$window","envService"],a}),c("modernizr",[],function(){"use strict";return window.Modernizr.addTest("highres",function(){if(window.matchMedia){var a=window.matchMedia("only screen and (-moz-min-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen  and (min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx)");if(a&&a.matches)return!0}}),window.Modernizr}),function(a){var b=a({});a.subscribe=function(){b.on.apply(b,arguments)},a.unsubscribe=function(){b.off.apply(b,arguments)},a.publish=function(){b.trigger.apply(b,arguments)}}(jQuery),c("pubsub",["jquery"],function(){}),c("core/services/window",["jquery","modernizr","pubsub"],function(a,b){"use strict";var c=function(c){function d(){return _.breakpoint}function e(a){_.breakpoint=a,c.publish("windowService.breakpoint",[a])}function f(b){_.dimensions=b,a.publish("windowService.resize",[b])}function g(){return _.dimensions}function h(){return _.scrollTop}function i(b){_.scrollTop=b,a.publish("windowService.scroll",[b])}function j(a){_.modalMode=a}function k(){return _.modalMode}function l(b,c,d,e,f){function g(b){a(h).each(function(c,d){a(d).attr("aria-hidden",b)})}_.uiBlock={isBlocked:b,clickCallback:c,backdropClass:d||"modal__backdrop--white",scrollableClass:e,index:f};var h=[".banner"," #travel-advisory",".view","footer"].join(",");g(!!b)}function m(){return _.uiBlock}function n(a){_.headerVisible=a}function o(){return _.headerVisible}function p(a){_.footerHidden=a}function q(){return _.footerHidden}function r(a){_.chromeHidden=a}function s(){return _.chromeHidden}function t(a){_.advisoryHidden=a}function u(){return _.advisoryHidden}function v(a){_.ninjaMode=a}function w(){return _.ninjaMode}function x(a){_.isChange=a}function y(){return _.isChange}function z(a){c.publish("windowService.headerFixed",[a]),_.headerFixed=a}function A(){return _.headerFixed}function B(a){_.doubleHeader=a}function C(){return _.doubleHeader}function D(a){_.statusBarVisible=a}function E(){return _.statusBarVisible}function F(a){_.ytsVisible=a,c.publish("windowService.setYtsVisible",[a])}function G(){return _.ytsVisible}function H(b){_.ytsFixed=b,a.publish("windowService.setYtsFixed",[b])}function I(){return _.ytsFixed}function J(a){_.ytsExpanded=a}function K(){return _.ytsExpanded}function L(a){_.ytsPayNow=a}function M(){return _.ytsPayNow}function N(a){c.publish("windowService.elevateMode",[a])}function O(a){c.publish("windowService.minimalLoginUi",[a])}function P(a){_.elevateLogin=a}function Q(){return _.elevateLogin}function R(b,c){a.subscribe("windowService."+b,c)}function S(b,c){a.unsubscribe("windowService."+b,c)}function T(){return _.scrollableClass}function U(a){return b.mq(a)}function V(){var a=document.documentElement.clientWidth/window.innerWidth;return window.innerHeight*a}function W(){_.isNinjaMode=!1,_.scrollTop=0,_.ytsVisible=!1,_.headerVisible=!0,_.statusBarVisible=!1}function X(){return _.shouldShowAppLoader}function Y(a){_.shouldShowAppLoader=a}function Z(){return _.avatarPickerOpen}function $(a){_.avatarPickerOpen=a}var _={breakpoint:"small",modalMode:!1,ninjaMode:!1,scrollTop:0,scrollableClass:null,uiBlock:{isBlocked:!1,clickCallback:null,backdropClass:"modal__backdrop--white"},statusBarVisible:!1,headerFixed:!1,headerVisible:!0,ytsVisible:!1,shouldShowAppLoader:!0};return this.pubSubService=c,{setBreakpoint:e,breakpoint:d,setDimensions:f,dimensions:g,setScrollTop:i,scrollTop:h,setModalMode:j,modal:k,setUiBlock:l,uiBlock:m,setHeaderVisible:n,headerVisible:o,setFooterHidden:p,footerHidden:q,setChromeHidden:r,chromeHidden:s,setAdvisoryHidden:t,advisoryHidden:u,setNinjaMode:v,ninjaMode:w,setChangeFlow:x,isChange:y,setHeaderFixed:z.bind(this),headerFixed:A,setDoubleHeader:B,doubleHeader:C,setStatusBarVisible:D,statusBarVisible:E,setYtsVisible:F,ytsVisible:G,setYtsFixed:H,ytsFixed:I,setYtsExpanded:J,ytsExpanded:K,setYtsPayNow:L,ytsPayNow:M,setElevateMode:N,setMinimalLoginUi:O,setElevateLogin:P,elevateLogin:Q,subscribe:R,unsubscribe:S,scrollableClass:T,mq:U,getDeviceWindowHeight:V,reset:W,getShowAppLoader:X,setShowAppLoader:Y,getAvatarPickerOpen:Z,setAvatarPickerOpen:$}};return c.$inject=["pubSubService"],c}),jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,b,c,d,e){return jQuery.easing[jQuery.easing.def](a,b,c,d,e)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b+c:-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b*b+c:d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return 0==b?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){return 0==b?c:b==e?c+d:(b/=e/2)<1?d/2*Math.pow(2,10*(b-1))+c:d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){return(b/=e/2)<1?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(1==(b/=e))return c+d;if(g||(g=.3*e),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(b-=1))*Math.sin(2*(b*e-f)*Math.PI/g))+c},easeOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(1==(b/=e))return c+d;if(g||(g=.3*e),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*b)*Math.sin(2*(b*e-f)*Math.PI/g)+d+c},easeInOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(2==(b/=e/2))return c+d;if(g||(g=.3*e*1.5),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return b<1?-.5*h*Math.pow(2,10*(b-=1))*Math.sin(2*(b*e-f)*Math.PI/g)+c:h*Math.pow(2,-10*(b-=1))*Math.sin(2*(b*e-f)*Math.PI/g)*.5+d+c},easeInBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),d*(b/=e)*b*((f+1)*b-f)+c},easeOutBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),d*((b=b/e-1)*b*((f+1)*b+f)+1)+c},easeInOutBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),(b/=e/2)<1?d/2*b*b*(((f*=1.525)+1)*b-f)+c:d/2*((b-=2)*b*(((f*=1.525)+1)*b+f)+2)+c},easeInBounce:function(a,b,c,d,e){return d-jQuery.easing.easeOutBounce(a,e-b,0,d,e)+c},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?7.5625*d*b*b+c:b<2/2.75?d*(7.5625*(b-=1.5/2.75)*b+.75)+c:b<2.5/2.75?d*(7.5625*(b-=2.25/2.75)*b+.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+.984375)+c},easeInOutBounce:function(a,b,c,d,e){return b<e/2?.5*jQuery.easing.easeInBounce(a,2*b,0,d,e)+c:.5*jQuery.easing.easeOutBounce(a,2*b-e,0,d,e)+.5*d+c}}),c("jquery-easing",["jquery"],function(){}),c("core/services/scroll",["angular","modernizr","jquery","jquery-easing"],function(a,b,c){"use strict";var d=function(a,b,d,e,f){this.$timeout=b,this.windowService=d,this.pubSubService=e,this.resourceBundle=f,this.$q=a,this._elements={},this._scrollOffset=0,this._scrollOffsetType={},this._offsets={nav:{small:0,medium:-54,large:-54},yts:{small:-60,medium:-60,large:-90}},this._scrollElems={all:c("body, html"),body:c("body")},this.SCROLL_DEFAULTS={animate:!0,delay:0,easing:"easeOutQuint",duration:1e3},this.setOffsetType("nav"),this._headerFixed=d.headerFixed();var g=function(a){this._headerFixed=a}.bind(this);e.subscribe("windowService.headerFixed",g),this._loadFromPersistence=!1;var h=function(){this._loadFromPersistence=!0}.bind(this);return e.subscribe("scroll.loadFromPersistence",h),this._stateScrollOverrides={},this.stopEventPropagation=function(a){return a.preventDefault(),a.stopPropagation(!0),!1},{addElement:this.addElement.bind(this),go:this.go.bind(this),setOffset:this.setOffset.bind(this),setOffsetType:this.setOffsetType.bind(this),scroll:this.scroll.bind(this)}};return d.$inject=["$q","$timeout","windowService","pubSubService","ResourceBundle"],d.prototype.scroll=function(a){var b="undefined"!=typeof a.delay?a.delay:1e3;return this.pubSubService.publish("yts.setState",[a.target]),this.go(this._getScrollId(a.target),{delay:b})},d.prototype._getScrollId=function(a){return this._stateScrollOverrides[a]||this.resourceBundle.states[a].scrollTarget},d.prototype._verifyUID=function(a){var b=a.attr("id");return b||(b="vx1235",a.attr("id",b)),b},d.prototype.addElement=function(a,b){var c=this._verifyUID(a);return this._elements[c]={callback:b,elem:a},this._elements[c]},d.prototype.setOffset=function(a){var b=this,d=this.windowService.ytsVisible()&&this.windowService.ytsFixed();return"undefined"!=typeof a?void(this._scrollOffset=a):void(this._scrollOffsetType.weekBar?this._scrollOffset=this._scrollOffsetType.weekBar:this._loadFromPersistence?(this._scrollOffset=0,this._loadFromPersistence=!1):this._scrollOffsetType.yts&&!d?this._scrollOffset=this._headerFixed?54:0:this._scrollOffsetType.nav?this._scrollOffset=this._scrollOffsetType.nav:this._scrollOffset=Math.min.apply(null,c.map(Object.keys(b._scrollOffsetType),function(a){var c=b._scrollOffsetType[a];return b._headerFixed&&!d?c+54:c})))},d.prototype.setOffsetType=function(a,b){var c=this.windowService.breakpoint();if("undefined"==typeof b)switch(c){case"large":b=this._offsets[a].large;break;case"medium":b=this._offsets[a].medium;break;case"small":b=this._offsets[a].small}this._scrollOffsetType[a]=b},d.prototype.go=function(a,b){function d(){var b="mousewheel DOMMouseScroll touchmove";c(window).bind(b,i.stopEventPropagation.bind(i));var d=!1;if(null===e){var j="object"==typeof a?a:c("#"+a);j.length&&(e=j.offset().top)}var k=e+i._scrollOffset-c("#change-guider").height();i._scrollElems.all.animate({scrollTop:k},h.duration,h.easing,function(){g.resolve(),d||(c(window).unbind(b),d=!0,f&&"function"==typeof h.callback&&h.callback("end"))})}var e,f,g=this.$q.defer(),h=c.extend({},this.SCROLL_DEFAULTS,b),i=this;switch(this.setOffset(h.offset),a){case"top":e=0;break;case"bottom":e=this._scrollElems.body.height();break;default:h.callback&&h.callback("start"),e=null}return this.$timeout(d,h.delay),g.promise},d}),c("core/services/observer",["angular"],function(a){"use strict";var b=function(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){function A(a){return a.charAt(0).toUpperCase()+a.slice(1)}var B={$rootScope:b,$window:c,$timeout:d,$location:e,tripService:f,changeService:g,fareService:h,seatService:i,purchaseService:j,pnrService:k,locationService:l,elevateService:m,persistenceService:n,checkInService:o,ancillariesService:p,windowService:q,manageService:r,workflowService:s,cancelService:t,errorHandlerService:u,bookingTimerService:v,loadingService:w,adobeAnalyticsService:x,pubSubService:y,scrollService:z};return a.forEach(B,function(a,b){this[b]=a},this),delete B.$rootScope,delete B.$window,delete B.$location,delete B.$timeout,a.forEach(B,function(a,b){var c="_add"+A(b)+"Watches";"undefined"!=typeof this[c]&&this["_add"+A(b)+"Watches"]()},this),{}};return b.$inject=["$rootScope","$window","$timeout","$location","tripService","changeService","fareService","seatService","purchaseService","pnrService","locationService","elevateService","persistenceService","checkInService","ancillariesService","windowService","manageService","workflowService","cancelService","errorHandlerService","bookingTimerService","loadingService","adobeAnalyticsService","pubSubService","scrollService"],b.prototype._addErrorHandlerServiceWatches=function(){this.$rootScope.$watch(this.errorHandlerService.getStartOverFlag,function(a){a&&this.locationService.resetApp()}.bind(this))},b.prototype._addTripServiceWatches=function(){var a=this;this.$rootScope.$watch(this.tripService.travelerAmountHash,function(){if(this.locationService.getContext()!==this.locationService.contexts.CHANGE){var b=a.tripService.travelerAmount();a.purchaseService.updateTravelers(b),a.seatService.updateTravellers(b)}}.bind(this)),this.$rootScope.$watch(this.tripService.getDates,function(b){a.fareService.handleDates(b,"BOOK")},!0),this.$rootScope.$watch(this.tripService.getSelectedTripPublicModel,function(b,c){b!==c&&a.persistenceService.saveTripModel(b)},!0),this.$rootScope.$watch(this.ancillariesService.getAllSelectedAncillaries,function(b){a.seatService.setSelectedAncillaries(b)},!0),this.$rootScope.$watch(this.locationService.isBookBackStep,function(b){b&&(a.pubSubService.publish("yts.collapseYts",[!0]),a.scrollService.go("top"))}),this.$rootScope.$watch(this.locationService.shouldRender,function(b){b&&a.locationService.push(a.tripService.getSelectedTripPublicModel())})},b.prototype._addFareServiceWatches=function(){this.$rootScope.$watchCollection(this.fareService.getSelectedFares,function(a){var b;if(a.length&&(!a[0]||a[0].tier)){var c="book"===this.locationService.getContext()?this.tripService:this.changeService;b=c.getTripTypeLegs(),this.seatService.setRequestSeatMapModels(b,a),this.seatService.updateSelectedFaresModel(a),this.purchaseService.setSelectedFares(a),"change"===this.locationService.getContext()&&this.changeService.setSelectedFares(a)}}.bind(this)),this.$rootScope.$watch(this.fareService.getActiveCurrency,this.purchaseService.setActiveCurrency),this.$rootScope.$watch(this.fareService.isAllFaresSelected,function(a,b){if(a!==b){var c=this.fareService.getSelectedFares();c.length>0&&this.tripService.updateCityPairs(this.fareService.getSelectedFares())}}.bind(this)),this.$rootScope.$watch(this.fareService.lockInventoryNewFares,function(){this.purchaseService.setLockInventoryFares(this.fareService.lockInventoryNewFares())}.bind(this))},b.prototype._addLocationServiceWatches=function(){this.$rootScope.$watch(this.locationService.getContext,function(a,b){if(a!==b){var c={book:"booking","check-in":"checkin",change:"change",cancel:"checkin",manage:"checkin"},d=c[a];this.pnrService.setPNRType(d),b&&(a===this.locationService.contexts.CHECKIN?this.checkInService.reset():a===this.locationService.contexts.BOOK?(this.tripService.reset(),this.fareService.reset(),this.windowService.reset()):a===this.locationService.contexts.MANAGE&&(this.tripService.reset(),this.fareService.reset(),this.manageService.reset()),b===this.locationService.contexts.BOOK&&this.fareService.releaseLockInventoryCabin())}}.bind(this)),this.$rootScope.$watch(this.locationService.shouldResetBook,function(a){a&&(this.seatService.resetService(),this.fareService.reset(),this.tripService.reset(),this.windowService.reset(),this.locationService.setResetBook(!1))}.bind(this))},b.prototype._addElevateServiceWatches=function(){this.$rootScope.$watchCollection(this.elevateService.getMustPersistUserData,function(a,b){a!==b&&this.persistenceService.saveElevateModel(this.elevateService.getUserData())}.bind(this)),this.$rootScope.$watchCollection(this.elevateService.getAccountInfo,function(a,b){a!==b&&this.purchaseService.updateAccountInfo(a)}.bind(this)),this.$rootScope.$watchCollection(this.elevateService.getTier,function(a){this.purchaseService.updateElevateTier(a)}.bind(this))},b.prototype._addPersistenceServiceWatches=function(){this.$rootScope.$watchCollection(this.persistenceService.getElevateModel,function(a,b){a!==b&&this.elevateService.setUserPersistenceData(a)}.bind(this)),this.$rootScope.$watchCollection(this.persistenceService.getPrivateModel,function(a,b){a!==b&&a.authToken&&this.elevateService.setAuthToken(a.authToken)}.bind(this))},b.prototype._addCancelServiceWatches=function(){this.$rootScope.$watch(this.cancelService.getQuoteModel,function(a,b){a!==b&&a&&this.purchaseService.setCancelQuote(a)}.bind(this),!0)},b.prototype._addChangeServiceWatches=function(){var a=this;this.$rootScope.$watch(this.changeService.getDates,function(b){a.fareService.handleDates(b,"CHANGE")},!0),this.$rootScope.$watch(this.changeService.getQuoteModel,function(b,c){b!==c&&b&&(this.pubSubService.publish("adobeAnalytics.updateQuoteModel",[b]),a.purchaseService.setChangeQuote(b))}.bind(this),!0)},b.prototype._addAdobeAnalyticsServiceWatches=function(){var b=this;this.$rootScope.$watch(this.elevateService.isLoggedIn,function(c){b.adobeAnalyticsService.UIEvent(b.adobeAnalyticsService.EVENTS.ELEVATE_STATE,{isLoggedIn:c,elevateUser:a.copy(b.elevateService.getUserData())})}),this.$rootScope.$watch(this.elevateService.isRecognizedNotLoggedIn,function(c){b.adobeAnalyticsService.UIEvent(b.adobeAnalyticsService.EVENTS.ELEVATE_STATE,{isRecognizedNotLoggedIn:c,elevateUser:a.copy(b.elevateService.getUserData())})}),this.$rootScope.$watch(this.fareService.getFareIntention,function(c){b.adobeAnalyticsService.UIEvent(b.adobeAnalyticsService.EVENTS.FARE_INTENTION,{fareIntention:a.copy(c)})}),this.$rootScope.$watch(function(){return this.fareService.getSelectedFares().length}.bind(this),function(){b.adobeAnalyticsService.UIEvent(b.adobeAnalyticsService.EVENTS.SELECTED_FARES,{selectedFares:a.copy(b.fareService.getSelectedFares())})},!0),this.$rootScope.$on("$routeChangeSuccess",function(a,c){c.catchAll&&b.adobeAnalyticsService.UIEvent(b.adobeAnalyticsService.EVENTS.PAGE_NOT_FOUND,{absUrl:b.locationService.getAbsUrl(),path:b.locationService.getPath()})})},b}),c("core/services/ensighten",[],function(){"use strict";var a=function(a){this._env=a,this._hostTypes={DEVELOPMENT:"development",PRODUCTION:"production",QA:"quality-assurance"},this._ensightenMap={DEVELOPMENT:"dev/",PRODUCTION:"",QA:"stage/"};var b,c=this._env.meta("hostType");for(var d in this._hostTypes)this._hostTypes[d]===c&&(b=d);if("undefined"!=typeof b){var e="//nexus.ensighten.com/virginamerica/"+this._ensightenMap[b]+"Bootstrap.js",f=document.createElement("script");f.async=!0,f.src=e,document.getElementsByTagName("head")[0].appendChild(f)}};return a.$inject=["envService"],a}),function(a){function d(a,b){return function(c){return k(a.call(this,c),b)}}function e(a,b){return function(c){return this.lang().ordinal(a.call(this,c),b)}}function f(){}function g(a){w(a),i(this,a)}function h(a){var b=q(a),c=b.year||0,d=b.month||0,e=b.week||0,f=b.day||0,g=b.hour||0,h=b.minute||0,i=b.second||0,j=b.millisecond||0;this._input=a,this._milliseconds=+j+1e3*i+6e4*h+36e5*g,this._days=+f+7*e,this._months=+d+12*c,this._data={},this._bubble()}function i(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return b.hasOwnProperty("toString")&&(a.toString=b.toString),b.hasOwnProperty("valueOf")&&(a.valueOf=b.valueOf),a}function j(a){return a<0?Math.ceil(a):Math.floor(a)}function k(a,b){for(var c=a+"";c.length<b;)c="0"+c;return c}function l(a,b,c,d){var e,f,g=b._milliseconds,h=b._days,i=b._months;g&&a._d.setTime(+a._d+g*c),(h||i)&&(e=a.minute(),f=a.hour()),h&&a.date(a.date()+h*c),i&&a.month(a.month()+i*c),g&&!d&&da.updateOffset(a),(h||i)&&(a.minute(e),a.hour(f))}function m(a){return"[object Array]"===Object.prototype.toString.call(a)}function n(a){return"[object Date]"===Object.prototype.toString.call(a)||a instanceof Date}function o(a,b,c){var d,e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0;for(d=0;d<e;d++)(c&&a[d]!==b[d]||!c&&s(a[d])!==s(b[d]))&&g++;return g+f}function p(a){if(a){var b=a.toLowerCase().replace(/(.)s$/,"$1");
a=Ma[a]||Na[b]||b}return a}function q(a){var b,c,d={};for(c in a)a.hasOwnProperty(c)&&(b=p(c),b&&(d[b]=a[c]));return d}function r(b){var c,d;if(0===b.indexOf("week"))c=7,d="day";else{if(0!==b.indexOf("month"))return;c=12,d="month"}da[b]=function(e,f){var g,h,i=da.fn._lang[b],j=[];if("number"==typeof e&&(f=e,e=a),h=function(a){var b=da().utc().set(d,a);return i.call(da.fn._lang,b,e||"")},null!=f)return h(f);for(g=0;g<c;g++)j.push(h(g));return j}}function s(a){var b=+a,c=0;return 0!==b&&isFinite(b)&&(c=b>=0?Math.floor(b):Math.ceil(b)),c}function t(a,b){return new Date(Date.UTC(a,b+1,0)).getUTCDate()}function u(a){return v(a)?366:365}function v(a){return a%4===0&&a%100!==0||a%400===0}function w(a){var b;a._a&&a._pf.overflow===-2&&(b=a._a[ia]<0||a._a[ia]>11?ia:a._a[ja]<1||a._a[ja]>t(a._a[ha],a._a[ia])?ja:a._a[ka]<0||a._a[ka]>23?ka:a._a[la]<0||a._a[la]>59?la:a._a[ma]<0||a._a[ma]>59?ma:a._a[na]<0||a._a[na]>999?na:-1,a._pf._overflowDayOfYear&&(b<ha||b>ja)&&(b=ja),a._pf.overflow=b)}function x(a){a._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function y(a){return null==a._isValid&&(a._isValid=!isNaN(a._d.getTime())&&a._pf.overflow<0&&!a._pf.empty&&!a._pf.invalidMonth&&!a._pf.nullInput&&!a._pf.invalidFormat&&!a._pf.userInvalidated,a._strict&&(a._isValid=a._isValid&&0===a._pf.charsLeftOver&&0===a._pf.unusedTokens.length)),a._isValid}function z(a){return a?a.toLowerCase().replace("_","-"):a}function A(a,b){return b.abbr=a,oa[a]||(oa[a]=new f),oa[a].set(b),oa[a]}function B(a){delete oa[a]}function C(a){var c,d,e,f,g=0,h=function(a){if(!oa[a]&&pa)try{b("./lang/"+a)}catch(a){}return oa[a]};if(!a)return da.fn._lang;if(!m(a)){if(d=h(a))return d;a=[a]}for(;g<a.length;){for(f=z(a[g]).split("-"),c=f.length,e=z(a[g+1]),e=e?e.split("-"):null;c>0;){if(d=h(f.slice(0,c).join("-")))return d;if(e&&e.length>=c&&o(f,e,!0)>=c-1)break;c--}g++}return da.fn._lang}function D(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function E(a){var b,c,d=a.match(ta);for(b=0,c=d.length;b<c;b++)Ra[d[b]]?d[b]=Ra[d[b]]:d[b]=D(d[b]);return function(e){var f="";for(b=0;b<c;b++)f+=d[b]instanceof Function?d[b].call(e,a):d[b];return f}}function F(a,b){return a.isValid()?(b=G(b,a.lang()),Oa[b]||(Oa[b]=E(b)),Oa[b](a)):a.lang().invalidDate()}function G(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(ua.lastIndex=0;d>=0&&ua.test(a);)a=a.replace(ua,c),ua.lastIndex=0,d-=1;return a}function H(a,b){var c;switch(a){case"DDDD":return xa;case"YYYY":case"GGGG":case"gggg":return ya;case"YYYYY":case"GGGGG":case"ggggg":return za;case"S":case"SS":case"SSS":case"DDD":return wa;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Ba;case"a":case"A":return C(b._l)._meridiemParse;case"X":return Ea;case"Z":case"ZZ":return Ca;case"T":return Da;case"SSSS":return Aa;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"ww":case"W":case"WW":case"e":case"E":return va;default:return c=new RegExp(P(O(a.replace("\\","")),"i"))}}function I(a){var b=(Ca.exec(a)||[])[0],c=(b+"").match(Ja)||["-",0,0],d=+(60*c[1])+s(c[2]);return"+"===c[0]?-d:d}function J(a,b,c){var d,e=c._a;switch(a){case"M":case"MM":null!=b&&(e[ia]=s(b)-1);break;case"MMM":case"MMMM":d=C(c._l).monthsParse(b),null!=d?e[ia]=d:c._pf.invalidMonth=b;break;case"D":case"DD":null!=b&&(e[ja]=s(b));break;case"DDD":case"DDDD":null!=b&&(c._dayOfYear=s(b));break;case"YY":e[ha]=s(b)+(s(b)>68?1900:2e3);break;case"YYYY":case"YYYYY":e[ha]=s(b);break;case"a":case"A":c._isPm=C(c._l).isPM(b);break;case"H":case"HH":case"h":case"hh":e[ka]=s(b);break;case"m":case"mm":e[la]=s(b);break;case"s":case"ss":e[ma]=s(b);break;case"S":case"SS":case"SSS":case"SSSS":e[na]=s(1e3*("0."+b));break;case"X":c._d=new Date(1e3*parseFloat(b));break;case"Z":case"ZZ":c._useUTC=!0,c._tzm=I(b);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":a=a.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":a=a.substr(0,2),b&&(c._w=c._w||{},c._w[a]=b)}}function K(a){var b,c,d,e,f,g,h,i,j,k,l=[];if(!a._d){for(d=M(a),a._w&&null==a._a[ja]&&null==a._a[ia]&&(f=function(b){return b?b.length<3?parseInt(b,10)>68?"19"+b:"20"+b:b:null==a._a[ha]?da().weekYear():a._a[ha]},g=a._w,null!=g.GG||null!=g.W||null!=g.E?h=Z(f(g.GG),g.W||1,g.E,4,1):(i=C(a._l),j=null!=g.d?V(g.d,i):null!=g.e?parseInt(g.e,10)+i._week.dow:0,k=parseInt(g.w,10)||1,null!=g.d&&j<i._week.dow&&k++,h=Z(f(g.gg),k,j,i._week.doy,i._week.dow)),a._a[ha]=h.year,a._dayOfYear=h.dayOfYear),a._dayOfYear&&(e=null==a._a[ha]?d[ha]:a._a[ha],a._dayOfYear>u(e)&&(a._pf._overflowDayOfYear=!0),c=U(e,0,a._dayOfYear),a._a[ia]=c.getUTCMonth(),a._a[ja]=c.getUTCDate()),b=0;b<3&&null==a._a[b];++b)a._a[b]=l[b]=d[b];for(;b<7;b++)a._a[b]=l[b]=null==a._a[b]?2===b?1:0:a._a[b];l[ka]+=s((a._tzm||0)/60),l[la]+=s((a._tzm||0)%60),a._d=(a._useUTC?U:T).apply(null,l)}}function L(a){var b;a._d||(b=q(a._i),a._a=[b.year,b.month,b.day,b.hour,b.minute,b.second,b.millisecond],K(a))}function M(a){var b=new Date;return a._useUTC?[b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()]:[b.getFullYear(),b.getMonth(),b.getDate()]}function N(a){a._a=[],a._pf.empty=!0;var b,c,d,e,f,g=C(a._l),h=""+a._i,i=h.length,j=0;for(d=G(a._f,g).match(ta)||[],b=0;b<d.length;b++)e=d[b],c=(H(e,a).exec(h)||[])[0],c&&(f=h.substr(0,h.indexOf(c)),f.length>0&&a._pf.unusedInput.push(f),h=h.slice(h.indexOf(c)+c.length),j+=c.length),Ra[e]?(c?a._pf.empty=!1:a._pf.unusedTokens.push(e),J(e,c,a)):a._strict&&!c&&a._pf.unusedTokens.push(e);a._pf.charsLeftOver=i-j,h.length>0&&a._pf.unusedInput.push(h),a._isPm&&a._a[ka]<12&&(a._a[ka]+=12),a._isPm===!1&&12===a._a[ka]&&(a._a[ka]=0),K(a),w(a)}function O(a){return a.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e})}function P(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Q(a){var b,c,d,e,f;if(0===a._f.length)return a._pf.invalidFormat=!0,void(a._d=new Date(NaN));for(e=0;e<a._f.length;e++)f=0,b=i({},a),x(b),b._f=a._f[e],N(b),y(b)&&(f+=b._pf.charsLeftOver,f+=10*b._pf.unusedTokens.length,b._pf.score=f,(null==d||f<d)&&(d=f,c=b));i(a,c||b)}function R(a){var b,c=a._i,d=Fa.exec(c);if(d){for(a._pf.iso=!0,b=4;b>0;b--)if(d[b]){a._f=Ha[b-1]+(d[6]||" ");break}for(b=0;b<4;b++)if(Ia[b][1].exec(c)){a._f+=Ia[b][0];break}Ca.exec(c)&&(a._f+="Z"),N(a)}else a._d=new Date(c)}function S(b){var c=b._i,d=qa.exec(c);c===a?b._d=new Date:d?b._d=new Date(+d[1]):"string"==typeof c?R(b):m(c)?(b._a=c.slice(0),K(b)):n(c)?b._d=new Date(+c):"object"==typeof c?L(b):b._d=new Date(c)}function T(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return a<1970&&h.setFullYear(a),h}function U(a){var b=new Date(Date.UTC.apply(null,arguments));return a<1970&&b.setUTCFullYear(a),b}function V(a,b){if("string"==typeof a)if(isNaN(a)){if(a=b.weekdaysParse(a),"number"!=typeof a)return null}else a=parseInt(a,10);return a}function W(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function X(a,b,c){var d=ga(Math.abs(a)/1e3),e=ga(d/60),f=ga(e/60),g=ga(f/24),h=ga(g/365),i=d<45&&["s",d]||1===e&&["m"]||e<45&&["mm",e]||1===f&&["h"]||f<22&&["hh",f]||1===g&&["d"]||g<=25&&["dd",g]||g<=45&&["M"]||g<345&&["MM",ga(g/30)]||1===h&&["y"]||["yy",h];return i[2]=b,i[3]=a>0,i[4]=c,W.apply({},i)}function Y(a,b,c){var d,e=c-b,f=c-a.day();return f>e&&(f-=7),f<e-7&&(f+=7),d=da(a).add("d",f),{week:Math.ceil(d.dayOfYear()/7),year:d.year()}}function Z(a,b,c,d,e){var f,g,h=new Date(Date.UTC(a,0)).getUTCDay();return c=null!=c?c:e,f=e-h+(h>d?7:0),g=7*(b-1)+(c-e)+f+1,{year:g>0?a:a-1,dayOfYear:g>0?g:u(a-1)+g}}function $(a){var b=a._i,c=a._f;return"undefined"==typeof a._pf&&x(a),null===b?da.invalid({nullInput:!0}):("string"==typeof b&&(a._i=b=C().preparse(b)),da.isMoment(b)?(a=i({},b),a._d=new Date(+b._d)):c?m(c)?Q(a):N(a):S(a),new g(a))}function _(a,b){da.fn[a]=da.fn[a+"s"]=function(a){var c=this._isUTC?"UTC":"";return null!=a?(this._d["set"+c+b](a),da.updateOffset(this),this):this._d["get"+c+b]()}}function aa(a){da.duration.fn[a]=function(){return this._data[a]}}function ba(a,b){da.duration.fn["as"+a]=function(){return+this/b}}function ca(a){var b=!1,c=da;"undefined"==typeof ender&&(a?this.moment=function(){return!b&&console&&console.warn&&void(b=!0),c.apply(null,arguments)}:this.moment=da)}for(var da,ea,fa="2.4.0",ga=Math.round,ha=0,ia=1,ja=2,ka=3,la=4,ma=5,na=6,oa={},pa="undefined"!=typeof module&&module.exports,qa=/^\/?Date\((\-?\d+)/i,ra=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,sa=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,ta=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,ua=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,va=/\d\d?/,wa=/\d{1,3}/,xa=/\d{3}/,ya=/\d{1,4}/,za=/[+\-]?\d{1,6}/,Aa=/\d+/,Ba=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Ca=/Z|[\+\-]\d\d:?\d\d/i,Da=/T/i,Ea=/[\+\-]?\d+(\.\d{1,3})?/,Fa=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d:?\d\d|Z)?)?$/,Ga="YYYY-MM-DDTHH:mm:ssZ",Ha=["YYYY-MM-DD","GGGG-[W]WW","GGGG-[W]WW-E","YYYY-DDD"],Ia=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Ja=/([\+\-]|\d\d)/gi,Ka="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),La={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},Ma={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},Na={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},Oa={},Pa="DDD w W M D d".split(" "),Qa="M D H h m s w W".split(" "),Ra={M:function(){return this.month()+1},MMM:function(a){return this.lang().monthsShort(this,a)},MMMM:function(a){return this.lang().months(this,a)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(a){return this.lang().weekdaysMin(this,a)},ddd:function(a){return this.lang().weekdaysShort(this,a)},dddd:function(a){return this.lang().weekdays(this,a)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return k(this.year()%100,2)},YYYY:function(){return k(this.year(),4)},YYYYY:function(){return k(this.year(),5)},gg:function(){return k(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return k(this.weekYear(),5)},GG:function(){return k(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return k(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return s(this.milliseconds()/100)},SS:function(){return k(s(this.milliseconds()/10),2)},SSS:function(){return k(this.milliseconds(),3)},SSSS:function(){return k(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return a<0&&(a=-a,b="-"),b+k(s(a/60),2)+":"+k(s(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";return a<0&&(a=-a,b="-"),b+k(s(10*a/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}},Sa=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];Pa.length;)ea=Pa.pop(),Ra[ea+"o"]=e(Ra[ea],ea);for(;Qa.length;)ea=Qa.pop(),Ra[ea+ea]=d(Ra[ea],2);for(Ra.DDDD=d(Ra.DDD,3),i(f.prototype,{set:function(a){var b,c;for(c in a)b=a[c],"function"==typeof b?this[c]=b:this["_"+c]=b},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(a){return this._months[a.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(a){return this._monthsShort[a.month()]},monthsParse:function(a){var b,c,d;for(this._monthsParse||(this._monthsParse=[]),b=0;b<12;b++)if(this._monthsParse[b]||(c=da.utc([2e3,b]),d="^"+this.months(c,"")+"|^"+this.monthsShort(c,""),this._monthsParse[b]=new RegExp(d.replace(".",""),"i")),this._monthsParse[b].test(a))return b},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(a){return this._weekdays[a.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(a){return this._weekdaysShort[a.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(a){return this._weekdaysMin[a.day()]},weekdaysParse:function(a){var b,c,d;for(this._weekdaysParse||(this._weekdaysParse=[]),b=0;b<7;b++)if(this._weekdaysParse[b]||(c=da([2e3,1]).day(b),d="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=new RegExp(d.replace(".",""),"i")),this._weekdaysParse[b].test(a))return b},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(a){var b=this._longDateFormat[a];return!b&&this._longDateFormat[a.toUpperCase()]&&(b=this._longDateFormat[a.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a]=b),b},isPM:function(a){return"p"===(a+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(a,b){var c=this._calendar[a];return"function"==typeof c?c.apply(b):c},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(a,b,c,d){var e=this._relativeTime[c];return"function"==typeof e?e(a,b,c,d):e.replace(/%d/i,a)},pastFuture:function(a,b){var c=this._relativeTime[a>0?"future":"past"];return"function"==typeof c?c(b):c.replace(/%s/i,b)},ordinal:function(a){return this._ordinal.replace("%d",a)},_ordinal:"%d",preparse:function(a){return a},postformat:function(a){return a},week:function(a){return Y(a,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),da=function(b,c,d,e){return"boolean"==typeof d&&(e=d,d=a),$({_i:b,_f:c,_l:d,_strict:e,_isUTC:!1})},da.utc=function(b,c,d,e){var f;return"boolean"==typeof d&&(e=d,d=a),f=$({_useUTC:!0,_isUTC:!0,_l:d,_i:b,_f:c,_strict:e}).utc()},da.unix=function(a){return da(1e3*a)},da.duration=function(a,b){var c,d,e,f=da.isDuration(a),g="number"==typeof a,i=f?a._input:g?{}:a,j=null;return g?b?i[b]=a:i.milliseconds=a:(j=ra.exec(a))?(c="-"===j[1]?-1:1,i={y:0,d:s(j[ja])*c,h:s(j[ka])*c,m:s(j[la])*c,s:s(j[ma])*c,ms:s(j[na])*c}):!(j=sa.exec(a))||(c="-"===j[1]?-1:1,e=function(a){var b=a&&parseFloat(a.replace(",","."));return(isNaN(b)?0:b)*c},i={y:e(j[2]),M:e(j[3]),d:e(j[4]),h:e(j[5]),m:e(j[6]),s:e(j[7]),w:e(j[8])}),d=new h(i),f&&a.hasOwnProperty("_lang")&&(d._lang=a._lang),d},da.version=fa,da.defaultFormat=Ga,da.updateOffset=function(){},da.lang=function(a,b){var c;return a?(b?A(z(a),b):null===b?(B(a),a="en"):oa[a]||C(a),c=da.duration.fn._lang=da.fn._lang=C(a),c._abbr):da.fn._lang._abbr},da.langData=function(a){return a&&a._lang&&a._lang._abbr&&(a=a._lang._abbr),C(a)},da.isMoment=function(a){return a instanceof g},da.isDuration=function(a){return a instanceof h},ea=Sa.length-1;ea>=0;--ea)r(Sa[ea]);for(da.normalizeUnits=function(a){return p(a)},da.invalid=function(a){var b=da.utc(NaN);return null!=a?i(b._pf,a):b._pf.userInvalidated=!0,b},da.parseZone=function(a){return da(a).parseZone()},i(da.fn=g.prototype,{clone:function(){return da(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return F(da(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var a=this;return[a.year(),a.month(),a.date(),a.hours(),a.minutes(),a.seconds(),a.milliseconds()]},isValid:function(){return y(this)},isDSTShifted:function(){return!!this._a&&(this.isValid()&&o(this._a,(this._isUTC?da.utc(this._a):da(this._a)).toArray())>0)},parsingFlags:function(){return i({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(a){var b=F(this,a||da.defaultFormat);return this.lang().postformat(b)},add:function(a,b){var c;return c="string"==typeof a?da.duration(+b,a):da.duration(a,b),l(this,c,1),this},subtract:function(a,b){var c;return c="string"==typeof a?da.duration(+b,a):da.duration(a,b),l(this,c,-1),this},diff:function(a,b,c){var d,e,f=this._isUTC?da(a).zone(this._offset||0):da(a).local(),g=6e4*(this.zone()-f.zone());return b=p(b),"year"===b||"month"===b?(d=432e5*(this.daysInMonth()+f.daysInMonth()),e=12*(this.year()-f.year())+(this.month()-f.month()),e+=(this-da(this).startOf("month")-(f-da(f).startOf("month")))/d,e-=6e4*(this.zone()-da(this).startOf("month").zone()-(f.zone()-da(f).startOf("month").zone()))/d,"year"===b&&(e/=12)):(d=this-f,e="second"===b?d/1e3:"minute"===b?d/6e4:"hour"===b?d/36e5:"day"===b?(d-g)/864e5:"week"===b?(d-g)/6048e5:d),c?e:j(e)},from:function(a,b){return da.duration(this.diff(a)).lang(this.lang()._abbr).humanize(!b)},fromNow:function(a){return this.from(da(),a)},calendar:function(){var a=this.diff(da().zone(this.zone()).startOf("day"),"days",!0),b=a<-6?"sameElse":a<-1?"lastWeek":a<0?"lastDay":a<1?"sameDay":a<2?"nextDay":a<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(b,this))},isLeapYear:function(){return v(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=V(a,this.lang()),this.add({d:a-b})):b},month:function(a){var b,c=this._isUTC?"UTC":"";return null!=a?"string"==typeof a&&(a=this.lang().monthsParse(a),"number"!=typeof a)?this:(b=this.date(),this.date(1),this._d["set"+c+"Month"](a),this.date(Math.min(b,this.daysInMonth())),da.updateOffset(this),this):this._d["get"+c+"Month"]()},startOf:function(a){switch(a=p(a)){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a?this.weekday(0):"isoWeek"===a&&this.isoWeekday(1),this},endOf:function(a){return a=p(a),this.startOf(a).add("isoWeek"===a?"week":a,1).subtract("ms",1)},isAfter:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)>+da(a).startOf(b)},isBefore:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)<+da(a).startOf(b)},isSame:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)===+da(a).startOf(b)},min:function(a){return a=da.apply(null,arguments),a<this?this:a},max:function(a){return a=da.apply(null,arguments),a>this?this:a},zone:function(a){var b=this._offset||0;return null==a?this._isUTC?b:this._d.getTimezoneOffset():("string"==typeof a&&(a=I(a)),Math.abs(a)<16&&(a*=60),this._offset=a,this._isUTC=!0,b!==a&&l(this,da.duration(b-a,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(a){return a=a?da(a).zone():0,(this.zone()-a)%60===0},daysInMonth:function(){return t(this.year(),this.month())},dayOfYear:function(a){var b=ga((da(this).startOf("day")-da(this).startOf("year"))/864e5)+1;return null==a?b:this.add("d",a-b)},weekYear:function(a){var b=Y(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==a?b:this.add("y",a-b)},isoWeekYear:function(a){var b=Y(this,1,4).year;return null==a?b:this.add("y",a-b)},week:function(a){var b=this.lang().week(this);return null==a?b:this.add("d",7*(a-b))},isoWeek:function(a){var b=Y(this,1,4).week;return null==a?b:this.add("d",7*(a-b))},weekday:function(a){var b=(this.day()+7-this.lang()._week.dow)%7;return null==a?b:this.add("d",a-b)},isoWeekday:function(a){return null==a?this.day()||7:this.day(this.day()%7?a:a-7)},get:function(a){return a=p(a),this[a]()},set:function(a,b){return a=p(a),"function"==typeof this[a]&&this[a](b),this},lang:function(b){return b===a?this._lang:(this._lang=C(b),this)}}),ea=0;ea<Ka.length;ea++)_(Ka[ea].toLowerCase().replace(/s$/,""),Ka[ea]);_("year","FullYear"),da.fn.days=da.fn.day,da.fn.months=da.fn.month,da.fn.weeks=da.fn.week,da.fn.isoWeeks=da.fn.isoWeek,da.fn.toJSON=da.fn.toISOString,i(da.duration.fn=h.prototype,{_bubble:function(){var a,b,c,d,e=this._milliseconds,f=this._days,g=this._months,h=this._data;h.milliseconds=e%1e3,a=j(e/1e3),h.seconds=a%60,b=j(a/60),h.minutes=b%60,c=j(b/60),h.hours=c%24,f+=j(c/24),h.days=f%30,g+=j(f/30),h.months=g%12,d=j(g/12),h.years=d},weeks:function(){return j(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*s(this._months/12)},humanize:function(a){var b=+this,c=X(b,!a,this.lang());return a&&(c=this.lang().pastFuture(b,c)),this.lang().postformat(c)},add:function(a,b){var c=da.duration(a,b);return this._milliseconds+=c._milliseconds,this._days+=c._days,this._months+=c._months,this._bubble(),this},subtract:function(a,b){var c=da.duration(a,b);return this._milliseconds-=c._milliseconds,this._days-=c._days,this._months-=c._months,this._bubble(),this},get:function(a){return a=p(a),this[a.toLowerCase()+"s"]()},as:function(a){return a=p(a),this["as"+a.charAt(0).toUpperCase()+a.slice(1)+"s"]()},lang:da.fn.lang,toIsoString:function(){var a=Math.abs(this.years()),b=Math.abs(this.months()),c=Math.abs(this.days()),d=Math.abs(this.hours()),e=Math.abs(this.minutes()),f=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(a?a+"Y":"")+(b?b+"M":"")+(c?c+"D":"")+(d||e||f?"T":"")+(d?d+"H":"")+(e?e+"M":"")+(f?f+"S":""):"P0D"}});for(ea in La)La.hasOwnProperty(ea)&&(ba(ea,La[ea]),aa(ea.toLowerCase()));ba("Weeks",6048e5),da.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},da.lang("en",{ordinal:function(a){var b=a%10,c=1===s(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}}),pa?(module.exports=da,ca(!0)):"function"==typeof c&&c.amd?c("moment",["require","exports","module"],function(b,c,d){return d.config().noGlobal!==!0&&ca(d.config().noGlobal===a),da}):ca()}.call(this),c("core/services/url_parser",["moment"],function(a){"use strict";var b={identificationPattern:{BOOK:new RegExp("book\\/(rt|ow|mc)\\/([acip][0-9]){1,4}\\/?([a-z]{3}_[a-z]{3}\\/?)*\\/?(\\d{8}_\\d{8}|\\d{8}\\/?)*","gi"),CHANGE:new RegExp("change\\/trip\\/(rt|ow|mc)\\/([acip][0-9]){1,4}\\/?([a-z]{3}_[a-z]{3}\\/?)*\\/?(\\d{8}_\\d{8}|\\d{8}\\/?)*","gi")},reverseParse:!0,_baseUrl:{BOOK:"/book",CHANGE:"/change/trip"},_availableContexts:{BOOK:"BOOK",CHANGE:"CHANGE"},_context:null,_tripTypePattern:{BOOK:/book\/(rt|ow|mc)/i,CHANGE:/change\/trip\/(rt|ow|mc)/i},_travelersPattern:/((([acip])([0-9]))+(?=\/|&|$))/gi,_cityPairsPattern:/\/([a-z]{3})_([a-z]{3})/gi,_datesPattern:/(\d{8})/gi,_bookingTypePattern:/#points$/i,_promoCodePattern:/\?promoCode=([^&]*)/,_isValid:!0,_tripTypeMapping:{ow:"ONE_WAY",rt:"ROUND_TRIP",mc:"MULTI_CITY"},_reverseTripMapping:{ONE_WAY:"ow",ROUND_TRIP:"rt",MULTI_CITY:"mc"},parseIntoModel:function(a,b,c){this.resourceBundle=b,this.envService=c;var d={meta:{url:a,tripType:"",cityPairs:[],dates:[],travelers:[],promoCode:"",isPoints:!1},parsed:{bookingType:"DOLLAR",cityPairs:[],dates:[],promoCode:"",tripType:"",travelers:{adults:1,children:0,infants:0,pets:0}}},e=this._parseTripType(a,d);return this._parseCityPairs(a,d,e),this._parseDates(a,d),this._parseTravelersInfo(a,d),this._parseBookingType(a,d),this._parsePromoCode(a,d),this._isValid?d:null},_parseTripType:function(a,b){var c=this._tripTypePattern[this._context],d=a.match(c),e=d[1];return b.meta.tripType=e,b.parsed.tripType=this._tripTypeMapping[e],e},_parseCityPairs:function(a,b,c){for(var d;d=this._cityPairsPattern.exec(a);){var e=d[1],f=d[2];b.meta.cityPairs.push({pair:d[0],from:e,to:f}),b.parsed.cityPairs.push({dep:e.toUpperCase(),des:f.toUpperCase()}),"rt"===c.toLowerCase()&&b.parsed.cityPairs.push({dep:f.toUpperCase(),des:e.toUpperCase()})}},_parseDates:function(b,c){for(var d;d=this._datesPattern.exec(b.split("?")[0]);){var e=d[1];c.meta.dates.push(e);var f=e.match(/^(\d{4})(\d{2})(\d{2}$)/),g=f[1]+"-"+f[2]+"-"+f[3];a(g).isValid()&&c.parsed.dates.push(g)}},_parseTravelersInfo:function(a,b){var c=this._travelersPattern.exec(a);if(c){this._travelersPattern.lastIndex=0;for(var d,e=/([acip])([0-9])/gi;d=e.exec(c[0]);){b.meta.travelers.push(d[0]);var f=d[1].toLowerCase();switch(f){case"a":b.parsed.travelers.adults=parseInt(d[2],10);break;case"c":b.parsed.travelers.children=parseInt(d[2],10);break;case"i":b.parsed.travelers.infants=parseInt(d[2],10);break;case"p":b.parsed.travelers.pets=parseInt(d[2],10)}this._isValid=this._isValid&&b.parsed.travelers.adults+b.parsed.travelers.children<=this.resourceBundle.urlParser.maximumNumberOfPeople,this._isValid=this._isValid&&b.parsed.travelers.infants<=b.parsed.travelers.adults,this._isValid=this._isValid&&!b.parsed.travelers.pets}}},_parsePromoCode:function(a,b){var c=a.match(this._promoCodePattern);c&&(b.meta.promoCode=c[1],b.parsed.promoCode=c[1])},_parseBookingType:function(a,b){var c=a.match(this._bookingTypePattern);c&&(b.parsed.bookingType="POINTS",b.meta.isPoints=!0)},parseIntoUrl:function(a){var b=this._baseUrl[this._context];return"undefined"==typeof a.cityPairs[0].des?b:(a.tripType&&(b+="/"+this._reverseParseTripType(a),a.travelers&&(b+="/"+this._reverseParseTravelersInfo(a),a.cityPairs&&(b+=this._reverseParseCityPairsAndDates(a),a.promoCode&&(b+="?"+this._reverseParsePromoCode(a)),"POINTS"===a.bookingType&&(b+="#points")))),b)},_reverseParseTripType:function(a){return this._reverseTripMapping[a.tripType]},_reverseParseTravelersInfo:function(a){var b="";return a.travelers.adults>0&&(b+="a"+a.travelers.adults),a.travelers.children>0&&(b+="c"+a.travelers.children),a.travelers.infants>0&&(b+="i"+a.travelers.infants),""===b&&(b="a1"),b},_reverseParseCityPairsAndDates:function(a){var b,c="";b="ROUND_TRIP"===a.tripType?1:a.cityPairs.length;for(var d=0;d<b;d++){var e=a.cityPairs[d];e&&e.dep&&e.des&&(c+="/"+e.dep.toLowerCase()+"_"+e.des.toLowerCase())}for(d=0;d<b;d++)a.dates[d]&&(c+="/"+a.dates[d].replace(/\-/g,""),"ROUND_TRIP"===a.tripType&&(c+="_"+a.dates[d+1].replace(/\-/g,"")));return c},_reverseParsePromoCode:function(a){return"promoCode="+a.promoCode}},c={identificationPattern:{BOOK:new RegExp(/referral.php\?/),CHANGE:new RegExp(/referral.php\?/)},_availableContexts:{BOOK:"BOOK",CHANGE:"CHANGE"},_context:null,reverseParse:!1,_queryStringPattern:new RegExp(/(&|\?)([^&]*)=([^&]*)/g),_paramMapping:{"flightSearch.tripType":function(a,b){b.meta.tripType=a,b.parsed.tripType=this._tripTypeMapping[a]},"flightSearch.origin":function(a,b){b.meta.origin=a,b.parsed.cityPairs[0]=b.parsed.cityPairs[0]?b.parsed.cityPairs[0]:{},b.parsed.cityPairs[0].dep=a.toUpperCase()},"flightSearch.destination":function(a,b){b.meta.destination=a,b.parsed.cityPairs[0]=b.parsed.cityPairs[0]?b.parsed.cityPairs[0]:{},b.parsed.cityPairs[0].des=a.toUpperCase()},"flightSearch.originMC":function(a,b){b.meta.originMC=a,b.parsed.cityPairs[1]=b.parsed.cityPairs[1]?b.parsed.cityPairs[1]:{},b.parsed.cityPairs[1].dep=a.toUpperCase()},"flightSearch.destinationMC":function(a,b){b.meta.destinationMC=a,b.parsed.cityPairs[1]=b.parsed.cityPairs[1]?b.parsed.cityPairs[1]:{},b.parsed.cityPairs[1].des=a.toUpperCase()},"flightSearch.depDateOW.MMDDYYYY":function(a,b){b.meta.dates.push(a),b.parsed.dates.push(this._formatDate(a))},"flightSearch.adults":function(a,b){b.meta.adults=a,b.parsed.travelers.adults=parseInt(a,10)},"flightSearch.kids":function(a,b){b.meta.kids=a,b.parsed.travelers.children=parseInt(a,10)},"flightSearch.infants":function(a,b){b.meta.infants=a,b.parsed.travelers.infants=parseInt(a,10)},"flightSearch.depDate.MMDDYYYY":function(a,b){b.meta.dates.push(a),b.parsed.dates.push(this._formatDate(a))},"flightSearch.returnDate.MMDDYYYY":function(a,b){b.meta.dates.push(a),b.parsed.dates.push(this._formatDate(a))},"flightSearch.depDateMC.MMDDYYYY":function(a,b){b.meta.dates.push(a),b.parsed.dates.push(this._formatDate(a))},"flightSearch.returnDateMC.MMDDYYYY":function(a,b){b.meta.dates.push(a),b.parsed.dates.push(this._formatDate(a))},"flightSearch.searchPromoCode":function(a,b){this._queryString.cid||(b.meta.promoCode=a,b.parsed.promoCode=a)},cid:function(a,b){b.meta.cid=a,b.parsed.promoCode=this.envService.legacyUrlMapping().channelMapping[a]}},_formatDate:function(b){var c=null,d=b.match(/(\d{2})%2F(\d{2})%2F(\d{4})/),e=d[3]+"-"+d[1]+"-"+d[2];return c=a(e).isValid()?e:null},_tripTypeMapping:{ow:"ONE_WAY",rt:"ROUND_TRIP",mc:"MULTI_CITY"},parseIntoModel:function(a,b,c){this.envService=c;var d,e={meta:{url:a,tripType:"",origin:"",destination:"",originMC:"",destinationMC:"",dates:[],adults:0,kids:0,infants:0,promoCode:""},parsed:{bookingType:"DOLLAR",cityPairs:[],dates:[],promoCode:"",tripType:"",travelers:{adults:1,children:0,infants:0,pets:0}}},f={};for(this._queryString={};d=this._queryStringPattern.exec(a);){var g=d[2],h=d[3];this._queryString[g]=h}for(var i in this._queryString)this._paramMapping[i]&&(f[i]||(this._paramMapping[i].call(this,this._queryString[i],e),f[i]=!0));return"ROUND_TRIP"===e.parsed.tripType&&e.parsed.cityPairs.push({dep:e.parsed.cityPairs[0].des,des:e.parsed.cityPairs[0].dep}),e}},d={identificationPattern:{BOOK:new RegExp(/book/gi),CHANGE:new RegExp(/change\/trip/gi)},_availableContexts:{BOOK:"BOOK",CHANGE:"CHANGE"},_context:null,reverseParse:!1,_queryStringPattern:new RegExp(/(&|\?)([^&]*)=([^&]*)/g),_paramMapping:{origin:function(a,b){b.meta.origin=a,b.parsed.cityPairs[0]=b.parsed.cityPairs[0]?b.parsed.cityPairs[0]:{},b.parsed.cityPairs[0].dep=a.toUpperCase()},destination:function(a,b){b.meta.destination=a,b.parsed.cityPairs[0]=b.parsed.cityPairs[0]?b.parsed.cityPairs[0]:{},b.parsed.cityPairs[0].des=a.toUpperCase()}},parseIntoModel:function(a,b,c){this.envService=c;var d={meta:{url:a,tripType:"",origin:"",destination:"",originMC:"",destinationMC:"",dates:[],adults:0,kids:0,infants:0,promoCode:""},parsed:{destinationState:"BOOK_INTRO_STATE",bookingType:"DOLLAR",cityPairs:[],dates:[],promoCode:"",tripType:"ROUND_TRIP",travelers:{adults:1,children:0,infants:0,pets:0}}};this._queryString={};for(var e;e=this._queryStringPattern.exec(a);)this._queryString[e[2]]=e[3];for(var f in this._queryString)this._paramMapping[f]&&this._paramMapping[f].call(this,this._queryString[f],d);var g=d.parsed.cityPairs[0];if(g&&g.des&&g.dep)return d.parsed.cityPairs.push({dep:g.des,des:g.dep}),d}},e=function(a,e){return this._resourceBundle=a,this._envService=e,b._context=b._availableContexts.BOOK,c._context=c._availableContexts.BOOK,d._context=d._availableContexts.BOOK,this._parsers=[b,c,d],{getModel:this.getModel.bind(this),getUrl:this.getUrl.bind(this),setContext:this.setContext.bind(this)}};return e.prototype.setContext=function(a){b._context=a,c._context=a,d._context=a},e.prototype.getModel=function(a){
for(var b=null,c=0;c<this._parsers.length;c++){var d=this._parsers[c];if(d.identificationPattern[d._context].lastIndex=0,d.identificationPattern[d._context].test(a)){b=d.parseIntoModel(a,this._resourceBundle,this._envService);break}}return b},e.prototype.getUrl=function(a){for(var b="",c=0;c<this._parsers.length;c++){var d=this._parsers[c];if(d.reverseParse){b=d.parseIntoUrl(a);break}}return b},e.$inject=["ResourceBundle","envService"],e}),c("core/services/workflow",["angular"],function(a){"use strict";var b=function(a,b,c,d,e,f,g,h,i,j,k,l,m){return this.tripService=a,this.fareService=b,this.seatService=c,this.ancillariesService=d,this.purchaseService=e,this.scrollService=f,this.windowService=g,this.locationService=h,this.statusService=i,this.bookingTimerService=j,this.pubSubService=k,this.travelerService=m,this.workflowService=this,this.adobeAnalyticsService=l,this.state={BOOK_INTRO:"BOOK_INTRO_STATE",DATE_PICKER:"DATE_PICKER_STATE",FARE_SELECTOR:"FARE_SELECTOR_STATE",TRAVELER_INFO:"TRAVELER_INFO_STATE",SEAT_SELECTOR:"SEAT_SELECTOR_STATE",ANCILLARIES_SELECTOR:"ANCILLARIES_SELECTOR_STATE",PURCHASE:"PURCHASE_STATE",SUCCESS:"SUCCESS_STATE"},this._transitionStates=[this.state.BOOK_INTRO,this.state.DATE_PICKER,this.state.FARE_SELECTOR,this.state.TRAVELER_INFO,this.state.ANCILLARIES_SELECTOR,this.state.SEAT_SELECTOR,this.state.PURCHASE,this.state.SUCCESS],this._transitionTypes=["REGRESSIVE","PROGRESSIVE"],this._stateTransitionsMap={BOOK_INTRO_STATE:{pageTitle:"Choose Guests and Cities",defaultTransition:"DATE_PICKER_STATE",allowedTransitions:{BOOK_INTRO_STATE:{type:"REGRESSIVE",handlers:[{service:"tripService",method:"setVisibleSection",params:{section:"AIRPORT_PICKER",isVisible:!0}},{service:"scrollService",method:"scroll",params:{target:"BOOK_INTRO_STATE",delay:0}}]},DATE_PICKER_STATE:{type:"PROGRESSIVE",handlers:[{service:"pubSubService",method:"publish",params:"collapseTripBooker"},{service:"tripService",method:"setVisibleSection",params:{section:"CALENDAR",isVisible:!0}},{service:"tripService",method:"setBookingFlow",params:!0},{service:"scrollService",method:"scroll",params:{target:"DATE_PICKER_STATE"},isPromise:!0,handlerCallbacks:[{service:"pubSubService",method:"publish",params:"collapseTripBooker"}]},{service:"adobeAnalyticsService",method:"fireEventObject",params:{type:this.adobeAnalyticsService.events.originDestinationSelected,dataFunc:this.tripService.getSelectedTripPublicModel.bind(this)}}]},FARE_SELECTOR_STATE:{type:"PROGRESSIVE",handlers:[{service:"fareService",method:"loadFares",isPromise:!0,handlerCallbacks:[{service:"tripService",method:"setVisibleSection",params:{section:"CALENDAR",isVisible:!0}},{service:"tripService",method:"setVisibleSection",params:{section:"PEOPLE_PICKER",isVisible:!0}},{service:"tripService",method:"setVisibleSection",params:{section:"SEAT_SELECTOR",isVisible:!1}},{service:"fareService",method:"setInventoryLocked",params:!1},{service:"tripService",method:"setBookingFlow",params:!0},{service:"bookingTimerService",method:"stopTimer"},{service:"seatService",method:"resetService"},{service:"scrollService",method:"setOffsetType",params:"yts"},{service:"scrollService",method:"scroll",params:{target:"FARE_SELECTOR_STATE",delay:0},isPromise:!0,handlerCallbacks:[{service:"pubSubService",method:"publish",params:"collapseTripBooker"},{service:"pubSubService",method:"publish",params:"collapseCalendar"}]},{service:"windowService",method:"setFooterHidden",params:!0},{service:"adobeAnalyticsService",method:"fireEventObject",params:{type:this.adobeAnalyticsService.events.flightSearch,dataFunc:this.tripService.getSelectedTripPublicModel.bind(this)}}],errorCallbacks:[{service:"statusService",method:"setStatus",params:{format:this.statusService.format.ERROR,copy:this.statusService.message.OOPS}}]}]}}},DATE_PICKER_STATE:{pageTitle:"Choose Dates",defaultTransition:"FARE_SELECTOR_STATE",allowedTransitions:{BOOK_INTRO_STATE:{type:"REGRESSIVE",handlers:[{service:"tripService",method:"clearDates"},{service:"tripService",method:"setVisibleSection",params:{section:"BOOK_INTRO_STATE",isVisible:!0}},{service:"scrollService",method:"scroll",params:{target:"BOOK_INTRO_STATE",delay:0}},{service:"tripService",method:"setVisibleSection",params:{section:"CALENDAR",isVisible:!1}},{service:"tripService",method:"setVisibleSection",params:{section:"PEOPLE_PICKER",isVisible:!1}},{service:"windowService",method:"setYtsVisible",params:!1},{service:"windowService",method:"setYtsExpanded",params:!1}]},FARE_SELECTOR_STATE:{type:"PROGRESSIVE",handlers:[{service:"fareService",method:"loadFares",isPromise:!0,handlerCallbacks:[{service:"tripService",method:"setVisibleSection",params:{section:"CALENDAR",isVisible:!0}},{service:"tripService",method:"setVisibleSection",params:{section:"PEOPLE_PICKER",isVisible:!0}},{service:"scrollService",method:"scroll",params:{target:"FARE_SELECTOR_STATE",delay:0},isPromise:!0,handlerCallbacks:[{service:"pubSubService",method:"publish",params:"collapseCalendar"}]},{service:"windowService",method:"setFooterHidden",params:!0},{service:"adobeAnalyticsService",method:"fireEventObject",params:{type:this.adobeAnalyticsService.events.flightSearch,dataFunc:this.tripService.getSelectedTripPublicModel.bind(this)}}],errorCallbacks:[{service:"statusService",method:"setStatus",params:{format:this.statusService.format.ERROR,copy:this.statusService.message.OOPS}}]}]}}},FARE_SELECTOR_STATE:{pageTitle:"Choose Fare",defaultTransition:"TRAVELER_INFO_STATE",allowedTransitions:{BOOK_INTRO_STATE:{type:"REGRESSIVE",handlers:[{service:"tripService",method:"clearDates"},{service:"fareService",method:"resetService"},{service:"purchaseService",method:"reset"},{service:"statusService",method:"setAlert",params:[[]]},{service:"tripService",method:"setVisibleSection",params:{section:"BOOK_INTRO_STATE",isVisible:!0}},{service:"scrollService",method:"scroll",params:{target:"BOOK_INTRO_STATE",delay:0}},{service:"tripService",method:"setVisibleSection",params:{section:"CALENDAR",isVisible:!1}},{service:"tripService",method:"setVisibleSection",params:{section:"PEOPLE_PICKER",isVisible:!1}},{service:"windowService",method:"setYtsVisible",params:!1},{service:"windowService",method:"setYtsExpanded",params:!1},{service:"windowService",method:"setFooterHidden",params:!1}]},DATE_PICKER_STATE:{type:"REGRESSIVE",handlers:[{service:"tripService",method:"clearDates"},{service:"fareService",method:"resetService"},{service:"purchaseService",method:"reset"},{service:"statusService",method:"setAlert",params:[[]]},{service:"tripService",method:"validateCityPairs"},{service:"tripService",method:"setVisibleSection",params:{section:"CALENDAR",isVisible:!0}},{service:"scrollService",method:"scroll",params:{target:"DATE_PICKER_STATE",delay:0}},{service:"windowService",method:"setFooterHidden",params:!1}]},TRAVELER_INFO_STATE:{type:"PROGRESSIVE",handlers:[{service:"travelerService",method:"getTravelerFormsComplete",isConditional:!0,errorCallbacks:[{service:"seatService",method:"onScrollComplete"},{service:"pubSubService",method:"publish",params:"collapseSecondFareSelector"},{service:"pubSubService",method:"publish",params:["ancillariesSelector.setVisibility",[!1]]},{service:"scrollService",method:"scroll",isPromise:!0,params:{target:"TRAVELER_INFO_STATE"}},{service:"tripService",method:"setVisibleSection",params:{section:"TRAVELER_INFO",isVisible:!0}},{service:"pubSubService",method:"publish",params:"travelerInfo.init"},{service:"windowService",method:"setFooterHidden",params:!0},{service:"adobeAnalyticsService",method:"fireEventObject",params:{type:this.adobeAnalyticsService.events.flightFareSelected,dataFunc:this.fareService.getSelectedFares.bind(this)}}],handlerCallbacks:[{service:"workflowService",method:"transition",params:["FARE_SELECTOR_STATE","ANCILLARIES_SELECTOR_STATE"]}]}]},ANCILLARIES_SELECTOR_STATE:{type:"PROGRESSIVE",handlers:[{service:"ancillariesService",method:"requestAvailableAncillaries",isPromise:!0,handlerCallbacks:[{service:"windowService",method:"setFooterHidden",params:!1},{service:"pubSubService",method:"publish",params:"travelerInfo.show"},{service:"pubSubService",method:"publish",params:"collapseSecondFareSelector"},{service:"scrollService",method:"scroll",isPromise:!0,params:{target:"ANCILLARIES_SELECTOR_STATE"}}],errorCallbacks:[{service:"pubSubService",method:"publish",params:["ancillariesSelector.setVisibility",[!1]]},{service:"workflowService",method:"transition",params:["FARE_SELECTOR_STATE","SEAT_SELECTOR_STATE"]}]},{service:"ancillariesService",method:"useUISelections"}]},SEAT_SELECTOR_STATE:{type:"PROGRESSIVE",handlers:[{service:"seatService",method:"getSeatMaps",isPromise:!0,handlerCallbacks:[{service:"pubSubService",method:"publish",params:"collapseSecondFareSelector"},{service:"pubSubService",method:"publish",params:"travelerInfo.show"},{service:"scrollService",method:"scroll",isPromise:!0,params:{target:"SEAT_SELECTOR_STATE"},handlerCallbacks:[{service:"seatService",method:"onScrollComplete"},{service:"pubSubService",method:"publish",params:"seatSelector.updateTravelers"}]},{service:"windowService",method:"setFooterHidden",params:!1}],errorCallbacks:[{service:"statusService",method:"setStatus",params:{format:this.statusService.format.ERROR,copy:this.statusService.message.OOPS}}]}]}}},TRAVELER_INFO_STATE:{pageTitle:"Traveler Information",defaultTransition:"ANCILLARIES_SELECTOR_STATE",allowedTransitions:{BOOK_INTRO_STATE:{type:"REGRESSIVE",handlers:[{service:"tripService",method:"clearDates"},{service:"fareService",method:"resetService"},{service:"purchaseService",method:"reset"},{service:"statusService",method:"setAlert",params:[[]]},{service:"scrollService",method:"scroll",params:{target:"BOOK_INTRO_STATE",delay:0}},{service:"tripService",method:"setVisibleSection",params:{section:"CALENDAR",isVisible:!1}},{service:"tripService",method:"setVisibleSection",params:{section:"PEOPLE_PICKER",isVisible:!1}},{service:"windowService",method:"setYtsVisible",params:!1},{service:"windowService",method:"setYtsExpanded",params:!1},{service:"windowService",method:"setFooterHidden",params:!1},{service:"pubSubService",method:"publish",params:"travelerInfo.hide"}]},DATE_PICKER_STATE:{type:"REGRESSIVE",handlers:[{service:"tripService",method:"clearDates"},{service:"fareService",method:"resetService"},{service:"purchaseService",method:"reset"},{service:"statusService",method:"setAlert",params:[[]]},{service:"tripService",method:"validateCityPairs"},{service:"tripService",method:"setVisibleSection",params:{section:"CALENDAR",isVisible:!0}},{service:"pubSubService",method:"publish",params:"travelerInfo.hide"},{service:"scrollService",method:"scroll",params:{target:"DATE_PICKER_STATE",delay:0}},{service:"windowService",method:"setFooterHidden",params:!1}]},FARE_SELECTOR_STATE:{type:"REGRESSIVE",handlers:[{service:"fareService",method:"resetSelectedFares"},{service:"purchaseService",method:"reset"},{service:"statusService",method:"setStatus",params:[[]]},{service:"tripService",method:"validateCityPairs"},{service:"scrollService",method:"scroll",params:{target:"FARE_SELECTOR_STATE",delay:0}},{service:"pubSubService",method:"publish",params:"travelerInfo.hide"},{service:"windowService",method:"setUiBlock",params:!1},{service:"windowService",method:"setYtsPayNow",params:!1},{service:"windowService",method:"setFooterHidden",params:!0}]},ANCILLARIES_SELECTOR_STATE:{type:"PROGRESSIVE",handlers:[{service:"ancillariesService",method:"requestAvailableAncillaries",isPromise:!0,handlerCallbacks:[{service:"scrollService",method:"scroll",isPromise:!0,params:{target:"ANCILLARIES_SELECTOR_STATE"},handlerCallbacks:[{service:"pubSubService",method:"publish",params:"travelerInfo.collapse"}]},{service:"windowService",method:"setFooterHidden",params:!1}],errorCallbacks:[{service:"workflowService",method:"transition",params:["TRAVELER_INFO_STATE","SEAT_SELECTOR_STATE"]}]},{service:"ancillariesService",method:"useUISelections"}]},SEAT_SELECTOR_STATE:{type:"PROGRESSIVE",handlers:[{service:"seatService",method:"getSeatMaps",isPromise:!0,handlerCallbacks:[{service:"scrollService",method:"scroll",isPromise:!0,params:{target:"SEAT_SELECTOR_STATE"},handlerCallbacks:[{service:"seatService",method:"onScrollComplete"},{service:"pubSubService",method:"publish",params:"seatSelector.updateTravelers"}]},{service:"pubSubService",method:"publish",params:"travelerInfo.collapse"},{service:"pubSubService",method:"publish",params:["ancillariesSelector.setVisibility",[!1]]},{service:"windowService",method:"setFooterHidden",params:!1}],errorCallbacks:[{service:"statusService",method:"setStatus",params:{format:this.statusService.format.ERROR,copy:this.statusService.message.OOPS}}]}]}}},ANCILLARIES_SELECTOR_STATE:{pageTitle:"Choose Ancillaries",defaultTransition:"SEAT_SELECTOR_STATE",allowedTransitions:{BOOK_INTRO_STATE:{type:"REGRESSIVE",handlers:[{service:"tripService",method:"clearDates"},{service:"fareService",method:"resetService"},{service:"purchaseService",method:"reset"},{service:"ancillariesService",method:"reset"},{service:"fareService",method:"setInventoryLocked",params:!1},{service:"bookingTimerService",method:"stopTimer"},{service:"seatService",method:"resetService"},{service:"statusService",method:"setStatus",params:[[]]},{service:"pubSubService",method:"publish",params:"travelerInfo.hide"},{service:"pubSubService",method:"publish",params:"ancillariesSelector.reset"},{service:"tripService",method:"setVisibleSection",params:{section:"BOOK_INTRO_STATE",isVisible:!0}},{service:"scrollService",method:"scroll",params:{target:"BOOK_INTRO_STATE",delay:0}},{service:"tripService",method:"setVisibleSection",params:{section:"CALENDAR",isVisible:!1}},{service:"tripService",method:"setVisibleSection",params:{section:"PEOPLE_PICKER",isVisible:!1}},{service:"windowService",method:"setYtsVisible",params:!1},{service:"windowService",method:"setYtsExpanded",params:!1},{service:"windowService",method:"setUiBlock",params:!1},{service:"windowService",method:"setYtsPayNow",params:!1}]},DATE_PICKER_STATE:{type:"REGRESSIVE",handlers:[{service:"ancillariesService",method:"reset"},{service:"tripService",method:"clearDates"},{service:"fareService",method:"resetService"},{service:"purchaseService",method:"reset"},{service:"ancillariesService",method:"reset"},{service:"fareService",method:"setInventoryLocked",params:!1},{service:"bookingTimerService",method:"stopTimer"},{service:"seatService",method:"resetService"},{service:"pubSubService",method:"publish",params:"travelerInfo.hide"},{service:"statusService",method:"setStatus",params:[[]]},{service:"tripService",method:"validateCityPairs"},{service:"pubSubService",method:"publish",params:"ancillariesSelector.reset"},{service:"tripService",method:"setVisibleSection",params:{section:"CALENDAR",isVisible:!0}},{service:"scrollService",method:"scroll",params:{target:"DATE_PICKER_STATE",delay:0}},{service:"windowService",method:"setUiBlock",params:!1},{service:"windowService",method:"setYtsPayNow",params:!1}]},FARE_SELECTOR_STATE:{type:"REGRESSIVE",handlers:[{service:"purchaseService",method:"reset"},{service:"ancillariesService",method:"reset"},{service:"fareService",method:"setInventoryLocked",params:!1},{service:"bookingTimerService",method:"stopTimer"},{service:"seatService",method:"resetService"},{service:"statusService",method:"setStatus",params:[[]]},{service:"tripService",method:"validateCityPairs"},{service:"pubSubService",method:"publish",params:"travelerInfo.hide"},{service:"pubSubService",method:"publish",params:"ancillariesSelector.reset"},{service:"scrollService",method:"scroll",params:{target:"FARE_SELECTOR_STATE",delay:0}},{service:"windowService",method:"setUiBlock",params:!1},{service:"windowService",method:"setYtsPayNow",params:!1},{service:"windowService",method:"setFooterHidden",params:!0}]},TRAVELER_INFO_STATE:{type:"REGRESSIVE",handlers:[{service:"ancillariesService",method:"reset"},{service:"fareService",method:"setInventoryLocked",params:!1},{service:"bookingTimerService",method:"stopTimer"},{service:"seatService",method:"resetService"},{service:"statusService",method:"setStatus",params:[[]]},{service:"tripService",method:"validateCityPairs"},{service:"scrollService",method:"scroll",params:{target:"TRAVELER_INFO_STATE",delay:0}},{service:"pubSubService",method:"publish",params:"ancillariesSelector.reset"},{service:"windowService",method:"setUiBlock",params:!1},{service:"windowService",method:"setYtsPayNow",params:!1},{service:"windowService",method:"setFooterHidden",params:!0}]},SEAT_SELECTOR_STATE:{type:"PROGRESSIVE",handlers:[{service:"seatService",method:"getSeatMaps",isPromise:!0,handlerCallbacks:[{service:"scrollService",method:"scroll",isPromise:!0,params:{target:"SEAT_SELECTOR_STATE"},handlerCallbacks:[{service:"seatService",method:"onScrollComplete"},{service:"pubSubService",method:"publish",params:"ancillariesSelector.collapse"},{service:"pubSubService",method:"publish",params:"seatSelector.updateTravelers"}]},{service:"windowService",method:"setFooterHidden",params:!1}],errorCallbacks:[{service:"statusService",method:"setStatus",params:{format:this.statusService.format.ERROR,copy:this.statusService.message.OOPS}}]}]}}},SEAT_SELECTOR_STATE:{pageTitle:"Choose Seats",defaultTransition:"PURCHASE_STATE",allowedTransitions:{BOOK_INTRO_STATE:{type:"REGRESSIVE",handlers:[{service:"tripService",method:"clearDates"},{service:"fareService",method:"resetService"},{service:"purchaseService",method:"reset"},{service:"ancillariesService",method:"reset"},{service:"fareService",method:"setInventoryLocked",params:!1},{service:"bookingTimerService",method:"stopTimer"},{service:"seatService",method:"resetService"},{service:"statusService",method:"setStatus",params:[[]]},{service:"pubSubService",method:"publish",params:"travelerInfo.hide"},{service:"pubSubService",method:"publish",params:"ancillariesSelector.reset"},{service:"tripService",method:"setVisibleSection",params:{section:"BOOK_INTRO_STATE",isVisible:!0}},{service:"scrollService",method:"scroll",params:{target:"BOOK_INTRO_STATE",delay:0}},{service:"tripService",method:"setVisibleSection",params:{section:"CALENDAR",isVisible:!1}},{service:"tripService",method:"setVisibleSection",params:{section:"PEOPLE_PICKER",isVisible:!1}},{service:"windowService",method:"setYtsVisible",params:!1},{service:"windowService",method:"setYtsExpanded",params:!1},{service:"windowService",method:"setUiBlock",params:!1},{service:"windowService",method:"setYtsPayNow",params:!1}]},DATE_PICKER_STATE:{type:"REGRESSIVE",handlers:[{service:"tripService",method:"clearDates"},{service:"fareService",method:"resetService"},{service:"purchaseService",method:"reset"},{service:"ancillariesService",method:"reset"},{service:"fareService",method:"setInventoryLocked",params:!1},{service:"bookingTimerService",method:"stopTimer"},{service:"seatService",method:"resetService"},{service:"statusService",method:"setStatus",params:[[]]},{service:"tripService",method:"validateCityPairs"},{service:"pubSubService",method:"publish",params:"travelerInfo.hide"},{service:"pubSubService",method:"publish",params:"ancillariesSelector.reset"},{service:"tripService",method:"setVisibleSection",params:{section:"CALENDAR",isVisible:!0}},{service:"scrollService",method:"scroll",params:{target:"DATE_PICKER_STATE",delay:0}},{service:"windowService",method:"setUiBlock",params:!1},{service:"windowService",method:"setYtsPayNow",params:!1}]},FARE_SELECTOR_STATE:{type:"REGRESSIVE",handlers:[{service:"fareService",method:"resetSelectedFares"},{service:"purchaseService",method:"reset"},{service:"ancillariesService",method:"reset"},{service:"fareService",method:"setInventoryLocked",params:!1},{service:"bookingTimerService",method:"stopTimer"},{service:"seatService",method:"resetService"},{service:"statusService",method:"setStatus",params:[[]]},{service:"tripService",method:"validateCityPairs"},{service:"pubSubService",method:"publish",params:"ancillariesSelector.reset"},{service:"pubSubService",method:"publish",params:"travelerInfo.hide"},{service:"scrollService",method:"scroll",params:{target:"FARE_SELECTOR_STATE",delay:0}},{service:"windowService",method:"setUiBlock",params:!1},{service:"windowService",method:"setYtsPayNow",params:!1},{service:"windowService",method:"setFooterHidden",params:!0}]},TRAVELER_INFO_STATE:{type:"REGRESSIVE",handlers:[{service:"ancillariesService",method:"reset"},{service:"fareService",method:"setInventoryLocked",params:!1},{service:"bookingTimerService",method:"stopTimer"},{service:"seatService",method:"resetService"},{service:"statusService",method:"setStatus",params:[[]]},{service:"tripService",method:"validateCityPairs"},{service:"pubSubService",method:"publish",params:"ancillariesSelector.reset"},{service:"scrollService",method:"scroll",params:{target:"TRAVELER_INFO_STATE",delay:0}},{service:"windowService",method:"setUiBlock",params:!1},{service:"windowService",method:"setYtsPayNow",params:!1},{service:"windowService",method:"setFooterHidden",params:!0}]},ANCILLARIES_SELECTOR_STATE:{type:"REGRESSIVE",handlers:[{service:"fareService",method:"setInventoryLocked",params:!1},{service:"bookingTimerService",method:"stopTimer"},{service:"seatService",method:"resetService"},{service:"statusService",method:"setStatus",params:[[]]},{service:"tripService",method:"validateCityPairs"},{service:"scrollService",method:"scroll",params:{target:"ANCILLARY_SELECTOR_STATE",delay:0}},{service:"windowService",method:"setUiBlock",params:!1},{service:"windowService",method:"setFooterHidden",params:!0},{service:"windowService",method:"setYtsPayNow",params:!1},{service:"purchaseService",method:"resetQuoteModel"}]},PURCHASE_STATE:{type:"PROGRESSIVE",handlers:[{service:"locationService",method:"go",params:{target:"/purchase"}},{service:"adobeAnalyticsService",method:"fireEventObject",params:{type:this.adobeAnalyticsService.events.payNow}}]}}},PURCHASE_STATE:{pageTitle:"Purchase",defaultTransition:"SUCCESS_STATE",allowedTransitions:{BOOK_INTRO_STATE:{type:"REGRESSIVE",handlers:[{service:"ancillariesService",method:"resetService"},{service:"seatService",method:"resetService"},{service:"fareService",method:"resetSelectedFares"},{service:"purchaseService",method:"reset"},{service:"fareService",method:"setInventoryLocked",params:!1},{service:"bookingTimerService",method:"stopTimer"},{service:"pubSubService",method:"publish",params:"travelerInfo.hide"},{service:"statusService",method:"setStatus",params:[[]]},{service:"windowService",method:"setUiBlock",params:!1},{service:"windowService",method:"setYtsPayNow",params:!1},{service:"windowService",method:"setFooterHidden",params:!0}]},DATE_PICKER_STATE:{type:"REGRESSIVE",handlers:[{service:"ancillariesService",method:"resetService"},{service:"seatService",method:"resetService"},{service:"fareService",method:"resetSelectedFares"},{service:"purchaseService",method:"reset"},{service:"fareService",method:"setInventoryLocked",params:!1},{service:"bookingTimerService",method:"stopTimer"},{service:"pubSubService",method:"publish",params:"travelerInfo.hide"},{service:"statusService",method:"setStatus",params:[[]]},{service:"windowService",method:"setUiBlock",params:!1},{service:"windowService",method:"setYtsPayNow",params:!1},{service:"windowService",method:"setFooterHidden",params:!0}]},FARE_SELECTOR_STATE:{type:"REGRESSIVE",handlers:[{service:"ancillariesService",method:"resetService"},{service:"seatService",method:"resetService"},{service:"fareService",method:"resetSelectedFares"},{service:"purchaseService",method:"reset"},{service:"fareService",method:"setInventoryLocked",params:!1},{service:"bookingTimerService",method:"stopTimer"},{service:"pubSubService",method:"publish",params:"travelerInfo.hide"},{service:"statusService",method:"setStatus",params:[[]]},{service:"windowService",method:"setUiBlock",params:!1},{service:"windowService",method:"setYtsPayNow",params:!1},{service:"windowService",method:"setFooterHidden",params:!0}]},SEAT_SELECTOR_STATE:{type:"REGRESSIVE",handlers:[{service:"ancillariesService",method:"resetService"},{service:"seatService",method:"resetService"},{service:"fareService",method:"resetSelectedFares"},{service:"purchaseService",method:"reset"},{service:"fareService",method:"setInventoryLocked",params:!1},{service:"bookingTimerService",method:"stopTimer"},{service:"statusService",method:"setStatus",params:[[]]},{service:"scrollService",method:"scroll",params:{target:"FARE_SELECTOR_STATE",delay:0}},{service:"windowService",method:"setUiBlock",params:!1},{service:"windowService",method:"setYtsPayNow",params:!1},{service:"windowService",method:"setFooterHidden",params:!0},{service:"this",method:"backStep"}]},SUCCESS_STATE:{type:"PROGRESSIVE",handlers:[{service:"locationService",method:"go",params:{target:"/success"}},{service:"windowService",method:"setYtsVisible",params:!1},{service:"bookingTimerService",method:"stopTimer"}]}}},SUCCESS_STATE:{pageTitle:"Purchase Success",defaultTransition:null,allowedTransitions:{}}},this._backScrollTransitionsMap={BOOK_INTRO_STATE:{allowedTransitions:{BOOK_INTRO_STATE:{type:"REGRESSIVE",handlers:[{service:"scrollService",method:"scroll",params:{target:"BOOK_INTRO_STATE",delay:0}}]}}},DATE_PICKER_STATE:{allowedTransitions:{BOOK_INTRO_STATE:{type:"REGRESSIVE",handlers:[{service:"scrollService",method:"scroll",params:{target:"BOOK_INTRO_STATE",delay:0}}]}}},FARE_SELECTOR_STATE:{allowedTransitions:{DATE_PICKER_STATE:{type:"REGRESSIVE",handlers:[{service:"scrollService",method:"scroll",params:{target:"DATE_PICKER_STATE",delay:0}}]}}},TRAVELER_INFO_STATE:{allowedTransitions:{FARE_SELECTOR_STATE:{type:"REGRESSIVE",handlers:[{service:"scrollService",method:"scroll",params:{target:"FARE_SELECTOR_STATE",delay:0}},{service:"windowService",method:"setUiBlock",params:!1}]}}},ANCILLARIES_SELECTOR_STATE:{allowedTransitions:{TRAVELER_INFO_STATE:{type:"REGRESSIVE",handlers:[{service:"locationService",method:"contextIs",params:this.locationService.contexts.CHANGE,isConditional:!0,handlerCallbacks:[{service:"workflowService",method:"scroll",params:["ANCILLARIES_SELECTOR_STATE","FARE_SELECTOR_STATE"]}],errorCallbacks:[{service:"seatService",method:"resetService"},{service:"scrollService",method:"scroll",params:{target:"TRAVELER_INFO_STATE",delay:0}},{service:"windowService",method:"setUiBlock",params:!1}]}]},FARE_SELECTOR_STATE:{type:"REGRESSIVE",handlers:[{service:"scrollService",method:"scroll",params:{target:"FARE_SELECTOR_STATE",delay:0}},{service:"windowService",method:"setUiBlock",params:!1}]}}},SEAT_SELECTOR_STATE:{allowedTransitions:{TRAVELER_INFO_STATE:{type:"REGRESSIVE",handlers:[{service:"seatService",method:"resetService"},{service:"pubSubService",method:"publish",params:"travelerInfo.show"},{service:"scrollService",method:"scroll",params:{target:"TRAVELER_INFO_STATE",delay:0}},{service:"windowService",method:"setUiBlock",params:!1}]},ANCILLARIES_SELECTOR_STATE:{type:"REGRESSIVE",handlers:[{service:"windowService",method:"setYtsPayNow",params:!1},{service:"tripService",method:"isVisible",params:"ANCILLARIES_SELECTOR",isConditional:!0,handlerCallbacks:[{service:"seatService",method:"resetService"},{service:"scrollService",method:"scroll",params:{target:"ANCILLARIES_SELECTOR_STATE",delay:0}},{service:"windowService",method:"setUiBlock",params:!1}],errorCallbacks:[{service:"workflowService",method:"scroll",params:["SEAT_SELECTOR_STATE","TRAVELER_INFO_STATE"]}]}]}}}},this._currentState="BOOK_INTRO_STATE",this._currentScrollState="BOOK_INTRO_STATE",{transition:this.transition.bind(this),getCurrentState:this.getCurrentState.bind(this),isBeforeCurrentState:this.isBeforeCurrentState.bind(this),backStep:this.backStep.bind(this),state:this.state}};return b.$inject=["tripService","fareService","seatService","ancillariesService","purchaseService","scrollService","windowService","locationService","statusService","bookingTimerService","pubSubService","adobeAnalyticsService","travelerService"],b.prototype.getCurrentState=function(){return this._currentState},b.prototype.isBeforeCurrentState=function(a){return this._transitionStates.indexOf(a)<this._transitionStates.indexOf(this.getCurrentState())},b.prototype._updateDocumentTitle=function(){var a=this._currentState,b=document.title.split(" - "),c=this._stateTransitionsMap[a].pageTitle;document.title=[c,b[1]].join(" - ")},b.prototype.transition=function(b,c,d){if(d=!!d,!this._isState(b))return!1;var e=this._stateTransitionsMap[b];"undefined"!=typeof c&&this._isState(c)||(c=e.defaultTransition);var f=e.allowedTransitions[c];return"undefined"!=typeof f&&(this._currentState=c,this._currentScrollState=c,this._updateDocumentTitle(),a.forEach(f.handlers,function(a){this._executeHandler(a,a.params,d)}.bind(this)),void 0)},b.prototype.scroll=function(b,c,d){if(d=!!d,!this._isState(b))return!1;var e=this._backScrollTransitionsMap[b];"undefined"!=typeof c&&this._isState(c)||(c=e.defaultTransition);var f=e.allowedTransitions[c];return"undefined"!=typeof f&&(this._currentScrollState=c,this.pubSubService.publish("yts.setState",[this._currentScrollState]),a.forEach(f.handlers,function(a){this._executeHandler(a,a.params,d)}.bind(this)),void 0)},b.prototype._isState=function(a){return this._transitionStates.indexOf(a)!==-1},b.prototype._executeHandler=function(b,c,d){var e,f=b.isPromise||b.isConditional;if((f||!d||"scrollService"!==b.service)&&(e=Array.isArray(c)?this[b.service][b.method].apply(this[b.service],c):this[b.service][b.method](c),f)){var g=function(){a.forEach(b.handlerCallbacks,function(a){this._executeHandler(a,a.params,d)}.bind(this))},h=function(){"undefined"!=typeof b.errorCallbacks&&a.forEach(b.errorCallbacks,function(a){this._executeHandler(a,a.params,d)}.bind(this))};b.isPromise?e.then(g.bind(this),h.bind(this)):e?g.apply(this):h.apply(this)}},b.prototype.backStep=function(a){a||(a=this._currentScrollState);var b=null,c=this._transitionStates.indexOf(a);c>0&&this._transitionStates[c-1]&&(b=this._transitionStates[c-1],this.scroll(a,b,!1))},b}),c("core/services/location",[],function(){"use strict";var a=function(a,b,c,d,e,f,g,h){this._$location=a,this._$rootScope=b,this._URLParser=c,this._$window=d,this._$singleTimeout=e,this._pubSubService=f,this._scrollService=g,this._parameterService=h,this.itShouldRender=!1,this.bookBackStep=!1,this.resetBook=!1;var i={BOOK:"book",CHECKIN:"check-in",CHANGE:"change",ELEVATE:"elevate",MANAGE:"manage",CANCEL:"cancel",SUCCESS:"success",FLIGHTSTATUS:"check-flight-status",SHOPLOGIN:"shop-login",BOOKLANDING:"book-landing"};return this._context=null,this._locationChangeState(i),{contexts:i,go:this.go.bind(this),push:this.push.bind(this),shouldRender:this.shouldRender.bind(this),setShouldRender:this.setShouldRender.bind(this),update:this.update.bind(this),isBackStepping:this.isBackStepping.bind(this),backStep:this.backStep.bind(this),setContext:this.setContext.bind(this),getContext:this.getContext.bind(this),contextIs:this.contextIs.bind(this),isBookBackStep:this.isBookBackStep.bind(this),shouldResetBook:this.shouldResetBook.bind(this),setResetBook:this.setResetBook.bind(this),resetApp:this.resetApp.bind(this),getAbsUrl:this.getAbsUrl.bind(this),getPath:this.getPath.bind(this),getLastPath:this.getLastPath.bind(this)}};return a.prototype.setResetBook=function(a){this.resetBook=a},a.prototype.shouldResetBook=function(){return this.resetBook},a.prototype.isBookBackStep=function(){return this.bookBackStep},a.prototype._locationChangeState=function(a){window.onpopstate=function(a){a.state&&a.state.vxBackStep&&(this._$singleTimeout(function(){this.backStep(a.target.location.href,null)}.bind(this)),this.isBookBackStep()&&a.preventDefault())}.bind(this),this._$rootScope.$on("$locationChangeStart",function(b,c,d){if(this._lastPath=d.split(location.origin)[1],this._parameterService.onLocationChange(),c===d)return c.indexOf("/book-travel")>-1?this.setContext(a.BOOKLANDING):c.indexOf("/book")!==-1?this.setContext(a.BOOK):c.indexOf("/flight-check-in")>-1?this.setContext(a.CHECKIN):c.indexOf("/manage-itinerary")>-1?this.setContext(a.MANAGE):c.indexOf("/elevate-frequent-flyer")>-1?this.setContext(a.ELEVATE):c.indexOf("/check-flight-status")>-1?this.setContext(a.FLIGHTSTATUS):c.indexOf("/shop-login")>-1&&this.setContext(a.SHOPLOGIN),
void("/"===this._$location.path()&&this.setContext(a.BOOK));var e="/"===this._$location.path(),f=d.indexOf("/elevate-frequent-flyer")!==-1,g=d.indexOf("/manage-itinerary")!==-1,h=d.indexOf("/flight-check-in")!==-1,i=c.indexOf("/book")!==-1&&d.indexOf("/book")!==-1,j=c.indexOf("/flight-check-in")!==-1&&d.indexOf("/flight-check-in")!==-1,k=c.indexOf("/cancel")!==-1&&d.indexOf("/cancel")!==-1,l=c.indexOf("/purchase")!==-1&&d.indexOf("/purchase")!==-1;(e&&!f&&!h&&!g||i||j||l||k)&&!this.isBackStepping(c,d)&&d.indexOf("/book-travel")===-1&&b.preventDefault(),i&&this._pubSubService.publish("yts.collapseYts",[!0]);var m=c.indexOf("/book")!==-1&&d.indexOf("/book")===-1,n=c.indexOf("/purchase")===-1&&d.indexOf("/purchase")!==-1,o=c.indexOf("/manage-itinerary")!==-1&&d.indexOf("/manage-itinerary")===-1,p=c.indexOf("/elevate-frequent-flyer")!==-1&&d.indexOf("/elevate-frequent-flyer")===-1,q=c.indexOf("/flight-check-in")!==-1&&d.indexOf("/flight-check-in")===-1,r=c.indexOf("/purchase")!==-1&&d.indexOf("/success")!==-1,s=d.indexOf("/success")>-1&&c.indexOf("/flight-check-in")>-1||r&&this._context===a.CHECKIN,t=c.indexOf("/shop-login")!==-1,u=c.indexOf("/success")!==-1&&d.indexOf("/elevate-frequent-flyer")!==-1,v=c.indexOf("/cancel")!==-1&&d.indexOf("/success")!==-1;m&&!n||u||r&&this._context===a.BOOK?this.resetApp():r&&this._context===a.CHANGE||v?this._resetChange(b):s?this._resetCheckIn(b):q?(this._pubSubService.publish("windowService.setYtsVisible",[!1]),this.setContext(a.CHECKIN)):o?(this._pubSubService.publish("windowService.setYtsVisible",[!1]),this.setContext(a.MANAGE)):p?(this._pubSubService.publish("windowService.setYtsVisible",[!1]),this.setContext(a.ELEVATE)):t&&(this._pubSubService.publish("windowService.setYtsVisible",[!1]),this.setContext(a.SHOPLOGIN))}.bind(this))},a.prototype.contextIs=function(){for(var a=0,b=arguments.length;a<b;a++)if(this._context===arguments[a])return!0;return!1},a.prototype.getContext=function(){return this._context},a.prototype.setContext=function(a){this._context=a},a.prototype.shouldRender=function(){return this.itShouldRender},a.prototype.setShouldRender=function(a){this.itShouldRender=a},a.prototype.go=function(a){a&&a.target&&(a.external?(this.update(a.target),this._$window.location.reload()):a.newTab?this._$window.open(a.target):this._$location.path(a.target))},a.prototype.resetApp=function(){this.update("/"),this._$window.location.reload()},a.prototype._resetChange=function(a){a.preventDefault(),this._$singleTimeout(function(){this.update("/manage-itinerary"),this._$window.location.reload()}.bind(this))},a.prototype._resetCheckIn=function(a){a.preventDefault(),this._$singleTimeout(function(){this.update("/flight-check-in/choose-flights"),this._$window.location.reload()}.bind(this))},a.prototype._isLegacyUrl=function(){return this._$location.path().indexOf("referral.php")!==-1},a.prototype.push=function(a){var b=this._URLParser.getUrl(a);this._isLegacyUrl()?this.update(b):"undefined"!=typeof history.pushState&&this._$window.history.pushState({vxBackStep:!0},document.title,b),this._$singleTimeout(function(){this.itShouldRender=!1}.bind(this))},a.prototype.update=function(a){this._$location.path(a),"undefined"!=typeof history.pushState&&this._$window.history.pushState({vxBackStep:!0},document.title,a)},a.prototype.isBackStepping=function(a,b){var c=this._determineFlow(a,b);return this._isBackStepForFlow(c,a,b)},a.prototype.backStep=function(a,b){var c=this._determineFlow(a,b);return this._doBackStepForFlow(c,a)},a.prototype._determineFlow=function(a,b){var c,d=a.indexOf("check-in")!==-1&&(null===b||b.indexOf("check-in")!==-1),e=a.indexOf("purchase")!==-1&&(null===b||b.indexOf("purchase")!==-1),f=a.indexOf("book")!==-1&&(null===b||b.indexOf("book")!==-1);return d&&(c="checkIn"),e&&(c="purchase"),f&&(c="book"),c},a.prototype._isBackStepForFlow=function(a,b,c){var d={checkIn:["choose-flights","add-passport-info","upgrade-options","lounge-options","seats/change","seats/select","extras","bags"],purchase:["add","complete","travel-bank"]},e=-1,f=-1;for(var g in d[a])b.indexOf(d[a][g])!==-1&&(e=g),null!==c&&c.indexOf(d[a][g])!==-1&&(f=g);return e<f},a.prototype._doBackStepForFlow=function(a,b){var c={checkIn:{ANCOR:"LOGIN","choose-flights":"FLIGHTS","add-passport-info":"PASSPORT","upgrade-options":"UPGRADE","lounge-options":"LOUNGE","seats/change":"SEATS_CHANGE","seats/select":"SEATS_SELECT",extras:"ANCILLARIES_SELECTOR",bags:"BAGGAGE"},purchase:{ANCOR:"select",add:"credit-card",complete:"selected","travel-bank":"travelbank"}};if("book"===a)return void this._doBackStepForBook();if("undefined"!=typeof c[a]){var d=!1;for(var e in c[a])if(b.indexOf(e)!==-1){this._pubSubService.publish(a+"Service.setView",[c[a][e]]),d=!0;break}var f="purchase"===a;(!d||f)&&this._pubSubService.publish(a+"Service.setView",[c[a].ANCOR])}},a.prototype._doBackStepForBook=function(){this.bookBackStep=!0},a.prototype.getAbsUrl=function(){return this._$location.absUrl()},a.prototype.getPath=function(){return this._$location.path()},a.prototype.getLastPath=function(){return this._lastPath},a.$inject=["$location","$rootScope","URLParser","$window","$singleTimeout","pubSubService","scrollService","parameterService"],a}),function(a,b){"function"==typeof c&&c.amd?c("tv4",[],b):"undefined"!=typeof module&&module.exports?module.exports=b():a.tv4=b()}(this,function(){function a(b,c){if(b===c)return!0;if("object"==typeof b&&"object"==typeof c){if(Array.isArray(b)!==Array.isArray(c))return!1;if(Array.isArray(b)){if(b.length!==c.length)return!1;for(var d=0;d<b.length;d++)if(!a(b[d],c[d]))return!1}else{var e;for(e in b)if(void 0===c[e]&&void 0!==b[e])return!1;for(e in c)if(void 0===b[e]&&void 0!==c[e])return!1;for(e in b)if(!a(b[e],c[e]))return!1}return!0}return!1}function b(a){var b=String(a).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return b?{href:b[0]||"",protocol:b[1]||"",authority:b[2]||"",host:b[3]||"",hostname:b[4]||"",port:b[5]||"",pathname:b[6]||"",search:b[7]||"",hash:b[8]||""}:null}function c(a,c){function d(a){var b=[];return a.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(a){"/.."===a?b.pop():b.push(a)}),b.join("").replace(/^\//,"/"===a.charAt(0)?"/":"")}return c=b(c||""),a=b(a||""),c&&a?(c.protocol||a.protocol)+(c.protocol||c.authority?c.authority:a.authority)+d(c.protocol||c.authority||"/"===c.pathname.charAt(0)?c.pathname:c.pathname?(a.authority&&!a.pathname?"/":"")+a.pathname.slice(0,a.pathname.lastIndexOf("/")+1)+c.pathname:a.pathname)+(c.protocol||c.authority||c.pathname?c.search:c.search||a.search)+c.hash:null}function d(a){return a.split("#")[0]}function e(a,b){if(a&&"object"==typeof a)if(void 0===b?b=a.id:"string"==typeof a.id&&(b=c(b,a.id),a.id=b),Array.isArray(a))for(var d=0;d<a.length;d++)e(a[d],b);else{"string"==typeof a.$ref&&(a.$ref=c(b,a.$ref));for(var f in a)"enum"!==f&&e(a[f],b)}}function f(a,b,c,d,e){if(Error.call(this),void 0===a)throw new Error("No code supplied for error: "+b);this.message=b,this.code=a,this.dataPath=c||"",this.schemaPath=d||"",this.subErrors=e||null;var f=new Error(this.message);if(this.stack=f.stack||f.stacktrace,!this.stack)try{throw f}catch(a){this.stack=a.stack||a.stacktrace}}function g(a,b){if(b.substring(0,a.length)===a){var c=b.substring(a.length);if(b.length>0&&"/"===b.charAt(a.length-1)||"#"===c.charAt(0)||"?"===c.charAt(0))return!0}return!1}function h(a){var b=new i,f=a||"en",g={addFormat:function(){b.addFormat.apply(b,arguments)},language:function(a){return a?(n[a]||(a=a.split("-")[0]),!!n[a]&&(f=a,a)):f},addLanguage:function(a,b){var c;for(c in j)b[c]&&!b[j[c]]&&(b[j[c]]=b[c]);var d=a.split("-")[0];if(n[d]){n[a]=Object.create(n[d]);for(c in b)"undefined"==typeof n[d][c]&&(n[d][c]=b[c]),n[a][c]=b[c]}else n[a]=b,n[d]=b;return this},freshApi:function(a){var b=h();return a&&b.language(a),b},validate:function(a,c,d,e){var g=new i(b,!1,n[f],d,e);"string"==typeof c&&(c={$ref:c}),g.addSchema("",c);var h=g.validateAll(a,c,null,null,"");return!h&&e&&(h=g.banUnknownProperties()),this.error=h,this.missing=g.missing,this.valid=null===h,this.valid},validateResult:function(){var a={};return this.validate.apply(a,arguments),a},validateMultiple:function(a,c,d,e){var g=new i(b,!0,n[f],d,e);"string"==typeof c&&(c={$ref:c}),g.addSchema("",c),g.validateAll(a,c,null,null,""),e&&g.banUnknownProperties();var h={};return h.errors=g.errors,h.missing=g.missing,h.valid=0===h.errors.length,h},addSchema:function(){return b.addSchema.apply(b,arguments)},getSchema:function(){return b.getSchema.apply(b,arguments)},getSchemaMap:function(){return b.getSchemaMap.apply(b,arguments)},getSchemaUris:function(){return b.getSchemaUris.apply(b,arguments)},getMissingUris:function(){return b.getMissingUris.apply(b,arguments)},dropSchemas:function(){b.dropSchemas.apply(b,arguments)},defineKeyword:function(){b.defineKeyword.apply(b,arguments)},defineError:function(a,b,c){if("string"!=typeof a||!/^[A-Z]+(_[A-Z]+)*$/.test(a))throw new Error("Code name must be a string in UPPER_CASE_WITH_UNDERSCORES");if("number"!=typeof b||b%1!==0||b<1e4)throw new Error("Code number must be an integer > 10000");if("undefined"!=typeof j[a])throw new Error("Error already defined: "+a+" as "+j[a]);if("undefined"!=typeof k[b])throw new Error("Error code already used: "+k[b]+" as "+b);j[a]=b,k[b]=a,m[a]=m[b]=c;for(var d in n){var e=n[d];e[a]&&(e[b]=e[b]||e[a])}},reset:function(){b.reset(),this.error=null,this.missing=[],this.valid=!0},missing:[],error:null,valid:!0,normSchema:e,resolveUrl:c,getDocumentUri:d,errorCodes:j};return g}Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on non-object");var f=[];for(var g in e)a.call(e,g)&&f.push(g);if(b)for(var h=0;h<d;h++)a.call(e,c[h])&&f.push(c[h]);return f}}()),Object.create||(Object.create=function(){function a(){}return function(b){if(1!==arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return a.prototype=b,new a}}()),Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>1&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&d!==1/0&&d!==-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);e<c;e++)if(e in b&&b[e]===a)return e;return-1}),Object.isFrozen||(Object.isFrozen=function(a){for(var b="tv4_test_frozen_key";a.hasOwnProperty(b);)b+=Math.random();try{return a[b]=!0,delete a[b],!1}catch(a){return!0}});var i=function(a,b,c,d,e){if(this.missing=[],this.missingMap={},this.formatValidators=a?Object.create(a.formatValidators):{},this.schemas=a?Object.create(a.schemas):{},this.collectMultiple=b,this.errors=[],this.handleError=b?this.collectError:this.returnError,d&&(this.checkRecursive=!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.scannedFrozenValidationErrors=[],this.validatedSchemasKey="tv4_validation_id",this.validationErrorsKey="tv4_validation_errors_id"),e&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorMessages=c,this.definedKeywords={},a)for(var f in a.definedKeywords)this.definedKeywords[f]=a.definedKeywords[f].slice(0)};i.prototype.defineKeyword=function(a,b){this.definedKeywords[a]=this.definedKeywords[a]||[],this.definedKeywords[a].push(b)},i.prototype.createError=function(a,b,c,d,e){var g=this.errorMessages[a]||m[a];if("string"!=typeof g)return new f(a,"Unknown error code "+a+": "+JSON.stringify(b),c,d,e);var h=g.replace(/\{([^{}]*)\}/g,function(a,c){var d=b[c];return"string"==typeof d||"number"==typeof d?d:a});return new f(a,h,c,d,e)},i.prototype.returnError=function(a){return a},i.prototype.collectError=function(a){return a&&this.errors.push(a),null},i.prototype.prefixErrors=function(a,b,c){for(var d=a;d<this.errors.length;d++)this.errors[d]=this.errors[d].prefixWith(b,c);return this},i.prototype.banUnknownProperties=function(){for(var a in this.unknownPropertyPaths){var b=this.createError(j.UNKNOWN_PROPERTY,{path:a},a,""),c=this.handleError(b);if(c)return c}return null},i.prototype.addFormat=function(a,b){if("object"==typeof a){for(var c in a)this.addFormat(c,a[c]);return this}this.formatValidators[a]=b},i.prototype.resolveRefs=function(a,b){if(void 0!==a.$ref){if(b=b||{},b[a.$ref])return this.createError(j.CIRCULAR_REFERENCE,{urls:Object.keys(b).join(", ")},"","");b[a.$ref]=!0,a=this.getSchema(a.$ref,b)}return a},i.prototype.getSchema=function(a,b){var c;if(void 0!==this.schemas[a])return c=this.schemas[a],this.resolveRefs(c,b);var d=a,e="";if(a.indexOf("#")!==-1&&(e=a.substring(a.indexOf("#")+1),d=a.substring(0,a.indexOf("#"))),"object"==typeof this.schemas[d]){c=this.schemas[d];var f=decodeURIComponent(e);if(""===f)return this.resolveRefs(c,b);if("/"!==f.charAt(0))return;for(var g=f.split("/").slice(1),h=0;h<g.length;h++){var i=g[h].replace(/~1/g,"/").replace(/~0/g,"~");if(void 0===c[i]){c=void 0;break}c=c[i]}if(void 0!==c)return this.resolveRefs(c,b)}void 0===this.missing[d]&&(this.missing.push(d),this.missing[d]=d,this.missingMap[d]=d)},i.prototype.searchSchemas=function(a,b){if(a&&"object"==typeof a){"string"==typeof a.id&&g(b,a.id)&&void 0===this.schemas[a.id]&&(this.schemas[a.id]=a);for(var c in a)if("enum"!==c)if("object"==typeof a[c])this.searchSchemas(a[c],b);else if("$ref"===c){var e=d(a[c]);e&&void 0===this.schemas[e]&&void 0===this.missingMap[e]&&(this.missingMap[e]=e)}}},i.prototype.addSchema=function(a,b){if("string"!=typeof a||"undefined"==typeof b){if("object"!=typeof a||"string"!=typeof a.id)return;b=a,a=b.id}(a=d(a)+"#")&&(a=d(a)),this.schemas[a]=b,delete this.missingMap[a],e(b,a),this.searchSchemas(b,a)},i.prototype.getSchemaMap=function(){var a={};for(var b in this.schemas)a[b]=this.schemas[b];return a},i.prototype.getSchemaUris=function(a){var b=[];for(var c in this.schemas)(!a||a.test(c))&&b.push(c);return b},i.prototype.getMissingUris=function(a){var b=[];for(var c in this.missingMap)(!a||a.test(c))&&b.push(c);return b},i.prototype.dropSchemas=function(){this.schemas={},this.reset()},i.prototype.reset=function(){this.missing=[],this.missingMap={},this.errors=[]},i.prototype.validateAll=function(a,b,c,d,e){var g;if(b=this.resolveRefs(b),!b)return null;if(b instanceof f)return this.errors.push(b),b;var h,i=this.errors.length,j=null,k=null;if(this.checkRecursive&&a&&"object"==typeof a){if(g=!this.scanned.length,a[this.validatedSchemasKey]){var l=a[this.validatedSchemasKey].indexOf(b);if(l!==-1)return this.errors=this.errors.concat(a[this.validationErrorsKey][l]),null}if(Object.isFrozen(a)&&(h=this.scannedFrozen.indexOf(a),h!==-1)){var m=this.scannedFrozenSchemas[h].indexOf(b);if(m!==-1)return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[h][m]),null}if(this.scanned.push(a),Object.isFrozen(a))h===-1&&(h=this.scannedFrozen.length,this.scannedFrozen.push(a),this.scannedFrozenSchemas.push([])),j=this.scannedFrozenSchemas[h].length,this.scannedFrozenSchemas[h][j]=b,this.scannedFrozenValidationErrors[h][j]=[];else{if(!a[this.validatedSchemasKey])try{Object.defineProperty(a,this.validatedSchemasKey,{value:[],configurable:!0}),Object.defineProperty(a,this.validationErrorsKey,{value:[],configurable:!0})}catch(b){a[this.validatedSchemasKey]=[],a[this.validationErrorsKey]=[]}k=a[this.validatedSchemasKey].length,a[this.validatedSchemasKey][k]=b,a[this.validationErrorsKey][k]=[]}}var n=this.errors.length,o=this.validateBasic(a,b,e)||this.validateNumeric(a,b,e)||this.validateString(a,b,e)||this.validateArray(a,b,e)||this.validateObject(a,b,e)||this.validateCombinations(a,b,e)||this.validateFormat(a,b,e)||this.validateDefinedKeywords(a,b,e)||null;if(g){for(;this.scanned.length;){var p=this.scanned.pop();delete p[this.validatedSchemasKey]}this.scannedFrozen=[],this.scannedFrozenSchemas=[]}if(o||n!==this.errors.length)for(;c&&c.length||d&&d.length;){var q=c&&c.length?""+c.pop():null,r=d&&d.length?""+d.pop():null;o&&(o=o.prefixWith(q,r)),this.prefixErrors(n,q,r)}return null!==j?this.scannedFrozenValidationErrors[h][j]=this.errors.slice(i):null!==k&&(a[this.validationErrorsKey][k]=this.errors.slice(i)),this.handleError(o)},i.prototype.validateFormat=function(a,b){if("string"!=typeof b.format||!this.formatValidators[b.format])return null;var c=this.formatValidators[b.format].call(null,a,b);return"string"==typeof c||"number"==typeof c?this.createError(j.FORMAT_CUSTOM,{message:c}).prefixWith(null,"format"):c&&"object"==typeof c?this.createError(j.FORMAT_CUSTOM,{message:c.message||"?"},c.dataPath||null,c.schemaPath||"/format"):null},i.prototype.validateDefinedKeywords=function(a,b){for(var c in this.definedKeywords)for(var d=this.definedKeywords[c],e=0;e<d.length;e++){var f=d[e],g=f(a,b[c],b);if("string"==typeof g||"number"==typeof g)return this.createError(j.KEYWORD_CUSTOM,{key:c,message:g}).prefixWith(null,"format");if(g&&"object"==typeof g){var h=g.code||j.KEYWORD_CUSTOM;if("string"==typeof h){if(!j[h])throw new Error("Undefined error code (use defineError): "+h);h=j[h]}var i="object"==typeof g.message?g.message:{key:c,message:g.message||"?"},k=g.schemaPath||"/"+c.replace(/~/g,"~0").replace(/\//g,"~1");return this.createError(h,i,g.dataPath||null,k)}}return null},i.prototype.validateBasic=function(a,b,c){var d;return(d=this.validateType(a,b,c))?d.prefixWith(null,"type"):(d=this.validateEnum(a,b,c))?d.prefixWith(null,"type"):null},i.prototype.validateType=function(a,b){if(void 0===b.type)return null;var c=typeof a;null===a?c="null":Array.isArray(a)&&(c="array");var d=b.type;"object"!=typeof d&&(d=[d]);for(var e=0;e<d.length;e++){var f=d[e];if(f===c||"integer"===f&&"number"===c&&a%1===0)return null}return this.createError(j.INVALID_TYPE,{type:c,expected:d.join("/")})},i.prototype.validateEnum=function(b,c){if(void 0===c.enum)return null;for(var d=0;d<c.enum.length;d++){var e=c.enum[d];if(a(b,e))return null}return this.createError(j.ENUM_MISMATCH,{value:"undefined"!=typeof JSON?JSON.stringify(b):b})},i.prototype.validateNumeric=function(a,b,c){return this.validateMultipleOf(a,b,c)||this.validateMinMax(a,b,c)||null},i.prototype.validateMultipleOf=function(a,b){var c=b.multipleOf||b.divisibleBy;return void 0===c?null:"number"==typeof a&&a%c!==0?this.createError(j.NUMBER_MULTIPLE_OF,{value:a,multipleOf:c}):null},i.prototype.validateMinMax=function(a,b){if("number"!=typeof a)return null;if(void 0!==b.minimum){if(a<b.minimum)return this.createError(j.NUMBER_MINIMUM,{value:a,minimum:b.minimum}).prefixWith(null,"minimum");if(b.exclusiveMinimum&&a===b.minimum)return this.createError(j.NUMBER_MINIMUM_EXCLUSIVE,{value:a,minimum:b.minimum}).prefixWith(null,"exclusiveMinimum")}if(void 0!==b.maximum){if(a>b.maximum)return this.createError(j.NUMBER_MAXIMUM,{value:a,maximum:b.maximum}).prefixWith(null,"maximum");if(b.exclusiveMaximum&&a===b.maximum)return this.createError(j.NUMBER_MAXIMUM_EXCLUSIVE,{value:a,maximum:b.maximum}).prefixWith(null,"exclusiveMaximum")}return null},i.prototype.validateString=function(a,b,c){return this.validateStringLength(a,b,c)||this.validateStringPattern(a,b,c)||null},i.prototype.validateStringLength=function(a,b){return"string"!=typeof a?null:void 0!==b.minLength&&a.length<b.minLength?this.createError(j.STRING_LENGTH_SHORT,{length:a.length,minimum:b.minLength}).prefixWith(null,"minLength"):void 0!==b.maxLength&&a.length>b.maxLength?this.createError(j.STRING_LENGTH_LONG,{length:a.length,maximum:b.maxLength}).prefixWith(null,"maxLength"):null},i.prototype.validateStringPattern=function(a,b){if("string"!=typeof a||void 0===b.pattern)return null;var c=new RegExp(b.pattern);return c.test(a)?null:this.createError(j.STRING_PATTERN,{pattern:b.pattern}).prefixWith(null,"pattern")},i.prototype.validateArray=function(a,b,c){return Array.isArray(a)?this.validateArrayLength(a,b,c)||this.validateArrayUniqueItems(a,b,c)||this.validateArrayItems(a,b,c)||null:null},i.prototype.validateArrayLength=function(a,b){var c;return void 0!==b.minItems&&a.length<b.minItems&&(c=this.createError(j.ARRAY_LENGTH_SHORT,{length:a.length,minimum:b.minItems}).prefixWith(null,"minItems"),this.handleError(c))?c:void 0!==b.maxItems&&a.length>b.maxItems&&(c=this.createError(j.ARRAY_LENGTH_LONG,{length:a.length,maximum:b.maxItems}).prefixWith(null,"maxItems"),this.handleError(c))?c:null},i.prototype.validateArrayUniqueItems=function(b,c){if(c.uniqueItems)for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)if(a(b[d],b[e])){var f=this.createError(j.ARRAY_UNIQUE,{match1:d,match2:e}).prefixWith(null,"uniqueItems");if(this.handleError(f))return f}return null},i.prototype.validateArrayItems=function(a,b,c){if(void 0===b.items)return null;var d,e;if(Array.isArray(b.items)){for(e=0;e<a.length;e++)if(e<b.items.length){if(d=this.validateAll(a[e],b.items[e],[e],["items",e],c+"/"+e))return d}else if(void 0!==b.additionalItems)if("boolean"==typeof b.additionalItems){if(!b.additionalItems&&(d=this.createError(j.ARRAY_ADDITIONAL_ITEMS,{}).prefixWith(""+e,"additionalItems"),this.handleError(d)))return d}else if(d=this.validateAll(a[e],b.additionalItems,[e],["additionalItems"],c+"/"+e))return d}else for(e=0;e<a.length;e++)if(d=this.validateAll(a[e],b.items,[e],["items"],c+"/"+e))return d;return null},i.prototype.validateObject=function(a,b,c){return"object"!=typeof a||null===a||Array.isArray(a)?null:this.validateObjectMinMaxProperties(a,b,c)||this.validateObjectRequiredProperties(a,b,c)||this.validateObjectProperties(a,b,c)||this.validateObjectDependencies(a,b,c)||null},i.prototype.validateObjectMinMaxProperties=function(a,b){var c,d=Object.keys(a);return void 0!==b.minProperties&&d.length<b.minProperties&&(c=this.createError(j.OBJECT_PROPERTIES_MINIMUM,{propertyCount:d.length,minimum:b.minProperties}).prefixWith(null,"minProperties"),this.handleError(c))?c:void 0!==b.maxProperties&&d.length>b.maxProperties&&(c=this.createError(j.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:d.length,maximum:b.maxProperties}).prefixWith(null,"maxProperties"),this.handleError(c))?c:null},i.prototype.validateObjectRequiredProperties=function(a,b){if(void 0!==b.required)for(var c=0;c<b.required.length;c++){var d=b.required[c];if(void 0===a[d]){var e=this.createError(j.OBJECT_REQUIRED,{key:d}).prefixWith(null,""+c).prefixWith(null,"required");if(this.handleError(e))return e}}return null},i.prototype.validateObjectProperties=function(a,b,c){var d;for(var e in a){var f=c+"/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),g=!1;if(void 0!==b.properties&&void 0!==b.properties[e]&&(g=!0,d=this.validateAll(a[e],b.properties[e],[e],["properties",e],f)))return d;if(void 0!==b.patternProperties)for(var h in b.patternProperties){var i=new RegExp(h);if(i.test(e)&&(g=!0,d=this.validateAll(a[e],b.patternProperties[h],[e],["patternProperties",h],f)))return d}if(g)this.trackUnknownProperties&&(this.knownPropertyPaths[f]=!0,delete this.unknownPropertyPaths[f]);else if(void 0!==b.additionalProperties){if(this.trackUnknownProperties&&(this.knownPropertyPaths[f]=!0,delete this.unknownPropertyPaths[f]),"boolean"==typeof b.additionalProperties){if(!b.additionalProperties&&(d=this.createError(j.OBJECT_ADDITIONAL_PROPERTIES,{}).prefixWith(e,"additionalProperties"),this.handleError(d)))return d}else if(d=this.validateAll(a[e],b.additionalProperties,[e],["additionalProperties"],f))return d}else this.trackUnknownProperties&&!this.knownPropertyPaths[f]&&(this.unknownPropertyPaths[f]=!0)}return null},i.prototype.validateObjectDependencies=function(a,b,c){var d;if(void 0!==b.dependencies)for(var e in b.dependencies)if(void 0!==a[e]){var f=b.dependencies[e];if("string"==typeof f){if(void 0===a[f]&&(d=this.createError(j.OBJECT_DEPENDENCY_KEY,{key:e,missing:f}).prefixWith(null,e).prefixWith(null,"dependencies"),this.handleError(d)))return d}else if(Array.isArray(f))for(var g=0;g<f.length;g++){var h=f[g];if(void 0===a[h]&&(d=this.createError(j.OBJECT_DEPENDENCY_KEY,{key:e,missing:h}).prefixWith(null,""+g).prefixWith(null,e).prefixWith(null,"dependencies"),this.handleError(d)))return d}else if(d=this.validateAll(a,f,[],["dependencies",e],c))return d}return null},i.prototype.validateCombinations=function(a,b,c){return this.validateAllOf(a,b,c)||this.validateAnyOf(a,b,c)||this.validateOneOf(a,b,c)||this.validateNot(a,b,c)||null},i.prototype.validateAllOf=function(a,b,c){if(void 0===b.allOf)return null;for(var d,e=0;e<b.allOf.length;e++){var f=b.allOf[e];if(d=this.validateAll(a,f,[],["allOf",e],c))return d}return null},i.prototype.validateAnyOf=function(a,b,c){if(void 0===b.anyOf)return null;var d,e,f=[],g=this.errors.length;this.trackUnknownProperties&&(d=this.unknownPropertyPaths,e=this.knownPropertyPaths);for(var h=!0,i=0;i<b.anyOf.length;i++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var k=b.anyOf[i],l=this.errors.length,m=this.validateAll(a,k,[],["anyOf",i],c);if(null===m&&l===this.errors.length){if(this.errors=this.errors.slice(0,g),this.trackUnknownProperties){for(var n in this.knownPropertyPaths)e[n]=!0,delete d[n];for(var o in this.unknownPropertyPaths)e[o]||(d[o]=!0);h=!1;continue}return null}m&&f.push(m.prefixWith(null,""+i).prefixWith(null,"anyOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=d,this.knownPropertyPaths=e),h?(f=f.concat(this.errors.slice(g)),this.errors=this.errors.slice(0,g),this.createError(j.ANY_OF_MISSING,{},"","/anyOf",f)):void 0},i.prototype.validateOneOf=function(a,b,c){if(void 0===b.oneOf)return null;var d,e,f=null,g=[],h=this.errors.length;this.trackUnknownProperties&&(d=this.unknownPropertyPaths,e=this.knownPropertyPaths);for(var i=0;i<b.oneOf.length;i++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var k=b.oneOf[i],l=this.errors.length,m=this.validateAll(a,k,[],["oneOf",i],c);if(null===m&&l===this.errors.length){if(null!==f)return this.errors=this.errors.slice(0,h),this.createError(j.ONE_OF_MULTIPLE,{index1:f,index2:i},"","/oneOf");if(f=i,this.trackUnknownProperties){for(var n in this.knownPropertyPaths)e[n]=!0,delete d[n];for(var o in this.unknownPropertyPaths)e[o]||(d[o]=!0)}}else m&&g.push(m.prefixWith(null,""+i).prefixWith(null,"oneOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=d,this.knownPropertyPaths=e),null===f?(g=g.concat(this.errors.slice(h)),this.errors=this.errors.slice(0,h),this.createError(j.ONE_OF_MISSING,{},"","/oneOf",g)):(this.errors=this.errors.slice(0,h),null)},i.prototype.validateNot=function(a,b,c){if(void 0===b.not)return null;var d,e,f=this.errors.length;this.trackUnknownProperties&&(d=this.unknownPropertyPaths,e=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={});var g=this.validateAll(a,b.not,null,null,c),h=this.errors.slice(f);return this.errors=this.errors.slice(0,f),this.trackUnknownProperties&&(this.unknownPropertyPaths=d,this.knownPropertyPaths=e),null===g&&0===h.length?this.createError(j.NOT_PASSED,{},"","/not"):null};var j={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1e3},k={};for(var l in j)k[j[l]]=l;var m={INVALID_TYPE:"invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",KEYWORD_CUSTOM:"Keyword failed: {key} ({message})",CIRCULAR_REFERENCE:"Circular $refs: {urls}",UNKNOWN_PROPERTY:"Unknown property (not in schema)"};f.prototype=Object.create(Error.prototype),f.prototype.constructor=f,f.prototype.name="ValidationError",f.prototype.prefixWith=function(a,b){if(null!==a&&(a=a.replace(/~/g,"~0").replace(/\//g,"~1"),this.dataPath="/"+a+this.dataPath),null!==b&&(b=b.replace(/~/g,"~0").replace(/\//g,"~1"),this.schemaPath="/"+b+this.schemaPath),null!==this.subErrors)for(var c=0;c<this.subErrors.length;c++)this.subErrors[c].prefixWith(a,b);return this};var n={},o=h();return o.addLanguage("en-gb",m),o.tv4=o,o}),c("common/models/serial-model",["angular","jquery","tv4"],function(a,b,c){"use strict";var d=function(a){this._savedState={isPartial:!1,model:{}},this.init(a)};return d.prototype.init=function(a){if(a&&(b.extend(this,a),!this._isSchemaValid()))throw c.error},d.prototype._schema={},d.prototype._serializerMappings={},d.prototype._customSerializers={},d.prototype._deserializerMappings={},d.prototype._customDeserializers={},d.prototype._generateHash=function(){var a=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return[a(),a(),"-",a(),"-",a(),"-",a(),"-",a(),a(),a()].join("")},d.prototype.addGuid=function(){return this.guid=this.guid?this.guid:this._generateHash(),this.guid},d.prototype.serialize=function(b,c,d){if(this.sanitize(),b)return this._customSerializers[b]?this._customSerializers[b](this,c,d):!!this._serializerMappings[b]&&this._serializeByMap(this._serializerMappings[b]);var e={};return a.forEach(this,function(a,b){"_rawData"!==b&&(a._schema?e[b]=a.serialize():e[b]=a)}),e},d.prototype.deserialize=function(a,c,d){if(this._rawData=a,c)return this._customDeserializers[c]?this._customDeserializers[c](a,this,d):!!this._deserializerMappings[c]&&this._deserializeByMap(a,this._deserializerMappings[c],c);var e;try{e=JSON.parse(a)}catch(a){return!1}return e?(b.extend(this,e),this._isSchemaValid()):void 0},d.prototype._serializeByMap=function(a){var b={};for(var c in a)a[c]&&this[c]&&(b[a[c]]=this[c]);return b},d.prototype._deserializeAnyOf=function(a,c,d,e,f){var g={};try{var h=b.isArray(a[d[c]]);for(var i in f.anyOf){if(!h){f=f.anyOf[i].properties;break}if(h&&"undefined"!=typeof f.anyOf[i].properties&&"array"===f.anyOf[i].properties.type){
"undefined"==typeof g[c]&&(g[c]=[]),f=f.anyOf[i].properties.items;break}}var j=f.split("/").pop();if(h){var k=this;b.each(a[d[c]],function(a,b){var d=new k._customTypes[j];d.deserialize(b,e),g[c].push(d)})}else g[c]=new this._customTypes[j],g[c].deserialize(a[d[c]],e)}catch(a){return!1}return g},d.prototype._deserializeElement=function(a,b,c){var d={};for(var e in b)if(b[e]&&"undefined"!=typeof a[b[e]]){var f=this._schema.properties[e];if("string"==typeof f)try{d[e]=new(this._customTypes[f.split("/").pop()]),d[e].deserialize(a[b[e]],c)}catch(a){return!1}else"undefined"!=typeof f&&"undefined"!=typeof f.anyOf?d[e]=this._deserializeAnyOf(a,e,b,c,f):d[e]=a[b[e]]}else if("object"==typeof b[e]&&"array"===this._schema.properties[e].type){d[e]=[];for(var g in a[e])d[e].push(this._deserializeElement(a[e][g],b[e],c))}return d},d.prototype._deserializeByMap=function(a,c,d){var e;if("string"==typeof a)try{e=JSON.parse(a)}catch(a){return!1}else e=a;return!!e&&void b.extend(this,this._deserializeElement(e,c,d))},d.prototype.sanitize=function(){this._sanitizeObject(this,null,this._schema)},d.prototype._sanitizeObject=function(a,c,d){var e=c?a[c]:a;(d.optional===!0&&void 0===e||null===e)&&delete a[c],"undefined"!=typeof e&&d.properties&&b.each(d.properties,function(a,b){this._sanitizeObject(e,a,b)}.bind(this))},d.prototype.saveLastState=function(){this._savedState.model=a.copy(this)},d.prototype._diffModel=function(a,c){var d=null;for(var e in a)if(a.hasOwnProperty(e)&&c.hasOwnProperty(e)){if("object"==typeof a[e]){var f=this._diffModel(a[e],c[e]);f&&(d||(d=b.isArray(a)?[]:b.isPlainObject(a)?{}:new a.constructor),d[e]=f)}else if(a[e]!==c[e]){if(!b.isArray(a))return a;d||(d=[]),d[e]=a[e]}}else!c.hasOwnProperty(e)&&a.hasOwnProperty(e)&&(d||(d={}),d[e]=a[e]);return d},d.prototype.diff=function(){var a=this._diffModel(this,this._savedState.model);return a._savedState.isPartial=!0,a},d.prototype._isSchemaValid=function(){return c.validate(this,this._schema)},d.prototype.reset=function(){for(var a in this)this.hasOwnProperty(a)&&delete this[a]},d}),c("common/models/address-model",["angular","common/models/serial-model"],function(a,b){"use strict";var c=function(a){this.init(a)};return c.prototype=new b,c.prototype.constructor=c,c.prototype._schema={type:"object",properties:{name:{type:"string",optional:!0},addressOne:{type:"string"},address1:{type:"string"},addressTwo:{type:"string",optional:!0},address2:{type:"string",optional:!0},cardNumber:{type:"string",optional:!0},city:{type:"string"},state:{type:"string",optional:!0},country:{type:"string"},zipCode:{type:"string",optional:!0},postalCode:{type:"string",optional:!0},addressType:{type:"string",optional:!0},primary:{type:"boolean",optional:!0},addressName:{type:"string",optional:!0},index:{type:"number",optional:!0}}},c.prototype._elevateMap={address1:"address1",address2:"address2",addressOne:"addressOne",addressName:"addressName",addressTwo:"addressTwo",addressType:"addressType",cardNumber:"cardNumber",city:"city",country:"country",postalCode:"postalCode",primary:"primary",sequenceNum:"sequenceNum",state:"state",zipCode:"zipCode"},c.prototype._defaultMap={addressOne:"addressOne",addressTwo:"addressTwo",city:"city",state:"state",country:"country",zipCode:"zipCode",addressType:"addressType",addressName:"addressName"},c.prototype._purchaseMap={addressOne:"addressOne",addressTwo:"addressTwo",city:"city",state:"state",country:"country",zipCode:"zipCode",addressType:"addressType",addressName:"addressName"},c.prototype._editMap={addressOne:"addressOne",addressTwo:"addressTwo",city:"city",state:"state",country:"country",zipCode:"zipCode",addressName:"addressName",sequenceNum:"sequenceNum"},c.prototype._visaCheckout={addressOne:"addressOne",city:"city",state:"state",country:"country",zipCode:"zipCode",addressName:"nickname"},c.prototype._billingAddressCustomDeserializer=function(b,c){var d,e="HOME";b.addressName?d=b.addressName:b.sequenceNum&&(d=e+" "+b.sequenceNum),a.extend(c,{addressName:d,address1:b.addressOne,address2:b.addressTwo,addressType:e,cardNumber:b.cardNumber,city:b.city,country:b.country,postalCode:b.zipCode,sequenceNum:b.sequenceNum,state:b.state})},c.prototype._elevateCustomDeserializer=function(b,c){var d=b.addressName?b.addressName:b.addressType+" "+b.sequenceNum;a.extend(c,{addressOne:b.addressOne,addressTwo:b.addressTwo,city:b.city,state:b.state,country:b.country,zipCode:b.zipCode,addressType:b.addressType,addressName:d,primary:b.primary,sequenceNum:b.sequenceNum})},c.prototype._applicationModelCustomDeserializer=function(b,c){a.extend(c,{addressOne:b.getApplicantAddressOne(),addressTwo:b.getApplicantAddressTwo(),city:b.getApplicantCity(),state:b.getApplicantState(),country:"US",zipCode:b.getApplicantZipCode(),addressType:"HOME",addressName:"HOME",primary:!0,sequenceNum:1})},c.prototype._creditCardResponse=function(b,c){a.extend(c,{addressOne:b.addressOne,city:b.city,state:b.state,country:"US",zipCode:b.zipCode,addressType:"HOME",addressName:"HOME"})},c.prototype._deserializerMappings={pnr:c.prototype._defaultMap,edit:c.prototype._editMap},c.prototype._serializerMappings={purchase:c.prototype._purchaseMap,elevate:c.prototype._elevateMap,edit:c.prototype._editMap,visaCheckout:c.prototype._visaCheckout},c.prototype._customDeserializers={billingAddress:c.prototype._billingAddressCustomDeserializer,elevate:c.prototype._elevateCustomDeserializer,creditCardApplication:c.prototype._applicationModelCustomDeserializer,creditCardResponse:c.prototype._creditCardResponse},c}),c("common/models/payment-option-model",["angular","moment","common/models/serial-model","common/models/address-model"],function(a,b,c,d){"use strict";var e=function(a){this.init(a),this.guid=this.addGuid()};return e.prototype=new c,e.prototype._schema={type:"object",properties:{guid:{type:"string",optional:!0},ccNumber:{type:"string",optional:!0},tbNumber:{type:"string",optional:!0},paymentAmount:{type:"number",optional:!0},securityCode:{type:"string",minLength:3,maxLength:4,optional:!0},type:{type:"string"},expiryDate:{type:"string",optional:!0},expireMonth:{type:"integer",optional:!0},expireYear:{type:"integer",optional:!0},summary:{type:"string",optional:!0},nickname:{type:"string",optional:!0},cardHolderName:{type:"string",optional:!0},mapAddressId:{type:"number",optional:!0},mapAdressId:{type:"number",optional:!0},shouldSave:{type:"boolean",optional:!0},changed:{type:"boolean",optional:!0},sequenceNum:{type:"number"},callid:{type:"string",optional:!0},addressList:{type:"array",optional:!0,items:"#/definitions/AddressModel"},address:{anyOf:[{properties:"#/definitions/AddressModel"},{type:"number"}]}}},e.prototype._customTypes={AddressModel:d},e.prototype._customSerializers={purchase:function(b){var c={};return b.callid?a.extend(c,{ccNumber:b.callid,cardType:e.VISACO}):(a.extend(c,{ccNumber:b.ccNumber,securityCode:b.securityCode,cardType:b.type.toUpperCase(),expiryDate:b.expiryDate,paymentAmount:b.paymentAmount,cardHolderName:b.cardHolderName,sequenceNum:b.sequenceNum,identifiedName:b.nickname}),b.shouldSave&&!c.sequenceNum&&(c.sequenceNum=0)),c},edit:function(a){a._parseExpiryDates(a,a.type);var b={ccNumber:a.ccNumber,securityNumber:a.securityCode,cardholderName:a.cardHolderName,mapAddressId:a.mapAddressId||a.mapAdressId,nickname:a.nickname,expireYear:a.expireYear,expireMonth:a.expireMonth,expiryDate:a.expiryDate,type:a.type,sequenceNum:a.sequenceNum};return b},elevate:function(a){return{changed:a.changed,ccNumber:a.ccNumber,securityCode:a.securityCode,cardType:a.type,expiryDate:a.expiryDate,identifiedName:a.nickname,mapAddressId:a.mapAddressId,nameOnCard:a.cardHolderName,sequenceNum:a.sequenceNum,primary:a.primary}}},e.prototype._elevateMap={ccNumber:"ccNumber",securityCode:"securityCode",type:"cardType",expiryDate:"expiryDate",mapAddressId:"mapAddressId",nameOnCard:"nameOnCard",sequenceNum:"sequenceNum",primary:"primary",nickname:"identifiedName"},e.prototype._serializerMappings={purchase:e.prototype._elevateMap},e.prototype._deserializerMappings={purchase:{ccNumber:"ccNumber",securityCode:"securityCode",type:"cardType",expiryDate:"expiryDate"},pnr:{ccNumber:"ccNumber",tbNumber:"tbNumber",type:"cardType",nameOnCard:"cardHolderName",amountCharged:"amountCharged"}},e.prototype._customDeserializers={elevate:function(b,c){c._parseExpiryDates(b,b.cardType);var f=b.identifiedName;if(!b.identifiedName&&b.cardType&&b.cardType.toLowerCase()!==e.TRAVELBANK&&(f=b.cardType+" "+b.sequenceNum),a.extend(c,{ccNumber:b.ccNumber,type:b.cardType||b.type,cardHolderName:b.cardHolderName,mapAddressId:b.mapAddressId,changed:b.changed,primary:b.primary,nickname:f,sequenceNum:b.sequenceNum}),Array.isArray(b.addressInfo)){c.addressList=[];var g;for(var h in b.addressInfo)g=new d,g.deserialize(b.addressInfo[h],"elevate"),c.addressList.push(g);!c.mapAddressId&&c.addressList.length>0?c.address=c.addressList[0]:c.address=c.addressList[c.mapAddressId]}},edit:function(b,c){c._parseExpiryDates(b,b.cardType),a.extend(c,{cardHolderName:b.cardHolderName,ccNumber:b.ccNumber,changed:b.changed,expiryDate:b.expireDate,mapAddressId:b.mapAddressId,nickname:b.identifiedName,primary:b.primary,type:b.cardType})},creditCardApplication:function(b,c){var e=new d;e.deserialize(b,"creditCardApplication"),a.extend(c,{ccNumber:b.getAccountNumber(),type:"VISA",typeTempCard:b.isCardTypePremium()?"VXPREMIUM":"VXBASE",expiryDate:b.getExpirationDate(),securityCode:b.getSecurityCode(),address:e,cardHolderName:b.getApplicantName()})},visaCheckout:function(b,c){a.extend(c,{ccNumber:b.ccNumber,type:b.type,address:b.address,callid:b.callid})}},e.VISA="visa",e.AMEX="amex",e.MASTER="mastercard",e.DISCOVER="discover",e.UATP="uatp",e.VIRGIN="virgin",e.TRAVELBANK="travelbank",e.VXPREMIUM="vxpremium",e.VXBASE="vxbase",e.VISACO="VISACO",e.OPTION_NAMES={visa:"Visa",amex:"American Express",mastercard:"MasterCard",discover:"Discover",uatp:"UATP",virgin:"Virgin America Card",travelbank:"Travel Bank",vxpremium:"Virgin America Premium",vxbase:"Virgin America Card",visaco:"Visa Checkout"},e.prototype.getTitle=function(){var a="";return this.type===e.VIRGIN||this.type===e.TRAVELBANK?a=e.OPTION_NAMES[this.type.toLowerCase()]:this.type&&(a=e.OPTION_NAMES[this.type.toLowerCase()]+" ending "+this.ccNumber.toString().substr(-4)),a},e.prototype.isExpired=function(){if(this.callid)return!1;this._parseExpiryDates(this);var a=this.expireYear,c=this.expireMonth,d=b([a,c].join("-")),e=b([a,c,d.daysInMonth()].join("-"));return e.isBefore(b())},e.prototype._parseExpiryDates=function(b,c){if(!c||c.toLowerCase()!==e.TRAVELBANK)if(!b.expiryDate||b.expireMonth&&b.expireYear)!b.expiryDate&&b.expireMonth&&b.expireYear&&a.extend(this,{expireMonth:b.expireMonth,expireYear:b.expireYear,expiryDate:b.expireYear+"-"+b.expireMonth});else{var d=b.expiryDate.split("-");a.extend(this,{expireDate:b.expireDate,expireMonth:parseInt(d[1]),expireYear:parseInt(d[0])})}},e}),c("common/models/fareinfo-model",["angular","common/models/serial-model"],function(a,b){"use strict";var c=function(a){this.init(a)};return c.prototype=new b,c.prototype._schema={type:"object",properties:{totalBaseFare:{type:"number"},totalTax:{type:"number"},totalFare:{type:"number"},totalPoints:{type:"number",optional:!0},fareDetails:{type:"array",properties:{type:{type:"string"},paxAmount:{type:"integer"},baseFare:{type:"number"},taxPerPax:{type:"number"},farePerPax:{type:"number"},totalFare:{type:"number"},pointsPerPax:{type:"number",optional:!0},taxListPerPax:{type:"array",items:{type:"object",properties:{code:{type:"string"},amount:{type:"number"}}}}}}}},c.prototype._deserializeTaxes=function(a){var b,c,d,e={};for(b=0,c=a.length;b<c;b++)d=a[b],e[d.taxCode]=d.taxAmount;return e},c.prototype._deserializeFare=function(b,c){c.totalBaseFare=b.totalBaseFare,c.totalTax=b.totalTax,c.totalFare=b.totalFare,c.totalPoints=b.totalPoints,c.fareDetails=[];var d={type:"adult",paxAmount:b.adultFare.numOfPax,baseFare:b.adultFare.adultBaseFarePerPax,taxPerPax:b.adultFare.adultTaxPerPax,farePerPax:b.adultFare.adultFarePerPax,totalFare:b.adultFare.totalAdultFare,pointsPerPax:b.adultFare.totalPointsPerPax};if(a.isArray(b.adultFare.taxListPerPax)&&(d.taxListPerPax=c._deserializeTaxes(b.adultFare.taxListPerPax)),c.fareDetails.push(d),b.infantFare){var e={type:"infant",paxAmount:b.infantFare.numOfPax,baseFare:b.infantFare.infantBaseFarePerPax,taxPerPax:b.infantFare.infantTaxPerPax,farePerPax:b.infantFare.infantFarePerPax,totalFare:b.infantFare.totalInfantFare,pointsPerPax:b.infantFare.totalPointsPerPax};a.isArray(b.infantFare.taxListPerPax)&&(e.taxListPerPax=c._deserializeTaxes(b.infantFare.taxListPerPax)),c.fareDetails.push(e)}},c.prototype._customDeserializers={fare:c.prototype._deserializeFare},c.prototype._customSerializers={lockInventory:function(b){var c=a.extend({},b._rawData),d=b._rawData.infantFare;return d&&!d.totalInfantFare&&delete c.infantFare,c}},c}),c("common/models/flight-model",["angular","moment","common/models/serial-model"],function(a,b,c){"use strict";var d=function(a){this.init(a)};return d.prototype=new c,d.FLIGHT_TYPES={NON_STOP:"nonStop",CONNECTING:"connecting",THRU:"thru"},d.prototype._schema={type:"object",properties:{flightId:{type:"number"},flightNum:{type:"string"},aircraftType:{type:"string"},arrival:{type:"string"},arrivalDateTime:{type:"string"},updatedDepartureDateTime:{type:"string",optional:!0},updatedArrivalDateTime:{type:"string",optional:!0},classOfService:{type:"string"},fareBasisCode:{type:"string",optional:!0},cabinClass:{type:"string"},cabinType:{type:"string"},departure:{type:"string"},departureDateTime:{type:"string"},flownSegment:{type:"boolean"},marketingAirline:{type:"string"},operatingAirline:{type:"string"},segNum:{type:"number"},status:{type:"string"},withinACSWindow:{type:"boolean"},changeSeatOption:{type:"object"},thruFlight:{type:"boolean"},isUpgraded:{type:"boolean",optional:!0},isRedEye:{type:"boolean",optional:!0},tier:{type:"string",optional:!0},oAndDId:{type:"string",optional:!0}}},d.prototype.getDepartureTime=function(){if(!this.departureTime){var a=b(this.departureDateTime,"YYYY-MM-DD HH:mm Z");this.departureTime=a.zone(this.departureDateTime).format("h:mma")}return this.departureTime},d.prototype.getArrivalTime=function(){if(!this.arrivalTime){var a=b(this.arrivalDateTime,"YYYY-MM-DD HH:mm Z");this.arrivalTime=a.zone(this.arrivalDateTime).format("h:mma")}return this.arrivalTime},d.prototype.getDuration=function(){if(!this.duration){var a=b(this.departureDateTime,"YYYY-MM-DD HH:mm Z"),c=b(this.arrivalDateTime,"YYYY-MM-DD HH:mm Z");this.duration=c.subtract(a).format("h[h] mm[m]")}return this.duration},d.prototype._deserializerMappings={defaultMap:{flightId:"flightId",flightNum:"flightNum",thruFlight:"thruFlight",aircraftType:"aircraftType",cabinType:"cabinType",cabinClass:"cabinClass",arrival:"arrival",arrivalDateTime:"arrivalDateTime",updatedArrivalDateTime:"updatedArrivalDateTime",classOfService:"classOfService",fareBasisCode:"fareBasisCode",departure:"departure",departureDateTime:"departureDateTime",updatedDepartureDateTime:"updatedDepartureDateTime",flownSegment:"flownSegment",marketingAirline:"marketingAirline",operatingAirline:"operatingAirline",segNum:"segNum",status:"status",withinACSWindow:"withinACSWindow",changeSeatOption:"changeSeatOption"}},d.prototype._defaultSerializer=function(b){var c={aircraftType:b.aircraftType,flightNum:b.flightNum,departure:b.departure,arrival:b.arrival,arrivalDateTime:b.arrivalDateTime,departureDateTime:b.departureDateTime,classOfService:b.classOfService,cabinType:b.cabinType,tier:b.tier,segNum:b.segNum,fareBasisCode:b.fareBasisCode};return b.tiers&&(c.tiers={},a.forEach(b.tiers,function(a,b){c.tiers[b]=a.serialize()})),c},d.prototype._customSerializers={defaultMap:d.prototype._defaultSerializer},d.prototype._serializerMappings={ancillaries:{aircraftType:"aircraftType",flightNum:"flightNum",departure:"departure",arrival:"arrival",arrivalDateTime:"arrivalDateTime",departureDateTime:"departureDateTime",classOfService:"classOfService",cabinType:"cabinType",segNum:"segNum",fareBasisCode:"fareBasisCode"}},d}),c("core/constants/resource-bundle",[],function(){"use strict";var a={laxAlaskaLounge:"Alaska Lounge at LAX",fareSelector:{invalidDateMinuteBuffer:90},cityPicker:{airportAliases:["NYC","WAS"]},changeGuider:{changeDates:"Change: Select new dates",changeCities:"Change: Select new cities",changeFares:"Change: Select new fare",changeFaresExtended:"Change: Select new fare type",changeAncillaries:"Change: Select new extras",changeSeats:"Change: Select new seats",reviewChanges:"Change: Review changes",submitPayment:"Change: Submit payment"},ical:{subjectPrefix:"Virgin America"},ancillaryCopy:{bundleIncluded:"{{title}} is not available because some perks already come with your benefits."},checkIn:{status:{NOT_AVAILABLE:"Not available",INCLUDED:"Included",CLOSED:"Closed"},dayLimit:2,loungeOptions:{continueButton:{none:"No thanks",unavailable:"Continue",selected:"Continue"},continueText:{none:"Continue without lounge",unavailable:"Sorry, no lounges available.",selected:"{number} lounge selected"},IAD:{options:["Complimentary Drinks","Free Food","Free WiFi","Luxury Seating"]},JFK:{options:["Complimentary Drinks","Free Food","Free WiFi","Luxury Seating","Spa Services"]},LAX:{options:["Complimentary Drinks","Free Food","Free WiFi","Luxury Seating","Views"]},SFO:{options:["Complimentary Drinks","Free Food","Free WiFi","Luxury Seating"]}},upgradeOptions:{mc:{title:"Main Cabin",options:["Less leg room","No free movies","No free food","Regular boarding"]},mce:{title:"Main Cabin Express",options:["More leg room","Free movies","Free food","Early boarding","Priority security"]},mcs:{title:"Main Cabin Select",options:["Early Boarding","Priority Security","More Leg Room","Free Food","Free Movies"]},first:{title:"First Class",options:["Luxury Seating","Dedicated Cabin Space","Priority Security","Early Boarding","Free Food","Free Movies"]}},ancillaryOptions:{continueButton:{NONE:"No thanks",SELECTED:"Continue",INCLUDED:"No thanks"},continueText:{NONE:"Continue without",SELECTED:"Continue with ",INCLUDED:"Continue with Included"}},baggage:{heading:'Checked bags are $25 each. (Elevate/Mileage Plan status, credit card and certain fare types include additional bags as a benefit, see <a href="/cms/vx-fees" target="_blank">Fees</a> for benefit rules.)*'}},elevate:{favoriteDestinations:["Atlanta, GA","Austin, TX","Baltimore, MD","Boston, MA","Cancun, Mexico","Charlotte, NC","Chicago, IL","Cincinnati, OH","Cleveland, OH","Dallas, TX","Denver, CO","Detroit, MI","Fort Lauderdale, FL","Fort Myers, FL","Hartford, CT","Honolulu, HI","Houston, TX","Indianapolis, IN","Jacksonville, FL","Kansas City, MO","Las Vegas, NV","Los Angeles, CA","Los Cabos, Mexico","Long Beach, CA","Maui/Kahului, HI","Miami, FL","Milwaukee, WI","Minneapolis, MN","Nashville, TN","New York, NY","Newark, NJ","New Orleans, LA","Oakland, CA","Orange County, CA","Orlando, FL","Palm Springs, CA","Philadelphia, PA","Phoenix, AZ","Pittsburgh, PA","Providence, RI","Portland, OR","Raleigh-Durham, NC","Sacramento, CA","Salt Lake City, UT","San Antonio, TX","San Diego, CA","San Francisco, CA","San Jose, CA","Seattle, WA","St. Louis, MO","Tampa, FL","Toronto, ON","Washington, DC","West Palm Beach, FL"],navBarLinks:{loggedOut:[{value:"/cms/elevate-frequent-flyer",name:"About Elevate"},{value:"/cms/elevate-frequent-flyer/earn-points",name:"Earn Points"},{value:"/cms/elevate-frequent-flyer/redeem-points",name:"Redeem Points"},{value:"/cms/elevate-frequent-flyer/status",name:"Status"},{value:"/cms/elevate-frequent-flyer/partners",name:"Partners"},{value:"/cms/elevate-frequent-flyer/convert-points",name:"Convert Points"},{value:"/cms/elevate-frequent-flyer/partners/credit-card",name:"Credit Card"}],loggedIn:[{value:"/elevate-frequent-flyer/landing",name:"Overview"},{value:"/elevate-frequent-flyer/my-account",name:"My Account"},{value:"/cms/elevate-frequent-flyer",name:"About Elevate"},{value:"/cms/elevate-frequent-flyer/earn-points",name:"Earn Points"},{value:"/cms/elevate-frequent-flyer/redeem-points",name:"Redeem Points"},{value:"/cms/elevate-frequent-flyer/status",name:"Status"},{value:"/cms/elevate-frequent-flyer/partners",name:"Partners"},{value:"/cms/elevate-frequent-flyer/convert-points",name:"Convert Points"},{value:"/cms/elevate-frequent-flyer/partners/credit-card",name:"Credit Card"},{value:"LOGOUT",name:"SIGN OUT"}]}},statusMessages:{irop:{flightCancelled:{DESC:"<strong>Sorry, we can't check you in.</strong><br/>You can change or cancel your itinerary for free.*"},changedCities:{DESC:"Heads up! Free changes only apply to your original origin and destination."},outsideSegmentRange:{DESC:"Heads up! There are changes and fees for dates outside of {{startDate}} and {{endDate}}."},fareNotification:{DESC:"It is free to change to fares in {{fareClass}}."}},checkIn:{addExtra:{DESC:"Add {{ancillaryTitle}}"},addPassportInfo:{DESC:"Complete {{name}}'s passport information"},upgradeYourSeat:{DESC:"Wanna Upgrade?"},upgradeYourSeatConnecting:{DESC:"Wanna Upgrade? | {{departure}} - {{arrival}}"},selectLoungeOptions:{DESC:"Chill in Style."},selectLoungeOptionsConnecting:{DESC:"Chill in Style. | {{departure}} - {{arrival}}"},changeYourSeats:{DESC:"Change your seats?"},numberOfBags:{DESC:"How many bags?"},payment:{DESC:"Payment"},international:{DESC:"Sorry. We can't check you in online. Please check in at the airport."},seatSelectionUnavailable:{DESC:"Sorry. Seat selection unavailable."}},peoplePicker:{travelersSelected:{DESC:"Got it. <strong>{{travelers}}.</strong>"}},travelerInfo:{namesMustBeUnique:{DESC:"Names must be unique!"}},login:{failed:{DESC:"<strong>Oops</strong>. Bad username or password. Please try again."},signInChallenge:{DESC:"Enter info or sign in."}},elevate:{signUpSuccess:{DESC:"Success! You are now an Elevate member and should have received an email confirmation."}},calendar:{selectReturnDate:{DESC:"Great, now pick your return date."},selectReturnDateMultiCity:{DESC:"Great, now pick your second date."},completeOneWay:{DESC:"<strong>{{tripStart}}.</strong> One way trip complete."},completeSameDay:{DESC:"<strong>{{tripStart}}.</strong> Looks good!"},completeRoundTrip:{DESC:'<strong>{{monthStart}} {{(monthStart === monthEnd) ? tripStartDay + "-" + tripEndDay : tripStartDay + "-" + tripEnd}},</strong> looks good.'},seasonalAvailability:{TITLE:"Hey!",DESC:"Flights to {{destinationCity}} start {{startDate}}."},noFlyDays:{TITLE:"Hey!",DESC:"Flights to {{destinationCity}} are only on certain days."}},fare:{complete:{DESC:"Looks good. <strong>{{departureTime}} in {{classOfService}}.</strong>"},pointsSignIn:{DESC:"You need to log into your elevate account to book a flight with points."},pickReturnDate:{DESC:"Nice. Now pick your returning flight."},pickMultiCityLeg2:{DESC:"Nice. Now pick your second flight."},notEnoughElevatePoints:{DESC:"Not enough points yet. Consider flying more often!"},jumped:{DESC:"<strong>Uh oh!</strong> Seems like the price jumped a bit."},noFlights:{DESC:"<strong>Uh oh!</strong> No flights found."},invalidDate:{DESC:"Departing and return flights cannot overlap. Please consider adding appropriate time between flights."},invalidDateMultiCity:{DESC:"The arrival of your first flight cannot overlap with the departure of your second flight. Please check the flight times."},restrictedDates:{TITLE:"Hey!",DESC:"We don't fly from {{dep}} to {{des}} on that date."},alaskaToManyPassengers:{DESC:'<div>Please call to arrange this booking.</div><div class="small lowercase">Call <a href="tel:+18002527522">1 (800) 252-7522</a> to book travel with more than 7 guests to this Alaska Airlines destination.</div>'}},ancillariesSelector:{ancillariesSelected:{DESC:"{{title}} added!"}},seatMap:{travellerMightBeReaccommodated:{DESC:"3C or 3D seating may be reassigned if a disabled guest requires the seat."}},booker:{multiCitySelected:{DESC:"Thumbs up."},citiesSelected:{DESC:"{{intro}} <strong>{{fromAirportCode}} to {{toAirportCode}}.</strong>"},TIMER_START:{TITLE:"Hey!",DESC:"We can only hold this price for 15 minutes."},TIMER_FOUR:{TITLE:"Hey!",DESC:"You have 4 minutes to finish paying."},TIMER_TWO:{TITLE:"Heads up!",DESC:"You have {{timeLeft()|date:'mm:ss'}} to finish paying."},TIMER_END:{TITLE:"Hey!",DESC:"We ran out of time, please re-select your flight."},petsNumberExceeded:{DESC:"We love our four-legged friends but unfortunately we have reached the maximum number of pet carriers allowed."}},purchase:{purchaseDeclined:{TITLE:"Uh oh.",DESC:" The transaction has been declined"},insuranceTravelBank:{TITLE:"Hey!",DESC:"You can't pay for insurance with Travel Bank, please select a credit card."},cardExpired:{TITLE:"Your credit card has expired.",DESC:"Please update the expiration date, or choose another form of payment."},extrasPriceIncrease:{DESC:"The price of one or more of your extras has changed. Please press accept to continue."},petsNotAvailable:{DESC:'Pets aren\'t available for <span ng-repeat="flight in flights">flight <strong>#{{flight.flightNum}} {{flight.departure}} - {{flight.arrival}}</strong><span ng-if="!$last"> & </span></span>.</br>Please choose another flight, or change your travel party'},visaCheckoutFailed:{DESC:"Visa Checkout is unavailable please use another form of payment."},visaCheckoutSandboxAPIKey:"ODT3AX559EEZPQ4LCBR213-4W5pnlbRO1cQRFolrLYnYL2V20",visaCheckoutProdApiKey:"S6QC6BCQYCUF3ZTRMBZE14vTMLeTCOAOa2XpisqcAtlp-db7M"},seatSelector:{selectRemainingSeats:{DESC:'Pick <strong>{{firstName}}\'s</strong> seat for {{departure}} to {{arrival}}. (<a href="#" class="link-skip" ng-click="statusBar.publish(\'seatSelector.skipSeatSelection\', [{{segmentIndex}}])">skip</a>)'},changeSeat:{DESC:'Pick <strong>{{firstName}}\'s</strong> seat for {{departure}} to {{arrival}}. (<a href="#" class="link-skip" ng-click="statusBar.publish(\'seatSelector.keepCurrentSeat\', [\'{{travelerGuid}}\',{{segmentIndex}}])">skip</a>)'},upgradeSeat:{DESC:"Pick <strong>{{firstName}}'s</strong> upgraded seat."}},error:{general:{DESC:"<strong>Oops</strong>. Something went wrong. Please try again."}},modal:{itinerarySent:{DESC:'<span class="status-bar-email-message">Itinerary sent! {{addresses}} will receive this itinerary shortly.</span>'},passportInfoAdded:{DESC:"Great. We’ve added passport info for {{name}}."},flightAlertsSuccess:{DESC:"You’re all set to receive departure information for your upcoming flights."}},flightStatus:{noFlights:{DESC:"Sorry, there are no flights for this search."}},flightAlerts:{dateInPast:{DESC:"That date is in the past. Please pick another date."}}},taxCodes:{AY:{DESC:"September 11th Security Fee"},US1:{DESC:"Federal Excise Tax"},US2:{DESC:"Federal Excise Tax"},US:{DESC:"Federal Excise Tax"},ZP:{DESC:"Segment Fee"},XF:{DESC:"Passenger Facility Charge"},XA:{DESC:"US APHIS User Fee"},XY:{DESC:"Federal Inspection Fee"},SQ:{DESC:"Airport Improvement Tax"},CA:{DESC:"Canadian Air Security Charge"},XG:{DESC:"Goods and Service Tax"},RC:{DESC:"Ontario Harmonized Tax"},UK:{DESC:"Mexico Tourism Tax"},XD:{DESC:"Mexico Airport Tax"},XO:{DESC:"Mexico IVA Transportation Tax"},YC:{DESC:"US International Arrival Departure tax"},YX:{DESC:"Mexico Surcharge"},MCE:{DESC:"Main Cabin Express"},INFANT:{DESC:"Infant fees"},INSURANCE:{DESC:"Travel Insurance"},PETC:{DESC:"Pets fee"},UNSUPPORTED:{DESC:"US Customs User Fee"}},intlTaxCodes:{US2:{DESC:"Intl Arrival/Departure Tax"}},flightAlerts:{notificationFrequency:[{name:"1 hour before departure",value:60},{name:"2 hours before departure",value:120},{name:"3 hours before departure",value:180}]},modal:{fareInfo:{SIZE:"large",TYPE:"custom",TITLE:"Info",TEMPLATE_URL:"/app/book/templates/modals/fare-info.tpl.html"},pets:{SIZE:"medium",TITLE:"Traveling with a pet?",TYPE:"default",TEMPLATE_URL:"/app/book/templates/modals/pets.tpl.html"},flightDetails:{SIZE:"med-low",TITLE:"Flight {{flightDetails.flightNum}} Information",TYPE:"default",TEMPLATE_URL:"/app/flight-status/templates/modals/flight-details.tpl.html"},seatChangeAccept:{SIZE:"medium",TITLE:"Your Seat Selection",TYPE:"default",TEMPLATE_URL:"/app/book/templates/modals/seat-selection.tpl.html"},refundableFaresNotice:{SIZE:"medium",TITLE:"Refundable Fares Notice",TYPE:"default",TEMPLATE_URL:"/app/book/templates/modals/refundable-fares-notice.tpl.html"},iropCancelNotice:{SIZE:"medium",TITLE:"Refund Notice",TYPE:"default",TEMPLATE_URL:"/app/book/templates/modals/irop-cancel-notice.tpl.html"},privacyPolicy:{SIZE:"medium",TITLE:"Privacy Policy",TYPE:"default",TEMPLATE_URL:"/app/common/templates/modals/privacy-policy.tpl.html"},primaryTraveler:{SIZE:"small",TITLE:"Canceling and Changing Flights",TYPE:"default",TEMPLATE_URL:"/app/book/templates/modals/primary-traveler.tpl.html"},cabinAvailability:{SIZE:"medium",TITLE:"Seat selection unavailable, but you can still book this flight.",TYPE:"default",TEMPLATE_URL:"/app/book/templates/modals/cabin-availability.tpl.html"},cvv:{SIZE:"medium",TITLE:"Where is my CVV?",TYPE:"default",TEMPLATE_URL:"/app/purchase/templates/modals/cvv.tpl.html"},dynamicFareRules:{SIZE:"medium",TITLE:"Fare Rules",TYPE:"default",TEMPLATE_URL:"/app/common/templates/modals/dynamic-fare-rules.tpl.html"},forgotPassword:{SIZE:"small",TITLE:"Forgot password?",TYPE:"default",TEMPLATE_URL:"/app/common/templates/modals/forgot-password.tpl.html"},fareSignIn:{SIZE:"small",TITLE:"Sign in to Elevate",TYPE:"default",TEMPLATE_URL:"/app/book/templates/modals/sign-in.tpl.html"},elevateOptionalFields:{SIZE:"medium",TITLE:"Information on optional fields",TYPE:"default",TEMPLATE_URL:"/app/elevate/templates/modals/optionals.tpl.html"},elevateTAndCs:{SIZE:"medium",TITLE:"Virgin America Visa Signature® Credit Cards Terms & Conditions",TYPE:"default",TEMPLATE_URL:"/app/elevate/templates/modals/terms-conditions.tpl.html"},miniSeatmap:{SIZE:"small",TYPE:"default",TEMPLATE_URL:"/app/book/templates/modals/mini-seatmap.tpl.html"},flightAlertsRules:{SIZE:"medium",TEMPLATE_URL:"/app/flight-alerts/templates/modals/rules.tpl.html",TITLE:"Virgin America Flight Alerts Program Overview",TYPE:"default"},peoplePicker:{SIZE:"small",TYPE:"custom",TITLE:"Who's Flying?",TEMPLATE_URL:"/app/book/templates/modals/people-picker.tpl.html"},airportPicker:{SIZE:"small",TYPE:"custom",TITLE:"Select Departure City",ALT_TITLE:"Select Arriving City",TEMPLATE_URL:"/app/book/directives/book-airport-picker.tpl.html"},printReceipt:{SIZE:"small",TITLE:"Print Receipt",TYPE:"default",TEMPLATE_URL:"/app/common/templates/modals/print-receipt.tpl.html"},invalidSevenDayResponse:{SIZE:"medium",TYPE:"custom",TITLE:"Change departure date?",TEMPLATE_URL:"/app/common/templates/modals/invalid-seven-day-selection.tpl.html"},travelerInfoAvatarPicker:{TYPE:"tight",TEMPLATE_URL:"/app/common/templates/modals/traveler-info-avatar-picker.tpl.html"},extrasWarning:{SIZE:"medium",TYPE:"default",TITLE:"Your Flight Extras",TEMPLATE_URL:"/app/common/templates/modals/extras-warning.tpl.html"},allyDepartureDate:{SIZE:"small",TITLE:"Departure Options",TYPE:"default",TEMPLATE_URL:"/app/book/templates/modals/ally-departure-date.tpl.html"}},genders:[{name:"Female",value:"FEMALE"},{name:"Male",value:"MALE"}],genderPronouns:{MALE:"he",FEMALE:"she"},months:[{value:1,name:"Jan"},{value:2,name:"Feb"},{value:3,name:"Mar"},{value:4,name:"Apr"},{value:5,name:"May"},{value:6,name:"Jun"},{value:7,name:"Jul"},{value:8,name:"Aug"},{value:9,name:"Sep"},{value:10,name:"Oct"},{value:11,name:"Nov"},{value:12,name:"Dec"}],longMonths:[{value:1,name:"January"},{value:2,name:"February"},{value:3,name:"March"},{value:4,name:"April"},{value:5,name:"May"},{value:6,name:"June"},{value:7,name:"July"},{value:8,name:"August"},{value:9,name:"September"},{value:10,name:"October"},{value:11,name:"November"},{value:12,name:"December"}],ages:{MAX_ADULT_AGE_YEARS:109,MIN_ADULT_AGE_YEARS:18,MIN_CHILD_AGE_YEARS:2,MAX_INFANT_MONTHS_IN_FUTURE:11},ancillaryIds:{BAG:"0GO",PET:"0BT",SEAT:"0B5",BOARD:"0G6",POWER:"POW"},warningCodes:{SEAT_PRICE_ERROR:"1310926",ANCILLARY_PRICE_ERROR:"1310937"},cabinClassVXToUiMap:{MC_NONREFUNDABLE:"main",MC_REFUNDABLE:"mainRefundable",
MCS_NONREFUNDABLE:"mcs",MCS_REFUNDABLE:"mcsRefundable",FIRST_NONREFUNDABLE:"first",FIRST_REFUNDABLE:"firstRefundable"},cabinClassToTier:{main:"main",mainRefundable:"main",mce:"mce",mcs:"mcs",mcsRefundable:"mcs",first:"first",firstRefundable:"first"},flightInformation:{tier:{name:{FIRST:"FIRST CLASS",MCS:"MAIN CABIN SELECT",MCE:"MAIN CABIN",MC:"MAIN CABIN"},emergencyExit:"EXIT ROW"},multiCityLeg:{name:{0:"SELECT SEATS"}},leg:{name:{0:"DEPARTING SEATS",1:"RETURNING SEATS"}},cabinClass:{main:"MAIN CABIN",mainRefundable:"MAIN CABIN",mcs:"MAIN CABIN SELECT",mcsRefundable:"MAIN CABIN SELECT",first:"FIRST CLASS",firstRefundable:"FIRST CLASS"},cabinDesc:{main:"Surf the web, watch your favorite shows, and pay $25 for each checked bag. Non-refundable fare. See a full list of fees here.",mainRefundable:"Get the Main Cabin feel with 100% refundable fares. Plus, one free checked bag and access to Express seats. ",mcs:"Enjoy free food and entertainment, one free checked bag, priority boarding and security, and more. Non-refundable fare.",mcsRefundable:"Enjoy free food and entertainment, one free checked bag, priority boarding and security, and more.",first:"Keep it classy with white leather seats, unlimited free entertainment, food and drinks. Plus, two free checked bags. Non-refundable fare with no change fee.",firstRefundable:"Need some flexibility? Change your plans on a whim with fully refundable fares and two free checked bags."},cabinBaggage:{main:0,mainRefundable:1,mcs:1,mcsRefundable:1,first:2,firstRefundable:2},ancillaryCabinNames:{main:"MAIN CABIN",mainRefundable:"MAIN CABIN REFUNDABLE",mcs:"MAIN CABIN SELECT",mcsRefundable:"MAIN CABIN SELECT REFUNDABLE",first:"FIRST CLASS",firstRefundable:"FIRST CLASS REFUNDABLE"},upgradeOption:{main:"Main Cabin Ticket",mainRefundable:"Refundable Ticket",mcs:"Main Cabin Select Ticket",mcsRefundable:"Main Cabin Select Refundable Ticket",first:"First Class Ticket",firstRefundable:"First Class Refundable Ticket"},tripType:{ROUND_TRIP:"Round Trip",ONE_WAY:"One Way",MULTI_CITY:"Multi City"}},states:{BOOK_INTRO_STATE:{scrollTarget:"top"},DATE_PICKER_STATE:{scrollTarget:"calendar"},FARE_SELECTOR_STATE:{scrollTarget:"fares"},SEAT_SELECTOR_STATE:{scrollTarget:"seatSelector"},TRAVELER_INFO_STATE:{scrollTarget:"travelerInfo"},ANCILLARIES_SELECTOR_STATE:{scrollTarget:"anc-selector"}},urlParser:{maximumNumberOfPeople:9},savedChoicesBar:{YES:"Yes",NO:"No",COPY:"Hi Natasha. Still looking for flights to JFK?"},calendar:{MAX_SELECTABLE_DAYS:331,SCROLL_OFFSET_DAYS:14},seatMap:{UPGRADE:"UPGRADE",DOWNGRADE:"DOWNGRADE",rowTypes:{MC:"MC",MCE:"MCE",MCS:"MCS",FIRST:"FIRST"}},elevatePointsMultiplier:{RED:5,SILVER:6.25,GOLD:10},avatarsDefaultMap:["A1","A2","A3","A4"],avatarsSpecialMap:["B1","B2","B3","B4","B5","B6","B7","B8"],ffPrograms:[{value:"VIRGIN_AMERICA",name:"Virgin America (Elevate)",nickname:"Elevate",isElevate:!0},{value:"ALASKA_AIRLINES",name:"Alaska Airlines (Mileage Plan)",nickname:"Alaska"},{value:"EMIRATES",name:"Emirates (Skywards)",nickname:"Skywards"},{value:"SINGAPORE_AIRLINES",name:"Singapore Airlines (KrisFlyer)",nickname:"KrisFlyer"}],genericErrorMessage:"Whoa there, something went wrong. Please call 1.877.FLY.VIRGIN.",elevateLanding:{earnPoints:[{img:"/images/icons/icon-card.png",desc:"No purchase is pointless when you earn up to triple the points per $1 spent with a credit card.",cta:"Learn More",url:"/cms/elevate-frequent-flyer/partners/credit-card"},{img:"/images/icons/icon-points.png",desc:"Earn even more points with our airline, hotel, shopping, and rental car partners.",cta:"See All Partners",url:"/cms/elevate-frequent-flyer/partners"},{img:"/images/icons/icon-buy.png",desc:"You can buy the points you need for your next reward trip, gift points, or transfer points to your friends and family.",cta:"Learn More",url:"/elevate-frequent-flyer/buy-gift-points"}]},api:{noErrorOnTimeout:["ancillaries/retrieve"]},tierStatus:{KEPT_ORIGINAL_TIER:"N/A"},a11yText:{ORIGIN_CITY:"Continue with {{airport}} as your origin city or select a different city",SELECT_ORIGIN_CITY:"Select your origin city",SELECT_DESTINATION_CITY:"Select your destination city",DESTINATION_CITY_EMPTY:"You're flying from {{originAirport}}, now select your destination city",DESTINATION_CITY_PICKED:"Continue with {{airport}} as your destination city or select a different city"},focusNav:{fareSelector:[{title:"Seven Day Selector",anchor:".seven-day-select__items.is-selected"},{title:"Ticket Type Selector",anchor:".ticket-type .input-radio"},{title:"Payment Options Selector",anchor:".payment-options .input-radio"},{title:"Fare Type Selector",anchor:".fare-selector__fare-map.is-first .fare-map"}],calendar:[{title:"Select Round Trip, One Way or Multicity",anchor:".trip-type--calendar .input-radio"},{title:"Calendar Date Selector",anchor:".is-current-month .month__days"}]},socialClientIds:{fb:"1627717694139725",google:"99801631818-bo2625c113suacfs8ctsa99jdcictda2.apps.googleusercontent.com"},destinationsList:{AUS:{url:"https://www.virginamerica.com/cms/travel-destinations/aus-austin-tx",name:"Austin, TX"},BOS:{url:"https://www.virginamerica.com/cms/travel-destinations/bos-boston-ma",name:"Boston, MA"},LAX:{url:"https://www.virginamerica.com/cms/travel-destinations/lax-los-angeles-ca",name:"Los Angeles, CA"},CUN:{url:"https://www.virginamerica.com/cms/travel-destinations/cun-cancun-mexico",name:"Cancun, Mexico"},ORD:{url:"https://www.virginamerica.com/cms/travel-destinations/ord-chicago-il",name:"Chicago, IL"},DAL:{url:"https://www.virginamerica.com/cms/travel-destinations/dal-dallas-tx",name:"Dallas, TX"},DEN:{url:"https://www.virginamerica.com/cms/travel-destinations/den-denver-co",name:"Denver, CO"},FLL:{url:"https://www.virginamerica.com/cms/travel-destinations/fll-fort-lauderdale-fl",name:"Fort Lauderdale, FL"},LAS:{url:"https://www.virginamerica.com/cms/travel-destinations/las-las-vegas-nv",name:"Las Vegas, NV"},JFK:{url:"https://www.virginamerica.com/cms/travel-destinations/new-york",name:"New York, NY"},SJD:{url:"https://www.virginamerica.com/cms/travel-destinations/sjd-los-cabos-mexico",name:"Los Cabos, Mexico"},EWR:{url:"https://www.www.virginamerica.com/cms/travel-destinations/newark",name:"Newark, NJ"},MCO:{url:"https://www.virginamerica.com/cms/travel-destinations/mco-orlando-fl",name:"Orlando, FL"},PSP:{url:"https://www.virginamerica.com/cms/travel-destinations/psp-palm-springs-ca",name:"Palm Springs, CA"},PDX:{url:"https://www.virginamerica.com/cms/travel-destinations/pdx-portland-or",name:"Portland, OR"},PVR:{url:"https://www.virginamerica.com/cms/travel-destinations/pvr-puerto-vallarta-mexico",name:"Puerto Vallarta, Mexico"},SAN:{url:"https://www.virginamerica.com/cms/travel-destinations/san-san-diego-ca",name:"San Diego, CA"},SJC:{url:"https://www.virginamerica.com/cms/travel-destinations/san-jose",name:"San Jose, CA"},SFO:{url:"https://www.virginamerica.com/cms/travel-destinations/sfo-san-francisco-ca",name:"San Francisco, CA"},SEA:{url:"https://www.virginamerica.com/cms/travel-destinations/sea-seattle-wa",name:"Seattle, WA"},DCA:{url:"https://www.virginamerica.com/cms/travel-destinations/washington-dc",name:"Washington DC, DC"},HNL:{url:"https://www.virginamerica.com/cms/travel-destinations/hnl-honolulu-hi",name:"Honolulu, HI"},OGG:{url:"https://www.virginamerica.com/cms/travel-destinations/ogg-maui-hi",name:"Maui, HI"}}};return a}),c("common/models/pnr-model",["angular","common/models/serial-model","common/models/address-model","common/models/payment-option-model","common/models/fareinfo-model","common/models/flight-model","core/constants/resource-bundle","moment"],function(a,b,c,d,e,f,g,h){"use strict";var i=function(a){this.init(a)};return i.prototype=new b,i.prototype._schema={type:"object",properties:{pnr:{type:"string"},lastName:{type:"string"},tripType:{type:"string"},nonRevenue:{type:"boolean"},international:{type:"boolean"},pointsBooking:{type:"boolean"},pointsRedeemed:{type:"number"},pnrTotalAmount:{type:"number"},pnrTotalExtras:{type:"number"},irop:{type:"boolean"},optInAlreadyApplied:{type:"boolean",optional:!0},iropInfo:{type:"object",optional:!0,properties:{rebookStart:{type:"string"},rebookEnd:{type:"string"},segmentStart:{type:"string"},segmentEnd:{type:"string"}}},iropInformation:{type:"object",optional:!0,properties:{irop:{type:"boolean"},iropType:{type:"string"},reBookInfo:{type:"object",optional:!0,properties:{rebookStart:{type:"string"},rebookEnd:{type:"string"},segmentStart:{type:"string"},segmentEnd:{type:"string"}}}}},flightList:{type:"array",items:{type:"object",properties:{origin:{type:"string"},destination:{type:"string"},checkInEligibility:{type:"string",optional:!0},changeEligibility:{type:"string",optional:!0},cancelEligibility:{type:"string",optional:!0},manageExtrasEligibility:{type:"string",optional:!0},departureDateTime:{type:"string"},arrivalDateTime:{type:"string"},flightNum:{type:"string"},flightId:{type:"number"},cabinClass:{type:"string"},flightType:{type:"string"},intineraryType:{type:"string",optional:!0},oAndDId:{type:"string",optional:!0},hasLoungePass:{type:"boolean",optional:!0},paxCheckInInfo:{type:"array",optional:!0,items:{status:{type:"string"},guestId:{type:"string"}}},segments:{type:"array",items:{anyOf:[{properties:f.prototype._schema},{properties:{type:"object",properties:{destination:{type:"string"},origin:{type:"string"},flightConnections:{type:"array",items:f.prototype._schema}}}}]}}}}},paxList:{type:"array",items:{type:"object",properties:{firstName:{type:"string"},guestId:{type:"string"},lastName:{type:"string"},loyaltyId:{type:"string"},loyaltyProgram:{type:"string"},ticketNum:{type:"string"},tierLevel:{type:"string"},paxType:{type:"string"},knownTravelerNumber:{type:"string",optional:!0},gender:{type:"string"},dob:{type:"string"}}}},seatList:{type:"array",items:{type:"object",properties:{seatNumber:{type:"string"},guestId:{type:"string"},flightNum:{type:"string"},flightId:{type:"number"},aisle:{type:"boolean"},mce:{type:"boolean"}}}},fareInfo:{type:"object",properties:{totalCost:{type:"number"},fareInfoList:{type:"array",items:"#/definitions/FareModel"}}},AddressInfo:"#/definitions/AddressModel",paymentInfo:"#/definitions/PaymentOptionModel",contact:{type:"object",optional:!0,properties:{email:{type:"string",optional:!0}}},extras:{type:"object",optional:!0,properties:{insurance:{type:"number"},baggage:{type:"number"},mce:{type:"number"},petc:{type:"number"},upgrade:{type:"number"}}},extraPaymentInfo:{type:"object",optional:!0,properties:{baggageFee:{type:"object"},creditCardUsed:{type:"object",properties:{ccNumber:{type:"string"},cardHolderName:{type:"string"},cardType:{type:"string"}}},loungeFee:{type:"object",optional:!0,properties:{segList:{type:"array",items:{type:"object",properties:{airport:{type:"string"},flightNum:{type:"string"},flightId:{type:"number"},paxList:{type:"array",items:{type:"object",properties:{paxInfo:{type:"object",properties:{firstName:{type:"string"},guestId:{type:"string"},lastName:{type:"string"},gender:{type:"string"},dob:{type:"string"}}}}}}}}}}},upgradeFee:{type:"object"},xpSeatFee:{type:"object"}}},ancillaryDetails:{optional:!0,properties:{ancillaryList:{type:"array"},priceMap:{type:"object"},summaryList:{type:"array"}}}}},i.prototype._deserializeCheckedInPax=function(a){var b=[];if(a&&a.paxListInfo.length)for(var c in a.paxListInfo){var d={status:a.paxListInfo[c].acsStatus,guestId:a.paxListInfo[c].guestId};b.push(d)}return b},i.prototype._defaultPNRDeserializer=function(b,g){var h,i,j,k,l,m,n,o;if(b.pnrInfo?(h=b.pnrInfo,i=b.extraPaymentInfo,j=b.changeFee,k=b.amountRefunded,l=b.originalFareInfo,m=b.newFareInfo,n=b.ccAmountCharged,o=b.totalMsrRefundAmount):h=b,h.pnr){g.pnr=h.pnr,g.lastName=h.lastName,g.tripType=h.tripType,g.international=h.international,g.nonRevenue=h.nonRevenue,g.optInAlreadyApplied=h.optInAlreadyApplied,h.iropInformation&&(g.irop=h.iropInformation.irop,g.iropType=h.iropInformation.iropType&&h.iropInformation.iropType.indexOf("CANCELLED")!==-1?"CANCELLED":"DELAYED",h.iropInformation.reBookInfo&&(g.iropInfo={rebookStart:h.iropInformation.reBookInfo.rebookStart,rebookEnd:h.iropInformation.reBookInfo.rebookEnd,segmentStart:h.iropInformation.reBookInfo.segmentStart,segmentEnd:h.iropInformation.reBookInfo.segmentEnd})),g.pnrTotalAmount=0,g.pnrTotalExtras=0,g.pnrCreatedWithin24hrs=h.pnrCreatedWithin24hrs,g.flightList=[],h.oAndDList.forEach(function(b){var c,d,e,h,i,j={destination:b.destination,origin:b.origin,pointsList:b.pointsInfo?b.pointsInfo.pointsList:[],itineraryType:b.itineraryType,oAndDId:b.oAndDId,segments:[],paxCheckInInfo:[],hasLoungePass:b.hasLoungePass};b.checkInEligibility&&(j.checkInEligibility=b.checkInEligibility),b.changeOption&&(j.changeEligibility=b.changeOption.eligibility),b.cancelOption&&(j.cancelEligibility=b.cancelOption.eligibility),b.manageExtrasOption&&(j.manageExtrasEligibility=b.manageExtrasOption.eligibility),b.connectingFlightList?(j.flightType="CONNECTING",e=b.connectingFlightList,c=e[0].flightSeg||e[0].flightSegList[0],e.forEach(function(a){a.flightSeg&&"VIRGIN_AMERICA"===a.flightSeg.operatingAirline?i=a.flightSeg.cabinClass:a.flightSegList&&a.flightSegList.forEach(function(a){"VIRGIN_AMERICA"===a.operatingAirline&&(i=a.cabinClass)})}),h=e[e.length-1],d=h.flightSeg||h.flightSegList[h.flightSegList.length-1]):b.flightSegList?(j.flightType="THRU",e=[b],c=e[0].flightSegList[0],h=e[0],d=h.flightSegList[h.flightSegList.length-1]):(j.flightType="NON_STOP",e=[b],c=d=b.flightSeg),j.aircraftType=c.aircraftType||null,j.departureDateTime=c.updatedDepartureDateTime||c.departureDateTime,j.arrivalDateTime=d.updatedArrivalDateTime||d.arrivalDateTime,j.flightNum=c.flightNum,j.flightId=c.flightId,j.cabinClass=i||c.cabinClass,j.paxCheckInInfo=g._deserializeCheckedInPax(c.segACSInfo),e.forEach(function(a){if(a.flightSeg){var b=new f;b.deserialize(a.flightSeg,"defaultMap"),j.segments.push(b)}else a.flightSegList&&a.flightSegList.forEach(function(a){var b=new f;b.deserialize(a,"defaultMap"),j.segments.push(b)})}),a.forEach(j.segments,function(a){a.changeSeatOption&&"ELIGIBLE"===a.changeSeatOption.eligibility&&(j.changeSeatEligibility=a.changeSeatOption.eligibility)}),g.flightList.push(j)}),g.paxList=[];for(var p in h.paxList){var q=h.paxList[p],r=a.copy(this._PaxModel,{});r.guestId=q.guestId,r.ticketNum=q.ticketNum,r.firstName=q.firstName,r.lastName=q.lastName,r.gender=q.gender,r.dob=q.dob,r.freeBagAllowance=q.freeBagAllowance,q.loyaltyInfo&&(r.loyaltyId=q.loyaltyInfo.loyaltyId,r.loyaltyProgram=q.loyaltyInfo.loyaltyProgram,"VIRGIN_AMERICA"===r.loyaltyProgram&&(r.tierLevel=(q.loyaltyInfo.tierLevel||"").replace("_"," "))),q.passportInfo&&(r.international=q.passportInfo),q.emergencyContactInfo&&(r.emergencyContactInfo=q.emergencyContactInfo),r.paxType=q.paxType,r.knownTravelerNum=q.knownTravelerNum,g.paxList.push(r)}g.seatList=[];for(var s in h.seatInfoList){var t=h.seatInfoList[s];g.seatList.push({flightId:t.flightId,flightNum:t.flightNum,guestId:t.guestId,seatNum:t.seat.seatNumber,aisle:t.seat.aisle,mce:t.seat.mce})}if(h.paymentInfo)if(g.paymentInfo=[],h.paymentInfo.paymentInfo.paymentInfoList)a.forEach(h.paymentInfo.paymentInfo.paymentInfoList,function(a){var b=new d;b.deserialize(a,"pnr"),g.paymentInfo.push(b)});else{var u=new d;u.deserialize(h.paymentInfo.paymentInfo,"pnr"),g.paymentInfo.push(u)}if(h.addressInfo&&(g.addressInfo=new c,g.addressInfo.deserialize(h.addressInfo,"pnr")),h.pnrFareInfo){g.fareInfo={totalCost:h.pnrFareInfo.pnrTotalCost,fareDetails:{}},g.pnrTotalAmount+=g.fareInfo.totalCost;var v=new e;v.deserialize(h.pnrFareInfo.fareInformation,"fare"),g.fareInfo.fareDetails=v,h.priceSummaryInfo&&a.forEach(h.priceSummaryInfo,function(a,b){b.indexOf("Extras")!==-1&&h.extras&&h.extras.petc&&(a-=h.extras.petc),g.fareInfo.fareDetails[b]=a})}g.pointsBooking=h.pointsBooking,g.pointsRedeemed=h.pointsRedeemed,h.contact&&h.contact.email&&(g.contact={email:h.contact.email}),h.extras&&(g.extras=h.extras,a.forEach(h.extras,function(a){g.pnrTotalExtras+=a}),h.extras.insurance&&(g.pnrTotalAmount+=h.extras.insurance,g.pnrTotalExtras-=h.extras.insurance),h.extras.petc&&(g.pnrTotalAmount+=h.extras.petc,g.pnrTotalExtras-=h.extras.petc)),g.ancillaryDetails=b.ancillaryDetails||h.ancillaryDetails,g.extraPaymentInfo=i||h.extraPaymentHistory||{};var w=0;if(g.ancillaryDetails&&g.ancillaryDetails.summaryList&&g.ancillaryDetails.summaryList.forEach(function(a){w+=a.totalAmount}),g.extraPaymentInfo.extraOptionsFee=w,n&&(g.ccAmountCharged=n,g.seatUpgradeAmountCharged=0),j&&(g.changeFee=j),k&&(g.amountRefunded=k),l&&(g.originalFareInfo=l),l&&(g.newFareInfo=m),o&&(g.totalMsrRefundAmount=o),b.seatInfoList){var x=b.seatInfoList,y=0;for(var z in x){var A=x[z].paxSeatList;for(var B in A)A[B].mce&&Object.size(A[B].payment)&&y++}y&&(g.seatUpgradeAmountCharged=30*y)}}},i.prototype._customDeserializers={checkin:i.prototype._defaultPNRDeserializer,purchase:i.prototype._defaultPNRDeserializer,accountInfo:i.prototype._defaultPNRDeserializer,change:i.prototype._defaultPNRDeserializer},i.prototype._paxfrequentFlyerSerializer=function(a){return a.paxList.map(function(a){var b={guestId:a.guestId};return a.loyaltyProgram&&a.loyaltyId&&(b.ffpAirline=a.loyaltyProgram,b.ffpNum=a.loyaltyId),b})},i.prototype._customSerializers={paxfrequentFlyer:i.prototype._paxfrequentFlyerSerializer},i.prototype.getLastFlightArrivalDate=function(){return h(this.flightList[this.flightList.length-1].arrivalDateTime)},i.prototype.isDuringElevateAvailability=function(){return!1},i.prototype.canJoinAlaskaMileagePlan=function(){return!this.paxList[0].loyaltyId},i.prototype.getBoardingPassUrl=function(a,b){var c={evt:a.context("api").resourceURL,flightId:b.flightId,flightNum:b.flightNum,lastName:this.paxList[0].lastName,pnr:this.pnr};return c.evt+"/v2/checkin/boardingpass-all?flightId="+c.flightId+"&flightNum="+c.flightNum+"&lastName="+c.lastName+"&pnr="+c.pnr},i}),c("common/models/pnr-summary-model",["angular","common/models/serial-model"],function(a,b){"use strict";var c=function(a){this.init(a),this.isSummary=!0};c.prototype=new b,c.prototype._schema={type:"object",properties:{flightNum:{type:"string"},bookingDateTime:{type:"string"},arrivalDateTime:{type:"string"},departureDateTime:{type:"string"},classOfService:{type:"string"},status:{type:"string"},origin:{type:"string"},destination:{type:"string"},lastName:{type:"string",optional:!0}}},c.prototype._deserializerMappings={accountInfo:{flightNum:"flightNumber",bookingDateTime:"bookingDateTime",arrivalDateTime:"arrivalDateTime",departureDateTime:"departureDateTime",classOfService:"classOfService",status:"status",origin:"origin",destination:"dest",lastName:"lastName"}};var d=function(a){this.init(a),this.isSummary=!0};return d.prototype=new b,d.prototype._schema={type:"object",properties:{pnr:{type:"string"},flightList:{type:"array",items:"#/definitions/FlightModel"}}},d.prototype._customDeserializers={accountInfo:function(a,b){b.pnr=a.pnr,b.flightList=[];for(var d,e=0;e<a.segDetails.length;e++)d=new c,d.deserialize(a.segDetails[e],"accountInfo"),b.flightList.push(d);var f=b.flightList;if(f.length&&(b.tripType=1===b.flightList.length?"ONE_WAY":2===f.length&&f[0].origin===f[1].destination&&f[0].destination===f[1].origin?"ROUND_TRIP":"",f.length>=2)){b.segments=[[]];for(var g=0,h=0;h<f.length;h++)h?f[h].origin===f[h-1].destination?b.segments[g].push(f[h].destination):(++g,b.segments.push([]),b.segments[g].push(f[h].origin),b.segments[g].push(f[h].destination)):(b.segments[g].push(f[h].origin),b.segments[g].push(f[h].destination))}}},d}),c("common/models/account-info-model",["common/models/serial-model","common/models/address-model","common/models/payment-option-model","common/models/pnr-model","common/models/pnr-summary-model"],function(a,b,c,d,e){"use strict";var f=function(a){this.init(a)};return f.PersonDetail=function(a){this.init(a)},f.PersonDetail.prototype=new a,f.PersonDetail.prototype._schema={type:"object",properties:{firstName:{type:"string"},lastName:{type:"string"},middleName:{type:"string",optional:!0},gender:{type:"string"},dateOfBirth:{type:"string"},redressNumber:{type:"string",optional:!0},knwnTravelerNumber:{type:"string",optional:!0},preCheckOption:{type:"string",optional:!0}}},f.PersonDetail.prototype._elevateMap={firstName:"firstName",lastName:"lastName",middleName:"middleName",gender:"gender",dateOfBirth:"dateOfBirth",redressNumber:"redressNumber",knwnTravelerNumber:"knwnTravelerNumber",preCheckOption:"preCheckOption"},f.PersonDetail.prototype._serializerMappings={elevate:f.PersonDetail.prototype._elevateMap},f.PersonDetail.prototype._deserializerMappings={elevate:f.PersonDetail.prototype._elevateMap},f.AvatarModifyNode=function(a){this.init(a)},f.AvatarModifyNode.prototype=new a,f.AvatarModifyNode.prototype._customSerializers={elevate:function(a){return{avatarCode:a.avatar}}},f.PhoneInfoModel=function(a){this.init(a)},f.PhoneInfoModel.prototype=new a,f.PhoneInfoModel.prototype._schema={type:"object",properties:{areaCode:{type:"string"},contactType:{type:"string"},number:{type:"string"},primary:{type:"boolean"},sequenceNum:{type:"number"},phoneName:{type:"string",optional:!0}}},f.PhoneInfoModel.prototype._elevateMap={areaCode:"areaCode",contactType:"contactType",number:"number",primary:"primary",sequenceNum:"sequenceNum",phoneName:"phoneName"},f.PhoneInfoModel.prototype._deserializerMappings={elevate:f.PhoneInfoModel.prototype._elevateMap},f.PhoneInfoModel.prototype._serializerMappings={elevate:f.PhoneInfoModel.prototype._elevateMap},f.PhoneInfoModel.prototype._customDeserializers={accPersonalInfo:function(a,b){var c=b._sanitizePhoneNumber(a);b.areaCode=c.substr(0,3),b.number=c.substr(3,c.length-3),b.contactType="MOBILE",b.primary=!0,b.sequenceNum=1,b.phoneName="Mobile"},accContactInfo:function(a,b){var c=b._sanitizePhoneNumber(a);b.areaCode=c.substr(0,3),b.number=c.substr(3,c.length-3),b.contactType="MOBILE",b.primary=!0,b.sequenceNum=1,b.phoneName="Mobile"}},f.PhoneInfoModel.prototype._sanitizePhoneNumber=function(a){return a?a.replace(/[^0-9]/g,"").trim():""},f.PhoneInfoModel.prototype._customSerializers={accPersonalInfo:function(a){return a.areaCode+a.number},accContactInfo:function(a){return a.areaCode+a.number}},f.EmailInfoModel=function(a){this.init(a)},f.EmailInfoModel.prototype=new a,f.EmailInfoModel.prototype._schema={type:"object",properties:{address:{type:"string"},emailType:{type:"string"},sequenceNum:{type:"number"},primary:{type:"boolean"}}},f.EmailInfoModel.prototype._elevateMap={address:"address",emailType:"emailType",sequenceNum:"sequenceNum",primary:"primary"},f.EmailInfoModel.prototype._serializerMappings={elevate:f.EmailInfoModel.prototype._elevateMap},f.EmailInfoModel.prototype._deserializerMappings={elevate:f.EmailInfoModel.prototype._elevateMap},f.EmailInfoModel.prototype._customSerializers={accPersonalInfo:function(a){return a.address},accContactInfo:function(a){return a.address}},f.EmailInfoModel.prototype._customDeserializers={accPersonalInfo:function(a,b){b.address=a,b.emailType="HOME",b.primary=!0,b.sequenceNum=1},accContactInfo:function(a,b){b.address=a,b.emailType="HOME",b.primary=!0,b.sequenceNum=1}},f.CompanionModel=function(a){this.init(a)},f.CompanionModel.prototype=new a,f.CompanionModel.prototype.constructor=f.CompanionModel,f.CompanionModel.prototype._schema={type:"object",properties:{firstName:{type:"string"},lastName:{type:"string"},relation:{type:"string"},sequenceNum:{type:"integer"}}},f.CompanionModel.prototype._accountInfoMap={firstName:"firstName",lastName:"lastName",relation:"relation",sequenceNum:"sequenceNum"},f.CompanionModel.prototype._deserializerMappings={accountInfo:f.CompanionModel.prototype._accountInfoMap},f.CompanionModel.prototype._serializerMappings={accountInfo:f.CompanionModel.prototype._accountInfoMap},f.GuestPreferenceModel=function(a){this.init(a)},f.GuestPreferenceModel.prototype=new a,f.GuestPreferenceModel.prototype.constructor=f.GuestPreferenceModel,f.GuestPreferenceModel.prototype._schema={type:"object",properties:{homeAirPort:{type:"string"},seatingPreference:{type:"string"},favoriteDestination:{type:"string"}}},f.GuestPreferenceModel.prototype._elevateMap={homeAirPort:"homeAirPort",seatingPreference:"seatingPreference",favoriteDestination:"favoriteDestination"},f.GuestPreferenceModel.prototype._serializerMappings={elevate:f.GuestPreferenceModel.prototype._elevateMap},f.GuestPreferenceModel.prototype._deserializerMappings={elevate:f.GuestPreferenceModel.prototype._elevateMap},f.FlightAlertModel=function(a){this.init(a)},f.FlightAlertModel.prototype=new a,f.FlightAlertModel.prototype.constructor=f.FlightAlertModel,f.FlightAlertModel.prototype._schema={type:"object",properties:{emailAddress:{type:"string"},smsNumber:{type:"string"},optInValue:{type:"boolean"},notifyMinutesPriorToEvent:{type:"integer"}}},f.FlightAlertModel.prototype._elevateMap={emailAddress:"emailAddress",smsNumber:"smsNumber",optInValue:"optInValue",notifyMinutesPriorToEvent:"notifyMinutesPriorToEvent"},f.FlightAlertModel.prototype._serializerMappings={elevate:f.FlightAlertModel.prototype._elevateMap},f.FlightAlertModel.prototype._deserializerMappings={elevate:f.FlightAlertModel.prototype._elevateMap},f.ElevateAccount=function(a){this.init(a)},f.ElevateAccount.prototype=new a,f.ElevateAccount.prototype.constructor=f.ElevateAccount,f.ElevateAccount.prototype._schema={type:"object",properties:{creationDateTime:{type:"string"},eid:{type:"string"},elevateID:{type:"string"},expirationDate:{type:"string"},firstName:{type:"string"},lastName:{type:"string"},renewalDate:{type:"string"},userID:{type:"string"},mpAcctStatus:{type:"integer"},mpAcctID:{type:"string"},mpMilesBalance:{type:"integer"},asDeeplinkURL:{type:"string"},asSecDeepLinkURL:{type:"string"}}},f.ElevateAccount.prototype._accountInfoMap={creationDateTime:"creationDateTime",eid:"eid",elevateID:"elevateID",expirationDate:"expirationDate",firstName:"firstName",lastName:"lastName",renewalDate:"renewalDate",userID:"userID",mpAcctStatus:"mpAcctStatus",mpAcctID:"mpAcctID",mpMilesBalance:"mpMilesBalance",asDeeplinkURL:"asDeeplinkURL",asSecDeepLinkURL:"asSecDeepLinkURL"},f.ElevateAccount.prototype._serializerMappings={accountInfo:f.ElevateAccount.prototype._accountInfoMap},f.ElevateAccount.prototype._deserializerMappings={accountInfo:f.ElevateAccount.prototype._accountInfoMap},f.ElevateAccount.prototype._customSerializers={elevate:function(a){return{eid:a.eid}}},f.TierDetail=function(a){this.init(a)},f.TierDetail.prototype=new a,f.TierDetail.prototype.constructor=f.TierDetail,f.TierDetail.prototype._schema={type:"object",properties:{tierLevel:{type:"string"},pointsToNextTier:{type:"integer"},tierQualifyingPoint:{type:"integer"},tripCount:{type:"integer"},adsProdStatus:{type:"string"},avatarCode:{type:"object",properties:{avatarCode:{type:"integer"}}}}},f.TierDetail.prototype._accountInfoMap={tierLevel:"tierLevel",pointsToNextTier:"pointsToNextTier",tierQualifyingPoint:"tierQualifyingPoint",tripCount:"tripCount"},f.TierDetail.prototype._customSerializers={accountInfo:function(a){return{tierLevel:a.tierLevel,pointsToNextTier:a.pointsToNextTier,tierQualifyingPoint:a.tierQualifyingPoint,tripCount:a.tripCount,avatarCode:{avatarCode:a.avatar}}}},f.TierDetail.prototype._customDeserializers={accountInfo:function(a,b){b.tierLevel=a.tierLevel,b.pointsToNextTier=a.pointsToNextTier,b.tierQualifyingPoint=a.tierQualifyingPoint,b.tripCount=a.tripCount,b.adsProdStatus=a.adsProdStatus,b.avatar=a.avatarCode?a.avatarCode.avatarCode:void 0}},f.PointDetail=function(a){this.init(a)},f.PointDetail.prototype=new a,f.PointDetail.prototype.constructor=f.PointDetail,f.PointDetail.prototype._schema={type:"object",properties:{activity:{type:"string"},activityDateTime:{type:"string"},datePointsEarnedTime:{type:"string"},datePointsExpireTime:{type:"string"},description:{type:"string"},lastName:{type:"string"},pnr:{type:"string"},points:{type:"integer"},pointsStatus:{type:"string"}}},f.PointDetail.prototype._accountInfoMap={activity:"activity",activityDateTime:"activityDateTime",datePointsEarnedTime:"datePointsEarnedTime",datePointsExpireTime:"datePointsExpireTime",description:"description",lastName:"lastName",pnr:"pnr",points:"points",pointsStatus:"pointsStatus"},f.PointDetail.prototype._serializerMappings={accountInfo:f.PointDetail.prototype._accountInfoMap},f.PointDetail.prototype._deserializerMappings={accountInfo:f.PointDetail.prototype._accountInfoMap},f.prototype=new a,f.prototype.constructor=f,f.constructor=a.prototype.constructor,f.prototype._schema={type:"object",properties:{elevateInfo:{eid:{type:"string"}},addressInfo:{type:"array",items:"#/definitions/AddressModel"},billingAddressInfoList:{type:"array",items:"#/definitions/AddressModel"},creditCardInfo:{type:"array",items:"#/definitions/PaymentOptionModel"},personDetail:"#/definitions/AccountInfoModel.PersonDetail",phoneInfoList:{type:"array",items:"#/definitions/AccountInfoModel.PhoneInfoModel"},checkinPNRList:{type:"array",items:d.prototype._schema},managePNRList:{type:"array",items:d.prototype._schema},textblob:{type:"string",optional:!0},flightAlert:"#/definitions/AccountInfoModel.FlightAlertModel",guestPreference:"#/definitions/AccountInfoModel.GuestPreferenceModel"},definitions:{AddressModel:b.prototype._schema,PaymentOptionModel:c.prototype._schema}},f.prototype._customSerializers={accAddress:function(a){var b,c=[];for(var d in a.addressInfo)b=a.addressInfo[d],c.push(b.serialize("elevate"));return c},accCreditCards:function(a){return{creditCardInfo:a.creditCardInfo}},accGuestPreference:function(a){return{guestPreference:a.guestPreference}},accFlightAlerts:function(a){return{flightAlert:a.flightAlert}}},f.prototype.addGuests=function(a){var b;try{b=this.textblob&&JSON.parse(this.textblob)}catch(a){return!1}b=b||{},b.guests=b.guests||[];var c=[];try{c=a.map(function(a){return a.serialize("guest")})}catch(a){return!1}return b.guests=b.guests.concat(c),this.textblob=JSON.stringify(b),!0},f.prototype._profileModifyDeserializer=function(a,d){d.addressInfo=[];var e=a.addressInfoList;for(var g in a.addressInfoList){var h=new b;h.deserialize(e[g],"elevate"),d.addressInfo.push(h)}d.creditCardInfo=[];for(var i in a.creditCardInfoList){var j=new c;j.deserialize(a.creditCardInfoList[i],"elevate");for(var k in d.addressInfo)if(d.addressInfo[k].sequenceNum===j.address){j.address=d.addressInfo[k];break}if(!(j.address instanceof b))for(k in d.addressInfo)if(d.addressInfo[k].primary){j.address=d.addressInfo[k];break}j.address instanceof b||d.addressInfo&&Array.isArray(d.addressInfo)&&d.addressInfo[0]&&(j.address=d.addressInfo[0]),d.creditCardInfo.push(j)}d.personDetail=new f.PersonDetail,d.personDetail.deserialize(a.personDetail,"elevate"),d.phoneInfoList=[];for(var l in a.phoneInfoList){var m=new f.PhoneInfoModel;m.deserialize(a.phoneInfoList[l],"elevate"),d.phoneInfoList.push(m)}d.emailInfoList=[];for(var n in a.emailInfoList){var o=new f.EmailInfoModel;o.deserialize(a.emailInfoList[n],"elevate"),d.emailInfoList.push(o)}d.elevateAccount=new f.ElevateAccount,d.elevateAccount.deserialize(a.elevateAccount,"accountInfo"),d.guestPreference=a.guestPreference,d.textblob=a.textblob||d.textblob},f.prototype._customDeserializers={accountInfo:function(a,g){g.addressInfo=[];var h=a.addressInfoList;for(var i in a.addressInfoList){var j=new b;j.deserialize(h[i],"elevate"),g.addressInfo.push(j)}g.creditCardInfo=[];for(var k in a.creditCardInfoList){var l=new c;l.deserialize(a.creditCardInfoList[k],"elevate");for(var m in g.addressInfo)if(g.addressInfo[m].sequenceNum===l.address){l.address=g.addressInfo[m];break}if(!(l.address instanceof b))for(m in g.addressInfo)if(g.addressInfo[m].primary){l.address=g.addressInfo[m];break}l.address instanceof b||g.addressInfo&&Array.isArray(g.addressInfo)&&g.addressInfo[0]&&(l.address=g.addressInfo[0]),g.creditCardInfo.push(l)}g.personDetail=new f.PersonDetail,g.personDetail.deserialize(a.personDetail,"elevate"),g.phoneInfoList=[];for(var n in a.phoneInfoList){var o=new f.PhoneInfoModel;o.deserialize(a.phoneInfoList[n],"elevate"),g.phoneInfoList.push(o);
}g.emailInfoList=[];for(var p in a.emailInfoList){var q=new f.EmailInfoModel;q.deserialize(a.emailInfoList[p],"elevate"),g.emailInfoList.push(q)}g.checkinPNRList=[];for(var r in a.checkingPNRList){var s=new d;s.deserialize(a.checkingPNRList[r],"accountInfo"),g.checkinPNRList.push(s)}g.managePNRList=[];var t=a.manageFlightDetail;if(t&&Object.keys(t).length>0){var u=new d,v=[];t.firstPnrInfo&&(u.deserialize(t.firstPnrInfo,"accountInfo"),v.push(u.pnr),g.managePNRList.push(u));for(var w in t.pnrList)v.indexOf(t.pnrList[w].pnr)===-1&&(u=new e,u.deserialize(t.pnrList[w],"accountInfo"),g.managePNRList.push(u),v.push(t.pnrList[w].pnr))}g.elevateAccount=new f.ElevateAccount,g.elevateAccount.deserialize(a.elevateAccount,"accountInfo"),g.tierDetail=new f.TierDetail,g.tierDetail.deserialize(a.tierDetail,"accountInfo"),g.pointDetailList=[];for(var x in a.pointDetailList){var y=new f.PointDetail;y.deserialize(a.pointDetailList[x],"accountInfo"),g.pointDetailList.push(y)}g.companionList=[];for(var z in a.companionList){var A=new f.CompanionModel;A.deserialize(a.companionList[z],"accountInfo"),g.companionList.push(A)}g.flightAlert=a.flightAlert,g.guestPreference=a.guestPreference,g.textblob=a.textblob||g.textblob},accProfileModify:f.prototype._profileModifyDeserializer,accAddress:function(a,c){c.addressInfo=[];for(var d in a)if(a[d]instanceof b)c.addressInfo.push(a[d]);else{var e=new b;e.deserialize(a[d],"elevate"),c.addressInfo.push(e)}},accCreditCards:function(a,d){d.billingAddressInfo=[];var e=a.billingAddressInfo;for(var f in e){var g=new b;g.deserialize(e[f],"billingAddress"),d.billingAddressInfo.push(g)}d.creditCardInfo=[];var h=a.creditCardInfo;for(var i in h)if(h[i].changed){var j=new c;j.deserialize(h[i],"elevate"),d.creditCardInfo.push(j)}},accGuestPreference:function(a,b){b.guestPreference=new f.GuestPreferenceModel(a)},accFlightAlerts:function(a,b){b.flightAlert=new f.FlightAlertModel(a)}},f}),c("common/models/traveler-model",["angular","common/models/serial-model"],function(a,b){"use strict";var c=function(a){this.init(a),this._regex={ALPHA:new RegExp("[^a-zA-Z\\s]","g")}};return c.prototype=new b,c.prototype._schema={type:"object",properties:{guid:{type:"string"},guestId:{optional:!0,anyOf:[{type:"number"},{type:"string"}]},ticketNum:{type:"string",optional:!0},travelerType:{type:"string"},primary:{type:"boolean"},status:{type:"string",optional:"true"},name:{type:"object",properties:{first:{type:"string"},middle:{type:"string",optional:!0},last:{type:"string"}}},dob:{type:"string"},gender:{type:"string"},contact:{type:"object",properties:{email:{type:"string",optional:!0},phone:{type:"string",optional:!0}}},avatar:{type:"string"},frequentFlyer:{type:"object",optional:!0,properties:{program:{type:"string"},number:{type:"string"}}},redressNum:{type:"string",optional:!0},knownTravelerNum:{type:"string",optional:!0},elevateMemberInfo:{type:"object",optional:!0,properties:{elevateId:{type:"string"},program:{type:"string"},tierLevel:{type:"string"}}},international:{type:"object",optional:!0,properties:{passportNum:{type:"string",optional:!0},passportCountry:{type:"string",optional:!0},passportExpires:{type:"string",optional:!0},citizenship:{type:"string",optional:!0},countryOfResidence:{type:"string",optional:!0},emergencyContact:{type:"object",optional:!0,properties:{name:{type:"string",optional:!0},phone:{type:"string",optional:!0}}}}},mcCostExempt:{type:"boolean",optional:!0}}},c.prototype.getFullName=function(){return this.name.first+" "+this.name.last},c.prototype.getPronoun=function(){var b=a.element(document.body).injector().get("ResourceBundle");return b.genderPronouns[this.gender]},c.prototype.setGuestId=function(a){this.guestId=["0",(a+1).toString(),".01"].join("")},c.isMcCostExempt=c.prototype.isMcCostExempt=function(a,b,c){return c=c||this.guestId,Array.isArray(a)&&a.some(function(a){if(a.isMcCostExempt()){if("O_AND_D"===a.level){var d=a.getPaxInfo(c,{oAndDId:b});return"undefined"!=typeof d&&(!d||d.pnrQuantity>0||d.uiQuantity>0)}if("PNR"===a.level)return!!a.getPaxQuantities()[c]}}.bind(this))},c.prototype._customDeserializers={travelerInfo:function(b,c){var d,e=!1;"primary"===b.travelerType?(d="ADULT",e=!0):d=b.travelerType.toUpperCase(),a.extend(c,{travelerType:d,primary:e,avatar:b.avatar,name:{first:b.firstName,middle:b.middleName,last:b.lastName},dob:b.dob,contact:{phone:b.phone,email:b.email},gender:b.sex,frequentFlyer:{program:b.frequentFlyer,number:b.frequentFlyerNumber||"",tierLevel:b.tierLevel,freeBagAllowance:b.freeBagAllowance},elevateNumber:b.elevateNumber,knownTravelerNum:b.knownTravelerNumber,redressNum:b.userRedressNumber,international:{passportNum:b.passport,passportCountry:b.issuingCountry,passportExpires:b.expirationDate,citizenship:b.citizenship,countryOfResidence:b.residence,emergencyContact:{name:b.emergencyName,phone:b.emergencyPhone||""}},someoneElse:b.someoneElse})}},c.prototype._paxSerialize=function(a){return{firstName:a.name.first,lastName:a.name.last,guestId:a.guestId,ticketNum:a.ticketNum,emailAddress:a.contact.email,dob:a.dob,sex:a.gender}},c.prototype._travelerInfoSerialize=function(a){return{avatar:a.avatar,email:a.contact.email,firstName:a.name.first.replace(/[^a-zA-Z\s]/g,"").trim(),middleName:a.name.middle?a.name.middle.replace(/[^a-zA-Z\s]/g,"").trim():null,lastName:a.name.last.replace(/[^a-zA-Z\s]/g,"").trim(),frequentFlyer:a.frequentFlyer?a.frequentFlyer.program:null,frequentFlyerNumber:a.frequentFlyer?a.frequentFlyer.number:null,elevateNumber:a.frequentFlyer&&"VIRGIN_AMERICA"===a.frequentFlyer.program?a.frequentFlyer.number:null,knownTravelerNumber:a.knownTravelerNum,phone:a.contact&&a.contact.phone?a.contact.phone.replace(/[^0-9]/g,"").trim():null,redressNumber:a.redressNum,sex:a.gender,travelerType:a.travelerType,dob:a.dob}},c.prototype._purchaseSerialize=function(b){return a.extend(b._apiStandardSerialize(b),{passportNum:b.international.passportNum,passportDate:b.international.passportExpires,issuingCountry:b.international.passportCountry,citizenship:b.international.citizenship,countryOfResidence:b.international.countryOfResidence})},c.prototype._apiStandardSerialize=function(a){var b={guestId:a.guestId,firstName:a.name.first.replace(a._regex.ALPHA,"").trim(),middleName:a.name.middle?a.name.middle.replace(a._regex.ALPHA,"").trim():"",lastName:a.name.last.replace(a._regex.ALPHA,"").trim(),type:a.travelerType.toUpperCase(),gender:a.gender,emailAddress:a.contact.email,dob:a.dob,knownTravelerNum:a.knownTravelerNum,redressNum:a.redressNum,mcCostExempt:a.mcCostExempt};return a.international&&a.international.emergencyContact&&a.international.emergencyContact.name&&(b.emergencyContactName=a.international.emergencyContact.name.replace(/[^a-zA-Z\s]/g,"").trim(),a.international.emergencyContact.phone&&(b.emergencyContactNum=a.international.emergencyContact.phone.replace(/[^0-9]/g,"").trim())),a.frequentFlyer&&a.frequentFlyer.program&&a.frequentFlyer.number&&(b.frequentFlyerInfo={ffpAirline:a.frequentFlyer.program,ffpNum:a.frequentFlyer.number}),(a.elevateNumber||a.frequentFlyer&&"VIRGIN_AMERICA"===a.frequentFlyer.program)&&(b.elevateMemberInfo={elevateId:a.elevateNumber||a.frequentFlyer.number,program:"VX"}),b},c.prototype._guestSerialize=function(a){var b={firstName:a.name.first,lastName:a.name.last,avatar:a.avatar,dateOfBirth:a.dob,gender:a.gender.toUpperCase()};return a.elevateMemberInfo&&a.elevateMemberInfo.tierLevel&&(b.elevateTier=a.elevateMemberInfo.tierLevel),a.frequentFlyer&&a.frequentFlyer.number&&a.frequentFlyer.program&&(b.loyaltyId=a.frequentFlyer.number,b.loyaltyProgram=a.frequentFlyer.program),b},c.prototype._frequentFlyerSerialize=function(a){var b={guestId:a.guestId};return a.frequentFlyer&&a.frequentFlyer.program&&a.frequentFlyer.number&&(b.ffpAirline=a.frequentFlyer.program,b.ffpNum=a.frequentFlyer.number),b},c.prototype._customSerializers={purchase:c.prototype._purchaseSerialize,pax:c.prototype._paxSerialize,travelerInfo:c.prototype._travelerInfoSerialize,apiStandard:c.prototype._apiStandardSerialize,guest:c.prototype._guestSerialize,frequentFlyer:c.prototype._frequentFlyerSerialize},c}),c("common/models/elevate-model",["common/models/serial-model","common/models/account-info-model","common/models/traveler-model"],function(a,b,c){"use strict";var d=function(a){this.init(a)};return d.prototype=new a,d.prototype.constructor=d,d.prototype._schema={type:"object",properties:{elevateId:{type:"string"},eid:{type:"string"},avatar:{type:"string",optional:!0},emailId:{type:"string"},firstName:{type:"string"},lastName:{type:"string"},middleName:{type:"string",optional:!0},foundingMember:{type:"boolean"},numOfPointsAvailable:{type:"integer"},numOfPointsToNextTier:{type:"number"},numberOfTierQualifyingPoints:{type:"number"},status:{type:"string"},tierLevel:{type:"string"},authToken:{type:"string"},accountInfo:b.prototype._schema}},d.prototype._travelerModelSerializer=function(a){var b=new c({travelerType:"primary",primary:!0,name:{first:a.firstName,middle:a.middleName||"",last:a.lastName},dob:a.accountInfo.personDetail.dateOfBirth,gender:a.accountInfo.personDetail.gender,contact:{email:a.emailId},avatar:a.avatar,frequentFlyer:{program:"VIRGIN_AMERICA",number:a.elevateId,tierLevel:a.tierLevel},redressNum:a.accountInfo.personDetail.redressNumber,knownTravelerNum:a.accountInfo.personDetail.knwnTravelerNumber});return a.accountInfo.elevateAccount&&a.accountInfo.elevateAccount.mpAcctID&&(b.frequentFlyer={program:"ALASKA_AIRLINES",number:a.accountInfo.elevateAccount.mpAcctID,tierLevel:null}),a.accountInfo.phoneInfoList&&a.accountInfo.phoneInfoList.length>0&&(b.contact.phone=a.accountInfo.phoneInfoList[0].areaCode+a.accountInfo.phoneInfoList[0].number),b},d.prototype._profileModifyChangeSerializer=function(a){var b=a.diff();b.accountInfo.accountInfo=a.accountInfo.accountInfo,b.accountInfo._savedState.isPartial=!0;var c=b.accountInfo.serialize("elevate");return c.authToken=a.authToken,c.elevateId=a.elevateId,c},d.prototype._customSerializers={travelerModel:d.prototype._travelerModelSerializer,profileModifyChange:d.prototype._profileModifyChangeSerializer,persistence:function(a){return{elevateId:a.elevateId,firstName:a.firstName,lastName:a.lastName,middleName:a.middleName,status:a.status,emailId:a.emailId,numOfPointsAvailable:a.numOfPointsAvailable,tierLevel:a.tierLevel,avatarCode:{avatarCode:a.avatar}}},accPersonalInfo:function(a){return{firstName:a.accountInfo.personDetail.firstName,middleName:a.accountInfo.personDetail.middleName,lastName:a.accountInfo.personDetail.lastName,dob:a.accountInfo.personDetail.dateOfBirth,email:a.accountInfo.emailInfoList[0].serialize("accPersonalInfo"),phoneNumber:a.accountInfo.phoneInfoList[0].serialize("accPersonalInfo"),sex:a.accountInfo.personDetail.gender,avatar:a.avatar,redressNumber:a.accountInfo.personDetail.redressNumber,knownTravelerNumber:a.accountInfo.personDetail.knwnTravelerNumber}},accContactInfo:function(a){return{email:a.accountInfo.emailInfoList[0].serialize("accContactInfo"),phoneNumber:a.accountInfo.phoneInfoList[0].serialize("accContactInfo")}}},d.prototype._customDeserializers={accPersonalInfo:function(a,c){if(c.accountInfo||(c.accountInfo=new b),c.accountInfo.personDetail||(c.accountInfo.personDetail=new b.PersonDetail),a.accountInfo&&a.accountInfo.personDetail?c.accountInfo.personDetail=a.accountInfo.personDetail:(c.accountInfo.personDetail.firstName=a.firstName||c.accountInfo.personDetail.firstName,c.accountInfo.personDetail.middleName=a.middleName||c.accountInfo.personDetail.middleName,c.accountInfo.personDetail.lastName=a.lastName||c.accountInfo.personDetail.lastName,c.accountInfo.personDetail.dateOfBirth=a.dob||c.accountInfo.personDetail.dateOfBirth,c.accountInfo.personDetail.gender=a.sex||c.accountInfo.personDetail.gender,c.accountInfo.personDetail.knwnTravelerNumber=a.knownTravelerNumber||c.accountInfo.personDetail.knwnTravelerNumber,c.accountInfo.personDetail.redressNumber=a.redressNumber||c.accountInfo.personDetail.redressNumber),c.accountInfo.phoneInfoList||(c.accountInfo.phoneInfoList=[]),a.phoneNumber){var d=new b.PhoneInfoModel;d.deserialize(a.phoneNumber,"accPersonalInfo"),c.accountInfo.phoneInfoList[0]=d}if(c.accountInfo.emailInfoList||(c.accountInfo.emailInfoList=[]),a.email){var e=new b.EmailInfoModel;e.deserialize(a.email,"accPersonalInfo"),c.accountInfo.emailInfoList[0]=e}a.avatar&&(c.avatar=a.avatar),c.numOfPointsAvailable=a.numOfPointsAvailable||c.numOfPointsAvailable||0,c.tierLevel=a.tierLevel||c.tierLevel,c.elevateId=a.elevateId||c.elevateId,c.status=a.status||c.status,c.tierLevel=a.tierLevel||c.tierLevel,c.firstName=a.firstName||c.firstName||c.accountInfo.personDetail.firstName,c.lastName=a.lastName||c.lastName||c.accountInfo.personDetail.lastName,c.emailId=a.emailId||c.emailId},accContactInfo:function(a,c){c.accountInfo||(c.accountInfo=new b);var d=new b.PhoneInfoModel;d.deserialize(a.phoneNumber,"accContactInfo"),c.accountInfo.phoneInfoList||(c.accountInfo.phoneInfoList=[]),c.accountInfo.phoneInfoList[0]=d,c.emailId=a.email;var e=new b.EmailInfoModel;e.deserialize(a.email,"accContactInfo"),c.accountInfo.emailInfoList||(c.accountInfo.emailInfoList=[]),c.accountInfo.emailInfoList[0]=e},persistence:function(a,b){var c=a.public.elevate;c&&(b.elevateId=c.elevateId,b.firstName=c.firstName,b.lastName=c.lastName,b.status=c.status,b.emailId=c.emailId,b.numOfPointsAvailable=c.numOfPointsAvailable||b.numOfPointsAvailable||0,b.tierLevel=c.tierLevel,b.avatar=c.avatarCode?c.avatarCode.avatarCode:void 0,b.authToken=a.protected&&a.protected.authToken?a.protected.authToken:void 0)},login:function(a,b){b.elevateId=a.elevateId,b.firstName=a.firstName,b.lastName=a.lastName,b.status=a.status,b.emailId=a.emailId,b.numOfPointsAvailable=a.numOfPointsAvailable,b.tierLevel=a.tierLevel,b.avatar=a.avatarCode?a.avatarCode.avatarCode:void 0}},d}),c("core/services/elevate",["angular","common/models/elevate-model","common/models/account-info-model"],function(a,b,c){"use strict";var d=function(a,c,d,e,f,g,h,i,j){this._stubService=h,this._bundle=i,this._persistenceService=j,this._stubedData={},this._model=new b,this._mustPersistUserData=!1,this._dirtyModel=!1,this._loginRequestModel={elevateId:"",userId:"",password:""},this._accountRequestModel={elevateId:"",futureBookingDetail:!0,searchPointsByDurationType:"ALL_DATES",searchPointsByStatusType:"ALL_POINTS",sortOrderDirectionType:"SORT_DESCENDING",sortOrderType:"COL_DATE",authToken:""},this._attachRequestModel={firstName:"",lastName:"",elevateID:"",pnrNumber:""},this.PROPERTIES={personDetail:"personDetail",addressInfoList:"addressInfoList",billingAddressInfoList:"billingAddressInfoList",phoneInfoList:"phoneInfoList",creditCardInfoList:"creditCardInfoList",emailInfoList:"emailInfoList",companionList:"companionList",guestPreference:"guestPreference",avatarCode:"avatarCode",flightAlerts:"flightAlert"},this._retrieveAccountContexts={booking:{futureBookingDetail:!1,searchPointsByDurationType:"PAST_MONTH",searchPointsByStatusType:"POINTS_EXPIRED",sortOrderDirectionType:"SORT_DESCENDING",sortOrderType:"COL_DATE",excludeFilter:["pnrList","pointDetail"]},checkin:{futureBookingDetail:!0,searchPointsByDurationType:"PAST_MONTH",searchPointsByStatusType:"POINTS_EXPIRED",sortOrderDirectionType:"SORT_DESCENDING",sortOrderType:"COL_DATE",excludeFilter:["pointDetail"]},manage:{futureBookingDetail:!0,searchPointsByDurationType:"PAST_MONTH",searchPointsByStatusType:"POINTS_EXPIRED",sortOrderDirectionType:"SORT_DESCENDING",sortOrderType:"COL_DATE",excludeFilter:["pointDetail"]},accountInfo:{futureBookingDetail:!0,searchPointsByDurationType:"ALL_DATES",searchPointsByStatusType:"ALL_POINTS",sortOrderDirectionType:"SORT_DESCENDING",sortOrderType:"COL_DATE",excludeFilter:["pnrList","pointDetail"]},elevateLanding:{futureBookingDetail:!0,searchPointsByDurationType:"ALL_DATES",searchPointsByStatusType:"ALL_POINTS",sortOrderDirectionType:"SORT_DESCENDING",sortOrderType:"COL_DATE"},accountActivity:{futureBookingDetail:!0,searchPointsByDurationType:"ALL_DATES",searchPointsByStatusType:"ALL_POINTS",sortOrderDirectionType:"SORT_DESCENDING",sortOrderType:"COL_DATE"}},this._cachedRetrieveAccountRequests=[],this._$rootScope=a,this._$q=e,this._api=f,this._cms=g,this._$timeout=d;var k={LOGIN:"LOGIN",SIGNUP:"SIGNUP"};return this._elevateAccount={},this._retrieveAccInfoDeferred,this._retrievingAccInfo=!1,this._accInfoRetrieved=!1,{viewConstants:k,getAuthToken:this.getAuthToken.bind(this),getElevateId:this.getElevateId.bind(this),setAuthToken:this.setAuthToken.bind(this),setElevateId:this.setElevateId.bind(this),retrieveAccountInfo:this.retrieveAccountInfo.bind(this),isLoggedIn:this.isLoggedIn.bind(this),verifyIfLoggedIn:this.verifyIfLoggedIn.bind(this),isRecognizedNotLoggedIn:this.isRecognizedNotLoggedIn.bind(this),isRecognizedOrLoggedIn:this.isRecognizedOrLoggedIn.bind(this),destroyRecognizedUser:this.destroyRecognizedUser.bind(this),getUserData:this.getUserData.bind(this),setUserPersistenceData:this.setUserPersistenceData.bind(this),getUserPersistenceData:this.getUserPersistenceData.bind(this),getMustPersistUserData:this.getMustPersistUserData.bind(this),getAccountInfo:this.getAccountInfo.bind(this),getOverridenAvatar:this.getOverridenAvatar.bind(this),getTier:this.getTier.bind(this),overrideAvatar:this.overrideAvatar.bind(this),doLogin:this.doLogin.bind(this),doLogout:this.doLogout.bind(this),attachToPNR:this.attachToPNR.bind(this),validateFrequentFlyer:this.validateFrequentFlyer.bind(this),validateElevateId:this.validateElevateId.bind(this),forgotPassword:this.forgotPassword.bind(this),doSignUp:this.doSignUp.bind(this),addAccountInfoAddress:this.handleProfileModify.bind(this),updateAccountInfoAddress:this.handleProfileModify.bind(this),addAccountInfoCreditCard:this.handleProfileModify.bind(this),updateAccountInfoCreditCard:this.handleProfileModify.bind(this),updatePersonDetail:this.handleProfileModify.bind(this),addAccountInfoPhone:this.handleProfileModify.bind(this),updateAccountInfoPhone:this.handleProfileModify.bind(this),handleProfileModify:this.handleProfileModify.bind(this),handleProfileDelete:this.handleProfileDelete.bind(this),retrieveForgotPasswordData:this.retrieveForgotPasswordData.bind(this),resetElevatePasswordByIDPhone:this.resetElevatePasswordByIDPhone.bind(this),resetElevatePassword:this.resetElevatePassword.bind(this),getSSOData:this.getSSOData.bind(this),getCreditCardData:this.getCreditCardData.bind(this),PROPERTIES:this.PROPERTIES,setModelDirty:this.setModelDirty.bind(this),locallyValidateFFPNumber:this.locallyValidateFFPNumber.bind(this),verifyElevateTiers:this.verifyElevateTiers.bind(this),hasAccountInfo:this.accInfoRetrieved.bind(this),requestElevatePoints:this.requestElevatePoints.bind(this),saveGuests:this.saveGuests.bind(this),MCSOptInEligibility:this.MCSOptInEligibility.bind(this)}};return d.$inject=["$rootScope","$interpolate","$timeout","$q","api","cms","stubService","ResourceBundle","persistenceService"],d.prototype.accInfoRetrieved=function(){return this._accInfoRetrieved},d.prototype.verifyElevateTiers=function(a){var b=this._api.elevate.tierDetails({elevateId:a}).then(function(a){var b=this._getTierDetailFromResponse(a.data.response);return{tier:b.tierLevel,freeBagAllowance:b.freeBagAllowance}}.bind(this));return b},d.prototype._getTierDetailFromResponse=function(a){return a.tierDetailList[0]},d.prototype.isLoggedIn=function(){return!!this._model.authToken},d.prototype.verifyIfLoggedIn=function(){var a=this._$q.defer();return this._persistenceService.retrieve().then(function(){var b=this._persistenceService.getElevateModel();b&&b.authToken?a.resolve():(this._cleanSession(),a.reject())}.bind(this)),a.promise},d.prototype.isRecognizedNotLoggedIn=function(){return this._model.elevateId&&!this._model.authToken},d.prototype.isRecognizedOrLoggedIn=function(){return this.isRecognizedNotLoggedIn()||this.isLoggedIn()},d.prototype.getAuthToken=function(){return this._model.authToken},d.prototype.setAuthToken=function(a){this._model.authToken=a},d.prototype.getElevateId=function(){return this._model.elevateId},d.prototype.setElevateId=function(a){this._model.elevateId=a},d.prototype.getUserData=function(){return this._model},d.prototype.getMustPersistUserData=function(){return this._mustPersistUserData},d.prototype.setUserPersistenceData=function(a){this._model.deserialize(a,"accPersonalInfo"),this._fixMyAvatar()},d.prototype.getUserPersistenceData=function(){return this._elevatePersistenceModel},d.prototype.getAccountInfo=function(){if(this._model&&this._model.accountInfo)return this._model.accountInfo},d.prototype.getTier=function(){return this._model.tierLevel},d.prototype.destroyRecognizedUser=function(){this._cleanSession()},d.prototype._buildLoginQuery=function(a,b){this._loginRequestModel.elevateId=a,this._loginRequestModel.userId=a,this._loginRequestModel.password=b;var c=this._loginRequestModel.elevateId.indexOf("@")>=0?"elevateId":"userId";delete this._loginRequestModel[c]},d.prototype._buildAccountInfoQuery=function(b){b&&(b.context?this._accountRequestModel=a.copy(this._retrieveAccountContexts[b.context]):b.payload&&(this._accountRequestModel=a.copy(b.payload))),this._accountRequestModel.elevateId=this.getElevateId(),this._accountRequestModel.authToken=this.getAuthToken()},d.prototype.doLogin=function(a,b,c){this._buildLoginQuery(a,b);var d=this,e=this._$q.defer();return this._api.elevate.checkElevateLogin(d._loginRequestModel).then(function(a){d._deserializeFromLogin(a.data.response),null!==c&&"function"==typeof c?c().then(function(){e.resolve(d._model)}):e.resolve(d._model)}.bind(this)).catch(function(a){e.reject(a)}),e.promise},d.prototype._deserializeFromLogin=function(a){this.setElevateId(a.elevateId),this.setAuthToken(a.authToken),this._model.deserialize(a,"login"),this._fixMyAvatar(),this._toggleMustPersistUserData()},d.prototype._fixMyAvatar=function(){if(!this._isValidAvatar(this._model.avatar)){var a=Math.floor(Math.random()*this._bundle.avatarsDefaultMap.length);this._model.avatar=this._bundle.avatarsDefaultMap[a]}},d.prototype._isValidAvatar=function(a){var b=!1,c=["avatarsDefaultMap","avatarsSpecialMap"];for(var d in c)for(var e in this._bundle[c[d]])if(this._bundle[c[d]][e]===a){b=!0;break}return b},d.prototype.overrideAvatar=function(a){this._overrienAvatar=a,this._model.avatar=a,this._toggleMustPersistUserData()},d.prototype.getOverridenAvatar=function(){return this._overrienAvatar},d.prototype.doLogout=function(){var a=this._$q.defer();return this._api.elevate.logout({logOut:!0}).then(function(){this._cleanSession(),a.resolve()}.bind(this)).catch(function(b){a.reject(b)}),a.promise},d.prototype._cleanSession=function(){this._elevateAccount={},this._model.reset(),this.setAuthToken(null),this._toggleMustPersistUserData()},d.prototype._buildElevateSignUpQuery=function(b){return b.elevateAccountInfo.foundingMember=!1,a.extend(b.phoneInfo,{sequenceNum:0,primary:!0}),a.extend(b.emailInfo,{sequenceNum:0,primary:!0,emailName:"ElevateEmail"}),a.extend(b.addressInfo,{sequenceNum:0,primary:!0,addressName:"Primary Address"}),b.flightAlertOptions.notifyMinutesPriorToEvent=60,b},d.prototype.doSignUp=function(a,b){var c=b?a:this._buildElevateSignUpQuery(a),d=this._$q.defer();return this._api.elevate.joinElevate(c).then(function(a){this._deserializeFromLogin(a.data.response),d.resolve()}.bind(this)).catch(function(a){d.reject(a)}),d.promise},d.prototype.retrieveAccountInfo=function(d){function e(b){var c=/(localhost|(www3|sandbox)\.(dev|qa)\.virginamerica\.com)/i.test(document.location.hostname),d=document.location.search.match(/stub-mpacctstatus=(\d)/i);if(c&&b.data.response&&b.data.response.elevateAccount){if(!d)return void window.console.warn('[Data Stubbing] "api/v2/elevate/retrieve-account-info": No URL pattern found');var e=parseInt(d[1]),f={mpAcctStatus:e,mpAcctID:0===e?"":"179306606",mpMilesBalance:0===e?0:12980,asDeeplinkURL:"https://www.alaskaair.com/?mpAcctStatus="+e,asSecDeepLinkURL:"https://www.alaskaair.com/?asSecDeepLinkURL=true&mpAcctStatus="+e};window.console.warn('[Data Stubbing] "api/v2/elevate/retrieve-account-info": adding to "elevateAccount" the following data ',f),a.extend(b.data.response.elevateAccount,f)}}if(this._buildAccountInfoQuery(d),this._retrievingAccInfo)return this._retrieveAccInfoDeferred.promise;this._retrieveAccInfoDeferred=this._$q.defer(),this._retrievingAccInfo=!0,this._accInfoRetrieved=!1;var f;return f=this._stubedData[this._model.emailId]?this._stubService.get(this._stubedData[this._model.emailId].rai):this._api.elevate.retrieveAccountInfo(this._accountRequestModel),f.then(function(a){this._model||(this._model=new b),e(a);var d=new c;d.deserialize(a.data.response,"accountInfo"),this._pushRetrieveAccountIntoCache(a.config.data,d),this._model.accountInfo=d,this._retrieveAccInfoDeferred.resolve(this._model.accountInfo),this._model.accountInfo.avatar!==this._model.avatar&&(this._model.accountInfo.avatar=this._model.avatar),this._retrieveAccInfoDeferred.resolve(this._model.accountInfo),this._dirtyModel=!1,this._retrieveAccInfoDeferred=null,this._retrievingAccInfo=!1,this._accInfoRetrieved=!0}.bind(this)).catch(function(a){this._retrieveAccInfoDeferred.reject(a),this._retrieveAccInfoDeferred=null,this._retrievingAccInfo=!1}.bind(this)),this._retrieveAccInfoDeferred.promise},d.prototype._toggleMustPersistUserData=function(){this._mustPersistUserData=!this._mustPersistUserData},d.prototype._pushRetrieveAccountIntoCache=function(b,c){var d=this._getCachedRetrieveAccount(b);d?d.obj=c:this._cachedRetrieveAccountRequests.push({payload:a.copy(b),obj:a.copy(c)})},d.prototype._getCachedRetrieveAccount=function(a){for(var b,c=0;c<this._cachedRetrieveAccountRequests.length;c++){var d,e=this._cachedRetrieveAccountRequests[c],f=0,g=0;for(d in e.payload)f++;for(d in e.payload){var h=e.payload[d];a[d]===h&&g++}g===f&&(b=e)}return b},d.prototype._setAccountInfoModelToCached=function(a){this._model.accountInfo=a.obj},d.prototype.attachToPNR=function(a,b,c,d){var e=this._$q.defer();this._attachRequestModel.firstName=a,this._attachRequestModel.lastName=b,this._attachRequestModel.elevateID=c,this._attachRequestModel.pnrNumber=d,this._attachRequestModel.elevateID&&""!==this._attachRequestModel.elevateID&&this._api.elevate.attachProfileToPNR(this._attachRequestModel).then(function(a){e.resolve(a.data)}).catch(function(a){e.reject(a)})},d.prototype.validateFrequentFlyer=function(a,b){var c=this._$q.defer(),d={ffpNum:b,partnerAirline:a};return this._api.elevate.validateFfpNumber(d).then(function(a){c.resolve(a.data)}).catch(function(a){c.reject(a)}),c.promise},d.prototype.validateElevateId=function(a,b,c){var d=this._$q.defer(),e={firstName:a.replace(/[^a-zA-Z\s]/g,"").trim(),lastName:b.replace(/[^a-zA-Z\s]/g,"").trim(),elevateID:c};return this._api.elevate.validateElevateId(e).then(function(a){d.resolve(a.data)}).catch(function(a){d.reject(a)}),d.promise},d.prototype.forgotPassword=function(a){var b=this._$q.defer(),c={emailId:a};return this._api.elevate.forgotElevatePassword(c).then(function(a){b.resolve(a.data.response)}).catch(function(a){b.reject(a)}),b.promise},d.prototype.doProfileModify=function(a){var b=this._$q.defer();return this._api.elevate.profileModify(a).then(function(a){this._dirtyModel=!0,this._model.accountInfo.deserialize(a.data.response,"accProfileModify"),b.resolve(a)}.bind(this)).catch(function(a){b.reject(a)}),b.promise},d.prototype._buildProfileModifyRequest=function(a){var b={entity:this._model.accountInfo.elevateAccount.serialize("elevate"),elevateId:this._model.elevateId,authToken:this._model.authToken,personDetail:this._model.accountInfo.personDetail.serialize("elevate")};for(var c in a){var d=a[c].property,e=a[c].object;if("personDetail"!==d&&"guestPreference"!==d&&"avatarCode"!==d&&"flightAlert"!==d)if($.isArray(e)){var f=[];e.forEach(function(a){var b=a.serialize("elevate");b&&f.push(b)}),b[d]=f}else b[d]=[e.serialize("elevate")];else b[d]=e.serialize("elevate")}return b},d.prototype.handleProfileModify=function(a){var b=this._buildProfileModifyRequest(a);return this.doProfileModify(b)},d.prototype.handleProfileDelete=function(a){var b=this._buildProfileModifyRequest(a),c=this._$q.defer();return delete b.entity,delete b.personDetail,this._api.elevate.profileDelete(b).then(function(a){this._dirtyModel=!0,c.resolve(a)}.bind(this)).catch(function(a){c.reject(a)}),c.promise},d.prototype.retrieveForgotPasswordData=function(a){var b=this._$q.defer(),c={urlIdentifier:a};return this._api.elevate.forgotElevatePasswordConfirm(c).then(function(a){b.resolve(a.data.response.phoneInfo[0].number)}).catch(function(a){b.reject(a)}),b.promise},d.prototype.resetElevatePasswordByIDPhone=function(a,b,c){var d=this._$q.defer(),e={urlIdentifier:a,last4digit:b,newPassword:c};return this._api.elevate.resetElevatePasswordByIDPhone(e).then(function(a){d.resolve(a.data.response)}).catch(function(a){d.reject(a)}),d.promise},d.prototype.resetElevatePassword=function(a){var b=this._$q.defer(),c={authToken:this._model.authToken,newPassword:a.newPassword,oldPassword:a.oldPassword};return this._api.elevate.resetElevatePasswordByAuthToken(c).then(function(a){b.resolve(a.data.response)}).catch(function(a){b.reject(a)}),b.promise},d.prototype.getSSOData=function(){var a=this._$q.defer();return this._api.elevate.transferPoints({authToken:this._model.authToken}).then(function(b){a.resolve(b)}.bind(this)).catch(function(b){a.reject(b)}),a.promise},d.prototype.getCreditCardData=function(a){var b=this._$q.defer();return this._api.elevate.addInstantCredit({authToken:this._model.authToken,feedIndicator:a}).then(function(a){b.resolve(a)}.bind(this)).catch(function(a){b.reject(a)}),b.promise},d.prototype.setModelDirty=function(){this._dirtyModel=!0},d.prototype.requestElevatePoints=function(a){var b=this._$q.defer(),c={pnr:a,authToken:this._model.authToken};return this._api.elevate.requestElevatePoints(c).then(function(a){"SUCCESS"===a.data.status.status?b.resolve(a):b.reject(a)}.bind(this)).catch(function(a){b.reject(a)}),b.promise},d.prototype.locallyValidateFFPNumber=function(a,b){var c={VIRGIN_AMERICA:function(a){var b=!1;if(11===a.length&&!isNaN(parseInt(a)))for(var c=parseInt(a.substr(10,1)),d=[6,5,4,3,8,7,6,5,4,3],e=0,f=0;f<d.length;f++){var g=parseInt(a.substr(f,1));e+=g*d[f];var h=e%11;b=h<2?0===c:c===11-h}return b},SINGAPORE_AIRLINES:function(a){var b=!1;if(10===a.length&&!isNaN(parseInt(a))){var c=parseInt(a.substr(9,1)),d=parseInt(a.substr(0,9)),e=d%7;b=c===e+3}return b},VIRGIN_AUSTRALIA:function(a){var b=!1;if(10===a.length&&!isNaN(parseInt(a))){for(var c=parseInt(a.substr(9,1)),d=0,e=0;e<9;e++){var f=parseInt(a.substr(e,1));d+=f}var g=d%7;b=c===g}return b},EMIRATES:function(a){var b=!1;if(9===a.length&&!isNaN(parseInt(a))){var c=parseInt(a.substr(8,1)),d=parseInt(a.substr(0,8)),e=d-7*parseInt(d/7);b=c===e}return b},ALASKA_AIRLINES:function(a){var b=!1;if(a.length<=12&&!isNaN(parseInt(a))){var c=a.length-1,d=parseInt(a.substr(c,1)),e=parseInt(a.substr(0,c)),f=e%7;b=d===f}return b}};return"function"==typeof c[a]&&c[a](b)},d.prototype.saveGuests=function(a){var b=this._$q.defer();return this._model&&this._model.accountInfo&&this._model.accountInfo.addGuests(a)?this.doProfileModify({elevateId:this._model.elevateId,authToken:this._model.authToken,textblob:this._model.accountInfo.textblob}):(b.reject(),b.promise)},d.prototype.MCSOptInEligibility=function(a){var b=this._$q.defer(),c={ffpInfoList:a};return this._api.elevate.MCSOptInEligibility(c).then(function(a){"SUCCESS"===a.data.status.status&&"ELIGIBLE"===a.data.response.eligibility?b.resolve(a):b.reject(a)}.bind(this)).catch(function(a){b.reject(a)}),b.promise},d}),c("common/models/fare-tier-model",["angular","common/models/serial-model","common/models/fareinfo-model"],function(a,b,c){"use strict";var d=function(a){this.init(a)};return d.prototype=new b,d.prototype._schema={type:"object",properties:{classOfService:{type:"string"},classOfServiceList:{type:"array",optional:!0,items:{type:"object",properties:{classOfService:{type:"string"},flightNum:{type:"string"}}}},dollarFare:{type:"object",optional:!0,
properties:{totalPoints:{type:"number"},totalTax:{type:"number"}}},pointsFare:{type:"object",optional:!0,properties:{baseFare:{type:"number"},totalFare:{type:"number"},totalTax:{type:"number"}}},fareBasisCode:{type:"string",optional:!0},fareInformation:c.prototype._schema,notAvailable:{type:"boolean"},originalKey:{type:"string"},cabinType:{type:"string"},seatsRemaining:{type:"number"},totalTax:{type:"number"},name:{type:"string"}}},d.prototype._defaultDeserializer=function(b,d,e){a.extend(d,{classOfService:b.classOfService,classOfServiceList:b.classOfServiceList,dollarFare:b.dollarFare,pointsFare:b.pointsFare,fareBasisCode:b.fareBasisCode,notAvailable:b.notAvailable,originalKey:b.originalKey,cabinType:b.cabinType,seatsRemaining:Number(b.seatsRemaining),totalTax:Number(b.totalTax),name:e&&e.name}),b.fareInformation&&(d.fareInformation=new c,d.fareInformation.deserialize(b.fareInformation,"fare"))},d.prototype._customDeserializers={defaultMap:d.prototype._defaultDeserializer},d}),c("common/models/selected-fare-model",["angular","common/models/serial-model","common/models/fareinfo-model","common/models/flight-model","common/models/fare-tier-model"],function(a,b,c,d,e){"use strict";var f=function(a){this.init(a)};return f.prototype=new b,f.prototype._schema={type:"object",properties:{oAndDId:{type:"string"},itineraryType:{type:"string"},tier:{type:"string"},tierModel:e.prototype._schema,tiers:{type:"object",patternProperties:{"^.+$ ":e.prototype._schema}},flightType:{type:"string"},deepLink:{type:"boolean"},thruFlightLegs:{optional:!0},information:c.prototype._schema,legs:{type:"array",items:d.prototype._schema},cost:{type:"object",properties:{dollars:{type:"object",optional:!0,properties:{base:{type:"number"},total:{type:"number"}}},points:{type:"object",optional:!0,properties:{base:{type:"number"},total:{type:"number"},totalPoints:{type:"number"}}}}}}},f.FLIGHT_TYPE={NON_STOP:"nonStop",CONNECTING:"connecting",THRU:"thru"},f.SEGMENT_NAME={NON_STOP:"flightSeg",CONNECTING:"connectingFlightList",THRU:"flightSegList"},f.prototype.getNumberOfLegs=function(){return this.thruFlightLegs&&this.thruFlightLegs.length||this.legs.length},f.prototype._getOAndDId=function(a){return a.originalOAndD?a.originalOAndD.oAndDId:0===a.direction?"IP1":"IP2"},f.getItineraryType=f.prototype.getItineraryType=function(a){return a.originalOAndD?a.originalOAndD.itineraryType:0===a.direction||"MULTI_CITY"===a.tripType?"OUTBOUND":"INBOUND"},f.prototype._getClassOfServiceForLeg=function(a){var b;return this.tierModel.classOfServiceList.some(function(c){if(c.flightNum===a.flightNum)return b=c.classOfService,!0}),b},f.prototype._defaultDeserializer=function(b,c,f){c.tiers={},a.forEach(b.tiers,function(a,b){var d=new e;d.deserialize(a,"defaultMap",{name:b}),c.tiers[b]=d}),c.tier=f.tier,c.tierModel=c.tiers[c.tier],a.extend(c,{flightType:b.flightType,oAndDId:c._getOAndDId(f),itineraryType:c.getItineraryType(f),information:c.tierModel.fareInformation});var g=function(a,e,g){var h=new d;return h.deserialize(a,"defaultMap"),h.classOfService=c._getClassOfServiceForLeg(h),h.isRedEye=!!b.isRedEye,h.tiers=c.tiers,h.tier=c.tier,h.segNum=g,h.oAndDId=c.oAndDId,h.fareIsUpgraded=!!(f.oldFare&&f.oldFare.legs&&f.oldFare.legs[e]&&f.oldFare.legs[e].tier!==c.tier),h},h=f.segNum;c.legs=[],b.legs.forEach(function(a,b){c.legs.push(g(a,b,++h))}),b.thruFlightLegs&&(h=f.segNum,c.thruFlightLegs=[],b.thruFlightLegs.forEach(function(a,b){c.thruFlightLegs.push(g(a,b,++h))})),c.cost={},c.tierModel.dollarFare&&(c.cost.dollars={base:c.tierModel.dollarFare.baseFare,total:c.tierModel.dollarFare.totalFare}),c.tierModel.pointsFare&&(c.cost.points={base:c.tierModel.dollarFare.baseFare,total:c.tierModel.dollarFare.totalFare,totalPoints:c.tierModel.pointsFare.totalPoints})},f.prototype._flightModelDeserializer=function(b,c,e){a.extend(c,{flightType:f.FLIGHT_TYPE[b.flightType],itineraryType:b.itineraryType,tier:e.tier,oAndDId:b.oAndDId}),c.legs=b.segments.reduce(function(a,b){var e=a[a.length-1];return e&&e.flightId===b.flightId?(e.arrival=b.arrival,e.arrivalDateTime=b.arrivalDateTime):(e=new d,e.deserialize(b,"defaultMap"),e.oAndDId=c.oAndDId,e.tier=c.tier,a.push(e)),a},[])},f.prototype._checkInDeserializer=function(b,c){a.extend(c,{oAndDId:b.oAndDId,itineraryType:b.itineraryType,flightType:f.FLIGHT_TYPE[b.flightType],legs:[]}),b.segments.forEach(function(a,b){var e=new d;e.deserialize(a,"defaultMap"),e.oAndDId=c.oAndDId,e.segNum=b+1,c.legs.push(e)})},f.prototype._ancillariesSerializer=function(a){var b={origin:a.legs[0].departure,destination:a.legs[a.legs.length-1].arrival,itineraryType:a.itineraryType,oAndDId:a.oAndDId},c=a.thruFlightLegs||a.legs;switch(a.flightType){case f.FLIGHT_TYPE.NON_STOP:b[f.SEGMENT_NAME.NON_STOP]=c[0].serialize("ancillaries");break;case f.FLIGHT_TYPE.CONNECTING:b[f.SEGMENT_NAME.CONNECTING]=[],c.forEach(function(a){b[f.SEGMENT_NAME.CONNECTING].push(a.serialize("ancillaries"))});break;case f.FLIGHT_TYPE.THRU:b[f.SEGMENT_NAME.THRU]=[],c.forEach(function(a){b[f.SEGMENT_NAME.THRU].push(a.serialize("ancillaries"))}.bind(this))}return b},f.prototype.getAncillariesSegList=function(){var b,c,d,e=this.serialize("ancillaries"),g=[];return a.forEach(f.SEGMENT_NAME,function(f){e[f]&&(c=a.copy(e[f]),delete e[f],a.isArray(c)||(c=[c]),c.forEach(function(c){b=a.extend({},e,c),d=g[g.length-1],d&&d.flightNum===c.flightNum&&d.oAndDId===d.oAndDId?(d.arrival=b.arrival,d.arrivalDateTime=b.arrivalDateTime):g.push(b)}))}),g},f.prototype._customSerializers={ancillaries:f.prototype._ancillariesSerializer},f.prototype._customDeserializers={defaultMap:f.prototype._defaultDeserializer,flightModel:f.prototype._flightModelDeserializer,checkIn:f.prototype._checkInDeserializer},f}),c("common/models/checkin-model",["angular","common/models/serial-model","common/models/payment-option-model","common/models/selected-fare-model"],function(a,b,c,d){"use strict";var e=function(a){this.init(a)};e.prototype=new b,e.prototype._schema={type:"object",properties:{guestId:{type:"string"},lastName:{type:"string"},firstName:{type:"string"}}},e.prototype._deserializerMappings={checkin:{guestId:"guestId",lastName:"lastName",firstName:"firstName"}},e.prototype._serializerMappings={checkin:{guestId:"guestId",lastName:"lastName",firstName:"firstName"}};var f=function(a){this.init(a)};return f.prototype=new b,f.prototype._schema={type:"object",properties:{checkinInfo:{type:"object",properties:{segList:{type:"array",items:{flightNum:{type:"string"},flightId:{type:"number"}}},paxList:{type:"array",items:"#/definitions/PaxCheckinModel"},baggageOption:{type:"object",optional:"true",properties:{baggageOandDList:{type:"array",items:{flightNum:{type:"string"},flightId:{type:"string"},paxList:{type:"array",items:{pax:"#/definitions/PaxCheckinModel",numOfBag:{type:"number"}}}}}}},upgradeOption:{type:"object",optional:"true",properties:{flightList:{type:"array",items:{flightNum:{type:"string"},flightId:{type:"number"},toBeUpgradedClass:{type:"string"},paxSeatList:{type:"array",items:{pax:"#/definitions/PaxCheckinModel",seatNum:{type:"string"}}}}}}}}},paymentInfo:{type:"object",optional:"true",properties:{creditCardInfo:"#/definitions/PaymentOptionModel"}},identificationInfo:{type:"object",properties:{pnr:{type:"string"},lastName:{type:"string"}}}},definitions:{PaymentOptionModel:c.prototype._schema}},f.prototype._basicSerialization=function(a){return{checkinInfo:{segList:a.checkinInfo.segList,paxList:a.checkinInfo.paxList},identificationInfo:a.identificationInfo}},f.prototype._baggageSerialization=function(a){var b=a._basicSerialization(a);return b.checkinInfo.baggageOption=a.checkinInfo.baggageOption,b},f.prototype._completeCheckInSerializer=function(a){return{travelerInfoList:a.travelerInfoList,oAndDList:[a.oAndDList],checkinInfo:a.checkinInfo,identificationInfo:a.identificationInfo}},f.prototype._loungeOptionsSerializer=function(a){var b=[],c=a.checkinInfo.upgradeOption.flightList;for(var d in c){var e=c[d],f={flightNum:e.flightNum,flightId:e.flightId,toBeUpgradedClass:e.toBeUpgradedClass};b.push(f)}return{checkinInfo:{segList:a.checkinInfo.segList,paxList:a.checkinInfo.paxList,upgradeOption:{flightList:b}},identificationInfo:a.identificationInfo}},f.prototype._customSerializers={basic:f.prototype._basicSerialization,baggage:f.prototype._baggageSerialization,completeCheckIn:f.prototype._completeCheckInSerializer,loungeOptions:f.prototype._loungeOptionsSerializer},f.prototype._chooseFlights=function(b,c){a.extend(c,{identificationInfo:b.identificationInfo,checkinInfo:{segList:[],paxList:[]},travelerInfoList:[],oAndDList:[]}),c.checkinInfo.segList=[],a.forEach(b.flightInfo.segments,function(a){c.checkinInfo.segList.push({flightNum:a.flightNum,flightId:a.flightId})});var f=new d;f.deserialize(b.flightInfo,"checkIn"),c.oAndDList=f.serialize("ancillaries");var g=[];for(var h in b.travelers)g.push(b.travelers[h].serialize("pax")),c.travelerInfoList.push(b.travelers[h].serialize("apiStandard"));a.forEach(g,function(a){var b=new e;b.deserialize(a,"checkin"),c.checkinInfo.paxList.push(b.serialize("checkin"))})},f.prototype._baggageDeserializer=function(b,c){var d={flightNum:null,flightId:null,paxList:[]},f=[];a.forEach(b,function(b){var c=a.copy(d);c.flightNum=b.flightNum,c.flightId=b.flightId,a.forEach(b.paxList,function(a){var b=new e;b.deserialize(a.pax,"checkin"),c.paxList.push({pax:b.serialize("checkin"),numOfBag:a.numOfBag})}),f.push(c)}),c.checkinInfo.baggageOption={baggageOandDList:f}},f.prototype._upgradeDeserializer=function(b,c){var d={flightNum:null,flightId:null,toBeUpgradedClass:null,paxSeatList:[]};return b&&Object.size(b)?(c.checkinInfo.upgradeOption={flightList:[]},void a.forEach(b,function(f){var g=a.copy(d);g.flightNum=f.flightNum,g.flightId=f.flightId,g.toBeUpgradedClass=f.classOfService,a.forEach(b.paxSeatList,function(a){var b=new e;b.deserialize(a.pax,"checkin");var c={pax:b.serialize("checkin"),seatNum:a.seatNum};g.paxSeatList.push(c)}),c.checkinInfo.upgradeOption.flightList.push(g)})):void delete c.checkinInfo.upgradeOption},f.prototype._searchSegForLounge=function(a,b){for(var c in a)if(a[c].arrival===b.airport||a[c].departure===b.airport)return a[c]},f.prototype._loungeDeserializer=function(a,b){var c=a.loungeOptions.map(function(c){var d=b._searchSegForLounge(a.flightInfo.segments,c);return{flightNum:d.flightNum,flightId:d.flightId,airport:c.airport,paxList:b.checkinInfo.paxList.map(function(a){return{pax:a}})}});c.length&&(b.checkinInfo.loungeOption={airportList:c})},f.prototype._customDeserializers={chooseFlights:f.prototype._chooseFlights,baggage:f.prototype._baggageDeserializer,seatUpgrade:f.prototype._upgradeDeserializer,lounge:f.prototype._loungeDeserializer},f}),c("core/services/check-in",["jquery","angular","common/models/checkin-model"],function(a,b,c){"use strict";var d=function(a,b,d,e,f,g,h,i,j,k,l,m){return this._$q=a,this._api=b,this._pnrService=d,this._elevateService=e,this._pubSubService=h,this._travelerService=g,this._extraOptionsResponseModel={},this._loungeOptions={},this._baggageResponseModel={},this._checkinModel=new c,this._purchaseService=f,this._ancillariesService=i,this._locationService=j,this._loadingService=k,this._utilsService=l,this._$deviceProvider=m,this._activeView="LOGIN",this._selectedUpgradeOption={},this._selectedLoungeOptions=[],this._travelers=[],this._nonInfantTravelers=[],this._flightUpgradingBySegment={},this._toBeUpgradedClasses={},this._selectedSeatObj=null,this._upgradeCostsBySegment={},this._upgradeTierExclusions={},this._flightInfo={},this._flightList=[],this._currentTiersBySegment={0:"main",1:"main",2:"main",3:"main"},this._checkInType={COMPLETE_CHECKIN:"completeCheckIn",EXPRESS_CHECKIN:"expressCheckIn"},this._currentCheckInType=this._checkInType.COMPLETE_CHECKIN,this.viewConstants={LOGIN:"LOGIN",FLIGHTS:"FLIGHTS",PASSPORT:"PASSPORT",UPGRADE:"UPGRADE",LOUNGE:"LOUNGE",SEATS_CHANGE:"SEATS_CHANGE",SEATS_SELECT:"SEATS_SELECT",ANCILLARIES_SELECTOR:"ANCILLARIES_SELECTOR",BAGGAGE:"BAGGAGE"},this.urlConstants={LOGIN:"/flight-check-in/",FLIGHTS:"/flight-check-in/choose-flights",PASSPORT:"/flight-check-in/add-passport-info",UPGRADE:"/flight-check-in/upgrade-options",LOUNGE:"/flight-check-in/lounge-options",SEATS_CHANGE:"/flight-check-in/seats/change",SEATS_SELECT:"/flight-check-in/seats/select",ANCILLARIES_SELECTOR:"/flight-check-in/extras",BAGGAGE:"/flight-check-in/bags",PURCHASE:"/purchase",SUCCESS:"/success"},this._pubSubService.subscribe("checkInService.setView",function(a){this.setView(a)}.bind(this)),this._pubSubService.subscribe("ancillaries.retrieved",function(){this._availableAncillaries=this._ancillariesService.getAvailableAncillaries()}.bind(this)),this._pubSubService.subscribe("ancillaries.updateSelectedAncillarySummaryList",this.updateSelectedAncillarySummaryList.bind(this)),this._availableAncillaries=[],this._selectedAncillarySummaryList=[],this._expressCheckInData=null,this._didFirstBaggageCall=!1,{getAvailableAncillaries:this.getAvailableAncillaries.bind(this),viewConstants:this.viewConstants,urlConstants:this.urlConstants,checkInType:this._checkInType,setCheckInType:this.setCheckInType.bind(this),getCheckInType:this.getCheckInType.bind(this),setView:this.setView.bind(this),getView:this.getView.bind(this),doCheckIn:this.doCheckIn.bind(this),doExpressCheckIn:this.doExpressCheckIn.bind(this),getExtraOptions:this.getExtraOptions.bind(this),getUpgradeOptions:this.getUpgradeOptions.bind(this),getLoungeOptions:this.getLoungeOptions.bind(this),getNumberOfLegs:this.getNumberOfLegs.bind(this),setSelectedUpgradeOption:this.setSelectedUpgradeOption.bind(this),getSelectedUpgradeOption:this.getSelectedUpgradeOption.bind(this),setSelectedLoungeOptions:this.setSelectedLoungeOptions.bind(this),getTravelers:this.getTravelers.bind(this),setTravelers:this.setTravelers.bind(this),getNonInfantTravelers:this.getNonInfantTravelers.bind(this),setNonInfantTravelers:this.setNonInfantTravelers.bind(this),getFlightList:this.getFlightList.bind(this),setFlightList:this.setFlightList.bind(this),getTripList:this.getTripList.bind(this),setTripList:this.setTripList.bind(this),buildCheckInSeatMapRequestModels:this.buildCheckInSeatMapRequestModels.bind(this),doBaggageFeeCall:this.doBaggageFeeCall.bind(this),extraPaymentAmount:this.extraPaymentAmount.bind(this),setCurrentSeats:this.setCurrentSeats.bind(this),getCurrentSeats:this.getCurrentSeats.bind(this),doCompleteCheckIn:this.doCompleteCheckIn.bind(this),getUpgradeItemsForPayment:this.getUpgradeItemsForPayment.bind(this),setSelectedSeats:this.setSelectedSeats.bind(this),reset:this.reset.bind(this),setFlightUpgraded:this.setFlightUpgraded.bind(this),getFlightUpgraded:this.getFlightUpgraded.bind(this),setUpgradedClass:this.setUpgradedClass.bind(this),getUpgradedClasses:this.getUpgradedClasses.bind(this),selectedSeats:this.selectedSeats.bind(this),getFlightSegmentByIndex:this.getFlightSegmentByIndex.bind(this),setUpgradeCost:this.setUpgradeCost.bind(this),getUpgradeTierExclusions:this.getUpgradeTierExclusions.bind(this),getCurrentTier:this.getCurrentTier.bind(this),setCurrentTier:this.setCurrentTier.bind(this),areAnySegmentsUpgraded:this.areAnySegmentsUpgraded.bind(this),areAnySegmentsNotUpgraded:this.areAnySegmentsNotUpgraded.bind(this),setUpgradedClassByTier:this.setUpgradedClassByTier.bind(this),purgeUpgradeOptions:this.purgeUpgradeOptions.bind(this),purgeLoungeOptions:this.purgeLoungeOptions.bind(this),updatePassport:this.updatePassport.bind(this),commitUpgradeOptions:this.commitUpgradeOptions.bind(this),hasSelectedUpgradeOption:this.hasSelectedUpgradeOption.bind(this),searchForLoungeOptions:this.searchForLoungeOptions.bind(this),getSeatChangeAvailability:this.getSeatChangeAvailability.bind(this),getSeatChangeAvailabilityForSegment:this.getSeatChangeAvailabilityForSegment.bind(this),setExpressCheckInData:this.setExpressCheckInData.bind(this),getExpressCheckInData:this.getExpressCheckInData.bind(this),doFirstBaggageCall:this.doFirstBaggageCall.bind(this),requestAvailableAncillaries:this.requestAvailableAncillaries.bind(this),getOAndDId:this.getOAndDId.bind(this),updateSelectedAncillarySummaryList:this.updateSelectedAncillarySummaryList.bind(this),isMainCabin:this.isMainCabin.bind(this),skipToAncillariesOrBaggage:this.skipToAncillariesOrBaggage.bind(this)}};return d.$inject=["$q","api","pnrService","elevateService","purchaseService","travelerService","pubSubService","ancillariesService","locationService","loadingService","utilsService","$deviceProvider"],d.prototype.getAvailableAncillaries=function(){return this._availableAncillaries},d.prototype.setUpgradedClassByTier=function(a,b){var c,d,e=this.getUpgradeOptions();for(var f in e)if(d=e[f],b===e[f].name){c=d.classOfService;break}var g=this.getFlightSegmentByIndex(a).flightId;return this.setUpgradedClass(g,c),d},d.prototype.setCheckInType=function(a){this._currentCheckInType=a},d.prototype.getCheckInType=function(){return this._currentCheckInType},d.prototype.setExpressCheckInData=function(a){this._expressCheckInData=a},d.prototype.getExpressCheckInData=function(){return this._expressCheckInData},d.prototype.getCurrentTier=function(a){return this._currentTiersBySegment[a]||"main"},d.prototype.areAnySegmentsNotUpgraded=function(){var a=this.getFlightList().segments.length,b=this.getUpgradeOptions().length;return a!==b},d.prototype.setCurrentTier=function(a,b){b="mc"===b?"main":b;var c,d=this.getUpgradeOptions(a);this._currentTiersBySegment[a]=b;for(var e in d)b===d[e].name&&(c=d[e]);if(c){this.setSelectedUpgradeOption(c,a);var f=this._travelerService.getTravelerAmounts(),g=f.adults+f.children;this.setUpgradeCost(a,c.fee*g)}else this.setUpgradeCost(a,0)},d.prototype.getUpgradeTierExclusions=function(){return this._upgradeTierExclusions},d.prototype.setUpgradeCost=function(a,b){this._upgradeCostsBySegment[a]=b;var c=0;for(var d in this._upgradeCostsBySegment)c+=this._upgradeCostsBySegment[d];this._seatsUpgradeCost=c,this._flightUpgradingBySegment[a]=b>0},d.prototype.areAnySegmentsUpgraded=function(){for(var a in this._flightUpgradingBySegment)if(this._flightUpgradingBySegment[a]===!0)return!0;return!1},d.prototype.getFlightSegmentByIndex=function(a){return this._flightList.segments[a]},d.prototype.setFlightUpgraded=function(a,b){this._flightUpgradingBySegment[a]=b},d.prototype.getFlightUpgraded=function(a){return this._flightUpgradingBySegment[a]},d.prototype.setUpgradedClass=function(a,b){this._toBeUpgradedClasses[a]=b},d.prototype.getUpgradedClasses=function(){return!!Object.size(this._toBeUpgradedClasses)&&this._toBeUpgradedClasses},d.prototype.setView=function(a){this._activeView=a},d.prototype.getView=function(){return this._activeView},d.prototype.setFlightList=function(a){this._flightList=a},d.prototype.getFlightList=function(){return this._flightList},d.prototype.setTripList=function(a){this._tripList=a},d.prototype.getTripList=function(){return this._tripList},d.prototype.setTravelers=function(a){this._travelers=a},d.prototype.getTravelers=function(){return this._travelers},d.prototype.setNonInfantTravelers=function(a){this._nonInfantTravelers=[],b.forEach(a,function(a){"infant"!==a.travelerType&&this._nonInfantTravelers.push(a)}.bind(this))},d.prototype.getNonInfantTravelers=function(){return this._nonInfantTravelers},d.prototype.setSelectedUpgradeOption=function(a,b){this._selectedUpgradeOption[b]=a},d.prototype.commitUpgradeOptions=function(){this._checkinModel.deserialize(this._selectedUpgradeOption,"seatUpgrade")},d.prototype.getSelectedUpgradeOption=function(a){return this._selectedUpgradeOption[a]},d.prototype.hasSelectedUpgradeOption=function(){return!!Object.size(this._selectedUpgradeOption)},d.prototype.setSelectedLoungeOptions=function(a){this._selectedLoungeOptions=a},d.prototype._buildCheckInBasicRequestModel=function(a,b,c){var d={identificationInfo:{pnr:a.pnr,lastName:a.lastName},flightInfo:b,travelers:c};return this._flightInfo=b,this._checkinModel.deserialize(d,"chooseFlights"),this._checkinModel.serialize("basic")},d.prototype._buildCheckInBaggageModel=function(a){var b=this.getFlightList(),c={baggageOandDList:[]},d={flightNum:b.flightNum,flightId:b.flightId,paxList:[]};for(var e in a){var f={pax:a[e].serialize("pax"),numOfBag:a[e].bagCount};d.paxList.push(f)}return c.baggageOandDList.push(d),this._checkinModel.deserialize(c.baggageOandDList,"baggage"),this._checkinModel.serialize("baggage")},d.prototype.convertCabinTypeToTier=function(a){var b;switch(a){case"MC":b="main";break;case"MCS":b="mcs";break;case"FIRST":b="first"}return b},d.prototype.isMainCabin=function(){return"main"===this.getCurrentTier(0)},d.prototype.buildCheckInSeatMapRequestModels=function(){var a=[],b=this.getFlightList().segments,c=[];for(var d in b){var e=b[d];if(c.indexOf(e.flightId)===-1&&"ELIGIBLE"===this.getSeatChangeAvailabilityForSegment(e.flightId)){c.push(e.flightId);var f=e.serialize("defaultMap"),g=this._selectedUpgradeOption[d];g?(f.classOfService=g.classOfService,f.tier=g.name):f.tier=this.convertCabinTypeToTier(f.cabinType),a.push(f)}}return a},d.prototype.setCurrentSeats=function(a){return this._currentSeats=a,a},d.prototype.getCurrentSeats=function(){return this._currentSeats},d.prototype._buildUpgradeOption=function(){var a,b=this.selectedSeats();if(this.getUpgradedClasses()&&b&&b.length){var c=this.selectedSeats(),d=this.getUpgradedClasses(),e=this.getFlightList().segments[0].flightId,f=e>1?e-1:0,g=[];for(var h in c){var i=c[h],j=i.flightId+f;if(d[j]){var k={flightNum:i.flightNum,flightId:j,toBeUpgradedClass:d[j],paxSeatList:[]};for(var l in i.paxSeatList){var m=i.paxSeatList[l],n={seatNum:m.seatNum,pax:{guestId:m.traveler.guestId,lastName:m.traveler.lastName,firstName:m.traveler.firstName}};k.paxSeatList.push(n)}g.push(k)}}a={flightList:g}}return a},d.prototype.doFirstBaggageCall=function(){var a=this._$q.defer();return this._didFirstBaggageCall?a.resolve():(this._travelers.forEach(function(a){a.bagCount=0}),this.doBaggageFeeCall(this._travelers).then(function(){var b=this._getBaggagePaxList();this._travelers.forEach(function(a){b.forEach(function(b){if(a.guestId===b.pax.guestId&&"infant"!==a.travelerType){var c=b.baggageFee.freeBagAllowance||0;a.frequentFlyer=a.frequentFlyer||{},a.frequentFlyer.freeBagAllowance=c,a.bagCount+=b.baggageFee.numOfCheckedInBags,a.ancillaryBagCount&&0===c&&(a.bagCount+=a.ancillaryBagCount+c)}})}),a.resolve()}.bind(this)),this._didFirstBaggageCall=!0),a.promise},d.prototype.doBaggageFeeCall=function(a){var b=this._buildCheckInBaggageModel(a),c=this.selectedSeats(),d=this.getUpgradedClasses();d&&c&&c.length&&(b.checkinInfo.upgradeOption=this._buildUpgradeOption());var e=!0;if(d){for(var f in this._currentSeats){var g=this._currentSeats[f];g.cabinType!==this._currentTiersBySegment[f]&&(e=!1)}e&&delete b.checkinInfo.upgradeOption}var h=this._$q.defer();return this._api.checkin.baggageFee(b).then(function(a){a.data&&a.data.response&&(this._baggageResponseModel=a.data.response),h.resolve()}.bind(this)),h.promise},d.prototype.doExpressCheckIn=function(a,b,c){var d=this._$q.defer(),e=this._buildCheckInBasicRequestModel(a,b,c);return e.deviceType=this._$deviceProvider.getDeviceType(),this._pnrService.setFlightList(b),this._pnrService.doExpressCheckIn(e).then(d.resolve.bind(this),d.reject.bind(this)),d.promise},d.prototype.doCheckIn=function(a,b,c){var d=this._$q.defer(),e=this._pnrService.findPNR("",a.lastName,a.pnr);return this._ancillariesService.reset(),e.then(function(e){var f=this._buildCheckInBasicRequestModel(a,b,c);this._pnrService.getExtraOptions(f).then(function(a){this._extraOptionsResponseModel=a,this.setTravelers(c),this.setNonInfantTravelers(c),this._updateTravelerBagCounts(e,c),this.setFlightList(b),this._setInitialTiers(),d.resolve(!0)}.bind(this))}.bind(this)),d.promise},d.prototype._setInitialTiers=function(){this._flightList.segments.forEach(function(a,b){this.setCurrentTier(b,this.convertCabinTypeToTier(a.cabinType))}.bind(this))},d.prototype._updateTravelerBagCounts=function(a,b){this._ancillariesService.setAncillaryDetailsFromPNR(a.ancillaryDetails),b.forEach(function(a){a.ancillaryBagCount=this._ancillariesService.getBagCountForPax(a,this.getOAndDId())}.bind(this))},d.prototype.requestAvailableAncillaries=function(){return this._ancillariesService.requestAvailableAncillaries({oAndDList:[this._checkinModel.oAndDList]})},d.prototype._resetBaggageOption=function(){var a=0;this._checkinModel.checkinInfo.baggageOption&&this._checkinModel.checkinInfo.baggageOption.baggageOandDList&&(b.forEach(this._getBaggagePaxList(),function(b){a+=b.numOfBag}),0===a&&delete this._checkinModel.checkinInfo.baggageOption)},d.prototype.doCompleteCheckIn=function(a){this._resetBaggageOption(),this._checkinModel.deserialize({flightInfo:this._flightInfo,loungeOptions:this._selectedLoungeOptions},"lounge");var b=this._checkinModel.serialize("completeCheckIn"),c=this.selectedSeats(),d=this.getUpgradedClasses();d&&c&&c.length&&(b.checkinInfo.upgradeOption=this._buildUpgradeOption());var e=!0;if(d){for(var f in this._currentSeats){var g=this._currentSeats[f];g.cabinType!==this._currentTiersBySegment[f]&&(e=!1)}e&&delete b.checkinInfo.upgradeOption}a&&(b.paymentInfo=this._purchaseService.buildPaymentInfoRequest(a.paymentOption));var h=this._buildCheckInSeatsChange(this._selectedSeatObj);return h.length&&(b.seatInfo={seatFlightList:h}),this._elevateService.isLoggedIn()?b.authToken=this._elevateService.getAuthToken():this._purchaseService.getAppliedTravelBank()&&(b.authToken=this._purchaseService.getTravelBankInfo().authToken),b.deviceType=this._$deviceProvider.getDeviceType(),b.ancillaryDetails={ancillaryList:this._ancillariesService.serializeSelectedAncillaries({selectionType:this._ancillariesService.selectionTypes.UI})},b.totalExtrasPrice=this._getSelectedAncillaryTotal(),this._pnrService.doCompleteCheckIn(b)},d.prototype.searchForLoungeOptions=function(){var a=this._$q.defer(),b=this._checkinModel.serialize("loungeOptions");return this._api.checkin.loungeOptions(b).then(function(b){b.data&&b.data.response?(this._loungeOptions=b.data.response,a.resolve()):a.reject(b)}.bind(this)),a.promise},d.prototype._buildCheckInSeatsChange=function(a){var b=[];for(var c in a){var d=a[c],e=this.getSelectedUpgradeOption(d.flightId-1);if(!e){var f=this.getFlightList().segments[0].flightId,g=f>1?f-1:0,h={flightNum:d.flightNum,flightId:d.flightId+g,paxSeatList:[]};for(var i in d.paxSeatList){var j=d.paxSeatList[i],k={mce:!1,seatNum:j.seatNum,pax:{guestId:j.traveler.guestId,lastName:j.traveler.lastName,firstName:j.traveler.firstName}};h.paxSeatList.push(k)}b.push(h)}}return b},d.prototype.setSelectedSeats=function(a){this._selectedSeatObj=a},d.prototype.selectedSeats=function(){return this._selectedSeatObj},d.prototype.getExtraOptions=function(){return this._extraOptionsResponseModel},d.prototype.getOAndDId=function(){return this._flightList&&this._flightList.oAndDId},d.prototype.getNumberOfLegs=function(){var a;if(this._extraOptionsResponseModel&&this._extraOptionsResponseModel.selectedOandDList&&this._extraOptionsResponseModel.selectedOandDList.length>0){var b=!1;"undefined"!=typeof this._extraOptionsResponseModel.selectedOandDList[0].segList[1]&&this._extraOptionsResponseModel.selectedOandDList[0].segList[0].flightNum===this._extraOptionsResponseModel.selectedOandDList[0].segList[1].flightNum&&(b=!0),a=this._extraOptionsResponseModel.selectedOandDList[0].segList.length,a=b?a-1:a}return a},d.prototype.getSeatChangeAvailability=function(){var a=[];if(this._extraOptionsResponseModel&&this._extraOptionsResponseModel.selectedOandDList&&this._extraOptionsResponseModel.selectedOandDList.length>0){var b=this._extraOptionsResponseModel.selectedOandDList[0];for(var c in b.segList){var d=b.segList[c],e={flightId:d.flightId,flightNum:d.flightNum,seatChangeEligibility:d.seatChangeEligibility};a.push(e)}}return a},d.prototype.getSeatChangeAvailabilityForSegment=function(a){var b="NOT_AVAILABLE";if(this._extraOptionsResponseModel&&this._extraOptionsResponseModel.selectedOandDList&&this._extraOptionsResponseModel.selectedOandDList.length>0){var c=this._extraOptionsResponseModel.selectedOandDList[0],d=null;for(var e in c.segList){var f=c.segList[e];if(f.flightId===a){d=f;break}}d&&(b=d.seatChangeEligibility)}return b},d.prototype.getUpgradeOptions=function(a){a||(a=0);var b=[],c={mcToFirst:"first",mcToMCE:"mce",mcToMCS:"mcs",mcsToFirst:"first"};if(this._upgradeTierExclusions[a]=[],this._extraOptionsResponseModel&&this._extraOptionsResponseModel.selectedOandDList&&this._extraOptionsResponseModel.selectedOandDList.length>0){var d=this._extraOptionsResponseModel.selectedOandDList[0];if(d.segList.length>0&&d.segList[a]&&d.segList[a].availableUpgrades)for(var e in d.segList[a].availableUpgrades){var f=d.segList[a].availableUpgrades[e],g="ALL_ELIGIBLE"===f.upgradeStatus,h={flightId:d.segList[a].flightId,flightNum:d.segList[a].flightNum,classOfService:f.classOfService,name:c[e],fee:f.fee,available:g};b.push(h),g||this._upgradeTierExclusions[a].push(c[e].toUpperCase())}}return b},d.prototype.getLoungeOptions=function(a){var b=this.getFlightSegmentByIndex(a||0);if(this._extraOptionsResponseModel&&this._extraOptionsResponseModel.selectedOandDList&&this._extraOptionsResponseModel.selectedOandDList.length>0){var c=Object.size(this._loungeOptions)&&this._loungeOptions.selectedOandDList&&this._loungeOptions.selectedOandDList.length>0?this._loungeOptions.selectedOandDList[0]:this._extraOptionsResponseModel.selectedOandDList[0],d=["AVAILABLE","COMPLIMENTARY"],e="LOUNGE_CLOSED",f=this._utilsService.formatLounge,g=c.availableLounges.paxList.reduce(function(a,c){var g=[];return c.originLounge.airport===b.departure&&g.push("originLounge"),c.destLounge.airport===b.arrival&&g.push("destLounge"),g.reduce(function(a,b,g){var h=c[b],i=a[g]||{airport:h.airport,loungeName:f(h.airport),totalFee:0,totalPax:0,available:!0,closed:!1,_rawData:[]};return d.indexOf(h.status)!==-1?(i.totalFee+=h.fee||0,i.totalPax+=1):i.available=!1,h.status===e&&(i.closed=!0),i._rawData.push(h),a[g]=i,a},a)},[]);return g}return[]},d.prototype.extraPaymentAmount=function(){var a=0;for(var c in this._upgradeCostsBySegment)a+=this._upgradeCostsBySegment[c];return b.forEach(this._selectedLoungeOptions,function(b){a+=b.totalFee}),b.forEach(this._getBaggagePaxList(),function(b){b.baggageFee&&(a+=b.baggageFee.fees)}),a+=this._getSelectedAncillaryTotal(),this._purchaseService.setCheckInExtraPaymentAmount(a),this._purchaseService.calculateCostAndTaxes(),a},d.prototype.updateSelectedAncillarySummaryList=function(){this._selectedAncillarySummaryList=this._ancillariesService.getSelectedAncillarySummaryList()},d.prototype._getSelectedAncillaryTotal=function(){return this._selectedAncillarySummaryList.reduce(function(a,b){return a+b.totalAmount},0)},d.prototype._getBaggagePaxList=function(){var a=[];if(this._baggageResponseModel&&this._baggageResponseModel.selectedOandDList&&this._baggageResponseModel.selectedOandDList.length>0){var b=this._baggageResponseModel.selectedOandDList[0];b&&b.baggageOption&&b.baggageOption.paxList&&b.baggageOption.paxList.length>0&&(a=b.baggageOption.paxList)}return a},d.prototype.getUpgradeItemsForPayment=function(){var a=[],c=[];b.forEach(this._selectedLoungeOptions,function(b){a.push({price:b.totalFee,name:b.loungeName+" (x"+b.totalPax+")"}),c.push({title:b.airport+" Lounge",totalAmount:b.totalFee,totalNumPurchased:b.totalPax})});var d={price:0,quantity:0};if(b.forEach(this._getBaggagePaxList(),function(a){a.baggageFee.fees>0&&(d.price+=a.baggageFee.fees,d.quantity+=a.baggageFee.numOfExcessBags)}),d.price&&(c.push({title:"Checked Bags",totalAmount:d.price,totalNumPurchased:d.quantity}),d.name="Extra bags (x"+d.quantity+")",delete d.quantity,a.push(d)),Object.size(this._upgradeCostsBySegment)&&this._seatsUpgradeCost>0){var e={price:this._seatsUpgradeCost,name:"Seat upgrade (x"+this.getNonInfantTravelers().length+")"};a.push(e)}return this._selectedAncillarySummaryList.forEach(function(b){var d={price:b.totalAmount,name:b.title+" (x"+b.totalNumPurchased+")"};a.push(d),c.push(b)}),this._pubSubService.publish("adobeAnalytics.ancillarySummary",[c]),
a},d.prototype.reset=function(){this._checkinModel.reset(),this._extraOptionsResponseModel={},this._baggageResponseModel={},this._activeView="LOGIN",this._selectedUpgradeOption={},this._selectedLoungeOptions=[],this._travelers=[],this._flightList=[],this._flightUpgradingBySegment={},this._toBeUpgradedClasses={},this._selectedSeatObj=null,this._upgradeCostsBySegment={},this._upgradeTierExclusions=[],this._currentTiersBySegment={}},d.prototype.purgeUpgradeOptions=function(){this._upgradeCostsBySegment={},this._selectedUpgradeOption={},this._flightUpgradingBySegment={},this._toBeUpgradedClasses={},this._seatsUpgradeCost=0},d.prototype.updatePassport=function(a,b){return b.identificationInfo={pnr:a.pnr,lastName:a.lastName},this._api.manage.updatePassport(b)},d.prototype.purgeLoungeOptions=function(){this._selectedLoungeOptions=[]},d.prototype.skipToAncillariesOrBaggage=function(){var a=this._$q.defer(),b=[this.doFirstBaggageCall()],c=this.viewConstants.BAGGAGE;this._didFirstBaggageCall=!1,this._loadingService.setLoading(a.promise),this.isMainCabin()&&!this._purchasedExpressSeats()&&(this._ancillariesService.useUISelections(),b.push(this.requestAvailableAncillaries())),this._$q.all(b).then(function(){this.isMainCabin()&&this._ancillariesService.shouldShowCheckInAncillaries(this.getOAndDId())&&(c=this.viewConstants.ANCILLARIES_SELECTOR),a.resolve(),this._locationService.update(this.urlConstants[c]),this.setView(this.viewConstants[c])}.bind(this))},d.prototype._purchasedExpressSeats=function(){return this._currentSeats.some(function(a){return a.seats&&a.seats.some(function(a){return a.mce})})},d}),c("core/services/manage",["angular"],function(a){"use strict";var b=function(a,b,c){return this._$q=a,this._api=b,this._pnrService=c,this._pnr=null,this._lastName=null,this._travelers=[],this._pnrModel={},{emailItinerary:this.emailItinerary.bind(this),addKnownTravelerNumber:this.addKnownTravelerNumber.bind(this),validateFfpNumber:this.validateFfpNumber.bind(this),setPnr:this.setPnr.bind(this),getPnr:this.getPnr.bind(this),setLastName:this.setLastName.bind(this),getLastName:this.getLastName.bind(this),getTravelers:this.getTravelers.bind(this),setTravelers:this.setTravelers.bind(this),savePnrModel:this.savePnrModel.bind(this),getPnrModel:this.getPnrModel.bind(this),reset:this.reset.bind(this),getPNRFromSummary:this.getPNRFromSummary.bind(this),getCalendarUrl:this.getCalendarUrl.bind(this),updatePassport:this.updatePassport.bind(this),applyMCSOptIn:this.applyMCSOptIn.bind(this)}};return b.$inject=["$q","api","pnrService"],b.prototype.setPnr=function(a){this._pnr=a},b.prototype.getPnr=function(){return this._pnr},b.prototype.setLastName=function(a){this._lastName=a},b.prototype.getLastName=function(){return this._lastName},b.prototype.setTravelers=function(a){this._travelers=a},b.prototype.getTravelers=function(){return this._travelers},b.prototype.emailItinerary=function(a,b,c){var d=this._$q.defer(),e=[];a=a.replace(/,/g,"\n");var f=a.split("\n");b=b?b:this.getPnr(),c=c?c:this.getLastName();for(var g in f){var h=f[g].trim(),i={pnr:b,emailAddress:h,includeBillingInfo:!0,lastName:c};e.push(this._api.manage.emailItinerary(i))}return this._$q.all(e).then(function(){d.resolve(f)}.bind(this)),d.promise},b.prototype.addKnownTravelerNumber=function(a,b,c,d){var e=d?d:this.getPnr(),f={lastName:b,firstName:a,pnr:e,knownTravelerNumber:c};return this._api.manage.addKtNumber(f)},b.prototype.updatePassport=function(a){var b=a.identificationInfo&&a.identificationInfo.pnr?a.identificationInfo.pnr:this.getPnr(),c=a.identificationInfo&&a.identificationInfo.lastName?a.identificationInfo.lastName:this.getLastName();return a.identificationInfo={pnr:b,lastName:c},this._api.manage.updatePassport(a)},b.prototype.applyMCSOptIn=function(a){var b={pnr:a.pnr,lastName:a.lastName};return this._api.manage.applyMCSOptIn(b)},b.prototype.validateFfpNumber=function(a,b){var c={ffpNum:a,partnerAirline:b};this._api.elevate.validateFfpNumber(c)},b.prototype.savePnrModel=function(b){var c=this;a.forEach(b,function(a,b){c._pnrModel[b]=c._pnrService.getMorePnrInfo(a)})},b.prototype.getPnrModel=function(){return this._pnrModel},b.prototype.reset=function(){this._pnr=null,this._lastName=null,this._travelers=[],this._pnrModel={}},b.prototype.getPNRFromSummary=function(a,b){var c=a.flightList[0].lastName||this._lastName,d=this._pnrService.retrievePNR("",c,a.pnr);return d.then(function(a){this._pnrModel[b]=this._pnrService.getMorePnrInfo(a)}.bind(this)),d},b.prototype.getCalendarUrl=function(a,b,c,d){var e=this._api.manage.getCalendarUrl();return e+"?fileID=001&subject="+a+"&description="+b+"&departureDateTime="+c+"&arrivalDateTime="+d},b}),c("core/services/script-loader",["jquery"],function(a){"use strict";var b=function(){return this._scriptStatus={},this._statuses={LOADING:"loading",LOADED:"loaded"},{load:this.load.bind(this),isLoaded:this.isLoaded.bind(this)}};return b.prototype.load=function(b){this._scriptStatus[b]||(this._scriptStatus[b]=this._statuses.LOADING,a.getScript(b,function(){this._scriptStatus[b]=this._statuses.LOADED}.bind(this)))},b.prototype.isLoaded=function(a){return this._scriptStatus[a]===this._statuses.LOADED},b}),c("core/services/pubsub",["jquery"],function(a){"use strict";var b=function(){var b={};return{publish:function(c,d){b[c]&&a.each(b[c],function(){this.apply(null,d||[])})},subscribe:function(a,c){return b[a]||(b[a]=[]),b[a].push(c),[a,c]},unsubscribe:function(c){var d=c[0];b[d]&&a.each(b[d],function(a){this===c[1]&&b[d].splice(a,1)})},clear:function(a){b[a]&&(b[a]=[])}}};return b}),c("core/services/exception-handler",[],function(){"use strict";var a=function(a){var b=a;return function(a){b.setShowAppLoader(!1)}};return a.$inject=["windowService"],a}),c("core/services/adobe-analytics-service",["moment","angular"],function(a,b){"use strict";var c=function(a,b,c,d,e,f){return this._pubSubService=a,this._$location=c,this._$rootScope=b,this._$q=d,this._locationService=e,this._env=f,this._intervalAttempts=0,this._latestRequestQuote=null,this._loadAdobeAnalytics().then(function(){this._adobeAnalytics=window.adobeAnalyticsNext}.bind(this)),this._ensightenInterval=setInterval(this._verifyEnsighten.bind(this),250),this._EVENTS={ELEVATE_STATE:"ELEVATE_STATE",SELECTED_FARES:"SELECTED_FARES",FARE_INTENTION:"FARE_INTENTION",ERROR_MESSAGE:"ERROR_MESSAGE",RESTRICTED_PAGE:"RESTRICTED_PAGE",PAGE_NOT_FOUND:"PAGE_NOT_FOUND",MODAL_OPENED:"MODAL_OPENED",TRAVEL_ADVISORY:"TRAVEL_ADVISORY",BOARDING_PASS:"BOARDING_PASS"},this._webData={pageName:"home",siteSection:"home",servEnv:"TC",events:[]},this._adobeEvents={restrictedPage:"restrictedPage",viewportChange:"viewportChange",chatRequested:"chatRequested",callRequested:"callRequested",freeEventChange:"freeEventChange",siteAlert:"siteAlert",register:"register",signin:"signin",signout:"signout",profileUpdate:"profileUpdate",forgotPassword:"forgotPassword",failedLogin:"failedLogin",emailSubscription:"emailSubscription",processStart:"processStart",processEnd:"processEnd",contactUs:"contactUs",seatUpgrade:"seatUpgrade",flightCheckIn:"flightCheckIn",flightChangeFee:"flightChangeFee",flightChangeFare:"flightChangeFare",flightNotification:"flightNotification",postPointsClaim:"postPointsClaim",pointCalculator:"pointCalculator",flightCompare:"flightCompare",flightUpgrade:"flightUpgrade",flightSearch:"flightSearch",calendarSearchPage:"calendarSearchPage",flightFareSelected:"flightFareSelected",flightSeatSelectionComplete:"flightSeatSelectionComplete",flightCheckout:"flightCheckout",flightPayment:"flightPayment",flightPaymentFailed:"flightPaymentFailed",ytsChangeApplied:"ytsChangeApplied",promoAdded:"promoAdded",promoClicked:"promoClicked",promoApplied:"promoApplied",promoDiscount:"promoDiscount",promoBooking:"promoBooking",originDestinationSelected:"originDestinationSelected",secondFlightSearch:"secondFlightSearch",whoIsFlying:"whoIsFlying",deptDateSelected:"deptDateSelected",fareSelected:"fareSelected",seatSelectionDeparting:"seatSelectionDeparting",continueAsGuest:"continueAsGuest",fillFormSignIn:"fillFormSignIn",completeButton:"completeButton",payNow:"payNow",addedNewCard:"addedNewCard",travelBank:"travelBank",purchaseTicketsClick:"purchaseTicketsClick",sevenDayComparison:"sevenDayComparison",sevenDayContinue:"sevenDayContinue",visaCheckoutClicked:"visaCheckoutClicked",visaCheckoutSelected:"visaCheckoutSelected",fareSelectorPointsToggle:"fareSelectorPointsToggle",completedTravelerInformation:"completedTravelerInformation",skippedOrSelectedExtras:"skippedOrSelectedExtras",ancillaryOpened:"ancillaryOpened",bookOnAlaska:"bookOnAlaska",closeBookOnAlaska:"closeBookOnAlaska",alaskaBannerShown:"alaskaBannerShown",isAlaskaOnly:"isAlaskaOnly",alaskaRedirectOffered:"alaskaRedirectOffered",reachLastAvailableDateOnBooking:"reachLastAvailableDateOnBooking",reachLastAvailableDateOnChange:"reachLastAvailableDateOnChange",bookOnAlaskaNotAvailableDate:"bookOnAlaskaNotAvailableDate",alaskaCardPromo:"alaskaCardPromo"},this._bookingFlowSteps={flightSearch:0,flightFareSelected:1,flightSeatSelectionComplete:2,flightCheckout:3},window.webData=this._webData,this._state={view:"",flightSearchResults:{},history:{triggerEvent:""},loggedInState:"anonymous",tripType:null,searchRootOD:null,selectedFares:[]},this._tripTypes={ROUND_TRIP:"RT",ONE_WAY:"OW",MULTI_CITY:"MC"},this.ANCILLARY_CONTEXTS={BOOKING_ANCILLARY_SCREEN:"AS",BOOKING_SEATMAP_MODAL:"SMM",BOOKING_SEATMAP_PREMIUM_SEATS:"SMPS",NEW_CHANGE_ANCILLARY_SCREEN:"CBAAS",NEW_CHANGE_SEATMAP_MODAL:"CBASMM",NEW_CHANGE_SEATMAP_PREMIUM_SEATS:"CBASMPS",EXISTING_CHANGE_ANCILLARY_SCREEN:"CBAAS",EXISTING_CHANGE_SEATMAP_MODAL:"CBASMM",EXISTING_CHANGE_SEATMAP_PREMIUM_SEATS:"CBASMPS",CHECKIN_ANCILLARY_SCREEN:"CHAS"},this.WEB_DATA_KEYS={ANCILLARY_SELECTIONS:"ancillaryType",ANCILLARY_LOCATION:"ancillaryLocation",PROMOTION_SHOWN:"promotionShown"},this._webData.reportSuite=this._env.analytics().reportSuite||"dev",this.cid=this.getCIDValue(),this._webData.abVersion=this._env.meta("abVersion"),this._$rootScope.$on("$locationChangeSuccess",function(){try{this._viewChange.call(this,this._$location.path())}catch(a){this._logError(a)}}.bind(this)),this._configurePubSub(),{receivedAPIResponse:this.receivedAPIResponse.bind(this),UIEvent:this.UIEvent.bind(this),fireEvent:this.fireEvent.bind(this),fireEventObject:this.fireEventObject.bind(this),EVENTS:this._EVENTS,events:this._adobeEvents,ANCILLARY_CONTEXTS:this.ANCILLARY_CONTEXTS,updateWebData:this.updateWebData.bind(this),WEB_DATA_KEYS:this.WEB_DATA_KEYS}};return c.prototype._verifyEnsighten=function(){window.Bootstrapper?(clearInterval(this._ensightenInterval),this._ENSIGHTEN=window.Bootstrapper):this._intervalAttempts>40?clearInterval(this._ensightenInterval):this._intervalAttempts++},c.prototype.updateWebData=function(a,b){this._webData[a]=b},c.prototype._loadAdobeAnalytics=function(){var a=this._$q.defer(),b=document.createElement("script");return b.async=!0,b.src="/scripts/AdobeAnalyticsNext.js",b.onload=function(){a.resolve()},document.body.appendChild(b),a.promise},c.prototype.getCIDValue=function(){var a=this.getUrlValue("cid");return a||(a=this._getCookie("s_cid")),a},c.$inject=["pubSubService","$rootScope","$location","$q","locationService","envService"],c.prototype.UIEvent=function(a,b){if("undefined"!=typeof a)switch(a){case"ELEVATE_STATE":this._setLoggedinState(b);break;case"MODAL_OPENED":this._setModelOpenedState(b);break;case"PAGE_NOT_FOUND":this._setPageNotFoundState(b);break;case"RESTRICTED_PAGE":this._setRestrictedPageState(b);break;case"ERROR_MESSAGE":this._setErrorMessageState(b);break;case"BOARDING_PASS":b&&b.accessType&&this._sendEventTrigger("boardingPassRedeem",{boardingPassRedeem:b.accessType})}},c.prototype.receivedAPIResponse=function(a,b,c,d){"object"==typeof d&&(this._webData=d.webData,this._state=d.localState);try{if(!this._webData)return!1;this._webData.flightBooking||(this._webData.flightBooking={});var e="",f=a.replace(/\//g,":");if(/cart:(update|retrieve)/i.test(f))return;switch(f){case":api:v2:booking:purchase":c.status&&/error/i.test(c.status.status)?(this._setFlightPaymentFailedData(b,c),e="flightPaymentFailed"):(this._setFlightPaymentData(b,c),e="flightPayment");break;case":api:v2:elevate:join-elevate":this._setRegisterProcessData(b,c),e="register";break;case":api:v2:elevate:login":e=this._setSigninProcessData(b,c);break;case":api:v2:elevate:logout":e="signout";break;case":api:v2:elevate:forget-elevate-password":this._setForgotPasswordData(b,c),e="forgotPassword";break;case":api:v2:elevate:profile-modify":this._state.modalURL&&(this._profileUpdateData(b,c),e="profileUpdate");break;case":api:v2:elevate:retrieve-account-info":this._setElevateAccountData(b,c),e="retrieveAccountInfo";break;case":api:v2:manage:pnr":this._setManagePNRData(b,c),e="managePNR";break;case":api:v2:checkin:complete":this._setFlightCheckinComplete(b,c),e="flightCheckIn";break;case":api:v2:checkin:express":this._setFlightCheckinComplete(b,c),e="flightCheckIn";break;case":api:v2:cancel:complete":this._webData.pageName="Manage: Cancel: Completed",e="flightCancel";break;case":api:v2:change:complete":this._setFlightChangeComplete(b,c),e="flightChange";break;case":api:v2:manage:complete":this._setFlightComplete(b,c),e="flightChange";break;case":api:v2:flightalerts:subscribe":this._setSiteAlertData(b,c),e="siteAlert";break;case":api:v2:config:state":break;default:this._webData.pageName="Untrapped API: "+f,e="untrappedAPI"}e?("number"==typeof this._bookingFlowSteps[this._state.history.triggerEvent]&&"number"==typeof this._bookingFlowSteps[e]&&this._bookingFlowSteps[this._state.history.triggerEvent]>this._bookingFlowSteps[e]&&this._webData.events.push("ytsChangeApplied"),this._state.history.triggerEvent=e,this._sendEventTrigger(e),this._log("TriggerEvent Call ["+e+"]: ",!1,{apiKey:f,triggerEvent:e,localState:this._state,webData:this._webData,req:b,res:c})):this._webData.pageError&&(this._adobeAnalytics.setWebEvent("pageError",{pageError:this._webData.pageError}),this._log("Set seperate API error: ",!1,this._webData.pageError)),e||this._log("API call: ",!1,{apiKey:f,triggerEvent:e,localState:this._state,req:b,res:c}),"object"==typeof wd&&(window.webData=this._webData)}catch(a){this._logError("Critical analytics error: ",{innerException:a})}},c.prototype._viewChange=function(a){var b=a.replace(/^\//,"").replace(/\//g,"_");this._state.view=b?b:"home";var c="LC-"+this._state.view,d="LC-success"===c&&this._webData.pageName.indexOf("Booking")===-1;d||this._ENSIGHTEN&&(this._ENSIGHTEN.ensEvent.trigger(c),this._log("Ensighten FireEvent (Location change): ",!1,this._state.view)),b&&!/^(purchase)$/.test(b)&&(this._webData.pageName=b,this._sendEventTrigger("viewChanged",this._webData))},c.prototype._setLoggedinState=function(a){if("undefined"!=typeof a)try{a.isLoggedIn||a.elevateUser&&a.elevateUser.elevateId?this._state.loggedInState="signed in":this._state.loggedInState=this._state.isRecognizedNotLoggedIn?"registered":"anonymous",this._webData.signinStatus=this._state.loggedInState}catch(a){this._logError("Could not set [setLoggedinState] state: ",{innerException:a})}},c.prototype._setModelOpenedState=function(a){if("undefined"!=typeof a)try{if(a.templateUrl){var b=a.templateUrl.match(/credit-card/);a.templateUrl=a.templateUrl.replace(/^\/|\.html|.tpl/gi,""),a.templateUrl=a.templateUrl.replace(/\//gi,": ");var c,d=["modalview",a.templateUrl].join(": ");b&&(c=this._locationService.contextIs(this._locationService.contexts.ELEVATE)?": elevate":": booking funnel",d+=c),this._state.modalURL=d;var e={pageName:this._state.modalURL};/compare-fares/i.test(this._state.modalURL)&&(e.events=["flightCompare"]),this._sendEventTrigger("modalView",e)}}catch(a){this._logError("Could not set [setModelOpened] state: ",{innerException:a})}},c.prototype._setPageNotFoundState=function(a){if("undefined"!=typeof a)try{a.path&&this._sendEventTrigger("pageNotFound",{pageName:["pageNotFound",a.path].join(": "),pageNotFoundURL:a.path})}catch(a){this._logError("Could not set [setPageNotFoundState] state: ",{innerException:a})}},c.prototype._setRestrictedPageState=function(a){if("undefined"!=typeof a)try{a.page&&this._sendEventTrigger("restrictedPage",{pageName:["restricted",a.page].join(": ")})}catch(a){this._logError("Could not set [setRestrictedPageState] state: ",{innerException:a})}},c.prototype._setErrorMessageState=function(a){if("undefined"!=typeof a)try{a.message&&this._sendEventTrigger("uiErrorMessage",{uiErrorMessage:a.message})}catch(a){this._logError("Could not set [setErrorMessageState] state: ",{innerException:a})}},c.prototype._applyAffectedFlights=function(b,c){var d={};for(var e in b){var f,g="object"==typeof b[e]?b[e].flightId:parseInt(b[e]);for(var h in c){var i=c[h],j=!!i.connectingFlightList,k=!1;if(j)for(var l in i.connectingFlightList){var m=i.connectingFlightList[l];parseInt(m.flightSeg.flightId)===g&&(f=m.flightSeg,k=!0)}else parseInt(i.flightSeg.flightId)===g&&(f=i.flightSeg,k=!0);if(k){var n={};n.upgrade={},n.upgrade.origin=i.origin,n.upgrade.destination=i.destination,n.upgrade.odPair=n.upgrade.origin+"-"+n.upgrade.destination,n.upgrade.departureDate=a(f.departureDateTime).format("l"),n.upgrade.arrivalDate=a(f.arrivalDateTime).format("l"),n.upgrade.classOfService=f.classOfService,n.upgrade.cabinClass=f.cabinClass,n.upgrade.cabinType=f.cabinType,n.upgrade.index=h,n.baggage=0,n.lounge=0,"object"==typeof f.extras&&("undefined"!=typeof f.extras.other&&(n.baggage=f.extras.other),"undefined"!=typeof f.extras.lounge&&(n.lounge=f.extras.lounge)),d[g]=n}}}return d},c.prototype._setFlightComplete=function(){this._webData.pageName="Manage: Change: Completed";var a={};a.changeFee="0",a.ccAmountCharged="0",a.totalMsrRefundAmount="0",a.baseFareDifference="0",a.totalFareDifference="0",a.typeOfChange="unknown",a.newFareInfo={},a.originalFareInfo={},a.flightDirection="NA",this._ancillarySummaryList&&(this._webData.ancillaryObj=this._ancillarySummaryList),this._webData.flightBooking.flightChange=a},c.prototype._setFlightChangeComplete=function(a,b){this._webData.pageName="Manage: Change: Completed";var c={};if(c.changeFee="0",c.ccAmountCharged="0",c.totalMsrRefundAmount="0",c.baseFareDifference="0",c.totalFareDifference="0",c.typeOfChange="unknown",c.newFareInfo={},c.originalFareInfo={},c.flightDirection="NA","object"==typeof b.response&&("object"==typeof b.response.originalFareInfo&&(c.originalFareInfo=b.response.originalFareInfo),"object"==typeof b.response.newFareInfo&&(c.newFareInfo=b.response.newFareInfo),"undefined"!=typeof b.response.ccAmountCharged&&(c.ccAmountCharged=b.response.ccAmountCharged),"undefined"!=typeof b.response.totalMsrRefundAmount&&(c.totalMsrRefundAmount=b.response.totalMsrRefundAmount),"undefined"!=typeof c.originalFareInfo.baseFare&&(c.baseFareDifference=c.newFareInfo.baseFare-c.originalFareInfo.baseFare,c.baseFareDifference=parseFloat(c.baseFareDifference).toFixed(2)),"undefined"!=typeof c.originalFareInfo.totalFare&&(c.totalFareDifference=c.newFareInfo.totalFare-c.originalFareInfo.totalFare,c.totalFareDifference=parseFloat(c.totalFareDifference).toFixed(2)),"undefined"!=typeof b.response.changeFee&&(c.changeFee=b.response.changeFee)),a.changeAndCancelInfo&&"object"==typeof a.changeAndCancelInfo.exchangingFlightIdList){var d=a.changeAndCancelInfo.exchangingFlightIdList,e=b.response.pnrInfo.oAndDList;c.to=this._applyAffectedFlights(d,e),c.from=this._applyAffectedFlights(d,this._webData.originalOAndDList),1===e.length?c.flightDirection="OW":c.flightDirection=1===c.to.index?"DF":"RF"}this._ancillarySummaryList&&(this._webData.ancillaryObj=this._ancillarySummaryList),this._webData.flightBooking.flightChange=c},c.prototype._setFlightCheckinComplete=function(a,c){this._webData.pageName="Manage: Check-in: Completed";var d=a.checkinInfo.segList,e=function(a){return t.flightId===a.flightId},f=this._applyAffectedFlights(d,c.response.pnrInfo.oAndDList),g=this._applyAffectedFlights(d,this._webData.originalOAndDList),h=a.checkinInfo,i={};"undefined"!=typeof c.response.extraPaymentInfo&&(i=c.response.extraPaymentInfo),"undefined"!=typeof c.response.pnrInfo.extras&&(this._webData.ancillaryExtra=c.response.pnrInfo.extras.other),this._webData.flightBooking.affectedSegments=this._webData.flightBooking.segments=h.segList;var j,k,l,m,n,o,p=c.response.pnrInfo;if(h.baggageOption&&"undefined"!=typeof h.baggageOption.baggageOandDList)for(j in this._webData.flightBooking.affectedSegments){var q={};o=this._webData.flightBooking.affectedSegments[j],n=o.flightNum.replace(/^0+/,"");for(k in h.baggageOption.baggageOandDList){var r=h.baggageOption.baggageOandDList[k];if(m=r.flightNum.replace(/^0+/,""),n===r.flightNum.replace(/^0+/,"")){q.numOfBag=0,q.fee=0,f[r.flightId].baggage&&(q.fee=f[r.flightId].baggage);for(l in r.paxList)q.numOfBag+=r.paxList[l].numOfBag;this._webData.flightBooking.affectedSegments[j].baggage=q}}}if("undefined"!=typeof h.upgradeOption&&"undefined"!=typeof h.upgradeOption.flightList){var s=[];for(k in p.extraPaymentHistory.upgradeFee.segList){var t=p.extraPaymentHistory.upgradeFee.segList[k],u={},v=h.segList.filter(e);if(v.length){u.numOfUpgrades=0,u.fee=0;for(l in t.paxList)u.fee+=t.paxList[l].feeAmount,u.numOfUpgrades+=1,u.isUpgraded=!0;u.to=f[t.flightId].upgrade,u.from=g[t.flightId].upgrade,s.push(u)}}this._webData.flightBooking.upgrades=s}c.response.extraPaymentInfo&&"undefined"!=typeof c.response.extraPaymentInfo.loungeFee&&(this._webData.flightBooking.loungeFee=c.response.extraPaymentInfo.loungeFee),this._ancillarySummaryList&&(this._webData.ancillaryObj=this._ancillarySummaryList.map(function(a){return b.extend({},a,{analyticsState:this.ANCILLARY_CONTEXTS.CHECKIN_ANCILLARY_SCREEN})}.bind(this)))},c.prototype._setTripOriginDestinationAndType=function(a){var b=a.cityPairs[0].dep,c=a.cityPairs[0].des;"MULTI_CITY"===a.tripType?this._webData.rootOD="MC:"+[a.cityPairs[0].dep,a.cityPairs[0].des].join("-")+"|"+[a.cityPairs[1].dep,a.cityPairs[1].des].join("-"):this._webData.rootOD=b+"-"+c;var d=this._tripTypes[a.tripType];this._webData.flightType=d,this._state.tripType=d},c.prototype._setTripOriginAndDestinationSelected=function(a){this._webData.pageName="Booking Funnel: O&D Selected",this._webData.siteSection="Booking Funnel",this._webData.flightBooking={},this._setTripOriginDestinationAndType(a)},c.prototype._setTripWhoIsFlying=function(a){this._webData.pageName="Booking Funnel: Whos is Flying",this._webData.siteSection="Booking Funnel",this._webData.flightBooking={},this._setTripOriginDestinationAndType(a)},c.prototype._setTripDepartureDateSelected=function(a){this._webData.pageName="Booking Funnel: Departure Date Selected",this._webData.siteSection="Booking Funnel",this._webData.flightBooking={},this._setTripOriginDestinationAndType(a)},c.prototype._setTripSearchData=function(a){this._webData.pageName="Booking Funnel: Flight Search",this._webData.siteSection="Booking Funnel",this._webData.flightBooking={};var b=this._state.searchRootOD;return this._setTripOriginDestinationAndType(a),this._state.searchRootOD=this._webData.rootOD,this._webData.searchDepartureDtm=a.dates[0],this._webData.daysToBooking=this._daysBetween(new Date,new Date(a.dates[0]))+1,"ONE_WAY"!==a.tripType&&(this._webData.searchReturningDtm=a.dates[1],this._webData.tripDuration=this._daysBetween(new Date(a.dates[0]),new Date(a.dates[1]))),this._webData.travelers={adults:a.travelers.adults,children:a.travelers.children,lapInfants:a.travelers.infants,pets:a.travelers.pets,pax:a.travelers.adults+a.travelers.children},!b||b!==this._webData.rootOD},c.prototype._setApplyPromoData=function(a,b){this._webData.promoCode=a.promoCode;try{b.status&&/error/i.test(b.status.status)?(this._webData.pageName="Booking Funnel: Apply Promo Code: Failed",this._webData.pageError=["Promo code failed",b.status.error.code,b.status.error.developerMessage].join("|")):(this._webData.pageName="Booking Funnel: Apply Promo Code: Success",this._webData.events.push("promoApplied"))}catch(a){this._logError("Could not capture [setFlightSearchData] data: ",{innerException:a})}},c.prototype._setTripFareSelected=function(){this._webData.pageName="Booking Funnel: Fare Selected"},c.prototype._setTripFareOptionsSelected=function(){this._webData.pageName="Booking Funnel: Fare Options Selected"},c.prototype._setTripSeatSelection=function(){this._webData.pageName="Booking Funnel: Seat Selection"},c.prototype._setTripFareSelectedData=function(a){if(this._webData.pageName="Booking Funnel: Flight & Fare Selected",this._webData.flightBooking={segments:[]},this._state.selectedFares=b.copy(a),a&&a.length>0)for(var c in a){var d=a[c],e=d.legs;this._webData.flightBooking.segments=this._webData.flightBooking.segments.concat(this._getFlightSegmentsFromSelectedFare("MULTI_CITY"===this._state.tripType?"MC":"DF",d,e))}},c.prototype._isCreditCard=function(a){return"travelbank"!==a.cardType.toLowerCase()&&"lp"!==a.cardType.toLowerCase()},c.prototype._setFlightPaymentData=function(a,b){if(this._webData.pageName="Booking Funnel: Payment Confirmed",a.bookingInfo&&"object"==typeof a.bookingInfo.travelerInfoList){var c=new Date;this._webData.elevateProfile={gender:a.bookingInfo.travelerInfoList[0].gender,age:a.bookingInfo.travelerInfoList[0].dob?c.getFullYear()-a.bookingInfo.travelerInfoList[0].dob.substr(0,4):""}}var d=!1;if(a&&a.paymentInfo){var e=a.paymentInfo,f=e.creditCardInfo?e.creditCardInfo:e.pointsDetails&&e.pointsDetails.creditCardInfo?e.pointsDetails.creditCardInfo:e.multipleFormInfo?e.multipleFormInfo.creditCardInfo:null;d=f&&"VISACO"===f.cardType}if(b.response&&b.response.pnrInfo){if(this._webData.bookingType=b.response.pnrInfo.pointsBooking?"POINTS":"DOLLAR",this._webData.pnr=b.response.pnrInfo.pnr,this._webData.ticketNum=[],this._webData.elevateNum=[],b.response.pnrInfo.paxList)for(var g in b.response.pnrInfo.paxList){var h=b.response.pnrInfo.paxList[g];this._webData.ticketNum.push(h.ticketNum),h.loyaltyInfo&&(this._webData.elevateNum.push(h.loyaltyInfo.loyaltyId),0===g&&(this._webData.elevateStatus=h.loyaltyInfo.tierLevel))}if(b.response.pnrInfo.pnrFareInfo){this._webData.flightTotalCost=b.response.pnrInfo.pnrFareInfo.pnrTotalCost,this._webData.paymentMethod=a.bookingInfo.bookingType;var i=0;if("object"==typeof b.response.pnrInfo.pnrFareInfo.fareInformation){var j=b.response.pnrInfo.pnrFareInfo.fareInformation;this._webData.flightBaseFare=j.totalBaseFare,i=j.totalTax}i>0&&(this._webData.taxFees=i),this._webData.ancillaryExtra=b.response.pnrInfo.priceSummaryInfo.totalExtras;var k=[],l=b.response.pnrInfo.paymentInfo.paymentInfo;if(l)if(l.paymentInfoList)for(var m in l.paymentInfoList){var n=l.paymentInfoList[m],o=this._isCreditCard(n)&&d?"VISACO":n.cardType;k.push(o)}else{var p=this._isCreditCard(l)&&d?"VISACO":l.cardType;k.push(p)}/true/i.test(a.bookingInfo.insuranceOption.selected)&&(this._webData.travelInsurance=a.bookingInfo.totalPremiumAmount),k.length>0?this._webData.cardType=k.join("|"):a.paymentInfo&&a.paymentInfo.creditCardInfo&&a.paymentInfo.creditCardInfo.cardType&&(this._webData.cardType=a.paymentInfo.creditCardInfo.cardType,this._webData.cardPaymentAmt=a.paymentInfo.creditCardInfo.paymentAmount)}for(var q in b.response.pnrInfo.oAndDList){var r=b.response.pnrInfo.oAndDList[q];if(r.connectingFlightList&&r.connectingFlightList[0].flightSegList)break;var s=r.connectingFlightList?r.connectingFlightList[0].flightSeg:r.flightSegList?r.flightSegList[0]:r.flightSeg,t=s.flightId,u=[s.departure,s.arrival].join("-"),v=this._webData.flightBooking.segments,w=v&&v.length>=t?v[t-1]:null;s&&w&&w.odPair===u&&r.pointsInfo&&r.pointsInfo.pointsList&&r.pointsInfo.pointsList.length>0&&(w.points=r.pointsInfo.pointsList[0].points)}}if(a.seatInfo&&a.seatInfo.seatFlightList)for(var x in a.seatInfo.seatFlightList){var y=a.seatInfo.seatFlightList[x],z=[];for(var A in y.paxSeatList)z.push(y.paxSeatList[A].seatNum);this._webData.flightBooking.segments[x].flightNum===y.flightNum&&(this._webData.flightBooking.segments[x].selectedSeats=z)}b.response.pnrInfo.ancillaryDetails&&(this._webData.responseAncillaryObj=b.response.pnrInfo.ancillaryDetails),this._ancillarySummaryList&&(this._webData.ancillaryObj=this._ancillarySummaryList),this._webData.email=b.response.pnrInfo.contact.email,this._webData.emailArea="Booking: Confirmation",this._webData.bookingAddress={city:b.response.pnrInfo.addressInfo.city,state:b.response.pnrInfo.addressInfo.state,country:b.response.pnrInfo.addressInfo.country,zipCode:b.response.pnrInfo.addressInfo.zipCode}},c.prototype._setFlightPaymentFailedData=function(a,b){this._webData.pageName="Booking Funnel: Payment Failed",this._webData.pageError=["Payment failed",b.status.error.code,b.status.error.developerMessage].join("|"),this._webData.events.push("paymentFailure")},c.prototype._setRegisterProcessData=function(a,b){this._webData.pageName="Elevate: Register";try{if(/error/i.test(b.status.status))return this._webData.pageName=this._webData.pageError="Elevate: Register Failed","failedLogin";if(a.elevateAccountInfo&&(this._webData.email=a.elevateAccountInfo.userID,this._webData.emailArea="Elevate: Register"),a.addressInfo&&(this._webData.elevateLocation={city:a.addressInfo.city,state:a.addressInfo.state,country:a.addressInfo.country,zipCode:a.addressInfo.zipCode}),a.personDetail){var c=new Date;this._webData.elevateProfile={gender:a.personDetail.gender,age:a.personDetail.dateOfBirth?c.getFullYear()-a.personDetail.dateOfBirth.substr(0,4):""}}return b.response&&(this._webData.elevateStatus=b.response.tierLevel,this._webData.elevateNum=[b.response.elevateId],this._webData.elevateAccountAge="Just registered"),"signin"}catch(a){return this._logError("Could not capture [setRegisterProcessData] data: ",{innerException:a}),"failedLogin"}},c.prototype._setSigninProcessData=function(a,b){this._webData.email=a.userId,this._webData.emailArea="Elevate: Login";try{return/error/i.test(b.status.status)?(this._webData.pageName=this._webData.pageError="Elevate: Signin Failed","failedLogin"):(this._webData.pageName="Elevate: Signin",this._webData.elevateStatus=b.response.tierLevel,this._webData.elevateNum=[b.response.elevateId],"signin")}catch(a){return this._logError("Could not capture [setSigninProcessData] data: ",{innerException:a}),"failedLogin"}},c.prototype._setForgotPasswordData=function(a){this._webData.pageName=this._webData.emailArea="Elevate: Forgot Password",this._webData.email=a.emailId},c.prototype._profileUpdateData=function(a){var b=this._state.modalURL.split(": ");this._webData.elevateUpdateArea=["modal",b[b.length-1]].join("-"),this._webData.pageName=["Elevate","Profile Update",this._webData.elevateUpdateArea].join(": "),a.emailInfoList&&a.emailInfoList.length>0&&a.emailInfoList[0].address&&(this._webData.email=a.emailInfoList[0].address,this._webData.emailArea=this._webData.pageName)},c.prototype._setElevateAccountData=function(b,c){this._webData.emailArea="Elevate: Get Profile Information",this._webData.elevateNum=[b.elevateId];try{if(!/error/i.test(c.status.status)&&"undefined"!=typeof c.response){if(c.response.addressInfoList&&(this._webData.elevateLocation={city:c.response.addressInfoList[0].city,state:c.response.addressInfoList[0].state,country:c.response.addressInfoList[0].country,zipCode:c.response.addressInfoList[0].zipCode}),c.response.personDetail){var d=new Date;this._webData.elevateProfile={gender:c.response.personDetail.gender,age:c.response.personDetail.dateOfBirth?d.getFullYear()-c.response.personDetail.dateOfBirth.substr(0,4):""}}c.response.elevateAccount&&(this._webData.elevateAccountAge=a(c.response.elevateAccount.creationDateTime).fromNow(),this._webData.email=c.response.elevateAccount.userID),c.response.tierDetail&&(this._webData.elevateStatus=c.response.tierDetail.tierLevel)}}catch(a){this._logError("Could not capture [setElevateAccountData] data: ",{innerException:a})}},c.prototype._setManagePNRData=function(a,b){try{if(this._webData.pageName="Manage: PNR",this._webData.siteSection="",this._state.view&&(this._webData.pageName=[this._state.view,this._webData.pageName].join(": ")),a.identificationInfo&&(this._webData.pnr=a.identificationInfo.pnr),
b.response&&b.response.pnrInfo){var c,d={},e=b.response.pnrInfo.oAndDList;if(this._webData.bookingType=b.response.pnrInfo.pointsBooking?"POINTS":"DOLLAR",this._webData.flightType=this._tripTypes[b.response.pnrInfo.tripType]||"NA",b.response.pnrInfo.contact&&b.response.pnrInfo.contact.email&&(this._webData.email=b.response.pnrInfo.contact.email,this._webData.emailArea="Manage PNR"),e&&e.length&&(c=e[0],d=c.flightSeg,d||(d=c.connectingFlightList?c.connectingFlightList[0].flightSeg:c.flightSegList[0]),this._webData.rootOD=[c.origin,c.destination].join("-"),d&&(this._webData.searchDepartureDtm=d.departureDateTime.substring(0,10))),e&&e.length>1){var f=e.length-1;if(c=e[f],d=c.flightSeg,!d)if(c.connectingFlightList){var g=c.connectingFlightList.length-1;d=c.connectingFlightList[g].flightSeg}else{var h=c.flightSegList-1;d=c.flightSegList[h]}d&&(this._webData.searchReturningDtm=d.arrivalDateTime.substring(0,10))}var i=!!e[0].connectingFlightList;this._webData.ticketNum=[];for(var j in e){var k=e[j],l="";i=!!k.connectingFlightList,i||(l=k.pointsInfo.pointsList&&k.pointsInfo.pointsList[0]?k.pointsInfo.pointsList[0].ticketNumber:""),this._webData.ticketNum.indexOf(l)===-1&&this._webData.ticketNum.push(l)}this._webData.originalOAndDList=b.response.pnrInfo.oAndDList}}catch(a){this._logError("Could not capture [setManagePNRData] data: ",{innerException:a})}},c.prototype._setSiteAlertData=function(a){this._webData.pageName="Flight Alerts",this._webData.siteSection="Self Service",a.email&&(this._webData.email=a.email,this._webData.emailArea="Flight Alerts",this._webData.flightNotificationMeth="email"),a.sms&&(this._webData.flightNotificationMeth=this._webData.flightNotificationMeth?[this._webData.flightNotificationMeth,"sms"].join("|"):"sms"),a.flightInfo&&a.flightInfo.length>0&&a.flightInfo[0].origin&&(this._webData.rootOD=[a.flightInfo[0].origin,a.flightInfo[0].destination].join("-"))},c.prototype._log=function(a,b,c){"undefined"!=typeof b&&b||(b=this._env.analytics().verbose),"object"==typeof console&&"function"==typeof console.log&&b&&void 0},c.prototype._logError=function(a,b){"object"==typeof console&&"function"==typeof console.error&&void 0},c.prototype._getCookie=function(a){try{var b=new RegExp("[; ]"+a+"=([^\\s;]*)"),c=(" "+document.cookie).match(b);if(a&&c)return unescape(c[1])}catch(a){return this._logError("Could not read cookie [getCookie] data: ",{innerException:a}),""}},c.prototype.getUrlValue=function(a,b){try{"undefined"==typeof b&&(b=window.location.href);var c=b.match("[?&]"+a+"=([^&]+)");return c?c[1]:""}catch(a){return this._logError("Could not read URL value [getUrlValue] data: ",{innerException:a}),""}},c.prototype._sendEventTrigger=function(a,b){if(this._adobeAnalytics&&"untrappedAPI"!==a&&(this._ENSIGHTEN&&this._ENSIGHTEN.ensEvent.trigger(a),this._adobeAnalytics.setWebEvent(a,b||this._webData)),/modalView/i.test(a)&&"object"==typeof b&&b.pageName){var c=b.pageName.split(": ");a=["modal",c[c.length-1]].join("-")}},c.prototype.addEvent=function(a){this._webData.events.indexOf(a)===-1&&this._webData.events.push(a)},c.prototype.removeEvent=function(a){this._webData.events.indexOf(a)!==-1&&this._webData.events.splice(this._webData.events.indexOf(a),1)},c.prototype._daysBetween=function(a,b){var c=new Date(a.getFullYear(),a.getMonth(),a.getDate()),d=new Date(b.getFullYear(),b.getMonth(),b.getDate());return Math.floor((d.getTime()-c.getTime())/864e5)},c.prototype._getFlightSegmentsFromSelectedFare=function(a,b,c){var d=[];if(!b)return d;for(var e in b.legs){var f=b.legs[e],g=parseInt(e,10),h={},i={isUpgraded:!1},j=this._getTierDetails(b.tiers,f.classOfService),k=0;0===g&&b.cost&&(b.cost.dollars&&b.cost.dollars.base&&(h.baseFare=b.cost.dollars.base),b.cost.points&&(h.baseFare=b.cost.points),"object"==typeof b.information._rawData&&b.information._rawData.totalTax&&(k=b.information._rawData.totalTax),b.legs[g].isUpgraded&&(i.isUpgraded=!0,i.from=this._getTierDetails(b.tiers,c[g].classOfService),i.to=j)),d.push({flightType:b.flightType,odPair:[f.departure,f.arrival].join("-"),segment:[g+1,Object.keys(b.legs).length].join("/"),flightDirection:a,flightNum:f.flightNum,aircraftType:f.aircraftType,cabinClass:j.cabinClass,fareClass:f.classOfService,fare:h,taxes:k,upgrade:i})}return d},c.prototype._getTierDetails=function(a,b){for(var c in a)if(a[c].classOfService===b)return{classOfService:b,cabinClass:c,baseFare:a[c].dollarFare.baseFare,fareBasisCode:a[c].fareBasisCode,totalTax:a[c].totalTax,upgradeAmt:a[c].upgradeAmt};return{}},c.prototype._getFlightSegments=function(a,b){var c=[];if(!b)return c;for(var d in b){var e=b[d];c.push({odPair:[e.flightSegment.departure,e.flightSegment.arrival].join("-"),segment:[parseInt(d,10)+1,b.length].join("/"),flightDirection:a,flightNum:e.flightSegment.flightNum,aircraftType:e.flightSegment.aircraftType,fareClass:e.flightSegment.classOfService})}return c},c.prototype._setTripSeatSelectionComplete=function(a){if(this._webData.pageName="Booking Funnel: Seat selection completed",a&&a.length)for(var b in a){var c=a[b],d=c.legs;for(var e in this._state.selectedFares[b].legs){var f=this._state.selectedFares[b].legs[e];d[e].flightNum===f.flightNum&&d[e].departure===f.departure&&d[e].departureDateTime===f.departureDateTime&&d[e].classOfService!==f.classOfService&&this._webData.events.push("seatUpgrade")}}},c.prototype._setTripFlightCheckout=function(){this._webData.pageName="Booking Funnel: Checkout"},c.prototype._setTripPromoAdded=function(a){this._webData.promoCode=a.code,a.success?(this._webData.pageName="Booking Funnel: Apply Promo Code: Success",this._webData.events.push("promoApplied")):(this._webData.pageName="Booking Funnel: Apply Promo Code: Failed",this._webData.pageError=["Promo code failed",a.errorCode,a.developerMessage].join("|"))},c.prototype._configurePubSub=function(){var a={"adobeAnalytics.flightCheckout":this._adobeEvents.flightCheckout,"adobeAnalytics.deptDateSelected":this._adobeEvents.deptDateSelected,"adobeAnalytics.seatSelectionDeparting":this._adobeEvents.seatSelectionDeparting,"adobeAnalytics.continueAsGuest":this._adobeEvents.continueAsGuest,"adobeAnalytics.fillFormSignIn":this._adobeEvents.fillFormSignIn,"adobeAnalytics.completeButton":this._adobeEvents.completeButton,"adobeAnalytics.payNow":this._adobeEvents.payNow,"adobeAnalytics.addedNewCard":this._adobeEvents.addedNewCard,"adobeAnalytics.travelBank":this._adobeEvents.travelBank,"adobeAnalytics.purchaseTicketsClick":this._adobeEvents.purchaseTicketsClick,"adobeAnalytics.sevenDayComparison":this._adobeEvents.sevenDayComparison,"adobeAnalytics.sevenDayContinue":this._adobeEvents.sevenDayContinue,"adobeAnalytics.submitApplicationButtonPressed":this._adobeEvents.submitApplicationButtonPressed,"adobeAnalytics.visaCheckoutClicked":this._adobeEvents.visaCheckoutClicked,"adobeAnalytics.visaCheckoutSelected":this._adobeEvents.visaCheckoutSelected,"adobeAnalytics.fareSelectorPointsToggle":this._adobeEvents.fareSelectorPointsToggle,"adobeAnalytics.completedTravelerInformation":this._adobeEvents.completedTravelerInformation,"adobeAnalytics.skippedOrSelectedExtras":this._adobeEvents.skippedOrSelectedExtras,"adobeAnalytics.ancillaryOpened":this._adobeEvents.ancillaryOpened,"adobeAnalytics.bookOnAlaska":this._adobeEvents.bookOnAlaska,"adobeAnalytics.closeBookOnAlaska":this._adobeEvents.closeBookOnAlaska,"adobeAnalytics.isAlaskaOnly":this._adobeEvents.isAlaskaOnly,"adobeAnalytics.alaskaRedirectOffered":this._adobeEvents.alaskaRedirectOffered,"adobeAnalytics.reachLastAvailableDateOnBooking":this._adobeEvents.reachLastAvailableDateOnBooking,"adobeAnalytics.reachLastAvailableDateOnChange":this._adobeEvents.reachLastAvailableDateOnChange,"adobeAnalytics.bookOnAlaskaNotAvailableDate":this._adobeEvents.bookOnAlaskaNotAvailableDate};this._pubSubService.subscribe("adobeAnalytics.seatSelectionComplete",function(a){this.fireEvent("flightSeatSelectionComplete",a)}.bind(this)),this._pubSubService.subscribe("adobeAnalytics.promoClicked",function(a){this.fireEvent("promoClicked",a)}.bind(this)),this._pubSubService.subscribe("adobeAnalytics.alaskaCardPromo",function(a){this.fireEvent(this._adobeEvents.alaskaCardPromo,a)}.bind(this)),this._pubSubService.subscribe("adobeAnalytics.bookOnAlaska",function(){this.fireEvent("bookOnAlaska")}.bind(this)),this._pubSubService.subscribe("adobeAnalytics.closeBookOnAlaska",function(){this.fireEvent("closeBookOnAlaska")}.bind(this)),this._pubSubService.subscribe("adobeAnalytics.isAlaskaOnly",function(){this.fireEvent("isAlaskaOnly")}.bind(this)),this._pubSubService.subscribe("adobeAnalytics.alaskaRedirectOffered",function(){this.fireEvent("alaskaRedirectOffered")}.bind(this)),this._pubSubService.subscribe("adobeAnalytics.alaskaBannerShown",function(a){this.fireEvent("alaskaBannerShown",a)}.bind(this)),this._pubSubService.subscribe("adobeAnalytics.promoAdded",function(a){this.fireEvent("promoAdded",a)}.bind(this)),this._pubSubService.subscribe("adobeAnalytics.fareSelected",function(a){this.fireEvent("fareSelected",a)}.bind(this)),this._pubSubService.subscribe("adobeAnalytics.updateQuoteModel",function(a){this._latestRequestQuote=a}.bind(this)),this._pubSubService.subscribe("adobeAnalytics.whoIsFlying",function(a){this.fireEvent(this._adobeEvents.whoIsFlying,a)}.bind(this)),this._pubSubService.subscribe("adobeAnalytics.applicationResponse",function(a){"APPROVED"===a.getResponseType()?this.fireEvent(this._adobeEvents.successfulCreditCardApplication):"CARD_EXISTS"===a.getResponseType()?this.fireEvent(this._adobeEvents.existingCreditCardHolderApplication):this.fireEvent(this._adobeEvents.contactLaterCreditCardApplication)}.bind(this)),this._pubSubService.subscribe("adobeAnalytics.ancillarySummary",function(a){this._ancillarySummaryList=a}.bind(this));for(var b in a)this._pubSubService.subscribe(b,this.fireEvent.bind(this,a[b]))},c.prototype.fireEventObject=function(a){this.fireEvent(a.type,a.data||a.dataFunc&&a.dataFunc())},c.prototype.fireEvent=function(a,b){var c=!1;switch(a){case this._adobeEvents.originDestinationSelected:this._setTripOriginAndDestinationSelected(b),this._ENSIGHTEN&&this._ENSIGHTEN.ensEvent.trigger(this._adobeEvents.calendarSearchPage);break;case this._adobeEvents.deptDateSelected:this._setTripDepartureDateSelected(b);break;case this._adobeEvents.flightSearch:var d=this._setTripSearchData(b);if(!d)return void(this._locationService.contextIs(this._locationService.contexts.BOOK)&&(this._webData.pageName="Booking Funnel: Secondary Flight Search",this._sendEventTrigger(this._adobeEvents.secondFlightSearch)));break;case this._adobeEvents.fareSelected:this._setTripFareSelected();break;case this._adobeEvents.flightFareSelected:this._setTripFareSelectedData(b);break;case this._adobeEvents.seatSelectionDeparting:this._setTripSeatSelection();break;case this._adobeEvents.flightSeatSelectionComplete:this._setTripSeatSelectionComplete(b);break;case this._adobeEvents.continueAsGuest:this._webData.pageName="Booking Funnel: Continue As Guest",this._webData.siteSection="Booking Funnel";break;case this._adobeEvents.fillFormSignIn:this._webData.pageName="Booking Funnel: Fill Form Sign In",this._webData.siteSection="Booking Funnel";break;case this._adobeEvents.completeButton:this._webData.pageName="Booking Funnel: Traveler Complete",this._webData.siteSection="Booking Funnel";break;case this._adobeEvents.payNow:this._webData.pageName="Booking Funnel: Pay Now",this._webData.siteSection="Booking Funnel";break;case this._adobeEvents.flightCheckout:this._setTripFlightCheckout();break;case this._adobeEvents.addedNewCard:this._webData.pageName="Booking Funnel: Add New Card",this._webData.siteSection="Booking Funnel";break;case this._adobeEvents.travelBank:this._webData.pageName="Booking Funnel: Travel Bank",this._webData.siteSection="Booking Funnel";break;case this._adobeEvents.purchaseTicketsClick:this._webData.pageName="Booking Funnel: Purchase Tickets Click",this._webData.siteSection="Booking Funnel";break;case this._adobeEvents.promoAdded:this._setTripPromoAdded(b);break;case this._adobeEvents.promoClicked:this._webData.promoClicked=b;break;case this._adobeEvents.alaskaBannerShown:this._webData.alaskaBannerShown=b;break;case this._adobeEvents.sevenDayComparison:this._webData.pageName="Booking Funnel: 7 Day Comparison";break;case this._adobeEvents.sevenDayContinue:this._webData.pageName="Booking Funnel: 7 Day Continue";break;case this._adobeEvents.visaCheckoutClicked:this._webData.pageName="Credit Card: Visa checkout clicked";break;case this._adobeEvents.visaCheckoutSelected:this._webData.pageName="Credit Card: Visa checkout selected";break;case this._adobeEvents.fareSelectorPointsToggle:this._webData.pageName="Fare Selector: Points and Dollars toggled.";break;case this._adobeEvents.completedTravelerInformation:this._webData.pageName="Booking funnel: traveler info completed";break;case this._adobeEvents.skippedOrSelectedExtras:this._webData.pageName="Booking funnel: ancillaries completed";break;case this._adobeEvents.ancillaryOpened:this._webData.pageName="Booking funnel: ancillaries expanded";break;case this._adobeEvents.bookOnAlaska:this._webData.pageName="Booking funnel: book on alaska";break;case this._adobeEvents.closeBookOnAlaska:this._webData.pageName="Booking funnel: book on alaska closed";break;case this._adobeEvents.isAlaskaOnly:this._webData.pageName="Booking funnel: alaska only";break;case this._adobeEvents.alaskaRedirectOffered:this._webData.pageName="Booking funnel: shared route banner";break;case this._adobeEvents.reachLastAvailableDateOnBooking:this._webData.pageName="Booking funnel: reach last available date";break;case this._adobeEvents.reachLastAvailableDateOnChange:this._webData.pageName="Manage funnel: reach last available date",c=!0;break;case this._adobeEvents.bookOnAlaskaNotAvailableDate:this._webData.pageName="Booking funnel: book on alaska not available date";break;case this._adobeEvents.alaskaCardPromo:this._webData.pageName=b.pageName,this._webData.linkName=b.pageName,c=!0}var e=this._locationService.contextIs(this._locationService.contexts.BOOK),f=this._locationService.contextIs(this._locationService.contexts.ELEVATE);(c||e||f)&&this._sendEventTrigger(a),delete this._webData.linkName},c}),c("core/services/error-handler",[],function(){"use strict";var a=function(a,b,c,d,e,f,g,h){return this._$injector=a,this._errorCache=b("errorCache"),this._$q=c,this._env=d,this._resourceBundle=e,this._statusService=f,this._adobeAnalyticsService=g,this._pubSubService=h,this._mapping=null,this._knownErrorCodes={TIMEOUT:"timeout",UNTRAPPED_ERROR:0},{trap:this.trap.bind(this),trapTimeout:this.trapTimeout.bind(this),trapWarningList:this.trapWarningList.bind(this),showMessage:this.showMessage.bind(this),getStartOverFlag:this.getStartOverFlag.bind(this),setStartOverFlag:this.setStartOverFlag.bind(this)}};return a.prototype.trap=function(a){var b,c,d,e=this._$q.defer(),f=function(b,c){b=b||this._resourceBundle.genericErrorMessage;var d=c?this._knownErrorCodes.UNTRAPPED_ERROR:a.code;this.showMessage(b,d,this._statusService.format.ERROR,a.continuable)}.bind(this);return this._fetchErrorData(a.code).then(function(g){b=g.data&&(g.data.message||g.data.apiMessage),c=g.data.code,d=c===this._knownErrorCodes.TIMEOUT,f(b,d),b&&c!==this._knownErrorCodes.UNTRAPPED_ERROR?e.resolve({code:a.code,message:b,internalMsg:g.data.apiMessage}):e.reject()}.bind(this),function(){f(),e.reject()}),e.promise},a.prototype.trapTimeout=function(){this.trap({code:this._knownErrorCodes.TIMEOUT})},a.prototype._fetchErrorData=function(a){this._$http||(this._$http=this._$injector.get("$http"));var b=this._env.context("cms").resourceURL;return this._$http.get(b+"/errors.json?code="+a,{cache:this._errorCache})},a.prototype.trapWarningList=function(a){var b,c,d,e=[],f=function(a,b,c){this._pubSubService.publish("warning",[a.errorCode]),c=c||this._resourceBundle.genericErrorMessage,d=this._buildMessageStructure(c,a.errorCode,this._statusService.format.ERROR,!0),b.resolve(d)}.bind(this);a.forEach(function(a){b=this._$q.defer(),this._fetchErrorData(a.errorCode).then(function(d){c=d.data&&(d.data.message||d.data.apiMessage),f(a,b,c)}.bind(this),function(){f(a,b)}.bind(this)),e.push(b.promise)}.bind(this)),this._$q.all(e).then(this._statusService.setAlert.bind(this))},a.prototype.showMessage=function(a,b,c,d){this._statusService.setAlert(this._buildMessageStructure(a,b,c,d)),this._adobeAnalyticsService.UIEvent(this._adobeAnalyticsService.EVENTS.ERROR_MESSAGE,{message:a,format:c,recoverable:d})},a.prototype._buildMessageStructure=function(a,b,c,d){var e={format:c?c:this._statusService.format.ERROR,copy:{DESC:a},sticky:!d,recoverable:d,errorCode:b,backdrop:{append:!d,callback:"destroyCallback"},controls:{close:!1,hide:d?"got it":"start over"}};return d||(e.dismissCallBack=function(){this._startOverFlag=!0}.bind(this)),e},a.prototype.getStartOverFlag=function(){return this._startOverFlag},a.prototype.setStartOverFlag=function(a){this._startOverFlag=a},a.$inject=["$injector","$cacheFactory","$q","envService","ResourceBundle","statusService","adobeAnalyticsService","pubSubService"],a}),c("core/services/latest-time",["moment"],function(a){"use strict";var b=function(){return this._latestTime=a(),{setHeaderTime:this.setHeaderTime.bind(this),getTime:this.getTime.bind(this)}};return b.$inject=[],b.prototype.setHeaderTime=function(b){b&&b.length>0?this._latestTime=a(b):this._latestTime=a()},b.prototype.getTime=function(){return this._latestTime},b}),c("common/models/trip-model",["angular","common/models/serial-model"],function(a,b){"use strict";var c=function(a){this.init(a)};return c.prototype=new b,c.prototype._schema={type:"object",properties:{bookingType:{type:"string"},cityPairs:{type:"array"},dates:{type:"array"},promoCode:{type:"string"},travelers:{type:"object",properties:{adults:{type:"number"},children:{type:"number"},infants:{type:"number"},pets:{type:"number"}}},tripType:{type:"string"}}},c.prototype._serializerMappings={persistence:{bookingType:"bookingType",cityPairs:"cityPairs",dates:"dates",travelers:"travelers",tripType:"tripType"}},c.prototype._customDeserializers={persistence:function(a,b){var c=a.public.trip;b.bookingType=c.bookingType,b.cityPairs=c.cityPairs,b.dates=c.dates,b.travelers=c.travelers,b.tripType=c.tripType}},c.prototype._customSerializers={search:function(b){var c={origin:"",dest:"",departureDate:"",returningDate:"",numOfAdults:null,numOfChildren:null,numOfInfants:null,numOfPets:null,bookingType:"DOLLAR",tripType:"roundTrip",promoCode:null};b.cityPairs&&b.cityPairs.length>0&&a.forEach(b.cityPairs,function(a,d){"ONE_WAY"===b.tripType||"ROUND_TRIP"===b.tripType?0===d&&(c.origin=a.dep,c.dest=a.des):(0===d&&(c.origin=a.dep,delete c.dest,c.oneWayList=[]),c.oneWayList.push({origin:a.dep,dest:a.des}))},this),c.numOfAdults=b.travelers.adults,c.numOfChildren=b.travelers.children,c.numOfInfants=b.travelers.infants,c.numOfPets=b.travelers.pets,c.bookingType=b.bookingType||"DOLLAR",b.promoCode&&0!==b.promoCode.length&&(c.promoCode=b.promoCode);var d=b.tripType;if(b.dates&&b.dates.length>0){var e="ONE_WAY"===d;"MULTI_CITY"!==d?(c.departureDate=b.dates[0],(e||!e&&b.dates.length>1)&&(c.returningDate=b.dates[1])):a.forEach(b.dates,function(a,b){c.oneWayList[b].departureDate=a})}return c}},c}),c("core/services/persistence",["angular","common/models/elevate-model","common/models/trip-model"],function(a,b,c){"use strict";var d=function(a,d){return this._$q=a,this._api=d,this._publicModel,this._privateModel,this._deserializedPublicModels={},this._isLoaded=!1,this._protos={elevate:b,trip:c},{saveElevateModel:this.saveElevateModel.bind(this),clear:this.clear.bind(this),getElevateModel:this.getElevateModel.bind(this),saveTripModel:this.saveTripModel.bind(this),getTripModel:this.getTripModel.bind(this),getPrivateModel:this.getPrivateModel.bind(this),retrieve:this.retrieve.bind(this),isLoaded:this.isLoaded.bind(this)}};return d.$inject=["$q","api"],d.prototype.saveElevateModel=function(a){this._saveModel("elevate",a).then(function(){this.retrieve()}.bind(this))},d.prototype.getElevateModel=function(){return this._deserializedPublicModels&&this._deserializedPublicModels.elevate?this._deserializedPublicModels.elevate:void 0},d.prototype.saveTripModel=function(a){this._saveModel("trip",a)},d.prototype.getTripModel=function(){return this._deserializedPublicModels&&this._deserializedPublicModels.trip?this._deserializedPublicModels.trip:void 0},d.prototype.getPrivateModel=function(){return this._privateModel},d.prototype._saveModel=function(a,b){var c=this._$q.defer(),d=function(){this._publicModel[a]=b.serialize("persistence"),this._deserializedPublicModels[a]=b;var d=function(a){a.data?c.resolve(a):c.reject(a)};this._update().then(d.bind(this),d.bind(this))}.bind(this);return this._publicModel?d():this.retrieve().then(d.bind(this),d.bind(this)),c.promise},d.prototype._update=function(){return this._api.persistence.update({public:this._publicModel,protected:this._privateModel})},d.prototype.clear=function(){return this._api.persistence.update({public:{},protected:{}})},d.prototype.retrieve=function(){var b=this._$q.defer();return this._api.persistence.retrieve().then(function(c){if(200===c.status){if(c.data.public){this._publicModel=c.data.public,this._privateModel=c.data.protected;for(var d in this._publicModel)this._deserializedPublicModels[d]=new this._protos[d],this._deserializedPublicModels[d].deserialize(c.data,"persistence")}else this._publicModel={},this._privateModel={};b.resolve(this._publicModel)}c.data=a.isString(c.data)?JSON.parse(c.data.replace(/\\/g,"").replace(/"\{/g,"{").replace(/\}"/g,"}")):c.data,(a.isObject(c.data.error)||c.data.status&&"ERROR"===c.data.status.toUpperCase())&&(this._api.persistence.create(),this._publicModel={},this._privateModel={},b.reject(c.data.error)),this._isLoaded=!0}.bind(this)),b.promise},d.prototype.isLoaded=function(){return this._isLoaded},d}),c("core/services/stub",[],function(){"use strict";var a=function(a,b,c){return this._env=a,this._$http=b,this._$q=c,{get:this.get.bind(this)}};return a.prototype.get=function(a){return this._$http.get("/stubs/"+a+".json")},a.$inject=["envService","$http","$q"],a}),c("common/models/flightalerts-model",["common/models/serial-model"],function(a){"use strict";var b=function(a){this.init(a)};return b.prototype=new a,b.prototype._schema={type:"object",properties:{dateDetails:{type:"array",items:{flightNum:{type:"string"},flightDateTime:{type:"string"}}}}},b.prototype._customDeserializers={flightAlerts:function(a,b){if(a.webScheduleDateDetials){b.dateDetails=[];for(var c in a.webScheduleDateDetials){var d=a.webScheduleDateDetials[c];b.dateDetails.push({flightNum:d.flightNumber,flightDateTime:d.flightDateTime})}}}},b}),c("core/services/flightalerts",["common/models/flightalerts-model"],function(a){"use strict";var b=function(a,b){return this._api=b,this._$q=a,this._flightAlertsModel=null,{retrieveFlightList:this.retrieveFlightList.bind(this),subscribe:this.subscribe.bind(this),unsubscribe:this.unsubscribe.bind(this)}};return b.$inject=["$q","api"],b.prototype.retrieveFlightList=function(b){var c=this._$q.defer();return this._api.flightAlerts.retrieveFlightList(b).then(function(b){this._flightAlertsModel=new a,this._flightAlertsModel.deserialize(b.data.response,"flightAlerts"),c.resolve(this._flightAlertsModel)}.bind(this)).catch(function(a){c.reject(a)}.bind(this)),c.promise},b.prototype.subscribe=function(a){a.sms=a.sms?a.sms.replace(/[^0-9]/g,"").trim().slice(-10):"";var b=this._$q.defer();return this._api.flightAlerts.subscribe(a).then(function(a){b.resolve(a.data)}.bind(this)).catch(function(a){b.reject(a)}.bind(this)),b.promise},b.prototype.unsubscribe=function(a){var b=this._$q.defer();return this._api.flightAlerts.unsubscribe(a).then(function(a){b.resolve(a.data)}.bind(this)).catch(function(a){b.reject(a)}.bind(this)),b.promise},b}),c("core/services/config",[],function(){"use strict";var a=function(a,b){return this._$q=a,this._api=b,{getStates:function(a){var b=this._$q.defer(),c={countryCode:a};return this._api.config.getStates(c).then(function(a){var c=a.data.response.stateList,d=[];for(var e in c){var f={name:c[e].name,value:c[e].code};d.push(f)}b.resolve(d)}),b.promise}.bind(this)}};return a.$inject=["$q","api"],a}),c("environment",["angular"],function(a){"use strict";var b=function(b){var c={flightPerformance:{resourceURL:"/static/DOTotp/"},lightApp:{resourceURL:"/light/"},analytics:{verbose:!1,reportSuite:"dev"},legacyUrlMapping:{channelMapping:{c87dbb7f06a928488e9919ff0127911f:"HPMK",abb45c62cac15a167a957310fec0fae4:"KYAK","1bc12cf20d5abdeb7aa376d1db3645f9":"TZOO"}},contextSwitching:{api:{resourceURL:"/api",proxyURL:"origin-w31dev-api.virginamerica.com",verbose:!1},cms:{resourceURL:"/cms",proxyURL:"vx.work.co"},snapshots:{resourceURL:"/snapshots",proxyURL:"localhost",proxyPort:3e3}},targetIdentifier:"sandbox-dev",targetDescription:"This target points to VX's sandbox route (sandbox.dev->sandbox.qa)",hostMapping:[{urlMatch:"^http[s]?://(localhost|((www3\\.dev|sandbox\\.dev)\\.virginamerica\\.com))",contentMerge:{hostType:"development",hostDescription:"This host is used for development purposes."}},{urlMatch:"^http[s]?://(www3\\.qa|sandbox\\.qa)\\.virginamerica\\.com",contentMerge:{hostType:"quality-assurance",hostDescription:"This host is used for quality assurance purposes."}},{urlMatch:"^http[s]?://(www|rc)\\.virginamerica\\.com",contentMerge:{hostType:"production",hostDescription:"This host is used for productions purposes."}}]};if(this._hostName="3080262d671d",this._commitHead="5f97a9e",this._uiVersion="triple-h-build-sandbox-1305",c.hostMapping){this._data=c;for(var d in c.hostMapping){var e=c.hostMapping[d],f=new RegExp(e.urlMatch);if(f.test(b.absUrl())){a.extend(this._data,e.contentMerge);break}}}else this._data=c;return{context:this.context.bind(this),meta:this.meta.bind(this),analytics:this.analytics.bind(this),flightPerformance:this.flightPerformance.bind(this),legacyUrlMapping:this.legacyUrlMapping.bind(this)}};return b.prototype.context=function(a){return this._data.contextSwitching[a]},b.prototype.analytics=function(){return this._data.analytics},b.prototype.flightPerformance=function(){return this._data.flightPerformance},b.prototype.legacyUrlMapping=function(){return this._data.legacyUrlMapping},b.prototype.meta=function(a){var b=null;switch(a){case"hostName":b=this._hostName;break;case"commitHead":b=this._commitHead;break;case"uiVersion":b=this._uiVersion;break;case"abVersion":b="B";break;default:b=this._data[a]}return b},b.$inject=["$location"],b}),c("core/constants/geo-bundle",[],function(){"use strict";var a={countries:[{name:"United States",value:"US"},{name:"Canada",value:"CA"},{name:"Afghanistan",value:"AF"},{name:"Aland Islands",value:"AX"},{name:"Albania",value:"AL"},{name:"Algeria",value:"DZ"},{name:"American Samoa",value:"AS"},{name:"Andorra",value:"AD"},{name:"Angola",value:"AO"},{name:"Anguilla",value:"AI"},{name:"Antarctica",value:"AQ"},{name:"Antigua and Barbuda",value:"AG"},{name:"Argentina",value:"AR"},{name:"Armenia",value:"AM"},{name:"Aruba",value:"AW"},{name:"Australia",value:"AU"},{name:"Austria",value:"AT"},{name:"Azerbaijan",value:"AZ"},{name:"Bahamas",value:"BS"},{name:"Bahrain",value:"BH"},{name:"Bangladesh",value:"BD"},{name:"Barbados",value:"BB"},{name:"Belarus",value:"BY"},{name:"Belgium",value:"BE"},{name:"Belize",value:"BZ"},{name:"Benin",value:"BJ"},{name:"Bermuda",value:"BM"},{name:"Bhutan",value:"BT"},{name:"Bolivia, Plurinational State of",value:"BO"},{name:"Bosnia and Herzegovina",value:"BA"},{name:"Botswana",value:"BW"},{name:"Bouvet Island",value:"BV"},{name:"Brazil",value:"BR"},{name:"British Indian Ocean Territory",value:"IO"},{name:"Brunei Darussalam",value:"BN"},{name:"Bulgaria",value:"BG"},{name:"Burkina Faso",value:"BF"},{name:"Burundi",value:"BI"},{name:"Cambodia",value:"KH"},{name:"Cameroon",value:"CM"},{name:"Cape Verde",value:"CV"},{name:"Cayman Islands",value:"KY"},{name:"Central African Republic",value:"CF"},{name:"Chad",value:"TD"},{name:"Chile",value:"CL"},{name:"China",value:"CN"},{name:"Christmas Island",value:"CX"},{name:"Cocos (Keeling) Islands",value:"CC"},{name:"Colombia",value:"CO"},{name:"Comoros",value:"KM"},{name:"Congo, the Democratic Republic of the",value:"CD"},{name:"Congo",value:"CG"},{name:"Cook Islands",value:"CK"},{name:"Costa Rica",value:"CR"},{name:"Côte d'Ivoire",value:"CI"},{name:"Croatia",value:"HR"},{name:"Cuba",value:"CU"},{name:"Cyprus",value:"CY"},{name:"Czech Republic",value:"CZ"},{name:"Denmark",value:"DK"},{name:"Djibouti",value:"DJ"},{name:"Dominica",value:"DM"},{name:"Dominican Republic",value:"DO"},{name:"Ecuador",value:"EC"},{name:"Egypt",value:"EG"},{name:"El Salvador",value:"SV"},{name:"Equatorial Guinea",value:"GQ"},{name:"Eritrea",value:"ER"},{name:"Estonia",value:"EE"},{name:"Ethiopia",value:"ET"},{name:"Falkland Islands (Malvinas)",value:"FK"},{name:"Faroe Islands",value:"FO"},{name:"Fiji",value:"FJ"},{name:"Finland",value:"FI"},{name:"France",value:"FR"},{name:"French Guiana",value:"GF"},{name:"French Polynesia",value:"PF"},{name:"French Southern Territories",value:"TF"},{name:"Gabon",value:"GA"},{name:"Gambia",value:"GM"},{name:"Georgia",value:"GE"},{name:"Germany",value:"DE"},{name:"Ghana",value:"GH"},{name:"Gibraltar",value:"GI"},{name:"Greece",value:"GR"},{name:"Greenland",value:"GL"},{name:"Grenada",value:"GD"},{name:"Guadeloupe",value:"GP"},{name:"Guam",value:"GU"},{name:"Guatemala",value:"GT"},{name:"Guernsey",value:"GG"},{name:"Guinea",value:"GN"},{name:"Guinea-Bissau",value:"GW"},{name:"Guyana",value:"GY"},{name:"Haiti",value:"HT"},{name:"Heard Island and McDonald Islands",value:"HM"},{name:"Holy See (Vatican City State)",value:"VA"},{name:"Honduras",value:"HN"},{name:"Hong Kong",value:"HK"},{name:"Hungary",value:"HU"},{name:"Iceland",value:"IS"},{name:"India",value:"IN"},{name:"Indonesia",value:"ID"},{name:"Iran, Islamic Republic of",value:"IR"},{name:"Iraq",value:"IQ"},{name:"Ireland",value:"IE"},{name:"Isle of Man",value:"IM"},{name:"Israel",value:"IL"},{name:"Italy",value:"IT"},{name:"Jamaica",value:"JM"},{name:"Japan",value:"JP"},{name:"Jersey",value:"JE"},{name:"Jordan",value:"JO"},{name:"Kazakhstan",value:"KZ"},{name:"Kenya",value:"KE"},{name:"Kiribati",value:"KI"},{name:"Korea, Democratic People's Republic of",value:"KP"},{name:"Korea, Republic of",value:"KR"},{name:"Kuwait",value:"KW"},{name:"Kyrgyzstan",value:"KG"},{name:"Lao People's Democratic Republic",value:"LA"},{name:"Latvia",value:"LV"},{name:"Lebanon",value:"LB"},{name:"Lesotho",value:"LS"},{name:"Liberia",value:"LR"},{name:"Libyan Arab Jamahiriya",value:"LY"},{name:"Liechtenstein",value:"LI"},{name:"Lithuania",value:"LT"},{name:"Luxembourg",value:"LU"},{name:"Macao",value:"MO"},{name:"Macedonia, the former Yugoslav Republic of",value:"MK"},{name:"Madagascar",value:"MG"},{name:"Malawi",value:"MW"},{name:"Malaysia",value:"MY"},{name:"Maldives",value:"MV"},{name:"Mali",value:"ML"},{name:"Malta",value:"MT"},{name:"Marshall Islands",value:"MH"},{name:"Martinique",value:"MQ"},{name:"Mauritania",value:"MR"},{name:"Mauritius",value:"MU"},{name:"Mayotte",value:"YT"},{name:"Mexico",value:"MX"},{name:"Micronesia, Federated States of",value:"FM"},{name:"Moldova, Republic of",value:"MD"},{name:"Monaco",value:"MC"},{name:"Mongolia",value:"MN"},{name:"Montenegro",value:"ME"},{name:"Montserrat",value:"MS"},{name:"Morocco",value:"MA"},{name:"Mozambique",value:"MZ"},{name:"Myanmar",value:"MM"},{name:"Namibia",value:"NA"},{name:"Nauru",value:"NR"},{name:"Nepal",value:"NP"},{name:"Netherlands Antilles",value:"AN"},{name:"Netherlands",value:"NL"},{name:"New Caledonia",value:"NC"},{name:"New Zealand",value:"NZ"},{name:"Nicaragua",value:"NI"},{name:"Niger",value:"NE"},{name:"Nigeria",value:"NG"},{name:"Niue",value:"NU"},{name:"Norfolk Island",value:"NK"},{name:"Northern Mariana Islands",value:"MP"},{name:"Norway",value:"NO"},{name:"Oman",value:"OM"},{name:"Pakistan",value:"PK"},{name:"Palau",value:"PW"},{name:"Palestinian Territory, Occupied",value:"PS"},{name:"Panama",value:"PA"
},{name:"Papua New Guinea",value:"PG"},{name:"Paraguay",value:"PY"},{name:"Peru",value:"PE"},{name:"Philippines",value:"PH"},{name:"Pitcairn",value:"PN"},{name:"Poland",value:"PL"},{name:"Portugal",value:"PT"},{name:"Puerto Rico",value:"PR"},{name:"Qatar",value:"QA"},{name:"Réunion",value:"RE"},{name:"Romania",value:"RO"},{name:"Russian Federation",value:"RU"},{name:"Rwanda",value:"RW"},{name:"Saint Barthélemy",value:"BL"},{name:"Saint Helena, Ascension and Tristan da Cunha",value:"SH"},{name:"Saint Kitts and Nevis",value:"KN"},{name:"Saint Lucia",value:"LC"},{name:"Saint Martin (French part)",value:"MF"},{name:"Saint Pierre and Miquelon",value:"PM"},{name:"Saint Vincent and the Grenadines",value:"VC"},{name:"Samoa",value:"WS"},{name:"San Marino",value:"SM"},{name:"Sao Tome and Principe",value:"ST"},{name:"Saudi Arabia",value:"SA"},{name:"Senegal",value:"SN"},{name:"Serbia",value:"RS"},{name:"Seychelles",value:"SC"},{name:"Sierra Leone",value:"SL"},{name:"Singapore",value:"SG"},{name:"Slovakia",value:"SK"},{name:"Slovenia",value:"SI"},{name:"Solomon Islands",value:"SB"},{name:"Somalia",value:"SO"},{name:"South Africa",value:"ZA"},{name:"South Georgia and the South Sandwich Islands",value:"GS"},{name:"Spain",value:"ES"},{name:"Sri Lanka",value:"LK"},{name:"Sudan",value:"SD"},{name:"Suriname",value:"SR"},{name:"Svalbard and Jan Mayen",value:"SJ"},{name:"Swaziland",value:"SZ"},{name:"Sweden",value:"SE"},{name:"Switzerland",value:"CH"},{name:"Syrian Arab Republic",value:"SY"},{name:"Taiwan, Province of China",value:"TW"},{name:"Tajikistan",value:"TJ"},{name:"Tanzania, United Republic of",value:"TZ"},{name:"Thailand",value:"TH"},{name:"Timor-Leste",value:"TL"},{name:"Togo",value:"TG"},{name:"Tokelau",value:"TK"},{name:"Tonga",value:"TO"},{name:"Trinidad and Tobago",value:"TT"},{name:"Tunisia",value:"TN"},{name:"Turkey",value:"TR"},{name:"Turkmenistan",value:"TM"},{name:"Turks and Caicos Islands",value:"TC"},{name:"Tuvalu",value:"TV"},{name:"Uganda",value:"UG"},{name:"Ukraine",value:"UA"},{name:"United Arab Emirates",value:"AE"},{name:"United Kingdom",value:"GB"},{name:"United States Minor Outlying Islands",value:"UM"},{name:"Uruguay",value:"UY"},{name:"Uzbekistan",value:"UZ"},{name:"Vanuatu",value:"VU"},{name:"Venezuela, Bolivarian Republic of",value:"VE"},{name:"Viet Nam",value:"VN"},{name:"Virgin Islands, British",value:"VG"},{name:"Virgin Islands, U.S.",value:"VI"},{name:"Wallis and Futuna",value:"WF"},{name:"Western Sahara",value:"EH"},{name:"Yemen",value:"YE"},{name:"Zambia",value:"ZM"},{name:"Zimbabwe",value:"ZW"}],usStates:[{value:"AL",name:"Alabama"},{value:"AK",name:"Alaska"},{value:"AS",name:"American Samoa"},{value:"AZ",name:"Arizona"},{value:"AR",name:"Arkansas"},{value:"AA",name:"Armed Forces Americas"},{value:"AE",name:"Armed Forces Europe Middle East and Canada"},{value:"AP",name:"Armed Forces Pacific"},{value:"CA",name:"California"},{value:"CO",name:"Colorado"},{value:"CT",name:"Connecticut"},{value:"DE",name:"Delaware"},{value:"DC",name:"District of Columbia"},{value:"FL",name:"Florida"},{value:"GA",name:"Georgia"},{value:"GU",name:"Guam"},{value:"HI",name:"Hawaii"},{value:"ID",name:"Idaho"},{value:"IL",name:"Illinois"},{value:"IN",name:"Indiana"},{value:"IA",name:"Iowa"},{value:"KS",name:"Kansas"},{value:"KY",name:"Kentucky"},{value:"LA",name:"Louisiana"},{value:"ME",name:"Maine"},{value:"MD",name:"Maryland"},{value:"MA",name:"Massachusetts"},{value:"MI",name:"Michigan"},{value:"MN",name:"Minnesota"},{value:"MS",name:"Mississippi"},{value:"MO",name:"Missouri"},{value:"MT",name:"Montana"},{value:"NE",name:"Nebraska"},{value:"NV",name:"Nevada"},{value:"NH",name:"New Hampshire"},{value:"NJ",name:"New Jersey"},{value:"NM",name:"New Mexico"},{value:"NY",name:"New York"},{value:"NC",name:"North Carolina"},{value:"ND",name:"North Dakota"},{value:"MP",name:"Northern Mariana Islands"},{value:"OH",name:"Ohio"},{value:"OK",name:"Oklahoma"},{value:"OR",name:"Oregon"},{value:"PA",name:"Pennsylvania"},{value:"PR",name:"Puerto Rico"},{value:"RI",name:"Rhode Island"},{value:"SC",name:"South Carolina"},{value:"SD",name:"South Dakota"},{value:"TN",name:"Tennessee"},{value:"TX",name:"Texas"},{value:"UM",name:"United States Minor Outlying Islands"},{value:"UT",name:"Utah"},{value:"VT",name:"Vermont"},{value:"VI",name:"Virgin Islands"},{value:"VA",name:"Virginia"},{value:"WA",name:"Washington"},{value:"WV",name:"West Virginia"},{value:"WI",name:"Wisconsin"},{value:"WY",name:"Wyoming"}]};return a}),c("core/constants/site-map-bundle",[],function(){"use strict";var a={siteMap:{header:[{group:[{url:"/book-travel",name:"Book"},{url:"/flight-check-in",name:"Check In"},{url:"/manage-itinerary",name:"Manage"}]},{group:[{url:"/cms/travel-deals",name:"Deals"},{url:"/cms/fly-with-us",name:"Flying With Us"},{url:"/cms/airport-destinations",name:"Where We Fly"},{url:"/cms/vx-fees",name:"Fees"},{url:"/check-flight-status",name:"Flight Status"},{url:"/get-flight-alerts",name:"Flight Alerts"}]}],footer:[{group:[{url:"/cms/sitemap",name:"Site Map"},{url:"http://virginamerica.custhelp.com/",name:"Contact Us/FAQs"},{url:"/cms/contract-of-carriage",name:"Contract of Carriage"},{url:"/cms/legal/privacy-policy",name:"Privacy Policy"},{url:"/cms/about-our-airline",name:"About Us"},{url:"/blog",name:"Blog"}]},{group:[{url:"/cms/legal/guest-service-commitment",name:"Guest Service Commitment"},{url:"https://www.virginamerica.com/cms/dam/vx-pdf/Tarmac_Delay_Contingency_Plan_Revised_May_2015.pdf",name:"Tarmac Delay Contingency Plan"},{url:"/cms/fly-with-us/Mobile-App",name:"Mobile App"},{url:"/cms/corporate-responsibility",name:"Corporate Responsibility"},{url:"/cms/intl-contract-of-carriage",name:"Int’l Contract of Carriage"}]},{group:[{url:"/cms/elevate-frequent-flyer",name:"Elevate"},{url:"/cms/corporate-travel",name:"Corporate & Group Travel"},{url:"/cms/corporate-travel/travel-agents",name:"Travel Agents"},{url:"/cms/about-our-airline/press",name:"Press & Awards"},{url:"/cms/news",name:"All News & Updates"},{url:"/cms/airline-jobs",name:"Careers"}]},{group:[{url:"https://elevate.virginamerica.com/pub/sf/ResponseForm?_ri_=X0Gzc2X%3DWQpglLjHJlYQGn0oWPReMY4XDaNwzdUWuzby0minVXMtX%3DWQpglLjHJlYQGiTzdzegm6dhzeeqzbYgKaeKzd0SzdkO&_ei_=EqJbYT9NhKIwWY6KwuLgbGM",name:"Email Unsubscribe"},{url:"/cms/travel-guard",name:"Travel Insurance"},{url:"http://ir.virginamerica.com/phoenix.zhtml?c=253736&p=irol-irhome",name:"Investor Relations"},{url:"/cms/accessibility-services",name:"Accessibility Services"},{url:"http://virginamerica.custhelp.com/app/ask/incidents.c$typeofquestion/2079",name:"Accessibility Services Form"}]},{group:[{url:"/cms/elevate-frequent-flyer/partners/credit-card",name:"Credit Card"},{url:"/cms/advertise-onboard",name:"Advertise Onboard"}]},{group:[{url:"http://instagram.com/virginamerica",name:"Instagram"},{url:"https://twitter.com/VirginAmerica",name:"Twitter"},{url:"https://www.facebook.com/VirginAmerica",name:"Facebook"},{url:"https://www.youtube.com/user/VirginAmerica",name:"YouTube"},{url:"https://plus.google.com/+VirginAmerica/",name:"Google+"}]}]}};return a}),c("core/constants/routes-bundle",[],function(){"use strict";var a={AUS:{sm:"/images/cities/AUS-mini.png",md:"/images/cities/AUS-mini-2x.png",lg:"/images/cities/AUS.png"},BNA:{sm:"/images/cities/BNA-mini.png",md:"/images/cities/BNA-mini-2x.png",lg:"/images/cities/BNA.png"},BOS:{sm:"/images/cities/BOS-mini.png",md:"/images/cities/BOS-mini-2x.png",lg:"/images/cities/BOS.png"},BWI:{sm:"/images/cities/BWI-mini.png",md:"/images/cities/BWI-mini-2x.png",lg:"/images/cities/BWI.png"},IND:{sm:"/images/cities/IND-mini.png",md:"/images/cities/IND-mini-2x.png",lg:"/images/cities/IND.png"},RDU:{sm:"/images/cities/RDU-mini.png",md:"/images/cities/RDU-mini-2x.png",lg:"/images/cities/RDU.png"},KOA:{sm:"/images/cities/KOA-mini.png",md:"/images/cities/KOA-mini-2x.png",lg:"/images/cities/KOA.png"},MSY:{sm:"/images/cities/MSY-mini.png",md:"/images/cities/MSY-mini-2x.png",lg:"/images/cities/MSY.png"},LAX:{sm:"/images/cities/LAX.png",md:"/images/cities/LAX.png",lg:"/images/cities/LAX.png"},CUN:{sm:"/images/cities/CUN-mini.png",md:"/images/cities/CUN-mini-2x.png",lg:"/images/cities/CUN.png"},ORD:{sm:"/images/cities/ORD-mini.png",md:"/images/cities/ORD-mini-2x.png",lg:"/images/cities/ORD.png"},DAL:{sm:"/images/cities/DAL-mini.png",md:"/images/cities/DAL-mini-2x.png",lg:"/images/cities/DAL.png"},DEN:{sm:"/images/cities/DEN-mini.png",md:"/images/cities/DEN-mini-2x.png",lg:"/images/cities/DEN.png"},DFW:{sm:"/images/cities/DFW-mini.png",md:"/images/cities/DFW-mini-2x.png",lg:"/images/cities/DFW.png"},FLL:{sm:"/images/cities/FLL-mini.png",md:"/images/cities/FLL-mini-2x.png",lg:"/images/cities/FLL.png"},LAS:{sm:"/images/cities/LAS-mini.png",md:"/images/cities/LAS-mini-2x.png",lg:"/images/cities/LAS.png"},JFK:{sm:"/images/cities/JFK.png",md:"/images/cities/JFK.png",lg:"/images/cities/JFK.png"},SJD:{sm:"/images/cities/SJD-mini.png",md:"/images/cities/SJD-mini-2x.png",lg:"/images/cities/SJD.png"},LGA:{sm:"/images/cities/LGA-mini.png",md:"/images/cities/LGA-mini-2x.png",lg:"/images/cities/LGA.png"},EWR:{sm:"/images/cities/EWR-mini.png",md:"/images/cities/EWR-mini-2x.png",lg:"/images/cities/EWR.png"},MCO:{sm:"/images/cities/MCO-mini.png",md:"/images/cities/MCO-mini-2x.png",lg:"/images/cities/MCO.png"},PSP:{sm:"/images/cities/PSP-mini.png",md:"/images/cities/PSP-mini-2x.png",lg:"/images/cities/PSP.png"},PHL:{sm:"/images/cities/PHL-mini.png",md:"/images/cities/PHL-mini-2x.png",lg:"/images/cities/PHL.png"},PDX:{sm:"/images/cities/PDX-mini.png",md:"/images/cities/PDX-mini-2x.png",lg:"/images/cities/PDX.png"},PVR:{sm:"/images/cities/PVR-mini.png",md:"/images/cities/PVR-mini-2x.png",lg:"/images/cities/PVR.png"},SAN:{sm:"/images/cities/SAN-mini.png",md:"/images/cities/SAN-mini-2x.png",lg:"/images/cities/SAN.png"},SJC:{sm:"/images/cities/SJC-mini.png",md:"/images/cities/SJC-mini-2x.png",lg:"/images/cities/SJC.png"},SFO:{sm:"/images/cities/SFO.png",md:"/images/cities/SFO.png",lg:"/images/cities/SFO.png"},SEA:{sm:"/images/cities/SEA-mini.png",md:"/images/cities/SEA-mini-2x.png",lg:"/images/cities/SEA.png"},IAD:{sm:"/images/cities/IAD-mini.png",md:"/images/cities/IAD-mini-2x.png",lg:"/images/cities/IAD.png"},DCA:{sm:"/images/cities/IAD2-mini.png",md:"/images/cities/IAD2-mini-2x.png",lg:"/images/cities/IAD2.png"},HNL:{sm:"/images/cities/HNL-mini.png",md:"/images/cities/NHL-mini-2x.png",lg:"/images/cities/HNL.png"},OGG:{sm:"/images/cities/OGG-mini.png",md:"/images/cities/OGG-mini-2x.png",lg:"/images/cities/OGG.png"}};return a}),function(a,b,c){"use strict";function d(a,b,c){e.directive(a,["$parse","$swipe",function(d,e){var f=75,g=.3,h=30;return function(i,j,k){function l(a){if(!m)return!1;var c=Math.abs(a.y-m.y),d=(a.x-m.x)*b;return n&&c<f&&d>0&&d>h&&c/d<g}var m,n,o=d(k[a]);e.bind(j,{start:function(a,b){m=a,n=!0},cancel:function(a){n=!1},end:function(a,b){l(a)&&i.$apply(function(){j.triggerHandler(c),o(i,{$event:b})})}})}}])}var e=b.module("ngTouch",[]);e.factory("$swipe",[function(){function a(a){var b=a.touches&&a.touches.length?a.touches:[a],c=a.changedTouches&&a.changedTouches[0]||a.originalEvent&&a.originalEvent.changedTouches&&a.originalEvent.changedTouches[0]||b[0].originalEvent||b[0];return{x:c.clientX,y:c.clientY}}var b=10;return{bind:function(c,d){var e,f,g,h,i=!1;c.on("touchstart mousedown",function(b){g=a(b),i=!0,e=0,f=0,h=g,d.start&&d.start(g,b)}),c.on("touchcancel",function(a){i=!1,d.cancel&&d.cancel(a)}),c.on("touchmove mousemove",function(c){if(i&&g){var j=a(c);if(e+=Math.abs(j.x-h.x),f+=Math.abs(j.y-h.y),h=j,!(e<b&&f<b))return f>e?(i=!1,void(d.cancel&&d.cancel(c))):(c.preventDefault(),void(d.move&&d.move(j,c)))}}),c.on("touchend mouseup",function(b){i&&(i=!1,d.end&&d.end(a(b),b))})}}}]),e.config(["$provide",function(a){a.decorator("ngClickDirective",["$delegate",function(a){return a.shift(),a}])}]),e.directive("ngClick",["$parse","$timeout","$rootElement",function(a,c,d){function e(a,b,c,d){return Math.abs(a-c)<p&&Math.abs(b-d)<p}function f(a,b,c){for(var d=0;d<a.length;d+=2)if(e(a[d],a[d+1],b,c))return a.splice(d,d+2),!0;return!1}function g(a){if(!(Date.now()-j>o)){var b=a.touches&&a.touches.length?a.touches:[a],c=b[0].clientX,d=b[0].clientY;c<1&&d<1||l&&l[0]===c&&l[1]===d||(l&&(l=null),"label"===a.target.tagName.toLowerCase()&&(l=[c,d]),f(k,c,d)||(a.stopPropagation(),a.preventDefault(),a.target&&a.target.blur()))}}function h(a){var b=a.touches&&a.touches.length?a.touches:[a],d=b[0].clientX,e=b[0].clientY;k.push(d,e),c(function(){for(var a=0;a<k.length;a+=2)if(k[a]==d&&k[a+1]==e)return void k.splice(a,a+2)},o,!1)}function i(a,b){k||(d[0].addEventListener("click",g,!0),d[0].addEventListener("touchstart",h,!0),k=[]),j=Date.now(),f(k,a,b)}var j,k,l,m=750,n=12,o=2500,p=25,q="ng-click-active";return function(c,d,e){function f(){o=!1,d.removeClass(q)}var g,h,j,k,l=a(e.ngClick),o=!1;d.on("touchstart",function(a){o=!0,g=a.target?a.target:a.srcElement,3==g.nodeType&&(g=g.parentNode),d.addClass(q),h=Date.now();var b=a.touches&&a.touches.length?a.touches:[a],c=b[0].originalEvent||b[0];j=c.clientX,k=c.clientY}),d.on("touchmove",function(a){f()}),d.on("touchcancel",function(a){f()}),d.on("touchend",function(a){var c=Date.now()-h,l=a.changedTouches&&a.changedTouches.length?a.changedTouches:a.touches&&a.touches.length?a.touches:[a],p=l[0].originalEvent||l[0],q=p.clientX,r=p.clientY,s=Math.sqrt(Math.pow(q-j,2)+Math.pow(r-k,2));o&&c<m&&s<n&&(i(q,r),g&&g.blur(),(!b.isDefined(e.disabled)||e.disabled===!1)&&d.triggerHandler("click",[a])),f()}),d.onclick=function(a){},d.on("click",function(a,b){c.$apply(function(){l(c,{$event:b||a})})}),d.on("mousedown",function(a){d.addClass(q)}),d.on("mousemove mouseup",function(a){d.removeClass(q)})}}]),d("ngSwipeLeft",-1,"swipeleft"),d("ngSwipeRight",1,"swiperight")}(window,window.angular),c("angular-touch",["angular"],function(){}),function(a,b,c){"use strict";function d(){function a(a,c){return b.extend(new(b.extend(function(){},{prototype:a})),c)}function c(a,b){var c=b.caseInsensitiveMatch,d={originalPath:a,regexp:a},e=d.keys=[];return a=a.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?\*])?/g,function(a,b,c,d){var f="?"===d?d:null,g="*"===d?d:null;return e.push({name:c,optional:!!f}),b=b||"",""+(f?"":b)+"(?:"+(f?b:"")+(g&&"(.+?)"||"([^/]+)")+(f||"")+")"+(f||"")}).replace(/([\/$\*])/g,"\\$1"),d.regexp=new RegExp("^"+a+"$",c?"i":""),d}var d={};this.when=function(a,e){if(d[a]=b.extend({reloadOnSearch:!0},e,a&&c(a,e)),a){var f="/"==a[a.length-1]?a.substr(0,a.length-1):a+"/";d[f]=b.extend({redirectTo:a},c(f,e))}return this},this.otherwise=function(a){return this.when(null,a),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(c,e,f,g,h,i,j,k){function l(a,b){var c=b.keys,d={};if(!b.regexp)return null;var e=b.regexp.exec(a);if(!e)return null;for(var f=1,g=e.length;f<g;++f){var h=c[f-1],i=e[f];h&&i&&(d[h.name]=i)}return d}function m(){var a=n(),d=q.current;a&&d&&a.$$route===d.$$route&&b.equals(a.pathParams,d.pathParams)&&!a.reloadOnSearch&&!p?(d.params=a.params,b.copy(d.params,f),c.$broadcast("$routeUpdate",d)):(a||d)&&(p=!1,c.$broadcast("$routeChangeStart",a,d),q.current=a,a&&a.redirectTo&&(b.isString(a.redirectTo)?e.path(o(a.redirectTo,a.params)).search(a.params).replace():e.url(a.redirectTo(a.pathParams,e.path(),e.search())).replace()),g.when(a).then(function(){if(a){var c,d,e=b.extend({},a.resolve);return b.forEach(e,function(a,c){e[c]=b.isString(a)?h.get(a):h.invoke(a)}),b.isDefined(c=a.template)?b.isFunction(c)&&(c=c(a.params)):b.isDefined(d=a.templateUrl)&&(b.isFunction(d)&&(d=d(a.params)),d=k.getTrustedResourceUrl(d),b.isDefined(d)&&(a.loadedTemplateUrl=d,c=i.get(d,{cache:j}).then(function(a){return a.data}))),b.isDefined(c)&&(e.$template=c),g.all(e)}}).then(function(e){a==q.current&&(a&&(a.locals=e,b.copy(a.params,f)),c.$broadcast("$routeChangeSuccess",a,d))},function(b){a==q.current&&c.$broadcast("$routeChangeError",a,d,b)}))}function n(){var c,f;return b.forEach(d,function(d,g){!f&&(c=l(e.path(),d))&&(f=a(d,{params:b.extend({},e.search(),c),pathParams:c}),f.$$route=d)}),f||d[null]&&a(d[null],{params:{},pathParams:{}})}function o(a,c){var d=[];return b.forEach((a||"").split(":"),function(a,b){if(0===b)d.push(a);else{var e=a.match(/(\w+)(?:[?*])?(.*)/),f=e[1];d.push(c[f]),d.push(e[2]||""),delete c[f]}}),d.join("")}var p=!1,q={routes:d,reload:function(){p=!0,c.$evalAsync(m)}};return c.$on("$locationChangeSuccess",m),q}]}function e(){this.$get=function(){return{}}}function f(a,c,d){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(e,f,g,h,i){function j(){n&&(n.remove(),n=null),l&&(l.$destroy(),l=null),m&&(d.leave(m,function(){n=null}),n=m,m=null)}function k(){var g=a.current&&a.current.locals,h=g&&g.$template;if(b.isDefined(h)){var k=e.$new(),n=a.current,q=i(k,function(a){d.enter(a,null,m||f,function(){b.isDefined(o)&&(!o||e.$eval(o))&&c()}),j()});m=q,l=n.scope=k,l.$emit("$viewContentLoaded"),l.$eval(p)}else j()}var l,m,n,o=g.autoscroll,p=g.onload||"";e.$on("$routeChangeSuccess",k),k()}}}function g(a,b,c){return{restrict:"ECA",priority:-400,link:function(d,e){var f=c.current,g=f.locals;e.html(g.$template);var h=a(e.contents());if(f.controller){g.$scope=d;var i=b(f.controller,g);f.controllerAs&&(d[f.controllerAs]=i),e.data("$ngControllerController",i),e.children().data("$ngControllerController",i)}h(d)}}}var h=b.module("ngRoute",["ng"]).provider("$route",d);h.provider("$routeParams",e),h.directive("ngView",f),h.directive("ngView",g),f.$inject=["$route","$anchorScroll","$animate"],g.$inject=["$compile","$controller","$route"]}(window,window.angular),c("angular-route",["angular"],function(){}),function(a,b,c){"use strict";function d(a){return null!=a&&""!==a&&"hasOwnProperty"!==a&&h.test("."+a)}function e(a,b){if(!d(b))throw g("badmember",'Dotted member path "@{0}" is invalid.',b);for(var e=b.split("."),f=0,h=e.length;f<h&&a!==c;f++){var i=e[f];a=null!==a?a[i]:c}return a}function f(a,c){c=c||{},b.forEach(c,function(a,b){delete c[b]});for(var d in a)a.hasOwnProperty(d)&&("$"!==d.charAt(0)||"$"!==d.charAt(1))&&(c[d]=a[d]);return c}var g=b.$$minErr("$resource"),h=/^(\.[a-zA-Z_$][0-9a-zA-Z_$]*)+$/;b.module("ngResource",["ng"]).factory("$resource",["$http","$q",function(a,d){function h(a){return i(a,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function i(a,b){return encodeURIComponent(a).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,b?"%20":"+")}function j(a,b){this.template=a,this.defaults=b||{},this.urlParams={}}function k(h,i,r){function s(a,b){var c={};return b=o({},i,b),n(b,function(b,d){q(b)&&(b=b()),c[d]=b&&b.charAt&&"@"==b.charAt(0)?e(a,b.substr(1)):b}),c}function t(a){return a.resource}function u(a){f(a||{},this)}var v=new j(h);return r=o({},l,r),n(r,function(e,h){var i=/^(POST|PUT|PATCH)$/i.test(e.method);u[h]=function(h,j,k,l){var r,w,x,y={};switch(arguments.length){case 4:x=l,w=k;case 3:case 2:if(!q(j)){y=h,r=j,w=k;break}if(q(h)){w=h,x=j;break}w=j,x=k;case 1:q(h)?w=h:i?r=h:y=h;break;case 0:break;default:throw g("badargs","Expected up to 4 arguments [params, data, success, error], got {0} arguments",arguments.length)}var z=this instanceof u,A=z?r:e.isArray?[]:new u(r),B={},C=e.interceptor&&e.interceptor.response||t,D=e.interceptor&&e.interceptor.responseError||c;n(e,function(a,b){"params"!=b&&"isArray"!=b&&"interceptor"!=b&&(B[b]=p(a))}),i&&(B.data=r),v.setUrlParams(B,o({},s(r,e.params||{}),y),e.url);var E=a(B).then(function(a){var c=a.data,d=A.$promise;if(c){if(b.isArray(c)!==!!e.isArray)throw g("badcfg","Error in resource configuration. Expected response to contain an {0} but got an {1}",e.isArray?"array":"object",b.isArray(c)?"array":"object");e.isArray?(A.length=0,n(c,function(a){"object"==typeof a?A.push(new u(a)):A.push(a)})):(f(c,A),A.$promise=d)}return A.$resolved=!0,a.resource=A,a},function(a){return A.$resolved=!0,(x||m)(a),d.reject(a)});return E=E.then(function(a){var b=C(a);return(w||m)(b,a.headers),b},D),z?E:(A.$promise=E,A.$resolved=!1,A)},u.prototype["$"+h]=function(a,b,c){q(a)&&(c=b,b=a,a={});var d=u[h].call(this,a,this,b,c);return d.$promise||d}}),u.bind=function(a){return k(h,o({},i,a),r)},u}var l={get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},delete:{method:"DELETE"}},m=b.noop,n=b.forEach,o=b.extend,p=b.copy,q=b.isFunction;return j.prototype={setUrlParams:function(a,c,d){var e,f,i=this,j=d||i.template,k=i.urlParams={};n(j.split(/\W/),function(a){if("hasOwnProperty"===a)throw g("badname","hasOwnProperty is not a valid parameter name.");!new RegExp("^\\d+$").test(a)&&a&&new RegExp("(^|[^\\\\]):"+a+"(\\W|$)").test(j)&&(k[a]=!0)}),j=j.replace(/\\:/g,":"),c=c||{},n(i.urlParams,function(a,d){e=c.hasOwnProperty(d)?c[d]:i.defaults[d],b.isDefined(e)&&null!==e?(f=h(e),j=j.replace(new RegExp(":"+d+"(\\W|$)","g"),function(a,b){return f+b})):j=j.replace(new RegExp("(/?):"+d+"(\\W|$)","g"),function(a,b,c){return"/"==c.charAt(0)?c:b+c})}),j=j.replace(/\/+$/,"")||"/",j=j.replace(/\/\.(?=\w+($|\?))/,"."),a.url=j.replace(/\/\\\./,"/."),n(c,function(b,c){i.urlParams[c]||(a.params=a.params||{},a.params[c]=b)})}},k}])}(window,window.angular),c("angular-resource",["angular"],function(){}),function(){"use strict";var a=angular.module("pasvaz.bindonce",[]);a.directive("bindonce",function(){var a=function(a){if(a&&0!==a.length){var b=angular.lowercase(""+a);a="f"!==b&&"0"!==b&&"false"!==b&&"no"!==b&&"n"!==b&&"[]"!==b}else a=!1;return a},b=function(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(b===a[c])return c;return-1},c=parseInt((/msie (\d+)/.exec(angular.lowercase(navigator.userAgent))||[])[1],10);isNaN(c)&&(c=parseInt((/trident\/.*; rv:(\d+)/.exec(angular.lowercase(navigator.userAgent))||[])[1],10));var d={restrict:"AM",controller:["$scope","$element","$attrs","$interpolate",function(d,e,f,g){var h=function(b,c,d){var e="show"===c?"":"none",f="hide"===c?"":"none";b.css("display",a(d)?e:f)},i=function(a,b){var c=[];if(angular.isObject(b)&&!angular.isArray(b)){var d=[];angular.forEach(b,function(a,b){a?d.push(b):c.push(b)}),b=d}b&&a.addClass(angular.isArray(b)?b.join(" "):b),c.length&&a.removeClass(c.join(" "))},j=function(a,b,c){b&&(a.newScope=a.scope.$new()),a.transclude(a.newScope||a.scope,function(b){c&&(a.nodes=a.nodes||[]);var d=a.element.parent(),e=a.element&&a.element[a.element.length-1],f=d&&d[0]||e&&e.parentNode,g=e&&e.nextSibling||null;angular.forEach(b,function(b){f.insertBefore(b,g),c&&a.nodes.push(b)})})},k={watcherRemover:void 0,queue:[],refreshQueue:[],group:f.boName,element:e,refreshing:!1,isReady:!1,oneWatcher:!1,keepBinders:!1,ready:function(){k.isReady=!0,k.runBinders(),k.refreshOn&&d.$on(k.refreshOn,k.refresher)},addBinder:function(a){this.group&&this.group!=a.group||(this.queue.push(a),!this.isReady||this.queue.length>1||this.runBinders())},setupWatcher:function(a){this.watcherRemover=d.$watch(a,function(a){void 0!==a&&(!k.oneWatcher&&k.removeWatcher(),k.isReady?k.refresher():k.checkBindonce(a))},!0)},checkBindonce:function(a){var b=a.$promise?a.$promise.then:a.then;"function"==typeof b?b(k.ready):k.ready()},removeWatcher:function(){void 0!==this.watcherRemover&&(this.watcherRemover(),this.watcherRemover=void 0)},destroy:function(){k.queue=[],k.refreshQueue=[],k.element=void 0,k.removeWatcher()},runBinders:function(){for(;this.queue.length>0;){var a=this.queue.shift();if(!a.dead){var c=a.scope.$eval(a.interpolate?g(a.value):a.value);this.runBinder(a,c),this.keepBinders&&(this.refreshQueue.push(a),a.stopRefresh=function(){k.refreshQueue[b(k.refreshQueue,a)]=null})}}},runBinder:function(b,d){switch(b.attr){case"boIf":a(d)&&j(b,!b.attrs.boNoScope,k.keepBinders);break;case"boSwitch":var e=b.controller[0];(b.selectedBinders=e.cases["!"+d]||e.cases["?"])&&(b.scope.$eval(b.attrs.change),angular.forEach(b.selectedBinders,function(a){a.element&&j(a,!b.attrs.boNoScope,k.keepBinders)}));break;case"boSwitchWhen":var e=b.controller[0];e.cases["!"+b.attrs.boSwitchWhen]=e.cases["!"+b.attrs.boSwitchWhen]||[],e.cases["!"+b.attrs.boSwitchWhen].push(b);break;case"boSwitchDefault":var e=b.controller[0];e.cases["?"]=e.cases["?"]||[],e.cases["?"].push(b);break;case"hide":case"show":h(b.element,b.attr,d);break;case"class":i(b.element,d);break;case"text":b.element.text(d);break;case"html":b.element.html(d);break;case"style":b.element.css(d);break;case"src":b.element.attr(b.attr,d),c&&b.element.prop("src",d);break;case"attr":angular.forEach(b.attrs,function(a,c){var d,e;c.match(/^boAttr./)&&b.attrs[c]&&(d=c.replace(/^boAttr/,"").replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),e=b.scope.$eval(b.attrs[c]),b.element.attr(d,e))});break;case"href":case"alt":case"title":case"id":case"value":b.element.attr(b.attr,d)}b.lastValue=d},destroyBinder:function(a,b){var c=function(a,b){for(var c=0;c<b.length;c++){var e=b[c];if(e===a){b.splice(c),d(e);break}}},d=function(a){a.newScope&&a.newScope.$destroy(),delete a.newScope,angular.forEach(a.nodes,function(a){var b=a.parentNode;b&&b.removeChild(a)}),delete a.nodes};switch(a.attr){case"boIf":d(a);break;case"boSwitch":a.selectedBinders&&delete a.selectedBinders;break;case"boSwitchWhen":var e=a.controller[0],f=e.cases["!"+a.attrs.boSwitchWhen]||[];c(a,f);break;case"boSwitchDefault":var e=a.controller[0],f=e.cases["?"]||[];c(a,f)}},refresher:function(){if(!k.refreshing){k.refreshing=!0;var a,b=k.refreshQueue.length;for(a=0;a<b;a++){var c=k.refreshQueue[a];if(c&&!c.dead){var d=c.scope.$eval(c.interpolate?g(c.value):c.value);"boIf"===c.attr?d!==c.lastValue&&(k.destroyBinder(c,d),k.runBinder(c,d)):(k.destroyBinder(c,d),k.runBinder(c,d))}}k.refreshing=!1}}};return k}],link:function(a,b,c,d){var e=c.bindonce&&a.$eval(c.bindonce);d.oneWatcher=c.hasOwnProperty("oneWatcher"),d.refreshOn=c.refreshOn&&a.$eval(c.refreshOn),d.keepBinders=d.oneWatcher||d.refreshOn,void 0!==e?d.checkBindonce(e):d.setupWatcher(c.bindonce),b.bind("$destroy",d.destroy)}};return d}),angular.forEach([{directiveName:"boShow",attribute:"show"},{directiveName:"boHide",attribute:"hide"},{directiveName:"boClass",attribute:"class"},{directiveName:"boText",attribute:"text"},{directiveName:"boBind",attribute:"text"},{directiveName:"boHtml",attribute:"html"},{directiveName:"boSrcI",attribute:"src",interpolate:!0},{directiveName:"boSrc",attribute:"src"},{directiveName:"boHrefI",attribute:"href",interpolate:!0},{directiveName:"boHref",attribute:"href"},{directiveName:"boAlt",attribute:"alt"},{directiveName:"boTitle",attribute:"title"},{directiveName:"boId",attribute:"id"},{directiveName:"boStyle",attribute:"style"},{directiveName:"boValue",attribute:"value"},{directiveName:"boAttr",attribute:"attr"},{directiveName:"boIf",transclude:"element",terminal:!0,priority:1e3},{directiveName:"boSwitch",require:"boSwitch",controller:function(){this.cases={}}},{directiveName:"boSwitchWhen",transclude:"element",priority:800,require:"^boSwitch"},{directiveName:"boSwitchDefault",transclude:"element",priority:800,require:"^boSwitch"}],function(b){var c=200;return a.directive(b.directiveName,function(){var a={priority:b.priority||c,transclude:b.transclude||!1,terminal:b.terminal||!1,require:["^bindonce"].concat(b.require||[]),controller:b.controller,compile:function(a,c,d){return function(a,c,e,f){var g=f[0],h=e.boParent;if(h&&g.group!==h){var i=g.element.parent();g=void 0;for(var j;9!==i[0].nodeType&&i.length;){if((j=i.data("$bindonceController"))&&j.group===h){g=j;break}i=i.parent()}if(!g)throw new Error("No bindonce controller: "+h)}var k={element:c,attr:b.attribute||b.directiveName,attrs:e,value:e[b.directiveName],interpolate:b.interpolate,group:h,transclude:d,controller:f.slice(1),scope:a},l=function(){null!=k&&(k.dead=!0,k.stopRefresh&&k.stopRefresh(),k.scope=k.element=k.transclude=void 0,delete k.nodes,k=null)};g.addBinder(k),c.bind("$destroy",l)}}};return a})})}(),c("angular-bindonce",["angular"],function(){}),window.AngularSlider=function(a,b,c){function d(a){n.cssText=a}function e(a,b){return typeof a===b}function f(){j.inputtypes=function(a){for(var d,e,f,g=0,h=a.length;g<h;g++)o.setAttribute("type",e=a[g]),d="text"!==o.type,d&&(o.value=p,o.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(e)&&o.style.WebkitAppearance!==c?(k.appendChild(o),f=b.defaultView,d=f.getComputedStyle&&"textfield"!==f.getComputedStyle(o,null).WebkitAppearance&&0!==o.offsetHeight,k.removeChild(o)):/^(search|tel)$/.test(e)||(d=/^(url|email)$/.test(e)?o.checkValidity&&o.checkValidity()===!1:o.value!=p)),r[a[g]]=!!d;return r}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var g,h,i="2.7.1",j={},k=b.documentElement,l="modernizr",m=b.createElement(l),n=m.style,o=b.createElement("input"),p=":)",q=({}.toString,{}),r={},s=[],t=s.slice,u={}.hasOwnProperty;h=e(u,"undefined")||e(u.call,"undefined")?function(a,b){return b in a&&e(a.constructor.prototype[b],"undefined")}:function(a,b){return u.call(a,b)},Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if("function"!=typeof b)throw new TypeError;var c=t.call(arguments,1),d=function(){if(this instanceof d){var e=function(){};e.prototype=b.prototype;var f=new e,g=b.apply(f,c.concat(t.call(arguments)));return Object(g)===g?g:f}return b.apply(a,c.concat(t.call(arguments)))};return d});for(var v in q)h(q,v)&&(g=v.toLowerCase(),j[g]=q[v](),s.push((j[g]?"":"no-")+g));return j.input||f(),j.addTest=function(a,b){if("object"==typeof a)for(var d in a)h(a,d)&&j.addTest(d,a[d]);else{if(a=a.toLowerCase(),j[a]!==c)return j;b="function"==typeof b?b():b,"undefined"!=typeof enableClasses&&enableClasses&&(k.className+=" "+(b?"":"no-")+a),j[a]=b}return j},d(""),m=o=null,j._version=i,j}(this,this.document),function(a,b,c){function d(a){return"[object Function]"==q.call(a)}function e(a){return"string"==typeof a}function f(){}function g(a){return!a||"loaded"==a||"complete"==a||"uninitialized"==a}function h(){var a=r.shift();s=1,a?a.t?o(function(){("c"==a.t?m.injectCss:m.injectJs)(a.s,0,a.a,a.x,a.e,1)},0):(a(),h()):s=0}function i(a,c,d,e,f,i,j){function k(b){if(!n&&g(l.readyState)&&(t.r=n=1,!s&&h(),l.onload=l.onreadystatechange=null,b)){"img"!=a&&o(function(){v.removeChild(l)},50);for(var d in A[c])A[c].hasOwnProperty(d)&&A[c][d].onload()}}var j=j||m.errorTimeout,l=b.createElement(a),n=0,q=0,t={t:d,s:c,e:f,a:i,x:j};1===A[c]&&(q=1,A[c]=[]),"object"==a?l.data=c:(l.src=c,l.type=a),l.width=l.height="0",l.onerror=l.onload=l.onreadystatechange=function(){k.call(this,q)},r.splice(e,0,t),"img"!=a&&(q||2===A[c]?(v.insertBefore(l,u?null:p),o(k,j)):A[c].push(l))}function j(a,b,c,d,f){return s=0,b=b||"j",e(a)?i("c"==b?x:w,a,b,this.i++,c,d,f):(r.splice(this.i++,0,a),1==r.length&&h()),this}function k(){var a=m;return a.loader={load:j,i:0},a}var l,m,n=b.documentElement,o=a.setTimeout,p=b.getElementsByTagName("script")[0],q={}.toString,r=[],s=0,t="MozAppearance"in n.style,u=t&&!!b.createRange().compareNode,v=u?n:p.parentNode,n=a.opera&&"[object Opera]"==q.call(a.opera),n=!!b.attachEvent&&!n,w=t?"object":n?"script":"img",x=n?"script":w,y=Array.isArray||function(a){return"[object Array]"==q.call(a)},z=[],A={},B={timeout:function(a,b){return b.length&&(a.timeout=b[0]),a}};m=function(a){function b(a){var b,c,d,a=a.split("!"),e=z.length,f=a.pop(),g=a.length,f={url:f,origUrl:f,prefixes:a};for(c=0;c<g;c++)d=a[c].split("="),(b=B[d.shift()])&&(f=b(f,d));for(c=0;c<e;c++)f=z[c](f);return f}function g(a,e,f,g,h){var i=b(a),j=i.autoCallback;i.url.split(".").pop().split("?").shift(),i.bypass||(e&&(e=d(e)?e:e[a]||e[g]||e[a.split("/").pop().split("?")[0]]),i.instead?i.instead(a,e,f,g,h):(A[i.url]?i.noexec=!0:A[i.url]=1,f.load(i.url,i.forceCSS||!i.forceJS&&"css"==i.url.split(".").pop().split("?").shift()?"c":c,i.noexec,i.attrs,i.timeout),(d(e)||d(j))&&f.load(function(){k(),e&&e(i.origUrl,h,g),j&&j(i.origUrl,h,g),A[i.url]=2})))}function h(a,b){function c(a,c){if(a){if(e(a))c||(l=function(){var a=[].slice.call(arguments);m.apply(this,a),n()}),g(a,l,b,0,j);else if(Object(a)===a)for(i in h=function(){
var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c}(),a)a.hasOwnProperty(i)&&(!c&&!--h&&(d(l)?l=function(){var a=[].slice.call(arguments);m.apply(this,a),n()}:l[i]=function(a){return function(){var b=[].slice.call(arguments);a&&a.apply(this,b),n()}}(m[i])),g(a[i],l,b,i,j))}else!c&&n()}var h,i,j=!!a.test,k=a.load||a.both,l=a.callback||f,m=l,n=a.complete||f;c(j?a.yep:a.nope,!!k),k&&c(k)}var i,j,l=this.yepnope.loader;if(e(a))g(a,0,l,0);else if(y(a))for(i=0;i<a.length;i++)j=a[i],e(j)?g(j,0,l,0):y(j)?m(j):Object(j)===j&&h(j,l);else Object(a)===a&&h(a,l)},m.addPrefix=function(a,b){B[a]=b},m.addFilter=function(a){z.push(a)},m.errorTimeout=1e4,null==b.readyState&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",l=function(){b.removeEventListener("DOMContentLoaded",l,0),b.readyState="complete"},0)),a.yepnope=k(),a.yepnope.executeStack=h,a.yepnope.injectJs=function(a,c,d,e,i,j){var k,l,n=b.createElement("script"),e=e||m.errorTimeout;n.src=a;for(l in d)n.setAttribute(l,d[l]);c=j?h:c||f,n.onreadystatechange=n.onload=function(){!k&&g(n.readyState)&&(k=1,c(),n.onload=n.onreadystatechange=null)},o(function(){k||(k=1,c(1))},e),i?n.onload():p.parentNode.insertBefore(n,p)},a.yepnope.injectCss=function(a,c,d,e,g,i){var j,e=b.createElement("link"),c=i?h:c||f;e.href=a,e.rel="stylesheet",e.type="text/css";for(j in d)e.setAttribute(j,d[j]);g||(p.parentNode.insertBefore(e,p),o(c,0))}}(this,document),AngularSlider.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},angular.module("vr.directives.slider",["ngTouch"]).directive("slider",["$timeout","$document","$interpolate","$swipe",function(a,b,c,d){function e(a){return angular.element(a)}function f(a){return""+a+"px"}function g(a,b){return a.css({opacity:b})}function h(a){return g(a,0)}function i(a){return g(a,1)}function j(a,b){return a.css({left:b})}function k(a){var b=parseFloat(a.css("width"));return isNaN(b)?a[0].offsetWidth:b}function l(a){return k(a)/2}function m(a){try{return a.offset().left}catch(a){}return a[0].getBoundingClientRect().left}function n(a,b){return m(a)>m(b)?m(a)-m(b)-k(b):m(b)-m(a)-k(a)}function o(a,b){return a.attr("ng-bind-template",b)}function p(a,b,c,d,e){!angular.isUndefined(b)&&b||(b=0),!angular.isUndefined(c)&&c&&0!=c||(c=1/Math.pow(10,b)),!angular.isUndefined(d)&&d||(d=0),!angular.isUndefined(a)&&a||(a=0);var f=(a-d)%c,g=f>c/2?a+c-f:a-f;return!angular.isUndefined(e)&&e||(e=g),g=Math.min(Math.max(g,d),e),parseFloat(g.toFixed(b))}function q(a,b){return Math.floor(a/b+.5)*b}function r(a,b){return a>0&&!isNaN(b)?Math.ceil(b/a)*a:b}function s(a){return u+" "+a+" "+v}var t=3,u=c.startSymbol(),v=c.endSymbol();return{restrict:"EA",require:"ngModel",scope:{floor:"@",ceiling:"@",step:"@",stepWidth:"@",precision:"@",buffer:"@",stickiness:"@",showSteps:"@",ngModel:"=",ngModelRange:"=",ngDisabled:"=",ngChange:"&",translateFn:"&",translateRangeFn:"&",translateCombinedFn:"&",scaleFn:"&",inverseScaleFn:"&"},template:"<span class='bar full'></span><span class='bar steps'><span class='bubble step' ng-repeat='step in stepBubbles()'></span></span><span class='bar selection'></span><span class='bar unselected low'></span><span class='bar unselected high'></span><span class='pointer low'></span><span class='pointer high'></span><span class='bubble low'></span><span class='bubble high'></span><span class='bubble middle'></span><span class='bubble selection'></span><span class='bubble limit floor'></span><span class='bubble limit ceiling'></span><input type='range' class='input low' /><input type='range' class='input high' /><input type='range' class='input selection' />",compile:function(c,g){function u(a){a||(a=c);var b=[];return angular.forEach(a.children(),function(a){b.push(e(a))}),b}function v(a,b,c){return{fullBar:a[0],stepBubs:a[1],selBar:b?a[2]:null,unSelBarLow:b?a[3]:null,unSelBarHigh:b?a[4]:null,minPtr:b?a[5]:a[2],maxPtr:b?a[6]:null,lowBub:b?a[7]:a[3],highBub:b?a[8]:null,cmbBub:b?a[9]:null,selBub:b?a[10]:null,flrBub:b?a[11]:a[4],ceilBub:b?a[12]:a[5],minInput:c?b?a[13]:a[6]:null,maxInput:c&&b?a[14]:null,selInput:c&&b?a[15]:null}}var w=g.showSteps,x=g.stepWidth?"stepWidth":"step",y=null!=g.ngModelRange,z={},A="ngModel",B="ngModelRange",C="selectBar",D=["floor","ceiling","stickiness",A];if(z=function(){for(var a=u(),b=[],c=0,d=a.length;c<d;c++){var f=a[c];f=e(f),f.css({"white-space":"nowrap",position:"absolute",display:"block","z-index":1}),b.push(f)}return b}(),z=v(z,!0,!0),g.translateFn&&g.$set("translateFn",""+g.translateFn+"(value)"),g.translateRangeFn&&g.$set("translateRangeFnFn",""+g.translateRangeFn+"(low,high)"),g.translateCombinedFn&&g.$set("translateCombinedFnFn",""+g.translateCombinedFn+"(low,high)"),g.scaleFn&&g.$set("scaleFn",""+g.scaleFn+"(value)"),g.inverseScaleFn&&g.$set("inverseScaleFn",""+g.inverseScaleFn+"(value)"),z.fullBar.css({left:0,right:0}),AngularSlider.inputtypes.range){var E={position:"absolute",margin:0,padding:0,opacity:0,height:"100%"};z.minInput.attr("step",s("inputSteps()")),z.minInput.attr("min",s("floor")),z.minInput.css(E),z.minInput.css("left",0),y?(z.minInput.attr("max",s("ngModelRange - (buffer / 2)")),z.maxInput.attr("step",s("inputSteps()")),z.maxInput.attr("min",s("ngModel + (buffer / 2)")),z.maxInput.attr("max",s("ceiling")),z.maxInput.css(E),z.selInput.attr("step",s("inputSteps()")),z.selInput.attr("min",s("ngModel")),z.selInput.attr("max",s("ngModelRange")),z.selInput.css(E)):(z.minInput.attr("max",s("ceiling")),z.minInput.css({width:"100%"}),z.maxInput.remove(),z.selInput.remove())}else z.minInput.remove(),z.maxInput.remove(),z.selInput.remove();if(o(z.stepBubs.children().eq(0),s("translation(step)")),o(z.ceilBub,s("translation(ceiling)")),o(z.flrBub,s("translation(floor)")),o(z.selBub,s("rangeTranslation("+A+","+B+")")),o(z.lowBub,s("translation("+A+")")),o(z.highBub,s("translation("+B+")")),o(z.cmbBub,s("combinedTranslation("+A+","+B+")")),y)D.push(B),D.unshift("buffer");else for(var F=[z.selBar,z.unSelBarLow,z.unSelBarHigh,z.maxPtr,z.selBub,z.highBub,z.cmbBub],G=0,H=F.length;G<H;G++)c=F[G],c.remove();return D.unshift("precision",x),w||z.stepBubs.children().remove(),{post:function(c,g,o,s){function w(){if(angular.forEach(D,function(a){c[a]=parseFloat(c[a]),a==A||a==B?c[a]=p(c[a],c.precision,c[x],c.floor,c.ceiling):"buffer"==a?!c.buffer||isNaN(c.buffer)||c.buffer<0?c.buffer=0:c.buffer=r(c[x],c.buffer):"precision"==a?!c.precision||isNaN(c.precision)?c.precision=0:c.precision=parseInt(c.precision):a==x?!c[x]||isNaN(c[x])?c[x]=1/Math.pow(10,c.precision):c[x]=parseFloat(c[x].toFixed(c.precision)):"stickiness"==a&&(isNaN(c.stickiness)?c.stickiness=t:c.stickiness<1&&(c.stickiness=1)),c.decodedValues[a]=c.decodeRef(a)}),y){if(c[B]<c[A]){var a=c[B];c[B]=c[A],c[A]=a}var b=p(c[B]-c[A],c.precision,c[x]);if(c.buffer>0&&b<c.buffer){var d=c.encode((c.decodedValues[A]+c.decodedValues[B])/2);c[A]=p(d-c.buffer/2,c.precision,c[x],c.floor,c.ceiling),c[B]=c[A]+c.buffer,c[B]>c.ceiling&&(c[B]=c.ceiling,c[A]=c.ceiling-c.buffer)}}F=k(E.fullBar),G=l(E.minPtr),H=m(E.fullBar),I=H+F-k(E.minPtr),J=I-H,K=c.floor,L=c.decodedValues.floor,M=c.ceiling,N=c.decodedValues.ceiling,O=M-K,P=N-L,Q=q(P,c.decodedValues[x])}function z(){function a(a){return(a-H)/J*100}function o(b){return a(b)/100*P+L}function r(a){return c.encode(o(a))}function t(a){var b=a-L;return O==P?b=q(b,c.decodedValues[x])/Q:b/=P,100*b}function u(a){return t(c.decode(a))}function v(a){return f(a*J/100)}function z(a){return Math.min(Math.max(a,H),I)}function D(b){return j(b,v(a(z(m(b)))))}function N(a,b,d){var e=a>0?1:-1;return b=b?b:100,d?(Math.sin(Math.min(Math.abs(a/b),1)*Math.PI-Math.PI/2)+1)*e*b/6:e*Math.pow(Math.min(Math.abs(a/b*2),1),c.stickiness)*b/2}function U(){var b=t(c.decodedValues[A]),d=u(c[A]+c[x])-b,e=b-u(c[A]-c[x]),f=u(c[A]+c.buffer)-b,g=a(G+H),h=b+N(R,R>0?d:e);if(j(E.minPtr,v(h)),j(E.lowBub,v(a(m(E.minPtr)-l(E.lowBub)+G))),y){var i=t(c.decodedValues[B]),k=u(c[B]+c[x])-i,n=i-u(c[B]-c[x]),o=i-u(c[B]-c.buffer),p=i+N(S,S>0?k:n);if(h>i-o&&(h=b+N(R,f,!0),j(E.minPtr,v(h)),j(E.lowBub,v(a(m(E.minPtr)-l(E.lowBub)+G)))),p<b+f&&(p=i+N(S,o,!0)),j(E.maxPtr,v(p)),j(E.highBub,v(a(m(E.maxPtr)-l(E.highBub)+G))),j(E.selBar,v(h+g)),E.selBar.css({width:v(p-h)}),j(E.selBub,v((h+p)/2-a(l(E.selBub)+H)+g)),j(E.cmbBub,v((h+p)/2-a(l(E.cmbBub)+H)+g)),E.unSelBarLow.css({left:0,width:v(h+g)}),j(E.unSelBarHigh,v(p+g)),E.unSelBarHigh.css({right:0}),AngularSlider.inputtypes.range){var q=2*g,r=h+f/2,s=100-r;r+=q;var w=p-o/2,z=h+q,C=p-h-q;p<=h+q&&(z=h,C=p+q-h),E.minInput.css({width:v(w)}),E.maxInput.css({left:v(r),width:v(s)}),E.selInput.css({left:v(z),width:v(C)})}}}function V(){var a=E.lowBub;D(E.lowBub),y&&(D(E.highBub),D(E.selBub),n(E.lowBub,E.highBub)<10?(h(E.lowBub),h(E.highBub),i(E.cmbBub),D(E.cmbBub),a=E.cmbBub):(i(E.lowBub),i(E.highBub),h(E.cmbBub),a=E.highBub)),n(E.flrBub,E.lowBub)<5?h(E.flrBub):y&&n(E.flrBub,a)<5?h(E.flrBub):i(E.flrBub),n(E.lowBub,E.ceilBub)<5?h(E.ceilBub):y&&n(a,E.ceilBub)<5?h(E.ceilBub):i(E.ceilBub)}function W(){R=0,S=0,ba&&(U(),V(),ba.removeClass("active")),ba=null,ca=null,$=!1}function X(b){ba&&c.$apply(function(){var d=b.clientX||b.x;if($){var e=r(d)-_,f=r(d)+aa;e<K?(f+=K-e,e=K):f>M&&(e-=f-M,f=M);var h=u(e),i=u(f);R=h,S=i,c[A]=e=p(e,c.precision,c[x],c.floor,c.ceiling),c[B]=f=p(f,c.precision,c[x],c.floor,c.ceiling),R-=u(e),S-=u(f)}else{var j=z(d+H-m(g)-l(ba)),k=a(j),n=c.encode(L+P*k/100);if(R=k,y)if(c.buffer>0)ca===A?n>c[B]-c.buffer&&(n=c[B]-c.buffer):n<c[A]+c.buffer&&(n=c[A]+c.buffer);else if(ca===A){if(n>c[B]){c[A]=c[B],c.decodedValues[A]=c.decodeRef(A),ca=B;var o=E.minPtr;E.minPtr=E.maxPtr,E.maxPtr=o,E.maxPtr.removeClass("active").removeClass("high").addClass("low"),E.minPtr.addClass("active").removeClass("low").addClass("high")}}else if(n<c[A]){c[B]=c[A],c.decodedValues[B]=c.decodeRef(B),ca=A;var o=E.minPtr;E.minPtr=E.maxPtr,E.maxPtr=o,E.minPtr.removeClass("active").removeClass("low").addClass("high"),E.maxPtr.addClass("active").removeClass("high").addClass("low")}c[ca]=n=p(n,c.precision,c[x],c.floor,c.ceiling),c.decodedValues[ca]=c.decodeRef(ca),ca===A?(R-=u(n),S=0):(S=R-u(n),R=0)}c.ngChange&&c.ngChange(),s.$setViewValue(c[A]),U(),V()})}function Y(a,b,d){if(!c.ngDisabled||1!=c.ngDisabled){var e=a.clientX||a.x;if(ba=b,ca=d,ba.addClass("active"),ca==C){$=!0;var f=r(e);_=f-c[A],aa=c[B]-f}X(a)}}function Z(){function a(a,b,c){function f(a){Y(a,b,c)}function g(a){X(a),W()}a=e(a),d.bind(a,{start:f,move:X,end:g,cancel:W})}function c(a,b,c){a=e(a),c=angular.isUndefined(c)?a:e(c),d.bind(a,{start:function(a){Y(a,c,b)}})}function f(a){a=e(a),d.bind(a,{move:X,end:function(a){X(a),W()},cancel:W})}AngularSlider.inputtypes.range?(a(E.minInput,E.minPtr,A),y&&(a(E.maxInput,E.maxPtr,B),a(E.selInput,E.selBar,C))):(f(b),c(E.minPtr,A),c(E.lowBub,A),c(E.flrBub,A,E.minPtr),y?(c(E.maxPtr,B),c(E.highBub,B),c(E.ceilBub,B,E.maxPtr),c(E.selBar,C),c(E.selBub,C,E.selBar),c(E.unSelBarLow,A,E.minPtr),c(E.unSelBarHigh,B,E.maxPtr)):(c(E.ceilBub,A,E.minPtr),c(E.fullBar,A,E.minPtr)))}var $,_,aa,ba,ca;w(),j(E.flrBub,0),j(E.ceilBub,f(F-k(E.ceilBub))),U(),V(),T||(Z(),T=!0)}var E=v(u(g),y,AngularSlider.inputtypes.range);c.decodedValues={floor:0,ceiling:0,step:0,stepWidth:0,precision:0,buffer:0,stickiness:0,ngModel:0,ngModelRange:0},c.translation=function(a){return a=parseFloat(a).toFixed(c.precision),angular.isUndefined(o.translateFn)?""+a:c.translateFn({value:a})},c.rangeTranslation=function(a,b){return angular.isUndefined(o.translateRangeFn)?"Range: "+c.translation((b-a).toFixed(c.precision)):c.translateRangeFn({low:a,high:b})},c.combinedTranslation=function(a,b){return angular.isUndefined(o.translateCombinedFn)?c.translation(a)+" - "+c.translation(b):c.translateCombinedFn({low:a,high:b})},c.encode=function(a){return angular.isUndefined(o.scaleFn)||""==o.scaleFn?a:c.scaleFn({value:a})},c.decode=function(a){return angular.isUndefined(o.inverseScaleFn)||""==o.inverseScaleFn?a:c.inverseScaleFn({value:a})},(1!=Math.round(c.encode(c.decode(1)))||100!=Math.round(c.encode(c.decode(100))))&&void 0,c.decodeRef=function(a){return c.decode(c[a])},c.inputSteps=function(){return Math.pow(10,c.precision*-1)};for(var F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=0,O=0,P=0,Q=1,R=0,S=0,T=!1,U=0;U<D.length;U++)c.$watch(D[U],function(){z()});e(window).bind("resize",function(){z()}),c.$on("refreshSlider",function(){a(function(){z()})}),a(function(){z()})}}}}}]),c("angular-slider",["angular-touch","angular"],function(){}),c("api/services/api-booking",[],function(){"use strict";var a=function(a,b){return{checkAvailablePetc:function(c){return b.post(a.url("booking","checkAvailablePetc"),c)},checkTravelInsurance:function(c){return b.post(a.url("booking","checkTravelInsurance"),c)},dynamicAirRule:function(c){return b.post(a.url("booking","dynamicAirRule"),c)},lockInventoryCabin:function(c){return b.post(a.url("booking","lockInventoryCabin"),c)},releaseLockInventoryCabin:function(){return b.get(a.url("booking","releaseLockInventoryCabin"))},purchase:function(c){return b.post(a.url("booking","purchase"),c)},search:function(c){return b.post(a.url("booking","search"),c)},searchCodeShare:function(c){return b.post(a.url("booking","searchCodeShare"),c)},tierDetails:function(c){return b.post(a.url("booking","tierDetails"),c)},travelBankLogin:function(c){return b.post(a.url("booking","travelBankLogin"),c)},validateFfpNumber:function(c){return b.post(a.url("booking","validateFfpNumber"),c)},validatePromoCode:function(c){return b.post(a.url("booking","validatePromoCode"),c)},requestQuote:function(c){return b.post(a.url("booking","requestQuote"),c)}}};return a}),c("api/services/api-change",[],function(){"use strict";var a=function(a,b){return{findPNR:function(c){return b.post(a.url("change","pnr"),c)},requestQuote:function(c){return b.post(a.url("change","requestQuote"),c)},complete:function(c){return b.post(a.url("change","complete"),c)}}};return a}),c("api/services/api-check-in",[],function(){"use strict";var a=function(a,b){return{findPNR:function(c){return b.post(a.url("checkin","pnr"),c)},express:function(c){return b.post(a.url("checkin","express"),c)},extraOptions:function(c){return b.post(a.url("checkin","extraOptions"),c)},loungeOptions:function(c){return b.post(a.url("checkin","loungeOptions"),c)},seatMap:function(c){return b.post(a.url("checkin","seatmap"),c)},baggageFee:function(c){return b.post(a.url("checkin","baggageFee"),c)},complete:function(c){return b.post(a.url("checkin","complete"),c)}}};return a}),c("api/services/api-seat-map",[],function(){"use strict";var a=function(a,b){return{select:function(c){return b.post(a.url("seat","change"),c)},retrieve:function(c){return b.post(a.url("seatmap","retrieve"),c)}}};return a}),c("api/services/api-elevate",[],function(){"use strict";var a=function(a,b){return{checkElevateLogin:function(c){return b.post(a.url("elevate","login"),c)},logout:function(c){return b.post(a.url("elevate","logout"),c)},attachProfileToPNR:function(c){return b.post(a.url("elevate","attachProfileToPnr"),c)},retrieveAccountInfo:function(c){return b.post(a.url("elevate","retrieveAccountInfo"),c)},validateFfpNumber:function(c){return b.post(a.url("elevate","validateFfpNumber"),c)},validateElevateId:function(c){return b.post(a.url("elevate","validateElevateId"),c)},joinElevate:function(c){return b.post(a.url("elevate","joinElevate"),c)},profileModify:function(c){return b.post(a.url("elevate","profileModify"),c)},profileDelete:function(c){return b.post(a.url("elevate","profileDelete"),c)},deleteElevate:function(c){return b.delete(a.url("elevate","profileModify"),c)},tierDetails:function(c){return b.post(a.url("elevate","tierDetails"),c)},forgotElevatePassword:function(c){return b.post(a.url("elevate","forgotElevatePassword"),c)},forgotElevatePasswordConfirm:function(c){return b.post(a.url("elevate","forgotElevatePasswordConfirm"),c)},resetElevatePasswordByIDPhone:function(c){return b.post(a.url("elevate","resetElevatePasswordByIDPhone"),c)},resetElevatePasswordByAuthToken:function(c){return b.post(a.url("elevate","resetElevatePasswordByAuthToken"),c)},travelBankBalance:function(c){return b.post(a.url("elevate","travelBankBalance"),c)},transferPoints:function(c){return b.post(a.url("buyGifts","transferPoints"),c)},addInstantCredit:function(c){return b.post(a.url("ads","addInstantCredit"),c)},requestElevatePoints:function(c){return b.post(a.url("elevate","requestElevatePoints"),c)},expressJoin:function(c){return b.post(a.url("elevate","expressJoin"),c)},MCSOptInEligibility:function(c){return b.post(a.url("elevate","MCSOptInEligibility"),c)}}};return a}),c("api/services/api-persistence",[],function(){"use strict";var a=function(a,b){return{create:function(){return b.post(a.url("cart","create"),{contentType:"application/json"})},retrieve:function(){return b.get(a.url("cart","retrieve"),{headers:{noPayload:!0}})},update:function(c){return b.put(a.url("cart","update"),c)}}};return a}),c("api/services/api-manage",[],function(){"use strict";var a=function(a,b){return{findPNR:function(c){return b.post(a.url("manage","pnr"),c)},addKtNumber:function(c){return b.post(a.url("manage","addKtNumber"),c)},emailItinerary:function(c){return b.post(a.url("manage","emailChangedItinerary"),c)},getCalendarUrl:function(){return a.url("calendar","ical")},complete:function(c){return b.post(a.url("manage","complete"),c)},updatePassport:function(c){return b.post(a.url("manage","updatePassport"),c)},applyMCSOptIn:function(c){return b.post(a.url("manage","applyOptIn"),c)}}};return a}),c("api/services/api-cancel",[],function(){"use strict";var a=function(a,b){return{complete:function(c){return b.post(a.url("cancel","complete"),c)},requestQuote:function(c){return b.post(a.url("cancel","requestQuote"),c)}}};return a}),c("api/services/api-flightstatus",[],function(){"use strict";var a=function(a,b){return{flightStatus:function(c){return b.post(a.url("flightStatus","flightStatus"),c)},tailNumberInfo:function(c){return b.post(a.url("flightStatus","tailNumberInfo"),c)}}};return a}),c("api/services/api-flightalert",[],function(){"use strict";var a=function(a,b){return{retrieveFlightList:function(c){return b.post(a.url("flightAlerts","retrieveFlightList"),c)},subscribe:function(c){return b.post(a.url("flightAlerts","subscribe"),c)},unsubscribe:function(c){return b.post(a.url("flightAlerts","unsubscribe"),c)}}};return a}),c("api/services/api-config",[],function(){"use strict";var a=function(a,b){return{getStates:function(c){return b.post(a.url("config","state"),c)}}};return a}),c("api/services/api-ancillaries",[],function(){"use strict";var a=function(a,b){return{retrieve:function(c){return b.post(a.url("ancillaries","retrieve"),c)}}};return a}),c("api/services/api-environment",[],function(){"use strict";var a=function(a,b){return{getInfo:function(c){return b.get(a.url("environment","info"),c)}}};return a}),c("api/services/api",["api/constants/api","api/services/api-booking","api/services/api-change","api/services/api-check-in","api/services/api-seat-map","api/services/api-elevate","api/services/api-persistence","api/services/api-manage","api/services/api-cancel","api/services/api-flightstatus","api/services/api-flightalert","api/services/api-config","api/services/api-ancillaries","api/services/api-environment"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";var o=function(o,p){var q,r={CONSTANTS:a,envService:p,url:function(a,b){var c,d=this.envService.context("api").resourceURL,e=this.envService.context("api").extension||"";return this.CONSTANTS.VERSIONS.some(function(f){var g=this.CONSTANTS.RESOURCES[f],h=g&&g[a],i=h&&h.entryPoints&&h.entryPoints[b];if(i)return c=d+"/"+f+h.base+i+e,!0}.bind(this)),c},getValidationToken:function(){return input.parse_i("")},isSuccess:function(a){return"SUCCESS"===a.status},isError:function(a){return"SUCCESS"!==a.status},errorObj:function(a){return a.status.error}};q={booking:b,checkin:d,seatMap:e,change:c,elevate:f,persistence:g,manage:h,cancel:i,flightStatus:j,flightAlerts:k,config:l,ancillaries:m,environment:n};for(var s in q){var t=q[s];r[s]=t(r,o)}return r};return o.$inject=["$http","envService"],o}),c("api/vx-api-app",["angular","api/services/api"],function(a,b){"use strict";return a.module("vxApiApp",[]).factory("api",b)}),c("cms/constants/cms",[],function(){"use strict";var a={RESOURCES:{config:"/config.json",info:"/info.json",flightInfo:"/flight-info.json"}};return a}),c("cms/services/cms-config",[],function(){"use strict";var a=function(a,b,c){return{get:function(d){var e=c.context("cms").resourceURL;return a.get(e+"/config.json",{cache:b}).then(function(a){var b=a.headers("Geo_Info")||"City=SANFRANCISCO;State=CA;MSA=7362";a.data.geoData={},angular.forEach(b.split(";"),function(b){var c=b.split("=");a.data.geoData[c[0]]=c[1]}),d(a.data)})}}};return a}),c("cms/services/cms-flight-info",[],function(){"use strict";var a=function(a,b,c){return{get:function(d){var e=c.context("cms").resourceURL;return a.get(e+"/flight_info.json",{cache:b}).then(function(a){d(a.data)})}}};return a}),c("cms/services/cms-info",[],function(){"use strict";var a=function(a,b,c){return{get:function(d){var e=c.context("cms").resourceURL,f=a.get(e+"/info.json",{cache:b});return f.then(function(a){"function"==typeof d&&d(a.data)}),f}}};return a}),c("cms/services/cms-traveler-advisory",[],function(){"use strict";var a=function(a,b){return{get:function(c){return a.get("/cms/traveler_advisory.json",{cache:b}).then(function(a){c(a.data)})}}};return a}),c("cms/services/cms",["cms/services/cms-config","cms/services/cms-flight-info","cms/services/cms-info","cms/services/cms-traveler-advisory"],function(a,b,c,d){"use strict";var e=function(e,f,g,h,i){this.$q=e;var j;this._services={};var k=h("cmsCache");j={config:a,flightInfo:b,info:c,travelerAdvisory:d};for(var l in j){var m=j[l];this._services[l]=m(g,k,i)}return this._services.getAirportNames=this.getAirportNames.bind(this),this._services};return e.prototype.getAirportNames=function(a){var b,c,d,e,f=this.$q.defer(),g={};return"string"==typeof a&&(a=[a],b=!0),this._services.config.get(function(h){for(var i in a)d=a[i],e=h.airports[d],e&&(b?c=e.name:g[d]=e.name);f.resolve(b?c:g)}),f.promise},e.$inject=["$q","CMS","$http","$cacheFactory","envService"],e}),c("cms/vx-cms-app",["angular","cms/constants/cms","cms/services/cms"],function(a,b,c){"use strict";return a.module("vxCmsApp",[]).constant("CMS",b).service("cms",c)}),function(a,b){var c=b.isDefined,d=b.isUndefined,e=b.isNumber,f=b.isObject,g=b.isArray,h=b.extend,i=b.toJson;b.module("LocalStorageModule",[]).provider("localStorageService",function(){this.prefix="ls",this.storageType="localStorage",this.cookie={expiry:30,path:"/"},this.notify={setItem:!0,removeItem:!1},this.setPrefix=function(a){return this.prefix=a,this},this.setStorageType=function(a){return this.storageType=a,this},this.setStorageCookie=function(a,b){return this.cookie.expiry=a,this.cookie.path=b,this},this.setStorageCookieDomain=function(a){return this.cookie.domain=a,this},this.setNotify=function(a,b){return this.notify={setItem:a,removeItem:b},this},this.$get=["$rootScope","$window","$document","$parse",function(a,b,j,k){var l,m=this,n=m.prefix,o=m.cookie,p=m.notify,q=m.storageType;j?j[0]&&(j=j[0]):j=document,"."!==n.substr(-1)&&(n=n?n+".":"");var r=function(a){return n+a},s=function(){try{var c=q in b&&null!==b[q],d=r("__"+Math.round(1e7*Math.random()));return c&&(l=b[q],l.setItem(d,""),l.removeItem(d)),c}catch(b){return q="cookie",a.$broadcast("LocalStorageModule.notification.error",b.message),!1}}(),t=function(b,c){if(c=d(c)?null:i(c),!s||"cookie"===m.storageType)return s||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),p.setItem&&a.$broadcast("LocalStorageModule.notification.setitem",{key:b,newvalue:c,storageType:"cookie"}),z(b,c);try{l&&l.setItem(r(b),c),p.setItem&&a.$broadcast("LocalStorageModule.notification.setitem",{key:b,newvalue:c,storageType:m.storageType})}catch(d){return a.$broadcast("LocalStorageModule.notification.error",d.message),z(b,c)}return!0},u=function(b){if(!s||"cookie"===m.storageType)return s||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),A(b);var c=l?l.getItem(r(b)):null;if(!c||"null"===c)return null;try{return JSON.parse(c)}catch(a){return c}},v=function(){var b,c;for(b=0;b<arguments.length;b++)if(c=arguments[b],s&&"cookie"!==m.storageType)try{l.removeItem(r(c)),p.removeItem&&a.$broadcast("LocalStorageModule.notification.removeitem",{key:c,storageType:m.storageType})}catch(b){a.$broadcast("LocalStorageModule.notification.error",b.message),B(c)}else s||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),p.removeItem&&a.$broadcast("LocalStorageModule.notification.removeitem",{key:c,storageType:"cookie"}),B(c)},w=function(){if(!s)return a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),[];var b=n.length,c=[];for(var d in l)if(d.substr(0,b)===n)try{c.push(d.substr(b))}catch(b){return a.$broadcast("LocalStorageModule.notification.error",b.Description),[]}return c},x=function(b){var c=n?new RegExp("^"+n):new RegExp,d=b?new RegExp(b):new RegExp;if(!s||"cookie"===m.storageType)return s||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),C();var e=n.length;for(var f in l)if(c.test(f)&&d.test(f.substr(e)))try{v(f.substr(e))}catch(b){return a.$broadcast("LocalStorageModule.notification.error",b.message),C()}return!0},y=function(){try{return b.navigator.cookieEnabled||"cookie"in j&&(j.cookie.length>0||(j.cookie="test").indexOf.call(j.cookie,"test")>-1)}catch(b){return a.$broadcast("LocalStorageModule.notification.error",b.message),!1}}(),z=function(b,c,h){if(d(c))return!1;if((g(c)||f(c))&&(c=i(c)),!y)return a.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var k="",l=new Date,m="";if(null===c?(l.setTime(l.getTime()+-864e5),k="; expires="+l.toGMTString(),c=""):e(h)&&0!==h?(l.setTime(l.getTime()+24*h*60*60*1e3),k="; expires="+l.toGMTString()):0!==o.expiry&&(l.setTime(l.getTime()+24*o.expiry*60*60*1e3),k="; expires="+l.toGMTString()),b){var n="; path="+o.path;o.domain&&(m="; domain="+o.domain),j.cookie=r(b)+"="+encodeURIComponent(c)+k+n+m}}catch(b){return a.$broadcast("LocalStorageModule.notification.error",b.message),!1}return!0},A=function(b){if(!y)return a.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var c=j.cookie&&j.cookie.split(";")||[],d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(r(b)+"=")){var f=decodeURIComponent(e.substring(n.length+b.length+1,e.length));try{return JSON.parse(f)}catch(a){return f}}}return null},B=function(a){z(a,null)},C=function(){for(var a=null,b=n.length,c=j.cookie.split(";"),d=0;d<c.length;d++){for(a=c[d];" "===a.charAt(0);)a=a.substring(1,a.length);var e=a.substring(b,a.indexOf("="));B(e)}},D=function(){return q},E=function(a,b,d,e){e=e||b;var g=u(e);return null===g&&c(d)?g=d:f(g)&&f(d)&&(g=h(g,d)),k(b).assign(a,g),a.$watch(b,function(a){t(e,a)},f(a[b]))},F=function(){for(var a=0,c=b[q],d=0;d<c.length;d++)0===c.key(d).indexOf(n)&&a++;return a};return{isSupported:s,getStorageType:D,set:t,add:t,get:u,keys:w,remove:v,clearAll:x,bind:E,deriveKey:r,length:F,cookie:{isSupported:y,set:z,add:z,get:A,remove:B,clearAll:C}}}]})}(window,window.angular),c("angular-local-storage",["angular"],function(){}),c("common/power-models/base-model",[],function(){"use strict";var a=function(){};return a}),c("common/power-models/search-model",["angular","common/power-models/base-model"],function(a,b){"use strict";var c=function(){};return c.mapping=["SearchModel"],c.prototype=new b,c.deserializedFromXXX=function(a){var b=new c;return b},c}),c("common/power-models/fare-model",["angular","common/power-models/base-model"],function(a,b){"use strict";var c=function(){};return c.mapping=[["SearchModel","departingFlightsInfo","bestFareList","\\d{4}-\\d{2}-\\d{2}","fare"].join("::"),["SearchModel","departingFlightsInfo","flightList","(NON_STOP|THRU|CONNECTING)","fareList","("+["FIRST","FIRST_CABIN_REFUNDABLE","INSTANT_UPG_TO_MCS","MAIN_CABIN","MAIN_CABIN_REFUNDABLE","MCS"].join("|")+")"].join("::")],c.prototype=new b,c}),c("common/power-models/visa-checkout-model",["angular","common/power-models/base-model","common/models/address-model"],function(a,b,c){"use strict";var d=function(){};return d.mapping=["VisaCheckoutCustomerInfoModel"],d.prototype=new b,d.prototype.getAddressInfo=function(){var a=new c;return a.deserialize(this.addressInfo,"elevate"),a},d.prototype.getPaymentInfo=function(){return this.paymentInfo&&this.paymentInfo.creditCardInfo},d}),c("common/constants/model-list",["common/power-models/search-model","common/power-models/fare-model","common/power-models/visa-checkout-model"],function(a,b,c){"use strict";var d=[a,b,c];return d}),c("common/providers/modal",["angular"],function(a){"use strict";var b={options:{backdrop:!0,keyboard:!0},$get:["$rootScope","$q","$http","$templateCache","$injector","$modalStack","$controller","$interpolate",function(c,d,e,f,g,h,i,j){function k(a){return a.template?d.when(a.template):e.get(a.templateUrl,{cache:f}).then(function(a){return a.data})}function l(b){var c=[];return a.forEach(b,function(b){(a.isfunction(b)||a.isArray(b))&&c.push(d.when(g.invoke(b)))}),c}var m={};return m.interpolate=function(a,b){return j(a)(b)},m.open=function(e){var f=d.defer(),g=d.defer(),j={result:f.promise,opened:g.promise,close:function(a){h.close(j,a)},dismiss:function(a){h.dismiss(j,a)}};if(e=a.extend({origin:document.activeElement},b.options,e),e.resolve=e.resolve||{},!e.template&&!e.templateUrl)throw new Error("One of template or templateUrl options is required.");var m=d.all([k(e)].concat(l(e.resolve)));return m.then(function(b){var d=(e.scope||c).$new();d.$close=j.close,d.$dismiss=j.dismiss;var g,k={},l=1;e.controller&&(k.$scope=d,k.$modalInstance=j,a.forEach(e.resolve,function(a,c){k[c]=b[l++]}),g=i(e.controller,k)),h.open(j,{scope:d,deferred:f,content:b[0],contentType:e.contentType,backdrop:e.backdrop,keyboard:e.keyboard,windowClass:e.windowClass,windowSize:e.size,title:e.title,showHeader:e.showHeader,showFooter:e.showFooter,footerLinkText:e.footerLinkText,footerDisclaimer:e.footerDisclaimer,footerDisclaimerText:e.footerDisclaimerText,additionalClass:e.additionalClass||"",origin:e.origin})},function(a){f.reject(a)}),m.then(function(){g.resolve(!0)},function(){g.reject(!1)}),j},m}]};return b}),c("common/providers/maxymiser",[],function(){"use strict";var a={$get:[function(){return this._cookiePrefix="vx_test_",this.campaign={},this.isRunning=function(a){var b=this._cookiePrefix+a,c=document.cookie.match(new RegExp(b+"=([^;]+)")),d=c&&decodeURIComponent(c[1]),e=JSON.parse(d);return!!e},{campaign:this.campaign,isRunning:this.isRunning.bind(this)}}]};return a}),c("common/providers/single-timeout",[],function(){"use strict";function a(){this.$get=["$timeout",function(a){var b=function(b,c){var d=a(b,c);d.then(function(){a.cancel(d)})};return b}]}return a}),c("common/providers/device-provider",["modernizr"],function(a){"use strict";var b={$get:["windowService",function(b){var c={};return c._windowService=b,c.getDeviceType=function(){var b=a.touch,c=this._windowService.breakpoint(),d="small"===c&&b?"MOBILE":"WEB";return d},c.isMobile=function(){return"MOBILE"===this.getDeviceType()},c}]};return b}),c("common/services/modal-stack",["angular"],function(a){"use strict";var b=function(b,c,d,e,f,g){function h(){for(var a=-1,b=n.keys(),c=0;c<b.length;c++)n.get(b[c]).value.backdrop&&(a=c);return a}function i(a){var c=b.find("body").eq(0),d=n.get(a).value;n.remove(a),d.modalDomEl.remove(),c.toggleClass(l,n.length()>0),k&&h()===-1&&(k.remove(),k=void 0,g.setModalMode(!1)),d.modalScope.$destroy()}var j,k,l="modal-open",m=d.$new(!0),n=f.createNew(),o={};return d.$watch(h,function(a){m.index=a+300}),b.bind("keydown",function(a){var b;27===a.which&&(b=n.top(),b&&b.value.keyboard&&d.$apply(function(){o.dismiss(b.key)}))}),o.open=function(d,e){n.add(d,{deferred:e.deferred,modalScope:e.scope,
backdrop:e.backdrop,keyboard:e.keyboard,origin:e.origin});var f=b.find("body").eq(0);h()>=0&&!k&&(j=a.element("<div vx-common-modal-backdrop></div>"),j.attr({"additional-class":e.additionalClass}),k=c(j)(m),f.append(k));var g=a.element("<div vx-common-modal-window></div>");g.attr({"modal-title":e.title,"window-class":e.windowClass,"content-type":e.contentType||"generic","window-width":e.windowSize||"medium",index:n.length()-1,"show-header":e.showHeader,"show-footer":e.showFooter,"footer-disclaimer":e.footerDisclaimer,"footer-disclaimer-text":e.footerDisclaimerText,"footer-link-text":e.footerLinkText}),g.html(e.content);var i=c(g)(e.scope);n.top().value.modalDomEl=i,f.append(i),f.addClass(l)},o.close=function(a,b){var c=n.get(a).value;c&&(c.deferred.resolve(b),i(a),e(function(){$(c.origin).focus()}))},o.dismiss=function(a,b){var c=n.get(a).value;c&&(c.deferred.reject(b),i(a),e(function(){$(c.origin).focus()}))},o.footerLinkFn=function(a){var b=n.get(a).value;b.modalScope.footerLinkFn()},o.getTop=function(){return n.top()},o};return b.$inject=["$document","$compile","$rootScope","$singleTimeout","$$stackedMap","windowService"],b}),c("common/services/modal-stacked-map",[],function(){"use strict";var a=function(){return{createNew:function(){var a=[];return{add:function(b,c){a.push({key:b,value:c})},get:function(b){for(var c=0;c<a.length;c++)if(b===a[c].key)return a[c]},keys:function(){for(var b=[],c=0;c<a.length;c++)b.push(a[c].key);return b},top:function(){return a[a.length-1]},remove:function(b){for(var c=-1,d=0;d<a.length;d++)if(b===a[d].key){c=d;break}return a.splice(c,1)[0]},removeTop:function(){return a.splice(a.length-1,1)[0]},length:function(){return a.length}}}}};return a}),c("common/directives/modal-backdrop",[],function(){"use strict";var a=function(a){return{restrict:"A",replace:!0,templateUrl:"/app/common/directives/modal-backdrop.tpl.html",scope:{additionalClass:"@"},link:function(b,c){a(function(){c.addClass(b.additionalClass+" is-visible")})}}};return a.$inject=["$timeout"],a}),c("common/directives/modal-window",[],function(){"use strict";var a=function(){return{restrict:"A",replace:!0,templateUrl:"/app/common/directives/modal-window.tpl.html",transclude:!0,scope:{index:"@"},link:c,controller:b}},b=function(a,b,c,d,e){this._$singleTimeout=a,this._$modalStack=b,this._$parse=c,this._windowService=d,this._accessibleService=e,this._keydownEvent="keydown.trapModalFocus"};b.$inject=["$singleTimeout","$modalStack","$parse","windowService","accessibleService"];var c=function(a,b,c,d){function e(a){r=a,r?b.addClass("is-scrollable"):b.removeClass("is-scrollable")}function f(){var a,c,d;s&&!w?(a=Math.round(t/2-u/2),c=i/2,d=t-2*i):(c=u,a=t,d=t),a>c?(r===!0||"undefined"==typeof r)&&e(!1):(!r||"undefined"==typeof r)&&e(!0),w?m.css({overflow:"auto",height:d}):r&&!y?m.css({"overflow-x":"hidden",height:d-20-b.find(".modal__footer").height()}):m.css({"overflow-x":"hidden",height:"auto"})}function g(){var a=Math.round(t/2-u/2);a>i/2?b.css("padding-top",a):b.css("padding-top",i/2)}function h(a,c,e){m.css({"overflow-x":"hidden",height:"auto"}),t=c.height,u=j.outerHeight(),v=k.outerHeight();var h=d._windowService.mq("(min-width:1026px)");b.toggleClass("animate",!!e),h&&!w?s!==!1&&"boolean"==typeof s||(s=!0,b.addClass(x),l.prependTo(k)):s!==!0&&"boolean"==typeof s||(s=!1,b.removeClass(x).css("padding-top",0),l.prependTo(m)),s&&g(),f()}var i=80,j=b.find(".modal__dialog"),k=b.find(".modal__header"),l=b.find(".modal__title"),m=b.find(".modal__content"),n=b.find(".modal__close"),o=b.find("[data-quick-links]"),p=m.find("a, button, input, select").eq(0),q=m||p;o.on("click","a",function(a){a.preventDefault();var c,e=$(this).attr("href").replace(/#/,""),f=b.find('[data-section="'+e+'"]'),g="small"===d._windowService.breakpoint()?-60:0;f.length&&(c=f.position().top+g,m.animate({scrollTop:c-20},500,"easeOutCirc"))}),m.addClass("is-"+c.contentType);var r,s,t,u,v,w="full"===c.windowWidth,x=w?"":"is-popup",y="tight"===c.contentType,z=d._$parse(c.showHeader)(a);a.title=c.modalTitle||"",a.showHeader=z!==!1,a.windowClass=c.windowClass||"",a.visible="",a.footerLinkText=c.footerLinkText,a.showFooter=c.showFooter,a.footerDisclaimerText=c.footerDisclaimerText,a.footerDisclaimer=c.footerDisclaimer,b.addClass("is-"+c.windowWidth),d._$singleTimeout(function(){b.addClass("is-visible"),q.length?q.focus():n.focus()},300),a.$parent.windowElem=b,a.$parent.modal={resize:function(a){d._$singleTimeout(function(){h(null,d._windowService.dimensions(),a)})}},d._$singleTimeout(function(){h(null,d._windowService.dimensions())}),d._windowService.setModalMode(!0,"modal__content"),d._windowService.subscribe("_windowService.resize",h),a.$on("$destroy",function(){d._windowService.unsubscribe("_windowService.resize",h),j.off(d._keydownEvent)}),j.on(d._keydownEvent,d._accessibleService.trapFocus.bind(this,q,n)),a.close=function(a){var b=d._$modalStack.getTop();b&&b.value.backdrop&&"static"!==b.value.backdrop&&a.target===a.currentTarget&&(a.preventDefault(),a.stopPropagation(),d._$modalStack.dismiss(b.key,"backdrop click"))},a.footerLinkFn=function(a){var b=d._$modalStack.getTop();b&&(a.preventDefault(),a.stopPropagation(),d._$modalStack.footerLinkFn(b.key),d._$modalStack.dismiss(b.key,"footer link"))}};return a}),c("common/directives/prevent-default",[],function(){"use strict";var a=function(){return{restrict:"A",link:b}},b=function(a,b,c){var d=window.document.addEventListener?function(a,b,c){a.addEventListener(b,c,!1)}:function(a,b,c){a.attachEvent("on"+b,c)};if(c.ngClick||""===c.href||"#"===c.href){var e=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};d(b[0],"click",e)}};return a}),c("common/directives/collapsible-section",["modernizr"],function(a){"use strict";var b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},c=b[a.prefixed("transition")],d=function(){return{controller:e,restrict:"A",scope:!0,link:f}},e=function(a){this._scrollService=a,this.isAnimating=!1};e.$inject=["scrollService"];var f=function(a,b,d,e){var f=b.parent(),g=b.parents(".collapse-container");a.collapsible={};var h=function(){var a=g.hasClass("is-expanding-fade-out");a?("function"==typeof this.callback&&(this.callback(this.callbackData),this.scrollToContainer&&this._scrollService.go(g)),f.removeClass("collapsed-section"),g.add(b).removeClass("collapsed-section is-expanding-fade-out"),g.addClass("is-expanding-fade-in")):(g.removeClass("is-expanding-fade-out is-expanding-fade-in"),this.callback=null,this.callbackData=null,this.isAnimating=!1)};g.on(c,h.bind(e)),a.collapsible.expand=function(a,b,d){e.callback=a,e.callbackData=b,e.scrollToContainer=d,e.isAnimating=!0,g.addClass("is-expanding-fade-out"),"undefined"==typeof c&&setTimeout(h.bind(e),500)}.bind(e),a.$watch(d.collapsed,function(a,c){a&&!c&&g.add(b).addClass("collapsed-section"),!a&&c&&!e.isAnimating&&g.add(b).removeClass("collapsed-section")})};return d}),c("common/directives/header",["angular","jquery"],function(a,b){"use strict";var c=function(){return{restrict:"A",scope:!0,transclude:!0,controller:d,link:e}};c.$inject=["$rootScope"];var d=function(b,c,d,e,f,g,h,i,j,k,l,m,n){this._$scope=b,this._$location=c,this._locationService=d,this._windowService=e,this._workflowService=f,this._tripService=g,this._utilsService=i,this._elevateService=h,this._scrollService=j,this._headerService=k,this._resourceBundle=l,this._$singleTimeout=m,this._pubSubService=n,this._resetFlowButton="#bookResetFlow",this._$scope.header={dropdown:{navActive:!1},elevateLoggedIn:!1,mustShowElevateTicker:!1,elevateUser:null,memberAvatar:"",toggleDropdown:this.toggleDropdown.bind(this),resetFlow:this.resetFlow.bind(this),openJoinAlaskaMileagePlan:this.openJoinAlaskaMileagePlan.bind(this),visible:!0},b.$watch(this._windowService.breakpoint,this.onBreakpointChange.bind(this)),b.$watch(this._windowService.elevateLogin,this.onElevateLoginChange.bind(this)),b.$watch(this._windowService.headerVisible,function(a){b.header.visible=a}),b.$watch(this._elevateService.isRecognizedOrLoggedIn,function(c){a.extend(b.header,{mustShowElevateTicker:c,elevateUser:this._elevateService.getUserData(),memberAvatar:this._elevateService.getUserData().avatar})}.bind(this)),b.$watch(this._elevateService.getOverridenAvatar,function(c){a.extend(b.header,{memberAvatar:c})}.bind(this)),b.$watch(this._elevateService.isLoggedIn,function(c){a.extend(b.header,{elevateLoggedIn:c})}.bind(this)),k._header.deferred.promise.then(!1,!1,function(){this.toggleDropdown(this._headerService._header.navActive)}.bind(this))};d.$inject=["$scope","$location","locationService","windowService","workflowService","tripService","elevateService","utilsService","scrollService","headerService","ResourceBundle","$singleTimeout","pubSubService"],d.prototype.onBreakpointChange=function(a,b){this._$scope.header.breakpoint=a,this._$scope.header.dropdown.navActive&&"large"===a&&"large"!==b&&this.toggleDropdown()},d.prototype.onElevateLoginChange=function(a){this._$scope.header.elevateLogin=a},d.prototype.resetFlow=function(){var a=this._$location.path().split("/");if(a.indexOf("book")!==-1){var c=this._$location.url().indexOf("purchase")!==-1;if(c)return;this._$singleTimeout(function(){b(this._resetFlowButton).trigger("click"),this._scrollService.go("top")}.bind(this)),this._tripService.setBookingFlow(!1)}else this._$location.path("book"),this._workflowService.transition(this._workflowService.getCurrentState(),"BOOK_INTRO_STATE");this._tripService.setBookingFlow(!1)},d.prototype.toggleDropdown=function(a){"undefined"==typeof a&&(a=!this._$scope.header.dropdown.navActive),this._$scope.header.dropdown.navActive=a,this._headerService._header.navActive=a,this._windowService.setModalMode(a)},d.prototype.openJoinAlaskaMileagePlan=function(){this._pubSubService.publish("core.openModal",["openJoinAlaskaMileagePlan",{linkCid:"VX_nav:mpjoin"}])};var e=function(a,c,d,e,f){f(a,function(a){c.append(a)});var g=b(c).find(".js-dropdown"),h=function(){g.css("height",e._windowService.getDeviceWindowHeight()-54+"px")};h(),e._windowService.subscribe("windowService.resize",h);var i=window.innerHeight;e._windowService.subscribe("scroll",function(){var a=window.innerHeight;a!==i&&h()})};return c}),c("common/directives/mobile-nav",[],function(){"use strict";var a=function(){return{restrict:"A",scope:!0,controller:b,templateUrl:"/app/common/directives/mobile-nav.tpl.html",replace:!0}},b=function(a,b){this._$scope=a,this._windowService=b,this._$scope.mobileNav={breakpoint:""},a.$watch(this._windowService.breakpoint,this.onBreakpointChange.bind(this))};return b.$inject=["$scope","windowService"],b.prototype.onBreakpointChange=function(a){this._$scope.mobileNav.breakpoint=a},a}),c("common/directives/yts",["angular","jquery","modernizr","content/constants/content-bundle"],function(a,b,c,d){"use strict";var e=function(){return{restrict:"A",scope:!0,replace:!0,controller:f,link:g,templateUrl:"/app/common/directives/yts.tpl.html"}},f=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){this._$scope=c,this._$rootScope=d,this._scrollService=e,this._purchaseService=f,this._tripService=g,this._fareService=h,this._changeService=i,this._seatService=j,this._travelerService=k,this._ancillariesService=l,this._windowService=m,this._resourceBundle=b,this._workflowService=n,this._locationService=o,this._loadingService=p,this._utilsService=q,this._pubSubService=r,this._statusService=s,this._accessibleService=t,this._$document=u,this._$compile=v,this._$singleTimeout=w,this._$modal=x,this._$location=y,this._$window=z,this._numberFilter=a("number"),this._tierLabels={0:"Main Cabin",1:"Main Cabin",2:"Main Cabin Select",3:"Main Cabin Select",4:"First Class",5:"First Class"},this._refundableMap={0:!1,1:!0,2:!1,3:!0,4:!1,5:!0},this._flightLabelsOptions={STANDARD:{departureLabel:"Departure",departingLabel:"Departing",returnLabel:"Return"},MULTI_CITY:{departureLabel:"First Segment",departingLabel:"First Segment",returnLabel:"Second Segment"}},this._currentState="BOOK_INTRO_STATE",this._resetFlowButton="#bookResetFlow",this._keydownEvent="keydown.trapYtsFocus",this._watchReferences={tripType:null,cityPairs:null,dates:null,travelerList:null,travelers:null,flights:null,currency:null,seats:null,taxes:null},this._alaskaBannerType=!1,c.yts={activeCurrency:"DOLLAR",alt:!1,collapsedHover:!1,collapseYts:this.collapseYts.bind(this),context:"book",currentState:"",expanded:!1,expandYts:this.expandYts.bind(this),focusYts:this.focusYts.bind(this),isVisible:!1,payNow:!1,legNumber:this.legNumber.bind(this),resetFlow:this.resetFlow.bind(this),hardReset:this.hardReset.bind(this),navStyle:this.navStyle.bind(this),purchase:f,change:this.onChange.bind(this),goToPayment:this.goToPayment.bind(this),total:0,totalIsPositive:!0,showFareRules:this.showFareRules.bind(this),showTaxesAndFeesModal:this.showTaxesAndFeesModal.bind(this),isHeaderVisible:!0,isBackButtonVisible:!0,newFee:0,changeFee:0,quoteExchangeType:"NoPayment",back:this.back.bind(this),getTotalLabel:this.getTotalLabel.bind(this),isBooking:this.isBooking.bind(this),isNewChange:this.isNewChange.bind(this),isChangeExtra:this.isChangeExtra.bind(this),flightLabels:this._flightLabelsOptions.STANDARD,alaskaBannerType:this._alaskaBannerType};var A=this;r.subscribe("windowService.setYtsVisible",function(a){this.setVisibility(a)}.bind(this)),r.subscribe("yts.collapseYts",function(a){a?this._$scope.yts.collapseYts():this._$scope.yts.expandYts()}.bind(this)),r.subscribe("yts.detectState",function(a){a||this._hasCollapsedSections()||!this._locationService.contextIs(this._locationService.contexts.CHANGE)?this._$scope.yts.isBackButtonVisible=!0:this._$scope.yts.isBackButtonVisible=!1}.bind(this)),r.subscribe("yts.setState",function(a){"change"===this._locationService.getContext()&&(this._$scope.yts.currentState=a,this.setBaseAndTotal(),"ANCILLARIES_SELECTOR_STATE"===a&&this._pubSubService.publish("hardCollapseSecondFareSelector",[]))}.bind(this)),r.subscribe("setBaseAndTotal",this.setBaseAndTotal.bind(this)),c.$watch(g.getTripType,function(a,b){a!==b&&(a===g.MULTI_CITY?c.yts.flightLabels=this._flightLabelsOptions.MULTI_CITY:c.yts.flightLabels=this._flightLabelsOptions.STANDARD,c.yts.tripType=a)}.bind(this)).bind(this),c.$watch(n.getCurrentState,function(a,b){"DATE_PICKER_STATE"===a?c.yts.alaskaBannerType="ALASKA_ONLY":"FARE_SELECTOR_STATE"===a?c.yts.alaskaBannerType="FAIR":c.yts.alaskaBannerType=!1,a!==b&&(A._currentState=a)}),c.$watch(m.ytsExpanded,function(a,b){a!==b&&(a?c.yts.expandYts():c.yts.collapseYts())}),c.$watch(m.ytsPayNow,function(a,b){a!==b&&(c.yts.payNow=a,this._pubSubService.publish("yts.payNow",[c.yts.payNow]))}.bind(this)),c.$watch(m.headerVisible,function(a,b){a!==b&&(c.yts.isHeaderVisible=a)}),c.$watch(o.getContext,function(a,b){a!==b&&(c.yts.collapseYts(),c.yts.context=a,this.destroyWatches(),this.initializeWatches())}.bind(this)),d.$on("ytsAlt",function(a,b){c.yts.alt=b.isAlt}),this.initializeWatches(),this.setBaseAndTotal()};f.$inject=["$filter","ResourceBundle","$scope","$rootScope","scrollService","purchaseService","tripService","fareService","changeService","seatService","travelerService","ancillariesService","windowService","workflowService","locationService","loadingService","utilsService","pubSubService","statusService","accessibleService","$document","$compile","$singleTimeout","$modal","$location","$window"],f.prototype.getTotalLabel=function(){return"DOLLAR"===this._activeCurrency?this._$scope.yts.total:this._$scope.yts.total+(this._$scope.yts.totalTaxes?" + $"+this._numberFilter(this._$scope.yts.totalTaxes+this._$scope.yts.totalUpgradeCosts,2):"")},f.prototype.back=function(){var a="book"===this._$scope.yts.context?null:this._determineCurrentSectionOnChange();this._workflowService.backStep(a),"book"!==this._$scope.yts.context&&"SEAT_SELECTOR_STATE"===a&&window.history.go(-1)},f.prototype.goToPayment=function(){(!this._$scope.yts.payNow||this._$scope.yts.alt)&&this._$scope.yts.collapseYts();var a=function(){this._windowService.setYtsVisible(!1),this._locationService.go({target:"/success"})},b=function(){this._$scope.yts.payNow&&this._workflowService.transition(this._currentState,"PURCHASE_STATE")},c=function(){this._windowService.setYtsExpanded(!1);var b=parseInt(this._$scope.yts.total.replace("$",""),10),c=b>0;if(this._$scope.yts.payNow){var d=this._changeService.getQuoteModel(),e=this._changeService.isNewOrExisting();if("EXISTING"!==e||"NoPayment"!==d.type&&"Refund"!==d.type){if(!d)return;if(c||d.paymentAmount)this._locationService.go({target:"/purchase"});else{var f=this._changeService.complete({paymentOption:null});this._loadingService.setLoading(f),this._statusService.setChangeGuider([]),f.then(a.bind(this))}}else{var g=this._changeService.manageComplete();this._loadingService.setLoading(g),g.then(a.bind(this))}}},d="book"===this._$scope.yts.context?b.bind(this):c.bind(this);d()},f.prototype.setVisibility=function(a){this._$scope.yts.isVisible!==a&&this._$singleTimeout(function(){this._$scope.yts.isVisible=a,this._windowService.setYtsVisible(a),this.setScrollOffset()}.bind(this))},f.prototype.setScrollOffset=function(){var a=this._$scope.yts.isVisible?void 0:0;this._scrollService.setOffsetType("yts",a)},f.prototype.resizeHandler=function(){var a=0;!c.flexbox&&this._$scope.yts.expanded&&"large"===this._$scope.yts.breakpoint?(b(".yts-expanded__yts-module").removeAttr("style").each(function(){var c=b(this).height();a=c>a?c:a}),b(".yts-expanded__yts-module").css("height",a)):b(".yts-expanded__yts-module").removeAttr("style")},f.prototype.setBaseAndTotal=function(){var a="book"===this._$scope.yts.context?"_setBaseAndTotalForBook":"_setBaseAndTotalForChange";this[a]()},f.prototype._setBaseAndTotalForBook=function(){var a=this._purchaseService.data();"DOLLAR"===this._activeCurrency?(this._$scope.yts.base="$"+this._numberFilter(a.baseDollars,2),this._$scope.yts.totalNum=a.baseDollars,this._$scope.yts.total="$"+this._numberFilter(a.totalDollars,2)):(this._$scope.yts.base=this._$scope.yts.total=this._numberFilter(a.totalPoints)+"pts",this._$scope.yts.totalNum=a.totalPoints),this._$scope.yts.extras=a.totalExtras,this._$scope.yts.totalTaxes=a.totalTaxes,this._$scope.yts.petsValue=a.petcTax,this._$scope.yts.petsAmount=this._tripService.getSelectedTripPublicModel().travelers.pets,this._$scope.yts.totalIsPositive=!0},f.prototype._isPayment=function(){return this._$location.url().indexOf("purchase")!==-1},f.prototype._isChangeSeats=function(){return this._$location.url().indexOf("change/seats")!==-1},f.prototype._isChangeExtras=function(){return this._$location.url().indexOf("change/extras")!==-1},f.prototype._isOnOrPastAncSelector=function(){return"ANCILLARIES_SELECTOR_STATE"===this._$scope.yts.currentState||this._isPayment()||this._isChangeSeats()},f.prototype._setBaseAndTotalForChange=function(){var a=this._changeService.getOriginalCost(),b=this._changeService.getChangeFee(),c=this._isPayment()?this._ancillariesService.getAPIAncillariesAmount():this._changeService.getUIAncillariesAmount(),d=this._isOnOrPastAncSelector()?this._ancillariesService.getExtrasRefund():0,e=this._isPayment()||this._isChangeSeats()?this._changeService.getBalance():this._changeService.getBalance()+c-d,f=this._changeService.getNewFlightCost();this._$scope.yts.typeOfChange=this._changeService.isNewOrExisting(),this._$scope.yts.base="$"+this._numberFilter(a,2);var g=("AerRefund"===this._changeService.quoteType()||"Refund"===this._changeService.quoteType())&&e<0?"-":"";this._$scope.yts.extras=c?"$"+this._numberFilter(Math.abs(c),2):"",this._$scope.yts.extrasRefund=d?"-$"+this._numberFilter(Math.abs(d),2):"",this._$scope.yts.newFee="$"+this._numberFilter(Math.abs(f),2),this._$scope.yts.changeFee="$"+this._numberFilter(b,2),this._$scope.yts.total=g+"$"+this._numberFilter(Math.abs(e),2),this._$scope.yts.totalIsPositive="-"!==g},f.prototype.onChange=function(a){this._$scope.yts.collapseYts();var b=null;if(this.isNewChange())return b=this._changeService.getSelectedTripPublicModel(),"calendar"!==a&&"people-picker"!==a&&"cities"!==a||(b.dates=[]),void this._locationService.push(b);if("book"===this._$scope.yts.context&&this._$scope.yts.alt)return this._workflowService.transition("PURCHASE_STATE","BOOK_INTRO_STATE"),b=this._tripService.getSelectedTripPublicModel(),"calendar"!==a&&"people-picker"!==a&&"cities"!==a||(b.dates=[]),void this._locationService.push(b);if(!this._$scope.yts.alt){var c=this._changeService.isExistingChangeType(this._changeService.EXISTING_CHANGE_TYPES.SEATS);"anc-selector"===a&&c&&(a="seatSelector");var d=a;"seat-selector-1"===a&&this._$scope.yts.flights[0].legs.length>1&&(d="seat-selector-2"),this._scrollService.go(d)}this._triggerSectionExpand(a)},f.prototype.destroyWatches=function(){for(var a in this._watchReferences)"function"==typeof this._watchReferences[a]&&this._watchReferences[a]()},f.prototype.initializeWatches=function(){this._$scope.$watch(this._windowService.breakpoint,this.onBreakpointChange.bind(this)),this._windowService.subscribe("resize",this.resizeHandler.bind(this));var b="book"===this._$scope.yts.context?this._tripService:this._changeService;"book"===this._$scope.yts.context&&(this._watchReferences.price=this._$scope.$watch(function(){return this._purchaseService.data().totalDollars}.bind(this),this._setBaseAndTotalForBook.bind(this))),this._watchReferences.tripType=this._$scope.$watch(b.getTripType,function(b){a.extend(this._$scope.yts,{isOneWay:b===this._tripService.ONE_WAY,isRoundTrip:b===this._tripService.ROUND_TRIP,isMultiCity:b===this._tripService.MULTI_CITY})}.bind(this)),this._watchReferences.cityPairs=this._$scope.$watch(b.getCityPairs,function(a){this._$scope.yts.cityPairs=a;for(var b=0;b<a.length;b++)if(!a[b])continue}.bind(this),!0),this._watchReferences.dates=this._$scope.$watch(b.getDates,function(a){this._$scope.yts.dates=this._utilsService.formatDates(a)}.bind(this),!0);var c="book"===this._$scope.yts.context?this._purchaseService:this._changeService;this._watchReferences.travelerList=this._$scope.$watch(c.getTravelers,function(){var a=this._$scope.yts.totalTravelers=b.getTotalTravelers();this._$scope.yts.travelerSummary=b.travelerTotalLabel(),this._$scope.yts.travelerList=a>1?b.getTravelerList(this._$scope.yts.travelers,!0):""}.bind(this),!0),this._pubSubService.subscribe("changeExistingCtrl.selectedFares",function(a){this._$scope.yts.flights=this._purchaseService.formatFares(a)}.bind(this)),this._watchReferences.fares=this._$scope.$watch(this._fareService.getSelectedFares,function(a){this._$scope.yts.payingTravelers=b.getPayingTravelerAmount(),this._$scope.yts.flights=this._purchaseService.formatFares(a);var c=this._purchaseService.getTopTier();this._$scope.yts.topTier=c,this._$scope.yts.collapsedTierLabel=this._tierLabels[c],this._$scope.yts.tierIsRefundable=this._refundableMap[c],this.setBaseAndTotal()}.bind(this),!0),this._watchReferences.travelers=this._$scope.$watch(this._travelerService.getTravelers,function(a){this._$scope.yts.travelers=a}.bind(this),!0),this._watchReferences.ancillaries=this._$scope.$watch(this._ancillariesService.getSelectedAncillariesAndPax,function(a){this._$scope.yts.ancillaries=a,this.setBaseAndTotal()}.bind(this),!0),this._watchReferences.seats=this._$scope.$watch(this._seatService.getSelectedSeatModel,function(){this._$scope.yts.travelers=this._travelerService.getTravelers(),this.setBaseAndTotal()}.bind(this),!0),this._watchReferences.currency=this._$scope.$watch(function(){return this._purchaseService.data().currency}.bind(this),function(a){this._activeCurrency=this._$scope.yts.activeCurrency=a,this.setBaseAndTotal()}.bind(this)),this._watchReferences.taxes=this._$scope.$watch(this._purchaseService.data,function(){"book"===this._$scope.yts.context&&this._setBaseAndTotalForBook()}.bind(this),!0),this._watchReferences.quotes=this._$scope.$watch(this._changeService.getQuoteModel,function(a,b){a!==b&&this.setBaseAndTotal()}.bind(this),!0)},f.prototype.onBreakpointChange=function(a){this._$scope.yts.breakpoint=a,this.setScrollOffset()},f.prototype.expandYts=function(){this._$scope.yts.expanded=!0,this._$scope.yts.collapsedHover=!1,this._windowService.setYtsExpanded(!0);var a=this;this._$singleTimeout(function(){a.resizeHandler()});var c=function(){a._$singleTimeout(function(){a.collapseYts()})};this._$singleTimeout(function(){var a=b(".yts-expanded a").eq(0),d=b("[data-yts-collapse]");this._windowService.setUiBlock(!0,c,"modal__backdrop--grey"),a.focus(),b("body").on(this._keydownEvent,this._accessibleService.trapFocus.bind(this,a,d))}.bind(this))},f.prototype.focusYts=function(){this._$scope.yts.expanded?this._$scope.yts.payNow?this._accessibleService.setText("Continue to Pay Now"):this._accessibleService.setText("Collapse Your Trip Summary"):this._accessibleService.setText("Expand Your Trip Summary")},f.prototype.collapseYts=function(){this._$scope.yts.expanded&&(this._$scope.yts.expanded=!1,this._windowService.setYtsExpanded(!1),this._windowService.setUiBlock(!1,null),b("body").off(this._keydownEvent))},f.prototype.navStyle=function(){if("large"!==this._$scope.yts.breakpoint)return{height:this._windowService.getDeviceWindowHeight()-b(".yts__cta").height()+"px","padding-bottom":b(".yts-expanded__yts-module--summary").height()+b("#change-guider").height()+"px"}},f.prototype.resetFlow=function(){this.collapseYts(),this._isPayment()||(this._$singleTimeout(function(){b(this._resetFlowButton).trigger("click"),this._scrollService.go("top")}.bind(this)),this._tripService.setBookingFlow(!1),this._pubSubService.publish("travelerInfo.hide"))},f.prototype.hardReset=function(){this._locationService.resetApp()},f.prototype.legNumber=function(a){return 0===a?"First Leg":"Second Leg"},f.prototype.showFareRules=function(){this._$modal.open(d.contentMap.FARE_RULES)},f.prototype.showTaxesAndFeesModal=function(){this._$modal.open(d.contentMap.TAXES)},f.prototype._triggerSectionExpand=function(a){var b={cities:"expandTripBooker",calendar:"expandCalendar","people-picker":"expandTripBooker",fares:"expandFirstFareSelector","fares-1":"expandSecondFareSelector",seatSelector:"expandFirstSeatSelector","seat-selector-1":"expandSecondSeatSelector",travelerInfo:"travelerInfo.expand","anc-selector":"ancillariesSelector.expand"};b[a]&&this._pubSubService.publish(b[a])},f.prototype._hasCollapsedSections=function(){return b("#booker .collapsed-section").length},f.prototype._determineCurrentSectionOnChange=function(){return this._$scope.yts.currentState?this._$scope.yts.currentState:this._hasCollapsedSections()?this._$scope.yts.fares&&this._$scope.yts.fares.length>=this._changeService.getTripTypeLegs()?this._workflowService.state.SEAT_SELECTOR:this._changeService.getVisibleSections().ANCILLARIES_SELECTOR?this._workflowService.state.ANCILLARIES_SELECTOR:this._$scope.yts.dates&&this._$scope.yts.dates.length>=this._changeService.getTripTypeLegs()?this._workflowService.state.FARE_SELECTOR:this._$scope.yts.cityPairs&&2===this._$scope.yts.cityPairs.length?this._workflowService.state.DATE_PICKER:this._workflowService.state.BOOK_INTRO:this._workflowService.state.BOOK_INTRO},f.prototype.isBooking=function(){return this._locationService.contextIs(this._locationService.contexts.BOOK)},f.prototype.isNewChange=function(){return this._locationService.contextIs(this._locationService.contexts.CHANGE)&&this._changeService.isChangeType(this._changeService.CHANGE_TYPES.NEW)},f.prototype.isChangeExtra=function(){return this._locationService.contextIs(this._locationService.contexts.CHANGE)&&this._changeService.isExistingChangeType(this._changeService.EXISTING_CHANGE_TYPES.EXTRAS_AND_SEATS)};var g=function(a,c,d,e){function f(b,c){var d=e._locationService.getContext();if(("book"===d||"change"===d)&&"PURCHASE_STATE"!==e._currentState&&"SUCCESS_STATE"!==e._currentState){var f=a.yts.isHeaderVisible?j.height():0,k=f+h.height();"change"===e._locationService.getContext()&&(k-=i.height());var l=e._$location.url().indexOf("change/trip")!==-1;c>=k&&!g&&a.yts.isVisible?(g=!0,e._windowService.setYtsFixed(!0)):c<k&&g&&!l&&(g=!1,e._windowService.setYtsFixed(!1));var m="BOOK_INTRO_STATE"!==e._currentState&&"SUCCESS_STATE"!==e._currentState||"change"===d&&(l||e._isChangeSeats()||e._isChangeExtras()||e._isPayment());e.setVisibility.call(e,m)}}var g=!1,h=b("#travel-advisory"),i=b("#change-guider"),j=b("header.banner");e._windowService.subscribe("scroll",f)};return e}),c("common/directives/yts-module",[],function(){"use strict";var a=function(){return{restrict:"A",transclude:!0,scope:{yts:"=",header:"=",changeTarget:"=",changeEnable:"="},templateUrl:"/app/common/directives/yts-module.tpl.html"}};return a}),c("common/directives/footer",[],function(){"use strict";var a=function(){return{restrict:"A",controller:b,scope:!0}},b=function(a,b,c,d){this._$scope=a,this._$modal=b,this._windowService=c,a.footer={modal:!1,year:new Date,links:d.siteMap.footer,openFooterModal:this.openFooterModal.bind(this),getOmega:this.getOmega.bind(this)},a.$watch(this._windowService.breakpoint,this.onBreakpointChange.bind(this))};return b.$inject=["$scope","$modal","windowService","SiteMapBundle"],b.prototype.onBreakpointChange=function(a){this._$scope.footer.breakpoint=a},b.prototype.openFooterModal=function(){this._$modal.open({contentType:"footer",size:"medium",title:"Where do you want to go?",controller:"FooterModalCtrl",templateUrl:"/app/common/templates/modals/footer.tpl.html"})},b.prototype.getOmega=function(a){if((a+1)/6%1===0)return"is-omega"},a}),c("common/directives/inline-modal",[],function(){"use strict";var a=function(){return{restrict:"A",scope:!0,replace:!0,transclude:!0,controller:b,link:c,templateUrl:"/app/common/directives/modal.tpl.html"}},b=function(a,b,c){this._$scope=a,this._$parse=b,this._windowService=c,this._$scope.modal={breakpoint:{},show:!1},a.$watch(this._windowService.breakpoint,this.onBreakpointChange.bind(this))};b.$inject=["$scope","$parse","windowService"],b.prototype.onBreakpointChange=function(a){this._$scope.modal.breakpoint.small="small"===a,this._$scope.modal.breakpoint.small&&this._$scope.modal.show?(this._$scope.modal.show=!0,this._windowService.setModalMode(!0)):this._$scope.modal.show&&(this._$scope.modal.show=!1,this._windowService.setModalMode(!1))},b.prototype.onShowChange=function(a){this._$scope.modal.show=!!a};var c=function(a,b,c,d){a.$watch(c.show,d.onShowChange.bind(d)),a.closeModal=function(){d._$parse(c.onClose)(a)}};return a}),c("common/directives/number-picker",[],function(){"use strict";var a=function(){return{restrict:"A",controller:b,scope:{onUpdate:"&",title:"@",allyLabel:"@",subTitle:"@",subTitleSmall:"@",canIncrement:"&increment",value:"=",e2eVal:"@",max:"@",min:"@",countedTraveler:"@"},templateUrl:"/app/common/directives/number-picker.tpl.html"}},b=function(a,b,c,d,e){var f=this;this._windowService=b,this._tripService=c,this._accessibleService=d,this._$scope=a,a.numberPicker={add:this.add.bind(this),getSubTitle:this.getSubTitle.bind(this),subtract:this.subtract.bind(this)},this._max=0,this._pubSubService=e,this._min=parseInt(a.min,10)||0,a.canIncrement="boolean"==typeof a.canIncrement()?a.canIncrement:function(){return!0},a.$watch(this._windowService.breakpoint,this.onBreakpointChange.bind(this)),a.$watch("max",function(b){f._max=parseInt(b,10),b<a.value&&(a.value=Math.max(f._max,0))})};return b.$inject=["$scope","windowService","tripService","accessibleService","pubSubService"],b.prototype.onBreakpointChange=function(a){this._$scope.numberPicker.breakpoint=a},b.prototype.getSubTitle=function(){return"small"===this._$scope.numberPicker.breakpoint?this._$scope.subTitleSmall:this._$scope.subTitle},b.prototype._allyAnnounceCount=function(a){var b=a?"increased":"decreased",c=["count",b,"to",this._$scope.value].join(" ");this._accessibleService.setText(c)},b.prototype.add=function(){this._$scope.value<this._max&&this._$scope.canIncrement()?this._$scope.value++:this._$scope.value=this._min,this._$scope.onUpdate({value:this._$scope.value}),this._allyAnnounceCount(!0),
this._pubSubService.publish("adobeAnalytics.whoIsFlying",[this._tripService.getSelectedTripPublicModel()])},b.prototype.subtract=function(){if(this._$scope.value>this._min)this._$scope.value--;else if(this._$scope.canIncrement())if("undefined"==typeof this._$scope.countedTraveler)this._$scope.value=this._max;else{var a=this._tripService.getTotalPayingTravelers()-this._min,b=this._max-a,c=Math.min(b,this._max);this._$scope.value=c}this._$scope.onUpdate({value:this._$scope.value}),this._allyAnnounceCount(),this._pubSubService.publish("adobeAnalytics.whoIsFlying",[this._tripService.getSelectedTripPublicModel()])},a}),c("common/directives/hover-class",["angular","modernizr"],function(a,b){"use strict";var c=function(){return{restrict:"A",link:d}},d=function(c,d,e){var f=e.vxCommonHoverClass;!b.touch&&a.isString(f)&&d.on("mouseover",d.addClass.bind(d,f)).on("mouseout",d.removeClass.bind(d,f))};return c}),c("common/directives/scroll",[],function(){"use strict";var a=function(){return{restrict:"A",scope:!0,replace:!1,controller:b,link:c}},b=function(a,b){this._$parse=a,this._scrollService=b};b.$inject=["$parse","scrollService"];var c=function(a,b,c,d){var e=d._$parse(c.scrollComplete);a.scrollToMe=function(){d._scrollService.go(b,{callback:function(b){"end"===b&&c.scrollComplete&&e(a)}})}};return a}),c("common/directives/local-scroll",[],function(){"use strict";var a=function(){return{restrict:"A",scope:!0,replace:!1,controller:b,link:c}},b=function(a,b,c,d){this._$timeout=a,this._$interval=b,this._scrollService=c,this._$parse=d};b.$inject=["$timeout","$interval","scrollService","$parse"];var c=function(a,b,c,d){function e(){var c=b.data("local-scroll-start");c&&d._$parse(c)(a);var e=d._scrollService.go(b);e.then(function(a,b,c){var d=b.data("local-scroll-complete");d&&c(d)(a)}.bind(null,a,b,d._$parse))}var f=parseInt(c.vxCommonLocalScroll,10);0!==f&&a.$watch(c.currentSection,function(a){a===f&&(d._visibilityInterval=d._$interval(function(){b.is(":visible")&&(d._$interval.cancel(d._visibilityInterval),d._visibilityInterval=void 0,e())},100))})};return a}),c("common/directives/status-bar",["angular","moment"],function(a,b){"use strict";var c=function(){return{restrict:"A",scope:{},controller:d,link:e,replace:!0,templateUrl:"/app/common/directives/status-bar.tpl.html"}},d=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){this.$scope=a,this.$timeout=b,this.$compile=c,this.$document=d,this.$location=e,this.statusService=g,this.windowService=h,this.workflowService=i,this.bookingTimerService=j,this.pubSubService=k,this.locationService=l,this.accessibleService=o,this.$window=p,this.statusTimer=null,this.alertTimer=null,this.statusArr=[],this.alertArr=[],this._statusScope={},this.keydownEvent="keydown.trapStatusFocus",this.statusDefaults={goBack:this.goBack.bind(this),shouldShowBackButton:this.shouldShowBackButton.bind(this),resetFocus:this.resetFocus.bind(this),back:this.hideStatus.bind(this),next:this.hideStatus.bind(this),hide:this.hideStatus.bind(this),undo:this.undoStatus.bind(this),sticky:!1,backdrop:{append:!1,callback:"defaultCallback"},format:g.format.SUCCESS,publish:function(a,b){this.pubSubService.publish(a,b)}.bind(this),visible:!0},this.alertDefaults={hide:this.hideAlert.bind(this),dismiss:this.dismissAlert.bind(this),sticky:!0,format:g.format.ALERT,visible:!0},this.backdropCallbacks={defaultCallback:function(){var a=this;b(function(){a.hideAlert()})}.bind(this),destroyCallback:function(){var a=this;b(function(){a.dismissAlert()})}.bind(this)},a.statusBar={classes:[]},a.alertBar={classes:[]},a.context="book",a.resetFlowButton="#bookResetFlow",a.$watchCollection(g.status,this.onStatusChange.bind(this)),a.$watchCollection(g.alert,this.onAlertChange.bind(this)),a.$watch(j.getHasTimeEnded,function(a){a&&(b(function(){h.setUiBlock(!1,null),this._destroyKeydownListener()}.bind(this)),b(function(){h.setUiBlock(!0,null),this._initKeydownListener()}.bind(this)))}.bind(this)),a.$watch(l.getContext,function(b){a.context=b}.bind(this)),k.subscribe("statusBar.hide",function(){this.hideAlert()}.bind(this)),a.resetFlow=function(){if("book"===a.context){var c=e.url().indexOf("purchase")!==-1;c?l.resetApp():(b(function(){$(a.resetFlowButton).trigger("click"),m.go("top"),g.setStatus([])}.bind(this)),n.setBookingFlow(!1))}else l.resetApp()}};d.$inject=["$scope","$timeout","$compile","$document","$location","ResourceBundle","statusService","windowService","workflowService","bookingTimerService","pubSubService","locationService","scrollService","tripService","accessibleService","$window"],d.prototype.goBack=function(){"check-in"===this.$scope.context?this.$window.history.go(-1):"book"===this.$scope.context&&(this.workflowService.backStep(null),this.statusService.setStatus([]))},d.prototype.shouldShowBackButton=function(){var a="check-in"===this.$scope.context,b="book"===this.$scope.context,c="Payment"!==this.$scope.statusBar.message,d="SEAT_SELECTOR_STATE"===this.workflowService.getCurrentState();return a&&c||b&&d},d.prototype.resetFocus=function(a){a.key&&this.accessibleService.setMostCurrentFocus()},d.prototype.undoStatus=function(){this.setStatusVisibility(!1)},d.prototype.setStatusVisibility=function(a){this.$scope.statusBar.visible=a},d.prototype.timeoutFn=function(a,b){var c=a||" ",d=/\s/g,e=250*c.match(d).length;return b&&this.$scope.alertBar.recoverable?this.statusService.TIMEOUT_WARNING:Math.max(this.statusService.TIMEOUT,Math.min(e,this.statusService.TIMEOUT_MAX))},d.prototype.startStatusTimer=function(b){this.resetStatusTimer(),this.statusTimer=this.$timeout(a.bind(this,function(){this.processStatus()}),this.timeoutFn(b))},d.prototype.resetStatusTimer=function(){this.statusTimer="object"!=typeof this.statusTimer||!this.$timeout.cancel(this.statusTimer)},d.prototype.resetAlertTimer=function(){this.alertTimer="object"!=typeof this.alertTimer||!this.$timeout.cancel(this.alertTimer)},d.prototype.updateStatusClasses=function(a){var b=[];if(this.$scope.statusBar.visible)switch(b.push("is-visible"),this.$scope.statusBar.format){case this.statusService.format.SUCCESS:b.push("is-success")}void 0!==a&&b.push(a),this.windowService.setStatusBarVisible(this.$scope.statusBar.visible),this.$scope.statusBar.classes=b.join(" ")},d.prototype.updateAlertClasses=function(){var a=[];if(this.$scope.alertBar.visible)switch(a.push("is-visible"),this.$scope.alertBar.recoverable&&a.push("is-recoverable"),this.$scope.alertBar.format){case this.statusService.format.ALERT:a.push("is-alert");break;case this.statusService.format.ERROR:a.push("is-error")}this.$scope.alertBar.classes=a.length?a.join(" "):""},d.prototype.processStatus=function(){var a;this.statusArr.length>0?(a=this.statusArr.shift(),this.setStatus(a)):this.hideStatus()},d.prototype.processAlert=function(){var a;this.alertArr.length>0?(a=this.alertArr.shift(),this.setAlert(a)):this.hideAlert()},d.prototype.onStatusChange=function(a){this.resetStatusTimer(),this.statusArr=this.statusArr.concat(a),this.processStatus()},d.prototype.onAlertChange=function(a){this.resetAlertTimer(),this.alertArr=this.alertArr.concat(a),this.processAlert()},d.prototype.setStatus=function(b){switch(b.message=b.copy.DESC,this.requiresNotification(b),b.format){case this.statusService.format.SUCCESS:b.controls={}}this.$scope.statusBar=a.extend({},this.statusDefaults,b),this.$scope.statusBar.sticky||this.startStatusTimer(b.message),this.updateStatusClasses(b.statusClass),this._compile(b,"status")},d.prototype.requiresNotification=function(a){var c=["DFW","DAL"],d=b().utc().zone(7),e=b([2014,9,12,23,59]),f="All Dallas flights are moving from DFW to DAL on October 13th.<br/> Be advised, we are currently displaying search results for both airports.";if(a.data&&e.diff(d,"seconds")>0)for(var g=0;g<c.length;g++)a.data.fromAirportCode!==c[g]&&a.data.toAirportCode!==c[g]||(a.message=f,a.statusClass="is-notification");return a},d.prototype._initKeydownListener=function(){var a=$(".bar-holder .is-visible").eq(0),b=$("a:visible",a).eq(0);a.focus(),$("body").on(this.keydownEvent,this.accessibleService.trapFocus.bind(this,a,b))},d.prototype._destroyKeydownListener=function(){$("body").off(this.keydownEvent)},d.prototype.setAlert=function(b){var c=200;switch(b.message=b.copy.DESC,b.format){case this.statusService.format.ALERT:case this.statusService.format.ERROR:b.controls||(b.controls={close:!0})}this.$scope.alertBar=a.extend({},this.alertDefaults,b),this.$scope.alertBar.backdrop&&this.$scope.alertBar.backdrop.append&&this.$timeout(function(){this.windowService.setUiBlock(!0,this.backdropCallbacks[this.$scope.alertBar.backdrop.callback],null,null,100),this._initKeydownListener()}.bind(this)),this.updateAlertClasses(),this._compile(b,"alert"),this.statusService.format.ERROR&&(c=700),setTimeout(function(){this.accessibleService.setAssertiveLevel("assertive"),this.accessibleService.setText($(".alert-bar .message").text()),this.$scope.alertBar.currentActive=document.activeElement,$(".alert-bar").focus()}.bind(this),c)},d.prototype._compile=function(b,c){var d=this.accessibleService.assertiveLevels.POLITE;this.$timeout(function(){var e="."+c+"-bar__copy",f=this.iElem.find(e),g='<span class="title" ng-show="'+c+'Bar.copy.TITLE">{{'+c+'Bar.copy.TITLE}}</span> <span class="message" tabindex="-1">'+b.message+"</span>";if("alert"===c){var h=this.$scope.alertBar.errorCode;g+="7218598"===h?'<a class="receipt-link" href="#" data-vx-common-universal-receipt vx-common-ally-click="universalReceipt.openModal()">Looking for a receipt?</a>':'<span class="code" ng-show="alertBar.errorCode">#'+h+"</span>"}this.accessibleService.getAssertiveLevel()!==d&&this.accessibleService.setAssertiveLevel(d),f.html(g),a.isObject(b.data)&&(a.extend(this.$scope,b.data),f=this._decorate(f,b.data)),this.$compile(f)(this._createFreshStatusScope(c)),setTimeout(function(){var a=$(".status-bar .message"),c=$("a",a),d=$(".balance-due",this.iElem),e=a.text()+" "+d.text();b.allyMessage&&(e=b.allyMessage+" "+e),this.accessibleService.setText(e),c.length&&(a.focus(),c.on("blur",this.resetFocus.bind(this)))}.bind(this),100)}.bind(this))},d.prototype._decorate=function(a,b){if(b.avatar){var c=$("<span />").addClass("status-avatar icon-avatar-"+b.avatar+"-sm");a.find(".status-avatar").remove(),a.find(".message").prepend(c)}else a.find(".status-avatar").remove();if(b.balance){var d=$("<div />").addClass("balance-due").html('Balance due <span class="due">'+b.balance+"</span>");if(a.find("span.balance-due").remove(),a.prepend(d),b.taxes){d.addClass("points");var e=$("<span />").addClass("taxes-due").html(b.taxes);d.append(e)}else a.find("span.taxes-due").remove()}else a.find("span.balance-due").remove();return a},d.prototype._createFreshStatusScope=function(a){return this._destroyStatusScope(a),this._statusScope[a]=this.$scope.$new()},d.prototype._destroyStatusScope=function(a){this._statusScope[a]&&this._statusScope[a].$destroy(),delete this._statusScope[a]},d.prototype.hideStatus=function(){this.$scope.statusBar.visible&&(this.$scope.statusBar.visible=!1,this.updateStatusClasses(),this._destroyStatusScope("status"))},d.prototype.hideAlert=function(){var a=this,b=!1;this.$scope.alertBar.visible||(b=!0),this.$scope.alertBar.visible&&(this.$scope.alertBar.visible=!1,this.$scope.alertBar.currentActive.focus(),this.updateAlertClasses(),this._destroyStatusScope("alert")),this.$scope.alertBar.backdrop&&this.$scope.alertBar.backdrop.append&&this.$timeout(function(){a.windowService.setUiBlock(!1,null),this._destroyKeydownListener()}),this.$scope.alertBar.dismissCallBack&&!b&&this.$scope.alertBar.dismissCallBack()},d.prototype.dismissAlert=function(){var a=this;this.$scope.alertBar.visible&&(this.$scope.alertBar.visible=!1,this.$scope.statusBar.visible=!1,this.updateStatusClasses(),this.updateAlertClasses(),this._destroyStatusScope("alert")),this.$timeout(function(){a.windowService.setUiBlock(!1,null),a._destroyKeydownListener()});var b=this.workflowService.getCurrentState();this.locationService.getContext()===this.locationService.contexts.BOOK&&"PURCHASE_STATE"!==b&&!this.$scope.alertBar.doNotRollbackOnDismiss&&this.workflowService.transition(b,"FARE_SELECTOR_STATE",!1),this.$scope.alertBar.dismissCallBack&&this.$scope.alertBar.dismissCallBack()},d.prototype.mouseOverHandler=function(){this.$scope.statusBar.visible&&!this.$scope.statusBar.sticky&&this.startStatusTimer()},d.prototype.mouseOutHandler=function(){this.$scope.statusBar.visible&&!this.$scope.statusBar.sticky&&this.startStatusTimer()};var e=function(a,b,c,d){function e(c,e){var i=h.height(),j=i+f.height();"change"===d.locationService.getContext()&&(j-=g.height());var k=d.$location.url().indexOf("/book")!==-1;"book"===d.locationService.getContext()&&k&&(a.statusBar.sticky?e>=j&&!a.statusBar.visible&&(d.setStatusVisibility(!0),$(b).show()):(d.setStatusVisibility(!0),$(b).show()))}b.on("mouseover",d.mouseOverHandler.bind(d)).on("mouseout",d.mouseOutHandler.bind(d)),d.iElem=b;var f=$("#travel-advisory"),g=$("#change-guider"),h=$("header.banner");d.windowService.subscribe("scroll",e)};return c}),c("common/directives/loading",["angular"],function(){"use strict";var a=function(){return{restrict:"A",scope:{},controller:b,replace:!0,templateUrl:"/app/common/directives/loading.tpl.html"}},b=function(a,b,c){this.$scope=a,a.loading={visible:!1,visibleClass:"",isOnTop:!1,context:"book"},a.$watch(b.visible,this.setVisibility.bind(this)),a.$watch(b.isOnTop,this.setIsOnTop.bind(this)),a.$watch(c.getContext,function(b){a.loading.context=b}.bind(this))};return b.prototype.setVisibility=function(a){this.$scope.loading.visible=a,this.$scope.loading.visibleClass=a?"is-visible":"",a&&"change"===this.$scope.loading.context&&(this.$scope.loading.visibleClass+=" is-change-flow")},b.prototype.setIsOnTop=function(a){this.$scope.loading.isOnTop=a},b.$inject=["$scope","loadingService","locationService"],a}),c("common/directives/travel-advisory",[],function(){"use strict";var a=function(){return{restrict:"A",scope:{},controller:b,link:c,templateUrl:"/app/common/directives/travel-advisory.tpl.html"}},b=function(a,b,c,d,e,f,g,h){var i=this;this._$scope=a,this.$timeout=b,this._windowService=d,this._locationService=e,this.pubSubService=f,a.travelAdvisory={bp:""},this._header={fixed:!1,visible:!0},c.travelerAdvisory.get(function(b){a.travelAdvisory=b.travelerAdvisory,b.travelerAdvisory&&b.travelerAdvisory.msg&&(g.UIEvent(g.EVENTS.TRAVEL_ADVISORY,{msg:b.travelerAdvisory.msg}),a.travelAdvisory.msgSafe=h.trustAsHtml(a.travelAdvisory.msg))}),a.$watch(this._windowService.breakpoint,this.onBreakpointChange.bind(this)),a.$watch(this._windowService.headerVisible,function(a){i._header.visible=a})};b.$inject=["$scope","$timeout","cms","windowService","locationService","pubSubService","adobeAnalyticsService","$sce"],b.prototype.onBreakpointChange=function(a){this._$scope.bp=a,"small"===a&&this._setHeaderFixed(!1)},b.prototype._setHeaderFixed=function(a){this._header.fixed=a,this._windowService.setHeaderFixed(a)};var c=function(a,b,c,d){function e(c,e){var f=d._locationService.getContext();if(f!==d._locationService.contexts.ELEVATE){var g=b.height();e>=g&&"small"!==a.bp&&!d._header.fixed&&d._header.visible?d._setHeaderFixed(!0):(e<g&&d._header.fixed||!d._header.visible)&&d._setHeaderFixed(!1)}}d._windowService.subscribe("scroll",e)};return a}),c("common/directives/change-guider",[],function(){"use strict";var a=function(){return{restrict:"A",scope:{},controller:b,link:c,templateUrl:"/app/common/directives/change-guider.tpl.html"}},b=function(a,b,c,d,e,f,g,h,i,j){var k=this;this._$scope=a,this.$timeout=b,this._changeService=d,this._fareService=e,this._seatService=f,this._locationService=g,this._windowService=h,this._pubSubService=i,this._statusService=j,this.pubSubService=i,this._$scope.bp="",a.changeGuider={msg:"",cancelChange:this.cancelChange.bind(this)},this._header={fixed:!1,visible:!0},a.$watch(this._windowService.breakpoint,this.onBreakpointChange.bind(this)),a.$watch(this._windowService.headerVisible,function(a){k._header.visible=a}),a.$watchCollection(j.changeGuider,function(b){b&&(a.changeGuider.msg=b)})};b.$inject=["$scope","$timeout","cms","changeService","fareService","seatService","locationService","windowService","pubSubService","statusService"],b.prototype.cancelChange=function(){this._$scope.changeGuider.msg="",this._changeService.reset(),this._fareService.reset(),this._seatService.resetService(),this._statusService.setStatus([]),this._windowService.setChangeFlow(!1),this._pubSubService.publish("yts.collapseYts",[!0]),this._locationService.setContext("manage"),this._locationService.go({target:"/manage-itinerary"})},b.prototype.onBreakpointChange=function(a){this._$scope.bp=a,"small"===a&&this._setHeaderFixed(!1)},b.prototype._setHeaderFixed=function(a){this._header.fixed=a,this._windowService.setHeaderFixed(a)};var c=function(a,b,c,d){function e(c,e){if(f===d._locationService.contexts.CHANGE){var g=b.height();e>=g&&"small"!==a.bp&&!d._header.fixed&&d._header.visible?d._setHeaderFixed(!0):(e<g&&d._header.fixed||!d._header.visible)&&d._setHeaderFixed(!1)}}var f=d._locationService.getContext();d._windowService.subscribe("scroll",e)};return a}),c("common/directives/window",["angular","jquery"],function(a,b){"use strict";var c={0:"small",550:"medium",1024:"large"},d=function(){return{restrict:"A",controller:e,link:f}};d.$inject=["$rootScope"];var e=function(a,b,c,d,e,f,g){a.backdropEl=null,this.$scope=a,this.$rootScope=b,this.$compile=c,this.$timeout=d,this.windowService=e,this.elevateService=f,this.pubSubService=g,this._hasPageYOffset=void 0!==window.pageYOffset};e.$inject=["$scope","$rootScope","$compile","$timeout","windowService","elevateService","pubSubService"],e.prototype.evaluateBreakpoint=function(){var a=c[Object.keys(c)[0]];for(var b in c)b<this.windowDims.width&&(a=c[b]);a!==this.latestBreakpoint&&(this.latestBreakpoint=a,this.windowService.setBreakpoint(this.latestBreakpoint),this.$timeout(function(){this.$scope.$apply()}.bind(this)))},e.prototype.onResize=function(){this.windowService.setDimensions(this.windowDims),this.evaluateBreakpoint()},e.prototype.onScroll=function(a){var b=this._hasPageYOffset?a.originalEvent.currentTarget.pageYOffset:(document.documentElement||document.body).scrollTop;this.windowService.setScrollTop(b)},e.prototype.getBreakpoint=function(){return this.windowService.breakpoint},e.prototype.setBreakpoint=function(a){this.windowService.setBreakpoint(a)};var f=function(c,d,e,f){function g(a){d.removeClass(function(a,b){return(b.match(/bp-\S+/g)||[]).join(" ")}).addClass("bp-"+a)}function h(a){a.preventDefault()}function i(a){D||(D=!0,0===a.currentTarget.scrollTop?a.currentTarget.scrollTop=1:a.currentTarget.scrollHeight===a.currentTarget.scrollTop+a.currentTarget.offsetHeight&&(a.currentTarget.scrollTop-=1),D=!1)}function j(a){a.stopPropagation()}function k(a){var c=a!==!0?"removeClass":"addClass";d[c]("is-modal-open");var e=f.windowService.scrollableClass(),g=b("body");a&&e?(b(document).on("touchmove",h),g.on("touchstart",e,i).on("touchmove",e,j)):(b(document).off("touchmove",h),g.off("touchstart",e,i).off("touchmove",e,j))}function l(e){var g=e.isBlocked?"addClass":"removeClass";d[g]("is-ui-blocked");var k=b("body");if(e.isBlocked&&e.scrollableClass?(b(document).on("touchmove",h),k.on("touchstart",e.scrollableClass,i).on("touchmove",e.scrollableClass,j)):(b(document).off("touchmove",h),k.off("touchstart",e.scrollableClass,i).off("touchmove",e.scrollableClass,j)),e.isBlocked){var l=a.element("<div vx-common-modal-backdrop></div>").addClass(e.backdropClass),m=f.$rootScope.$new(!0);m.index=e.index?e.index:0,c.backdropEl=f.$compile(l)(m),k.append(c.backdropEl),null!==e.clickCallback&&"function"==typeof e.clickCallback&&k.on("click",".modal__backdrop",e.clickCallback)}else c.backdropEl&&(k.off("click",".modal__backdrop",e.clickCallback),b(".modal__backdrop").remove())}function m(a){var b=a===!0?"addClass":"removeClass";d[b]("bg-dark")}function n(a){var b=a===!0?"addClass":"removeClass";d[b]("is-change-flow")}function o(a){var b=a===!0?"addClass":"removeClass";d[b]("is-yts-visible")}function p(){var a="boolean"==typeof arguments[0]?arguments[0]:arguments[1],b=a===!0?"addClass":"removeClass";d[b]("is-yts-fixed")}function q(a){var b=a===!0?"addClass":"removeClass";d[b]("is-yts-expanded")}function r(a){var b=a===!0?"addClass":"removeClass";d[b]("is-header-visible")}function s(a){var b=a===!0?"addClass":"removeClass";d[b]("is-chrome-hidden")}function t(a){var b=a===!0?"addClass":"removeClass";d[b]("is-footer-hidden")}function u(a){var b=a===!0?"addClass":"removeClass";d[b]("is-advisory-hidden")}function v(a){var b=a===!0?"addClass":"removeClass";d[b]("is-double-header")}function w(a){var b=a===!0?"addClass":"removeClass";d[b]("is-header-fixed")}function x(a){var b=a===!0?"addClass":"removeClass";d[b]("is-status-bar-fixed")}function y(a){var b=a===!0?"addClass":"removeClass";d[b]("is-elevate-mode")}function z(a){var b=a===!0?"addClass":"removeClass";d[b]("is-minimal-login-ui")}function A(a){var b=a===!0?"addClass":"removeClass";d[b]("is-elevate-login")}function B(a){var b=a===!0?"addClass":"removeClass";d[b]("is-avatar-picker-open")}var C=b(window),D=!1,E=a.bind(f,function(){this.windowDims={height:C.innerHeight(),width:C.innerWidth()},this.onResize()});C.on("scroll",f.onScroll.bind(f)).on("resize",E).trigger("resize"),f.pubSubService.subscribe("windowService.breakpoint",g),f.pubSubService.subscribe("windowService.setYtsVisible",o),g(f.windowService.breakpoint()),c.$watch(f.windowService.modal,k),c.$watch(f.windowService.uiBlock,l,!0),c.$watch(f.windowService.ninjaMode,m),c.$watch(f.windowService.isChange,n),c.$watch(f.windowService.ytsVisible,o),b.subscribe("windowService.setYtsFixed",p),c.$watch(f.windowService.ytsExpanded,q),c.$watch(f.windowService.headerVisible,r),c.$watch(f.windowService.chromeHidden,s),c.$watch(f.windowService.footerHidden,t),c.$watch(f.windowService.advisoryHidden,u),c.$watch(f.windowService.doubleHeader,v),c.$watch(f.windowService.statusBarVisible,x),c.$watch(f.windowService.elevateLogin,A),c.$watch(f.windowService.getAvatarPickerOpen,B),f.pubSubService.subscribe("windowService.headerFixed",w),f.pubSubService.subscribe("windowService.elevateMode",y),f.pubSubService.subscribe("windowService.minimalLoginUi",z)};return d}),c("common/directives/click-bg-gradient",[],function(){"use strict";var a=function(){return{restrict:"A",scope:{clickTargetEl:"@"},link:b}},b=function(a,b){var c="."+a.clickTargetEl;b.on("click",c,function(){var a=$(this);a.append('<div class="box-gradient"></div>'),setTimeout(function(){a.find(".box-gradient").remove()},1050)}),a.$on("$destroy",function(){b.off()})};return a}),c("common/directives/select-box",[],function(){"use strict";var a=function(){return{restrict:"A",scope:{data:"="},templateUrl:"/app/common/directives/select-box.tpl.html",link:b}},b=function(a,b){var c=function(){var a=$(this).hasClass("expanded")?"hide":"show";$(this).find("li").each(function(){$(this).hasClass("default-option")||$(this)[a]()}),$(this).toggleClass("expanded")};b.find("ul.select").bind("click",c)};return a}),function(a){"use strict";a.fn.extend({customSelect:function(b){if("undefined"==typeof document.body.style.maxHeight)return this;var c={customClass:"customSelect",mapClass:!0,mapStyle:!0},b=a.extend(c,b),d=b.customClass,e=function(b,c){var d=b.find(":selected"),e=c.children(":first"),g=d.html()||"&nbsp;";e.html(g),d.attr("disabled")?c.addClass(f("DisabledOption")):c.removeClass(f("DisabledOption")),setTimeout(function(){c.removeClass(f("Open")),a(document).off("mouseup.customSelect")},60)},f=function(a){return d+a};return this.each(function(){var c=a(this),g=a("<span />").addClass(f("Inner")),h=a("<span />");c.after(h.append(g)),h.addClass(d),b.mapClass&&h.addClass(c.attr("class")),b.mapStyle&&h.attr("style",c.attr("style")),c.addClass("hasCustomSelect").on("render.customSelect",function(){e(c,h),c.css("width","");var a=parseInt(c.outerWidth(),10)-(parseInt(h.outerWidth(),10)-parseInt(h.width(),10));h.css({display:"inline-block"});var b=h.outerHeight();c.attr("disabled")?h.addClass(f("Disabled")):h.removeClass(f("Disabled")),g.css({width:a,display:"inline-block"}),c.css({"-webkit-appearance":"menulist-button",width:h.outerWidth(),position:"absolute",opacity:0,height:b,fontSize:h.css("font-size")})}).on("change.customSelect",function(){h.addClass(f("Changed")),e(c,h)}).on("keyup.customSelect",function(a){h.hasClass(f("Open"))?(13==a.which||27==a.which)&&e(c,h):(c.trigger("blur.customSelect"),c.trigger("focus.customSelect"))}).on("mousedown.customSelect",function(){h.removeClass(f("Changed"))}).on("mouseup.customSelect",function(b){h.hasClass(f("Open"))||(a("."+f("Open")).not(h).length>0&&"undefined"!=typeof InstallTrigger?c.trigger("focus.customSelect"):(h.addClass(f("Open")),b.stopPropagation(),a(document).one("mouseup.customSelect",function(b){b.target!=c.get(0)&&a.inArray(b.target,c.find("*").get())<0?c.trigger("blur.customSelect"):e(c,h)})))}).on("focus.customSelect",function(){h.removeClass(f("Changed")).addClass(f("Focus"))}).on("blur.customSelect",function(){h.removeClass(f("Focus")+" "+f("Open"))}).on("mouseenter.customSelect",function(){h.addClass(f("Hover"))}).on("mouseleave.customSelect",function(){h.removeClass(f("Hover"))}).trigger("render.customSelect")})}})}(jQuery),c("jquery-custom-select",["jquery"],function(){}),c("common/directives/custom-select",["jquery-custom-select"],function(){"use strict";var a=function(){return{restrict:"A",controller:b,link:c}},b=function(a,b){this._$parse=a,this._$singleTimeout=b};b.$inject=["$parse","$singleTimeout"];var c=function(a,b,c,d){d._$singleTimeout(function(){if(b.customSelect({customClass:"custom-select"}),c.placeholderText){var e=d._$parse(c.placeholderText)(a);if(!e)return;var f=function(){b.next().find(".custom-selectInner").text(e)};f(),b.on("render.customSelect",function(){var a=b.find(":selected")[0];a.value||f()})}})};return a}),c("common/directives/bind-html-unsafe",[],function(){"use strict";var a=function(){return function(a,b,c){var d=c.vxBindHtmlUnsafe;a.$watch(d,function(a){if(a){var c=document.createElement("div");c.innerHTML=a,a=c.childNodes[0].nodeValue,b.html(a)}})}};return a}),c("common/directives/global-image",[],function(){"use strict";var a=function(){return{restrict:"A",scope:!1,controller:b,link:c}},b=function(a){this.imageService=a};b.$inject=["imageService"],b.prototype._validateImageFormat=function(a){var b=["gif"],c=a.match(/[0-9a-z]+$/i);return!!(c&&c.length&&b.indexOf(c[0].toLowerCase())<0)};var c=function(a,b,c,d){d._validateImageFormat(c.out)?(d.imageService.addImage(b,c),a.$on("$destroy",function(){d.imageService.removeImage(b)})):b.attr("src",c.out)};return a}),c("common/directives/form-expiration-date",["angular"],function(a){"use strict";var b=function(){return{restrict:"A",scope:!0,controller:c,link:d}},c=function(a){this._$scope=a};c.prototype.onInputChange=function(){var a,b=this._$scope.input.value;b.length&&b.length<=2?isNaN(b)?this._changeValue(""):(a=Number(b),1===b.length&&a>1?this._changeValue("0"+b+" / "):2===b.length&&a&&a<13?this._changeValue(b+" / "):(a&&a>12||0===a&&2===b.length)&&this._removeLastChar()):b.length>2&&isNaN(b[b.length-1])?this._removeLastChar():b.length>2&&new RegExp(/^\d{2}\s*\/\s*\d{4}.$/).test(b)&&this._removeLastChar()},c.prototype.getExpirationValue=function(){var a=this._$scope.input.value.split("/"),b=a[0].trim(),c=a[1].trim();return c=2===c.length?"20"+c:c,c+"-"+b},c.prototype.handleBackspace=function(a){var b=this._$scope.input.value;8===a.which&&(new RegExp(/^0\d\s*\/\s*$/).test(b)?(this._changeValue(""),a.preventDefault(),this._$scope.$apply()):new RegExp(/^\d{2}\s*\/\s*$/).test(b)?(this._changeValue(b.slice(0,1)),a.preventDefault(),this._$scope.$apply()):new RegExp(/^\d{2}\s*\/\s*\d$/).test(b)&&(this._removeLastChar(),a.preventDefault(),this._$scope.$apply()))},c.prototype._changeValue=function(a){this._$scope.input.value=a},c.prototype._removeLastChar=function(){var a=this._$scope.input.value;this._changeValue(a.slice(0,a.length-1))},c.$inject=["$scope"];var d=function(b,c,d,e){c.on("keydown",e.handleBackspace.bind(e)),a.extend(b.input,{change:e.onInputChange.bind(e),getExpirationValue:e.getExpirationValue.bind(e)})};return b}),c("common/directives/form-handler",["angular","moment"],function(a,b){"use strict";var c=function(){return{restrict:"A",controller:d,scope:!0,link:e}},d=function(a,c,d){this._$scope=a,this._$parse=c,this._$timeout=d,this._$scope.formHandler={register:this.register.bind(this),fields:{},data:{},rules:{},fieldGroups:{},fieldGroupVisibility:{},submitButtonMessage:"",valid:!1,isLoading:!1,clear:this.clear.bind(this),setValue:this.setValue.bind(this),isGroupEmpty:this.isGroupEmpty.bind(this),isGroupValid:this.isGroupValid.bind(this),setGroupVisibility:this.setGroupVisibility.bind(this),updateMessages:this.updateMessages.bind(this)},this._fields={},this._watchers={},this._defaultMessages={},this._emailReg=/^[A-Z0-9._%+-]+@[A-Z0-9.-]{2,}\.[A-Z]{2,4}$/i,this._$scope.formHandler.rules={required:{errorMessage:"Required",validator:function(a){return null!==a&&void 0!==a&&/\S/.test(a)}},greaterThanZero:{errorMessage:"Fix field",validator:function(a){var b=/^[\d]*$/.test(a);return a&&b&&parseInt(a,10)>0}},phoneLength:{errorMessage:"Bad format",checkWhileTyping:!0,validator:function(a){var b=a&&a.replace(/[^0-9]/g,"").trim();return null!==b&&void 0!==b&&b.trim().length>=10&&b.trim().length<=20}},passportLength:{errorMessage:"Bad format",validator:function(a){var b=a.trim();return null!==b&&void 0!==b&&b.trim().length<=15}},optional:{errorMessage:"",validator:function(){return!0}},execMethod:{errorMessage:"",validator:function(a,b){var c=!1;return"object"==typeof a&&(a=null===a?"":a.value),c=""===a||!b||!b.execMethod||b.execMethod(b)}},email:{errorMessage:"Bad e-mail",validator:function(a){return this._emailReg.test(a)}.bind(this)},emails:{errorMessage:"Bad e-mails",validator:function(a){for(var b=a.replace(/,/g,"\n").split("\n"),c=0;c<b.length;c++)if(!this._emailReg.test(b[c].trim()))return!1;return!0}.bind(this)},ssn:{errorMessage:"Bad format",validator:function(a){return/^\d{3}-?\d{2}-?\d{4}$/.test(a)}},ssn4:{errorMessage:"Bad format",validator:function(a){return/^\d{4}$/.test(a)}},emailOrNumber:{errorMessage:"Bad format",validator:function(a){return/^\d+$/.test(a)||/^[A-Z0-9._%+-]+@[A-Z0-9.-]{2,}\.[A-Z]{2,4}$/i.test(a)}},creditCardNumber:{errorMessage:"Bad format",checkWhileTyping:!0,validator:function(a){return/^[0-9-\s]*$/.test(a)}},creditCard:{errorMessage:"Invalid card #",validator:function(a){if(!/^([0-9-\s]+){4,}$/.test(a))return!1;var b=0,c=0,d=!1;a=a.replace(/\D/g,"");for(var e=a.length-1;e>=0;e--){var f=a.charAt(e);c=parseInt(f,10),d&&(c*=2)>9&&(c-=9),b+=c,d=!d}return b%10===0}},securityThreeDigit:{checkWhileTyping:!0,validator:function(a){return/^[0-9]{3}$/.test(a)}},securityFourDigit:{checkWhileTyping:!0,validator:function(a){return/^[0-9]{4}$/.test(a)}},pnrOrTicketNum:{errorMessage:"Required",validator:function(a){return/^[0-9]{13}$/.test(a)||/^[a-zA-Z]{6}$/.test(a)}},name:{errorMessage:"Is that a name?",checkWhileTyping:!0,validator:function(a){return/^[a-zA-Z\u00C0-\u017F-\s]*$/.test(a)}},address:{errorMessage:"Where is that?!",checkWhileTyping:!0,validator:function(a){return/^((?![\$\^%~!]).)*$/.test(a)}},city:{errorMessage:"Where is that?!",checkWhileTyping:!0,validator:function(a){return/^((?![\$\^%~!]).)*$/.test(a)&&/(?!^\d+$)^.+$/.test(a)}},phone:{errorMessage:"Bad format",checkWhileTyping:!0,validator:function(a){return/^[0-9\s\.\-\(\)\+]{4,}$/.test(a)}},phoneStrict:{errorMessage:"Bad format",checkWhileTyping:!0,validator:function(a){return/^\d{10}$/.test(a)}},number:{errorMessage:"Bad format",checkWhileTyping:!0,validator:function(a){return/^[\d]*$/.test(a)}},password:{errorMessage:"invalid password",checkWhileTyping:!0,validator:function(a){return/^\S{8,16}$/.test(a)}},date:{checkWhileTyping:!0,validator:function(a){return/^(?:(?:(?:0?[13578]|1[02])(\/|-|\.)31)\1|(?:(?:0?[1,3-9]|1[0-2])(\/|-|\.)(?:29|30)\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:0?2(\/|-|\.)29\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:(?:0?[1-9])|(?:1[0-2]))(\/|-|\.)(?:0?[1-9]|1\d|2[0-8])\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$/.test(a);
}},flightNum:{errorMessage:"Bad format",checkWhileTyping:!0,validator:function(a){return a=a.replace(/\D/g,""),/^[\d]*$/.test(a)&&a.length>0}},alphanumeric:{errorMessage:"Bad format",checkWhileTyping:!0,validator:function(a){return/^[a-zA-Z0-9]*$/.test(a)}},usZip:{errorMessage:"Bad format",checkWhileTyping:!0,validator:function(a){return/^\d{5}$/.test(a)}},caZip:{errorMessage:"Bad format",checkWhileTyping:!0,validator:function(a){return/^[A-Za-z][0-9][A-Za-z] [0-9][A-Za-z][0-9]$/.test(a)}},expirationDate:{errorMessage:"Bad format",checkWhileTyping:!0,validator:function(a){var c,d,e,f=a.split("/");return 2===f.length&&(c=f[0].trim(),d=f[1].trim(),!(c.length>2||0===Number(c)||Number(c)<1||Number(c)>12||2!==d.length&&4!==d.length)&&(d=2===d.length?"20"+d:d,e=b([d,c,"31"].join("-")),!e.isBefore(b())))}},ffMismatch:{errorMessage:"Mismatch",checkWhileTyping:!0,validator:function(){return!1}},ffValidating:{errorMessage:"Validating...",checkWhileTyping:!0,validator:function(){return!1}},ffInvalid:{errorMessage:"Invalid #",checkWhileTyping:!0,validator:function(){return!1}}}};d.$inject=["$scope","$parse","$timeout"],d.prototype.setValue=function(b,c){var d=this._fields[b];d&&a.isFunction(d.setValue)&&d.setValue(c)},d.prototype.clear=function(){for(var a in this._$scope.formHandler.fields){var b=this._$scope.formHandler.fields[a];b.value&&b.value.value?(b.setValue(""),b.setValidation&&b.setValidation()):b.value&&"function"==typeof b.resetValues?b.resetValues():b.value&&(b.value="",b.setValidation&&b.setValidation())}},d.prototype.register=function(b,c){var d=this._$scope.formHandler;this._fields[b]=c,d.fields[b]=c.values,c.fieldGroup&&(d.fieldGroups[c.fieldGroup]=d.fieldGroups[c.fieldGroup]||{},d.fieldGroups[c.fieldGroup][b]=c.values,!a.isUndefined(d.fieldGroupVisibility[c.fieldGroup])&&this.setGroupVisibility(c.fieldGroup,d.fieldGroupVisibility[c.fieldGroup]));for(var e,f=function(){this._onFieldChange(b),this._$timeout.cancel(e),e=this._$timeout(function(){e=null,this.validateForm()}.bind(this),200)}.bind(this),g=["value","isVisible","isValid"],h=this._watchers[b]?this._watchers[b]:[],i=0,j=g.length;i<j;i++){var k=this._$scope.$watch("formHandler.fields."+b+"."+g[i],f);h.push(k)}d.data[b]&&(c.setValue?c.setValue(d.data[b]):d.fields[b].value=d.data[b],c.validateValue&&c.validateValue(d.data[b]))},d.prototype._onFieldChange=function(a){var b=this._$scope.formHandler;b.data&&b.fields[a]&&(b.fields[a].value&&b.fields[a].value.value?b.data[a]=b.fields[a].value.value:b.data[a]=b.fields[a].value)},d.prototype._onSubmit=function(){this._$timeout(function(){if(this.validateForm()){var a=this._$scope.formHandler.onSuccess(this._$scope);a&&this.startLoading(a)}}.bind(this))},d.prototype._toggleDescribedbyAttr=function(a){var b=$(this._$scope.formHandler.form),c=$("[name="+a.name+"]",b),d=this._$scope.formHandler.submitButtonId;c&&d&&c.attr("aria-describedby",a.isValid?"":d)},d.prototype.validateForm=function(b){var c=!0,d=[];switch(a.forEach(this._$scope.formHandler.fields,function(a){if(a.isVisible){var b=c===!0&&a.isValid===!0;a.defaultSelect&&(a.isValid=!0),c=b,a.isValid||d.push(a),this._toggleDescribedbyAttr(a)}}.bind(this)),this._$scope.formHandler.valid=c,d.length){case 0:this._$scope.formHandler.submitButtonMessage=this._$scope.formHandler.submitMessage;break;case 1:d[0].overrideLabelPrefix&&d[0].readableLabel?this._$scope.formHandler.submitButtonMessage=d[0].readableLabel:this._$scope.formHandler.submitButtonMessage=d[0].readableLabel?"fix "+d[0].readableLabel:this._$scope.formHandler.submitErrorMessage;break;default:this._$scope.formHandler.submitButtonMessage=this._$scope.formHandler.submitErrorMessage}return!b&&this._$scope.formHandler.validChange&&this._$scope.formHandler.validChange({isValid:c}),c},d.prototype.startLoading=function(a){this._$scope.formHandler.isLoading=!0,this._$scope.formHandler.submitButtonMessage="loading",a.then(this.endLoading.bind(this),this.endLoading.bind(this))},d.prototype.endLoading=function(){this._$scope.formHandler.isLoading=!1,this.validateForm()},d.prototype.isGroupValid=function(b){if(this._$scope.formHandler.fieldGroups[b]){var c=!0;return a.forEach(this._$scope.formHandler.fieldGroups[b],function(a){a.isValid||(c=!1)}),c}},d.prototype.isGroupEmpty=function(b){var c=!0;if(this._$scope.formHandler.fieldGroups[b])return a.forEach(this._$scope.formHandler.fieldGroups[b],function(a){a.value&&(c=!1)}),c},d.prototype.setGroupVisibility=function(b,c){this._$scope.formHandler.fieldGroupVisibility[b]=!!c,a.forEach(this._$scope.formHandler.fieldGroups[b],function(a){a.setVisibility(!!c)})},d.prototype.updateMessages=function(a){this.validateForm(!0),this._$scope.formHandler.submitButtonMessage=a};var e=function(b,c,d,e){var f={};a.forEach(b.formHandler.fields,function(a,b){f[b]=a}),a.extend(b.formHandler,{form:c,fields:e._$parse(d.fields)(b)||{},data:e._$parse(d.data)(b)||{},iosRepaint:d.iosScrollRepaint||!1,onSuccess:e._$parse(d.onSuccess),submitMessage:d.submitMessage?d.submitMessage:"Continue",submitErrorMessage:d.submitErrorMessage?d.submitErrorMessage:"Complete form to continue",submitButtonId:d.submitButtonId,validChange:d.validChange?e._$parse(d.validChange).bind(null,b):null}),e._defaultMessages={success:b.formHandler.submitMessage,error:b.formHandler.submitErrorMessage},d.parentScope&&(e._$parse(d.parentScope)(b).formHandler=b.formHandler),Object.keys(f).length>0&&a.forEach(f,function(a,b){e.register(b,e._fields[b])}.bind(this)),c.submit(e._onSubmit.bind(e)),e.validateForm()};return c}),c("common/directives/form-input",["jquery","angular","modernizr"],function(a,b,c){"use strict";var d=function(){return{restrict:"A",replace:!0,scope:!0,transclude:!0,controller:e,templateUrl:"/app/common/directives/form-input.tpl.html",link:f}},e=function(b,d,e,f,g,h){this._$scope=b,this._$singleTimeout=e,this._$parse=d,this._$detection=f,this._scriptLoaderService=g,this._$window=a(window),this._accessibleService=h,this._defaultInvalidMessage="Pls fix",this._defaultValidMessage="Good",this._$scope.input={getValue:this.getValue.bind(this),isEmpty:this.isEmpty.bind(this),isValid:void 0,isOptional:!1,isVisible:!0,isMessagingVisible:!1,hasFocus:!1,validateValue:this.validateValue.bind(this),invalidMessage:this._defaultInvalidMessage,validMessage:this._defaultValidMessage,resetValidationRules:this.resetValidationRules.bind(this),setMaxLength:this.setMaxLength.bind(this),setValidation:this.setValidation.bind(this),setValidationRules:this.setValidationRules.bind(this),setVisibility:this.setVisibility.bind(this),isInputValid:this.isInputValid.bind(this),readValidationOnFocus:this.readValidationOnFocus.bind(this),toggleRequiredValidation:this.toggleRequiredValidation.bind(this),placeholderSupport:c.input.placeholder,showFakePlaceholder:!0},this.values=this._$scope.input,this._rules=this._$scope.formHandler.rules,this._$scope.$watch("input.validate",this._updateValidationFlags.bind(this),!0)};e.$inject=["$scope","$parse","$singleTimeout","$detection","scriptLoaderService","accessibleService"],e.prototype.getValue=function(){return this._$scope.input.value},e.prototype.isEmpty=function(){var a=this._$scope.input.value;return b.isUndefined(a)||""===a},e.prototype.readValidationOnFocus=function(b){function c(a,b){var c=b?b:"";return a+" on the "+c+" input."}var d,e=this._$scope.$parent.composite,f=a(b.currentTarget).parents(".input-composite"),g=f.find(".facade-form-input"),h=this._$scope.input.label;e&&e.isInvalid()&&!this._$scope.input.isOptional?(d=e.isValid()?"valid-message":"invalid-message",this._accessibleService.setText(c(g.data(d),g.data("label")))):this._$scope.input.isEmpty()||this._accessibleService.setText(c(this._$scope.input.message,h))},e.prototype.validateValue=function(a){this._$scope.input.change&&this._$scope.input.change();var c,d=!0;this._$scope.input.isMessagingVisible=!1,b.forEach(this._$scope.input.validate,function(b){var e=this._rules[b].validator(a,this._$scope.input);e||(d=!1,c||(c=this._rules[b].errorMessage)),this._rules[b].checkWhileTyping&&(this._$scope.input.isMessagingVisible=!e)}.bind(this)),d&&this._$scope.input.value?c=this._$scope.input.validMessage:this._$scope.input.invalidMessage!==this._defaultInvalidMessage?c=this._$scope.input.invalidMessage:this._$scope.input.isOptional&&0===a.length&&(c="optional",d=!0),this._$scope.input.readonly&&(d=!0),this.setValidation(d,c)},e.prototype.isInputValid=function(){var a=void 0===this._$scope.input.isValid,b=this._$scope.input.isOptional&&(!this._$scope.input.value||!this._$scope.input.value.length),c=this._$scope.input.readonly===!0;return a||b||c?void 0:this._$scope.input.isValid!==!1},e.prototype.setValidation=function(a,b){this._$scope.input.isValid=a,this._$scope.input.message=b},e.prototype.setMaxLength=function(a){this._$scope.input.maxLength=a},e.prototype.setValidationRules=function(a,b){this._$scope.input.validate=a.split(","),this._updateFlagsAndValidate(b)},e.prototype.toggleRequiredValidation=function(a){var b=this._$scope.input.validate,c=b?b.indexOf("optional"):-1,d=b?b.indexOf("required"):-1;c!==-1?b[c]=a:d!==-1?b[d]=a:b&&b.push(a),b=b&&b.join(","),this.setValidationRules(b,!0)},e.prototype.resetValidationRules=function(){this._$scope.input.validate=this._$scope.input.originalValidate.slice(0),this._updateFlagsAndValidate()},e.prototype._updateFlagsAndValidate=function(a){this._updateValidationFlags(this._$scope.input.validate);var b=this._$scope.input.validate.indexOf("optional")>-1,c=this._$scope.input.value;this._$scope.input.isOptional=b,c?this.validateValue(this._$scope.input.value):(this._$scope.input.isMessagingVisible=!!a||b,b||(this._$scope.input.isValid=!a&&void 0,a&&(this._$scope.input.message="required")))},e.prototype.setValue=function(a){this._$scope.input.value=a,this.validateValue(a),this._$scope.input.isMessagingVisible=!0},e.prototype._updateInputSize=function(){var b=a("input",this.iElem),c=a(".input-message-validate",this.iElem);this._$singleTimeout(function(){this._$scope.input.isMessagingVisible&&!this._$scope.input.hasInnerLabel?b.css("padding-right",c.outerWidth()):b.css("padding-right",b.css("padding-left"))}.bind(this))},e.prototype._updateValidationFlags=function(a){this._$scope.input.isOptional=a.indexOf("optional")!==-1,this._$scope.input.isOptional&&this.isEmpty()&&(this._$scope.input.message="optional",this._$scope.input.isValid=!0)},e.prototype.setVisibility=function(a){this._$scope.input.isVisible=a};var f=function(c,d,e,f){function g(){f._$singleTimeout(function(){this._$scope.input.hasFocus=!1,this._$scope.input.isMessagingVisible=!0,this._$scope.input.fakePlaceholder&&""===this._$scope.input.value&&(this._$scope.input.showFakePlaceholder=!0),this._updateInputSize()}.bind(f))}function h(){f._$singleTimeout(function(){this._$scope.input.hasFocus=!0,this._$scope.input.isMessagingVisible=!1,this._$scope.input.fakePlaceholder&&(this._$scope.input.showFakePlaceholder=!1),this._updateInputSize()}.bind(f))}function i(){!c.input.hasFocus&&g()}function j(){d.find("input").focus()}var k=["class","ngShow","validate","inputClass","inputHint","inputLabel","inputLabelClass","vxFormInput","inputReadonly"];f.iElem=d,b.forEach(e,function(b,c){c.indexOf("$")===-1&&k.indexOf(c)===-1&&a("input",d).attr(c,b)}),a("input",d).on("blur",g).on("focus",h).on("input",i);var l=e.readableLabel?e.readableLabel:e.inputLabel||e.placeholder;b.extend(c.input,{name:e.name,label:e.inputLabel,labelClass:e.inputLabelClass,inputClass:e.inputClass,inputHint:e.inputHint,placeholder:e.placeholder,fakePlaceholder:e.fakePlaceholder||!1,validate:e.validate.split(","),change:f._$parse(e.change)(c),execMethod:f._$parse(e.execMethod)(c),invalidMessage:e.invalidMessage||c.input.invalidMessage,validMessage:e.validMessage||c.input.validMessage,readableLabel:l,originalValidate:e.validate.split(","),overrideLabelPrefix:e.overrideLabelPrefix||!1,maxLength:e.maxlength||"",autocomplete:f._$detection.isFirefox()||"off"===e.autocomplete?"off":"on",readonly:f._$parse(e.inputReadonly)(c),ngFocus:f._$parse(e.ngFocus)(c),ngBlur:f._$parse(e.ngBlur)(c),autocompletetype:e.inputAutocompletetype,hasInnerLabel:e.hasInnerLabel,focus:j}),f.fieldGroup=e.fieldGroup,"undefined"!=typeof e.isVisible&&(c.input.isVisible=f._$parse(e.isVisible)(c)),c.input.isMessagingVisible=c.input.validate.indexOf("optional")>-1&&!c.input.readonly,c.formHandler.register(c.input.name,f),c.input.triggerPlaceholderPolyfill=function(){!c.input.placeholderSupport&&f._scriptLoaderService.isLoaded("/scripts/placeholder-polyfill.min.js")&&f._$singleTimeout(function(){var a=d.find("input");b.isUndefined(a[0].attributes.placeholder)&&(a[0].attributes.placeholder={value:c.input.placeholder}),a.placeHolder({className:"placeholder-polyfill"})}.bind(this))},c.input.triggerPlaceholderPolyfill()};return d}),c("common/directives/form-input-composite",["angular","jquery"],function(a,b){"use strict";var c=function(){return{restrict:"A",scope:!0,transclude:"element",controller:d,compile:e}},d=function(a,b,c){this._$scope=a,this._$parse=b,this._$compile=c,this._requiredFields=[],this._$scope.composite={isValid:this.isValid.bind(this),isInvalid:this.isInvalid.bind(this)}};d.prototype.isValid=function(){return this._requiredFields.every(function(a){var b=this._$scope.formHandler.fields[a];return b.isValid===!0}.bind(this))},d.prototype.isInvalid=function(){return this._areAnyFieldsInvalid()||this._areSomeValidSomeEmpty()},d.prototype._areAnyFieldsInvalid=function(){return this._requiredFields.some(function(a){var b=this._$scope.formHandler.fields[a];return b.isValid===!1}.bind(this))},d.prototype._areSomeValidSomeEmpty=function(){var a=this._requiredFields.some(function(a){var b=this._$scope.formHandler.fields[a];return b.isValid===!0}.bind(this)),b=this._requiredFields.some(function(a){var b=this._$scope.formHandler.fields[a];return!b.getValue()}.bind(this));return a&&b};var e=function(c,d,e){return function(c,d,f,g){function h(){var a=b(q.find("input")[0]);n.addClass("is-focused"),a.focus()}function i(){n.addClass("is-focused")}function j(){n.removeClass("is-focused")}function k(){if("undefined"!=typeof q){var a=q.find("input").map(function(a,b){return b.value}).get();return a.filter(function(a){return a}).join(" ")}}a.extend(c.composite,{focusContainer:i,blurContainer:j,focusFirstField:h,getCompositeValue:k});var l,m=f.readonly&&g._$parse(f.readonly)(c),n=b('<div class="input-composite cf" />');m||n.attr("ng-class","{ 'is-valid': composite.isValid(),'is-invalid': composite.isInvalid() }");var o=b('<div class="input-composite__composite" />');n.append(o);var p=b("<div data-vx-form-input-facade />");p.attr({"data-label":f.compositeLabel,"data-fetch-value":"composite.getCompositeValue","data-input-class":"form__input--no-padding input-inline","data-invalid-message":f.compositeInvalidMessage,"data-name":f.compositeName,"data-placeholder":f.compositePlaceholder,"data-valid-message":f.compositeValidMessage}),m?p.attr("data-disabled",!0):p.attr("ng-click","composite.focusFirstField"),o.append(p);var q=b('<div class="input-composite__fields" />');n.append(q),e(c,function(a){var c=b(b.clone(a[0])).find(".form__input");l=c.length,c.each(function(a,c){c=b(c),c.attr({"data-input-class":"form__input--no-padding","data-ng-focus":"composite.focusContainer","data-ng-blur":"composite.blurContainer"}),m&&c.attr("tabindex","-1");var d=b('<div class="input-inline" />');a===l-1&&d.addClass("is-last-child"),c.data("validate").indexOf("required")!==-1&&g._requiredFields.push(c.attr("name")),d.append(c),q.append(d)}.bind(this))}.bind(this)),d.after(g._$compile(n)(c))}};return d.$inject=["$scope","$parse","$compile"],c}),c("common/directives/form-input-facade",["angular"],function(a){"use strict";var b=function(){return{controller:c,link:d,restrict:"A",replace:!0,scope:!0,templateUrl:"/app/common/directives/form-input-facade.tpl.html"}},c=function(a,b,c){this._$scope=a,this._$parse=b,this._pubSubService=c,this._invalidMessageOverride=null,this._$scope.facadeInput={getInvalidMessage:this.getInvalidMessage.bind(this),getValue:this.getValue.bind(this),isPlaceholder:this.isPlaceholder.bind(this)}};c.prototype.getValue=function(){var a=this._$scope.facadeInput;return a.value||a.fetchValue()||a.placeholder},c.prototype.getInvalidMessage=function(){var a=this._$scope.facadeInput;return this._invalidMessageOverride||a.invalidMessage},c.prototype.isPlaceholder=function(){var a=this._$scope.facadeInput;return a.placeholder&&a.getValue()===a.placeholder||"000000000"===a.getValue()},c.$inject=["$scope","$parse","pubSubService"];var d=function(b,c,d,e){a.extend(b.facadeInput,{label:d.label,fetchValue:e._$parse(d.fetchValue)(b),inputClass:d.inputClass,invalidMessage:d.invalidMessage,name:d.name,ngBlur:e._$parse(d.ngBlur)(b),ngClick:e._$parse(d.ngClick)(b),ngFocus:e._$parse(d.ngFocus)(b),placeholder:d.placeholder,disabled:e._$parse(d.disabled)(b),validMessage:d.validMessage,value:d.value}),b.facadeInput.name&&(e._pubSubService.subscribe("facadeInput."+b.facadeInput.name+".setInvalidMessageOverride",function(a){e._invalidMessageOverride=a}.bind(e)),e._pubSubService.subscribe("facadeInput."+b.facadeInput.name+".resetInvalidMessageOverride",function(){e._invalidMessageOverride=null}.bind(e)))};return b}),c("common/directives/form-select-array",["angular","jquery"],function(a,b){"use strict";var c=function(){return{restrict:"A",replace:!0,scope:!0,controller:d,templateUrl:"/app/common/directives/form-select-array.tpl.html",link:e}},d=function(a,b,c,d){this._$scope=a,this._$parse=b,this._$singleTimeout=c,this._travelerService=d,this._$scope.select={hasTitle:!1,isClean:!0,isFocused:!1,isValid:void 0,isVisible:!0,isOptional:!1,validateValue:this.validateValue.bind(this),setVisibility:this.setVisibility.bind(this),setValidation:this.setValidation.bind(this),setValidationRules:this.setValidationRules.bind(this),setValue:this.setValue.bind(this),setDefault:this.setDefault.bind(this),setDisabled:this.setDisabled.bind(this),disabled:!1,refresh:this.refresh.bind(this),value:""},this._rules=this._$scope.formHandler.rules,this.values=this._$scope.select};d.$inject=["$scope","$parse","$singleTimeout","travelerService"],d.prototype.validateValue=function(b){this._$scope.select.change&&this._$scope.select.change();var c=!0;a.forEach(this._$scope.select.validate,function(a){var d=this._rules[a].validator(b,this._$scope.select);d||(c=!1)}.bind(this)),b?this._$scope.select.isClean=!1:this._$scope.select.isClean=!0,this.setValidation(c)},d.prototype.setVisibility=function(a){this._$scope.select.isVisible=a,a&&this.refresh()},d.prototype.setDisabled=function(a){this._$scope.select.disabled=a,this.refresh()},d.prototype.setValue=function(a){var b=this._setValueFromOptions(a);b||(b=this._resetTravelerTypeOptions(a)&&this._setValueFromOptions(a),b||(this._$scope.select.value="",this.validateValue("")))},d.prototype._setValueFromOptions=function(a){return this._$scope.select.options.some(function(b){if(b.value===a)return this._$scope.select.value=b,this.validateValue(a),this.refresh(),!0}.bind(this))},d.prototype._resetTravelerTypeOptions=function(a){if("travelerType"===this._$scope.select.name)return this._$scope.select.options=[this._travelerService.allPaxTypes[a]],!0},d.prototype.setDefault=function(a){this.setValue(this._$scope.select.options[a].value)},d.prototype.setValidationRules=function(a,b){var c=/optional/.test(a);this._$scope.select.validate=a.split(","),this._$scope.select.isOptional=c,this._$scope.select.value?this.validateValue(this._$scope.select.value):c?this._$scope.select.isValid=!0:this._$scope.select.isValid=!b&&void 0},d.prototype.refresh=function(){this._$singleTimeout(function(){this._$scope.select.isFocused=!0,this._selectElm.trigger("render.customSelect"),this._selectElm.trigger("render.customSelect")}.bind(this))},d.prototype.setValidation=function(a){this._$scope.select.isValid=a};var e=function(c,d,e,f){a.extend(c.select,{name:e.selectName,selectClass:e.selectClass?e.selectClass:"select",title:e.selectTitle,defaultSelect:e.defaultSelect,hasTitle:!!e.selectTitle,options:f._$parse(e.selectOptions)(c),change:f._$parse(e.change)(c),execMethod:f._$parse(e.execMethod)(c),validate:e.validate.split(","),readableLabel:e.selectTitle,instantValidate:e.instantValidate,disableable:!!e.disableable,disabled:!!e.disabled}),"undefined"!=typeof e.isVisible&&(c.select.isVisible=f._$parse(e.isVisible)(c)),f.fieldGroup=e.fieldGroup,f.iElem=d,f._selectElm=b("select",d),b("select",d).on("click, focus",function(){f._$singleTimeout(function(){c.select.isFocused=!0})}),!c.select.isVisible&&"dateAlt"!==c.select.name&&a.extend(c.select,{value:c.select.options[0],isValid:!0}),c.select.defaultSelect&&(c.select.setDefault(c.select.defaultSelect),c.select.isValid=!0),c.$watch(function(){return c.select.options},function(){var a=c.select.disableable&&1===c.select.options.length,b=a||c.select.disabled?"disabled":"";f._selectElm.prop("disabled",b),c.select.isOptional=c.select.validate.indexOf("optional")>-1||a}),c.select.isOptional=c.select.validate.indexOf("optional")>-1,c.select.isValid=!!c.select.isOptional||void 0,c.formHandler.register(c.select.name,f),c.select.instantValidate&&c.select.options.length>0&&c.select.setValue(c.select.options[0].value)};return c}),c("common/directives/form-select-object",["angular","jquery"],function(a,b){"use strict";var c=function(){return{restrict:"A",replace:!0,scope:!0,controller:d,templateUrl:"/app/common/directives/form-select-object.tpl.html",link:e}},d=function(a,b,c){this._$scope=a,this._$parse=b,this._$timeout=c,this._$scope.select={hasTitle:!1,isFocused:!1,isValid:void 0,isVisible:!0,isOptional:!1,validateValue:this.validateValue.bind(this),setVisibility:this.setVisibility.bind(this),setValidationRules:this.setValidationRules.bind(this),setValue:this.setValue.bind(this),setDisabled:this.setDisabled.bind(this),refresh:this.refresh.bind(this),value:""},this.values=this._$scope.select,this._rules=this._$scope.formHandler.rules};d.$inject=["$scope","$parse","$timeout"],d.prototype.validateValue=function(b){this._$scope.select.change&&this._$scope.select.change();var c=!0;a.forEach(this._$scope.select.validate,function(a){var d=this._rules[a].validator(b,this._$scope.select);d||(c=!1)}.bind(this)),this.setValidation(c)},d.prototype.setVisibility=function(a){this._$scope.select.isVisible=a,a&&this.refresh()},d.prototype.setDisabled=function(a){this._$scope.select.disabled=a,this.refresh()},d.prototype.setValue=function(a){var b=!1,c=this._$scope.select.options;for(var d in this._$scope.select.options){var e=c[d];e.value===a&&(b=!0,this._$scope.select.value=e,this.validateValue(a),this.refresh())}b||(this._$scope.select.value="",this.validateValue(""),this.refresh())},d.prototype.setValidationRules=function(a){this._$scope.input.validate=a.split(","),""!==this.value&&this.validateValue(this.value)},d.prototype.refresh=function(){this._$timeout(function(){this._selectElm.trigger("render.customSelect"),this._selectElm.trigger("render.customSelect")}.bind(this))},d.prototype.setValidation=function(a){this._$scope.select.isValid=a};var e=function(c,d,e,f){var g=void 0!==e.isVisible?f._$parse(e.isVisible)(c):b("select",d).is(":visible");a.extend(c.select,{name:e.selectName,selectClass:e.selectClass?e.selectClass:"select",title:e.selectTitle,hasTitle:!!e.selectTitle,options:f._$parse(e.selectOptions)(c),change:f._$parse(e.change)(c),execMethod:f._$parse(e.execMethod)(c),validate:e.validate.split(","),readableLabel:e.selectTitle,isVisible:g}),f._selectElm=b("select",d),b("select",d).on("click, focus",function(){f._$timeout(function(){c.select.isFocused=!0})}),c.select.isVisible||a.extend(c.select,{value:c.select.options[0],isValid:!0}),c.select.isOptional=c.select.validate.indexOf("optional")>-1,c.select.isValid=!!c.select.isOptional||void 0,c.formHandler.register(c.select.name,f)};return c}),c("common/directives/form-select-facade",["angular"],function(a){"use strict";var b=function(){return{restrict:"A",replace:!0,scope:!0,controller:c,templateUrl:"/app/common/directives/form-select-facade.tpl.html",link:d}},c=function(a,b){this._$scope=a,this._$parse=b,this._configMap={CREDIT_CARD:{typeProperty:"type",idProperty:"sequenceNum",showCCIcon:!0,getNickname:function(a){return"x-"+a.ccNumber.slice(a.ccNumber.length-4)}},ADDRESS:{typeProperty:"addressType",idProperty:"sequenceNum",getNickname:function(a){var b=a.addressTwo?a.addressOne+" "+a.addressTwo:a.addressOne,c=a.state?a.state+" "+a.zipCode:a.zipCode,d=[b,a.city,c];return"US"!==a.country&&d.push(a.country),d.join(", ")}}},this._$scope.facade={isOpen:!1,onClick:this.onClick.bind(this),selectedId:null,formattedOptions:[],hiddenOptions:[]}};c.prototype.onClick=function(a){var b=this._$scope.facade;b.canOpen(this._$scope)&&(b.isOpen&&this._select(a),b.isOpen=!b.isOpen)},c.prototype._select=function(a){var b=this._$scope.facade;b.selectedId=a.id,this._$scope.formHandler.fields[b.selectName].setValue(a.value)},c.$inject=["$scope","$parse"];var d=function(b,c,d,e){var f=e._$parse(d.options)(b);a.extend(b.facade,{config:e._configMap[d.type],selectName:d.selectName,canOpen:e._$parse(d.canOpen)}),f.forEach(function(a,c){b.facade.formattedOptions.push({type:a[b.facade.config.typeProperty],nickname:b.facade.config.getNickname(a),id:a[b.facade.config.idProperty],value:a}),0===c&&(b.facade.selectedId=a[b.facade.config.idProperty]),b.facade.hiddenOptions.push({name:a[b.facade.config.idProperty],value:a})})};return b}),c("common/directives/country-select",["angular","jquery"],function(a,b){"use strict";var c=function(){return{restrict:"A",replace:!0,scope:!0,controller:d,templateUrl:"/app/common/directives/country-select.tpl.html",link:e}},d=function(a,b,c){this._$scope=a,this._$parse=b,this._$timeout=c,this._$scope.select={hasTitle:!1,isFocused:!1,isValid:void 0,isVisible:!0,validateValue:this.validateValue.bind(this),setVisibility:this.setVisibility.bind(this),setValidationRules:this.setValidationRules.bind(this),refresh:this.refresh.bind(this),value:""},this.values=this._$scope.select,this._rules=this._$scope.formHandler.rules,this._$scope.$watch("select.options",function(a){a&&1===a.length&&this.setValue(a[0].value)}.bind(this))};d.$inject=["$scope","$parse","$timeout"],d.prototype.validateValue=function(b){this._$scope.select.change&&this._$scope.select.change();var c=!0;a.forEach(this._$scope.select.validate,function(a){var d=this._rules[a].validator(b,this._$scope.select);d||(c=!1)}.bind(this)),this.setValidation(c)},d.prototype.setVisibility=function(a){this._$scope.select.isVisible=a,a&&this.refresh()},d.prototype.setValue=function(b){a.forEach(this._$scope.select.options,function(a){a.value===b&&(this._$scope.select.value=a)}.bind(this)),this.validateValue(b),this._$timeout(function(){this._$scope.select.isFocused=!0,this.refresh()}.bind(this))},d.prototype.setValidationRules=function(a){this._$scope.input.validate=a.split(","),""!==this.value&&this.validateValue(this.value)},d.prototype.refresh=function(){this._$timeout(function(){this._selectElm.trigger("render.customSelect"),this._selectElm.trigger("render.customSelect")}.bind(this))},d.prototype.setValidation=function(a){this._$scope.select.isValid=a};var e=function(c,d,e,f){f._selectElm=b("select",d);var g=void 0!==e.isVisible?f._$parse(e.isVisible)(c):f._selectElm.is(":visible");a.extend(c.select,{name:e.selectName,selectClass:e.selectClass?e.selectClass:"select",title:e.selectTitle,hasTitle:!!e.selectTitle,options:f._$parse(e.selectOptions)(c),change:f._$parse(e.change)(c),execMethod:f._$parse(e.execMethod)(c),validate:e.validate.split(","),readableLabel:e.selectTitle,isVisible:g}),f._selectElm.on("click, focus",function(){f._$timeout(function(){c.select.isFocused=!0})}),c.select.isVisible||a.extend(c.select,{value:c.select.options[0],isValid:!0}),c.select.isValid=c.select.validate.indexOf("optional")>-1||void 0,c.formHandler.register(c.select.name,f),c.$on("$destroy",function(){f._selectElm.off()})};return c}),c("common/directives/form-radio",["angular"],function(a){"use strict";var b=function(){return{restrict:"A",replace:!0,scope:!0,controller:c,link:d}},c=function(a,b,c){this._$scope=a,this._$timeout=b,this._$scope.radio={isValid:!1,isVisible:!0,setVisibility:this.setVisibility.bind(this),validateValue:this.validateValue.bind(this),onSelect:this.onSelect.bind(this),value:""},this.values=this._$scope.radio,this._rules=this._$scope.formHandler.rules,c.subscribe("travelInsurance.hide",function(){this.setVisibility(!1)}.bind(this))};c.$inject=["$scope","$timeout","pubSubService"],c.prototype.validateValue=function(b){var c=!0;a.forEach(this._$scope.radio.validate,function(a){this._rules[a].validator(b)||(c=!1)}.bind(this)),this._$scope.radio.value=b,this._$scope.radio.isValid=c},c.prototype.setVisibility=function(a){this._$scope.radio.isVisible=a},c.prototype.onSelect=function(a){this._$scope.radio.value=a,this.validateValue(a)};var d=function(b,c,d,e){a.extend(b.radio,{name:d.radioName,validate:d.validate.split(","),readableLabel:d.radioLabel}),e._$timeout(function(){b.formHandler.register(b.radio.name,e),d.radioValue&&e.validateValue(d.radioValue)})};return b}),c("common/directives/form-checkbox",["jquery","angular"],function(a,b){"use strict";var c=function(){return{restrict:"A",replace:!0,scope:!0,transclude:!0,controller:d,templateUrl:"/app/common/directives/form-checkbox.tpl.html",link:e}},d=function(a,b,c){this._$scope=a,this._$timeout=b,this._$parse=c,this.test="LOREM",this._$scope.checkbox={isValid:void 0,isOptional:!1,isVisible:!0,setValidation:this.setValidation.bind(this),setVisibility:this.setVisibility.bind(this),validateValue:this.validateValue.bind(this),isInputValid:this.isInputValid.bind(this)},this.values=this._$scope.checkbox};d.$inject=["$scope","$timeout","$parse"],d.prototype.validateValue=function(){var a=this._$scope.checkbox.isOptional||this._$scope.checkbox.value;this.setValidation(a)},d.prototype.isInputValid=function(){var a=void 0===this._$scope.checkbox.isValid,b=this._$scope.checkbox.isOptional&&!this._$scope.checkbox.value;return a||b?void 0:this._$scope.checkbox.isOptional||this._$scope.checkbox.isValid},d.prototype.setValidation=function(a){this._$scope.checkbox.isValid=a},d.prototype.setVisibility=function(a){this._$scope.checkbox.isVisible=a};var e=function(c,d,e,f){var g=["class","ngShow","inputClass","inputLabel","vxFormInput"];f.iElem=d,b.forEach(e,function(b,c){c.indexOf("$")===-1&&g.indexOf(c)===-1&&a("input",d).attr(c,b)});var h=void 0!==e.isVisible?f._$parse(e.change)(c):a("input",d).is(":visible");b.extend(c.checkbox,{name:e.name,label:e.inputLabel,inputClass:e.inputClass,isOptional:void 0!==e.isOptional&&e.isOptional.length>0,readableLabel:e.readableLabel||e.placeholder||e.inputLabel,overrideLabelPrefix:e.overrideLabelPrefix||!1,isVisible:h,checkedDefault:e.checkedDefault||!1}),c.checkbox.isOptional&&(c.checkbox.isValid=!0),c.checkbox.checkedDefault&&(c.checkbox.isValid=!0,c.checkbox.value=!0),c.formHandler.register(c.checkbox.name,f)};return c}),c("common/directives/form-creditcard",["angular"],function(a){"use strict";var b=function(){return{restrict:"A",replace:!0,scope:{formHandler:"=",name:"@",inputLabel:"@",inputClass:"@",placeholder:"@",hasInnerLabel:"=",fieldGroup:"@",ccType:"=",inputReadonly:"="},controller:c,templateUrl:"/app/common/directives/form-creditcard.tpl.html",link:d}},c=function(a,b){this._$scope=a,this._$singleTimeout=b,this._$scope.cc={creditCardEntered:!1,creditCardValid:void 0},this._creditCardNotFoundMessage="Invalid card #",this._cardPatterns={visa:new RegExp("^4"),amex:new RegExp("^(34|37)"),mastercard:{test:function(a){if(/^5[1-5]/.test(a))return!0;var b=parseInt(a.substr(0,6),10);return b>=222100&&b<=272099}},discover:new RegExp("^(6011|65|64[4-9]|622(1(2[6-9]|[3-9])|[2-8]{2}|9([01]|2[0-5])))"),uatp:new RegExp("^1")}};c.$inject=["$scope","$singleTimeout"],c.prototype._getCardType=function(b){if(b){var c;return a.forEach(this._cardPatterns,function(a,d){a.test(b)&&(c=d)}),c}},c.prototype._changeCreditCardHandler=function(b){var c,d=this._$scope.formHandler.fields[this._$scope.name];
"undefined"!=typeof d&&this._$singleTimeout(function(){a.extend(this._$scope.cc,{creditCardEntered:b>0,creditCardValid:d.isValid}),this._$scope.inputReadonly||(c=this._getCardType(b),this._$scope.cc.creditCardType=c,this._$scope.formHandler.data.ccType=c),!this._$scope.ccType&&!c&&d.setValidation(!1,this._creditCardNotFoundMessage),this._updateSecurityNumber()}.bind(this))},c.prototype._updateSecurityNumber=function(){var a=this._$scope.formHandler.fields.securityNumber,b=this._$scope.cc.creditCardType;"undefined"!=typeof a&&b&&("uatp"===b.toLowerCase()?(a.setVisibility(!1),a.setValidationRules("optional")):"amex"===b.toLowerCase()?(a.setMaxLength(4),a.setValidationRules("required,securityFourDigit")):(a.setMaxLength(3),a.setValidationRules("required,securityThreeDigit")))};var d=function(a,b,c,d){a.ccType&&(a.cc.creditCardType=a.ccType),a.$watch("formHandler.fields."+a.name+".value",d._changeCreditCardHandler.bind(d))};return b}),c("common/directives/form-textarea",["jquery","angular"],function(a,b){"use strict";var c=function(){return{restrict:"A",replace:!0,scope:!0,controller:d,templateUrl:"/app/common/directives/form-textarea.tpl.html",link:e}},d=function(a,b){this._$scope=a,this._$timeout=b,this._$scope.textarea={isValid:void 0,isVisible:!0,isMessagingVisible:!1,validateValue:this.validateValue.bind(this)},this.values=this._$scope.textarea,this._rules=this._$scope.formHandler.rules};d.$inject=["$scope","$timeout"],d.prototype.validateValue=function(a){var c=!0;b.forEach(this._$scope.textarea.validate,function(b){var d=this._rules[b].validator(a,this._$scope.textarea);d||(c=!1)}.bind(this)),this._$scope.textarea.isValid=c};var e=function(c,d,e,f){b.extend(c.textarea,{name:e.inputName,label:e.inputLabel,hiddenLabel:e.inputHiddenLabel,hasLabel:!!e.inputLabel,validate:e.validate.split(",")}),a("textarea",d).on("blur",function(){f._$timeout(function(){c.textarea.isMessagingVisible=!0}.bind(f))}).on("focus",function(){f._$timeout(function(){c.textarea.isMessagingVisible=!1}.bind(f))}),c.formHandler.register(c.textarea.name,f)};return c}),c("common/directives/form-dob",["angular","moment"],function(a,b){"use strict";var c=function(){return{controller:d,link:e,restrict:"A",replace:!0,scope:{disabled:"=",travelerType:"=",formHandler:"=",day:"@",month:"@",placeholder:"@",onValid:"&",year:"@",compareDate:"=",isLoggedIn:"&"},templateUrl:"/app/common/directives/form-dob.tpl.html"}},d=function(c,d,e,f,g,h,i){this._$scope=c,this._$singleTimeout=d,this._$parse=e,this._elevateService=f,this._pubSubService=g,this._windowService=h,this._resourceBundle=i,this._$window=$(window),this._isLoggedIn=a.isUndefined(this._$scope.isLoggedIn())?this._elevateService.isLoggedIn:this._$scope.isLoggedIn,c.dob={isFocused:!1,isValid:void 0,isVisible:!0,value:"",validate:["required"],readableLabel:c.placeholder},c.months=this._resourceBundle.months,c.days=[],this._travelerTypes={ADULT:"adult",CHILD:"child",INFANT:"infant",PRIMARY:"primary"},this._travelerTypeDateRanges={adult:{startDate:b(this._$scope.compareDate).subtract("years",this._resourceBundle.ages.MAX_ADULT_AGE_YEARS),endDate:b(this._$scope.compareDate).subtract("years",this._resourceBundle.ages.MIN_ADULT_AGE_YEARS)},child:{startDate:b(this._$scope.compareDate).subtract("years",this._resourceBundle.ages.MIN_ADULT_AGE_YEARS),endDate:b(this._$scope.compareDate).subtract("years",this._resourceBundle.ages.MIN_CHILD_AGE_YEARS)},infant:{startDate:b(this._$scope.compareDate).subtract("years",this._resourceBundle.ages.MIN_CHILD_AGE_YEARS),endDate:b(this._$scope.compareDate).add("months",this._resourceBundle.ages.MAX_INFANT_MONTHS_IN_FUTURE)}},c.$watch("travelerType",function(a,b){a!==b&&this.resetValues(),this._$singleTimeout(function(){var b="primary"===a&&!this._isLoggedIn(),c=b?"adult":a;switch(c){case this._travelerTypes.ADULT:case this._travelerTypes.PRIMARY:this.startDate=this._travelerTypeDateRanges.adult.startDate,this.endDate=this._travelerTypeDateRanges.adult.endDate;break;case this._travelerTypes.CHILD:this.startDate=this._travelerTypeDateRanges.child.startDate,this.endDate=this._travelerTypeDateRanges.child.endDate;break;case this._travelerTypes.INFANT:this.startDate=this._travelerTypeDateRanges.infant.startDate,this.endDate=this._travelerTypeDateRanges.infant.endDate;break;default:this.startDate=this._travelerTypeDateRanges.adult.startDate,this.endDate=this._travelerTypeDateRanges.infant.endDate}this.generateYears(),this.validate()}.bind(this))}.bind(this)),c.dateChanged=this.dateChanged.bind(this),this.values=c.dob,c.formHandler.register("dob",this)};d.$inject=["$scope","$singleTimeout","$parse","elevateService","pubSubService","windowService","ResourceBundle"],d.prototype.generateDays=function(){var c,d=[];if(!a.isObject(this._$scope.month))return!1;c=this._$scope.month.value,c=c<10?"0"+c:c;for(var e=this._$scope.year||b().format("YYYY"),f=b(e+"-"+c+"-01").daysInMonth(),g=1,h=f;g<=h;g++)d.push(g);return this._$scope.days=d,d},d.prototype.generateYears=function(){for(var a=[],b=this.endDate.format("YYYY");b>=this.startDate.format("YYYY");b--)a.push(b);this._$scope.years=a},d.prototype.validate=function(){var a=this._$scope.day,c=!!this._$scope.month&&this._$scope.month.value;if(a&&c&&this._$scope.year){a=a<10?"0"+a:a,c=c<10?"0"+c:c;var d=this._$scope.year+"-"+c+"-"+a,e=b(d);e>=this.startDate&&e<=this.endDate?(this.setValidation(!0),this._$scope.dob.value=d):(this.setValidation(!1),this._$scope.dob.value="")}else this._$scope.dob.isValid&&(this.setValidation(!1),this._$scope.dob.value="")},d.prototype.setValue=function(a){var b=a.split("-");if(b.length<3)return!1;var c=b[2],d=b[1],e=b[0];this._$singleTimeout(function(){this._$scope.month=this._$scope.months[parseInt(d,10)-1],this.generateDays(),this._$scope.day=parseInt(c,10),this._$scope.year=parseInt(e,10),this._$scope.updateCustomSelects(),this.validate()}.bind(this))},d.prototype.validateValue=function(){this.validate()},d.prototype.resetDays=function(){this._$scope.day=0,this._$scope.updateCustomSelects()},d.prototype.dateChanged=function(){var a=this.generateDays();(!a||a.indexOf(this._$scope.day)<0)&&this.resetDays(),this.validate()},d.prototype.resetValues=function(){$.extend(this._$scope,{day:0,month:0,year:0}),this._$scope.dob.value="",this.setValidation(null),this._$scope.updateCustomSelects()},d.prototype.setValidation=function(a){this._$scope.dob.isValid=a},d.prototype._setDefaultMonth=function(a){this._$singleTimeout(function(){this._$scope.month=this._$scope.months[parseInt(a,10)-1],this.generateDays(),this._$scope.updateCustomSelects()}.bind(this))},d.prototype._addBreakpointSubscription=function(){this._pubSubService.subscribe("windowService.breakpoint",function(a){var b=parseInt(this._$scope.month.value,10)-1;this._$scope.month={},this._setMonthsFromBreakpoint(a),this._$scope.month=this._$scope.months[b],this._$singleTimeout(this._$scope.updateCustomSelects.bind(this))}.bind(this))},d.prototype._setMonthsFromBreakpoint=function(a){this._$scope.months="small"===a?this._resourceBundle.months:this._resourceBundle.longMonths};var e=function(b,c,d,e){var f;a.extend(b.dob,{eyebrowArray:d.eyebrow?d.eyebrow.split(","):[],inline:e._$parse(d.inline)(b),innerPlaceholderArray:d.innerPlaceholder?d.innerPlaceholder.split(","):[],inputClass:d.inputClass||"form__input--tight",selectInlineClass:d.selectInlineClass}),d.defaultMonth&&e._setDefaultMonth(d.defaultMonth),e._$parse(d.longMonths)(b)&&(e._addBreakpointSubscription(),e._setMonthsFromBreakpoint(e._windowService.breakpoint())),b.$watch("disabled",function(a){f=a?"addClass":"removeClass",c[f]("is-disabled"),c.find("select").prop("disabled",a)}),c.find("select").on("focus mousedown",function(a){b.disabled&&a.preventDefault()}),b.updateCustomSelects=function(a){e._$singleTimeout(function(){a.find("select").trigger("render.customSelect")})}.bind(null,c)};return c}),c("common/directives/form-date",["angular","moment"],function(a,b){"use strict";var c=function(){return{controller:d,link:e,restrict:"A",replace:!0,scope:{disabled:"=",travelerType:"=",formHandler:"=",validate:"@",day:"@",month:"@",placeholder:"@",onValid:"&",year:"@",name:"@",label:"@",startDate:"=",endDate:"="},templateUrl:"/app/common/directives/form-date.tpl.html"}},d=function(a,b,c,d,e,f){this._$scope=a,this._$singleTimeout=b,this._$parse=c,this._pubSubService=d,this._windowService=e,this._resourceBundle=f,this._$scope.date={isFocused:!1,isValid:void 0,isVisible:!0,isOptional:!1,value:void 0,readableLabel:this._$scope.placeholder,resetValues:this.resetValues.bind(this),setValidationRules:this.setValidationRules.bind(this)},this._$scope.months=this._resourceBundle.months,this._$scope.days=[],this._$scope.date.dateChanged=this.dateChanged.bind(this),this._$scope.date.isOptional="optional"===this._$scope.validate,this._$scope.date.isOptional&&this.setValidation(!0),this.values=this._$scope.date,this._$scope.formHandler.register(this._$scope.name,this),this._$scope.$watch("startDate",this._onDatesChange.bind(this)),this._$scope.$watch("endDate",this._onDatesChange.bind(this))};d.$inject=["$scope","$singleTimeout","$parse","pubSubService","windowService","ResourceBundle"],d.prototype._onDatesChange=function(){this.resetValues(),this.startDate=this._$scope.startDate,this.endDate=this._$scope.endDate,this.startDate&&this.endDate&&this.generateYears()},d.prototype.generateDays=function(){var c,d=[];if(!a.isObject(this._$scope.month))return!1;c=this._$scope.month.value,c=c<10?"0"+c:c;for(var e=this._$scope.year||b().format("YYYY"),f=b(e+"-"+c+"-01").daysInMonth(),g=1,h=f;g<=h;g++)d.push(g);return this._$scope.days=d,d},d.prototype.generateYears=function(){var a,b=[];if(parseInt(this.startDate.format("YYYY"))<parseInt(this.endDate.format("YYYY")))for(a=this.startDate.format("YYYY");a<this.endDate.format("YYYY");a++)b.push(a);else for(a=this.startDate.format("YYYY");a>=this.endDate.format("YYYY");a--)b.push(a);this._$scope.years=b},d.prototype.validate=function(){var a=this._$scope.day,b=!!this._$scope.month&&this._$scope.month.value;a&&b&&this._$scope.year?(this.setValidation(!0),a=a<10?"0"+a:a,b=b<10?"0"+b:b,this._$scope.date.value=this._$scope.year+"-"+b+"-"+a):this._$scope.date.isValid&&(this.setValidation(!1),this._$scope.date.value=void 0),this._$scope.date.isOptional&&this.setValidation(!0)},d.prototype.setValue=function(a){var b=a.split("-");if(b.length<3)return!1;var c=b[2],d=b[1],e=b[0];this._$singleTimeout(function(){this._$scope.month=this._$scope.months[parseInt(d,10)-1],this.generateDays(),this._$scope.day=parseInt(c,10),this._$scope.year=parseInt(e,10),this._$scope.updateCustomSelects(),this.validate()}.bind(this),1e3)},d.prototype.setValidationRules=function(a,b){this._$scope.date.isOptional=/optional/.test(a),this.values.value?this.validate():this._$scope.date.isOptional?this._$scope.date.isValid=!0:this._$scope.date.isValid=!b&&void 0},d.prototype.resetDays=function(){this._$scope.day=0,this._$scope.updateCustomSelects()},d.prototype.dateChanged=function(){var a=this.generateDays();(!a||a.indexOf(this._$scope.day)<0)&&this.resetDays(),this.validate()},d.prototype.resetValues=function(){this._$scope.day=0,this._$scope.month=0,this._$scope.year=0,this._$scope.date.value=void 0,this.setValidation(null),this._$scope.updateCustomSelects()},d.prototype.setValidation=function(a){this._$scope.date.isValid=a||this._$scope.date.isOptional},d.prototype._setDefaultMonth=function(a){this._$singleTimeout(function(){this._$scope.month=this._$scope.months[parseInt(a,10)-1],this.generateDays(),this._$scope.updateCustomSelects()}.bind(this))},d.prototype._addBreakpointSubscription=function(){this._pubSubService.subscribe("windowService.breakpoint",function(a){var b=parseInt(this._$scope.month.value,10)-1;this._$scope.month={},this._setMonthsFromBreakpoint(a),this._$scope.month=this._$scope.months[b],this._$singleTimeout(this._$scope.updateCustomSelects.bind(this))}.bind(this))},d.prototype._setMonthsFromBreakpoint=function(a){this._$scope.months="small"===a?this._resourceBundle.months:this._resourceBundle.longMonths};var e=function(b,c,d,e){var f,g=c.find("select");a.extend(b.date,{inline:e._$parse(d.inline)(b),innerPlaceholderArray:d.innerPlaceholder?d.innerPlaceholder.split(","):[]}),d.defaultMonth&&e._setDefaultMonth(d.defaultMonth),e._$parse(d.longMonths)(b)&&(e._addBreakpointSubscription(),e._setMonthsFromBreakpoint(e._windowService.breakpoint())),b.$watch("disabled",function(a){f=a?"addClass":"removeClass",c[f]("is-disabled")}),g.on("focus mousedown",function(a){b.disabled&&a.preventDefault()}),b.updateCustomSelects=function(a){e._$singleTimeout(function(){a.trigger("render.customSelect")})}.bind(null,g),e.validate(),b.$on("$destroy",function(){g.off()})};return c}),c("common/directives/form-address",[],function(){"use strict";var a=function(){return{controller:b,link:c,scope:{formCtrl:"=",addressFields:"=",isElevateUser:"=",formHandler:"=",disableFields:"@",hasInnerLabel:"=",fieldGroup:"@"},restrict:"A",templateUrl:"/app/common/directives/form-address.tpl.html"}},b=function(a,b,c,d,e){this._$scope=a,this._$configApi=b,this._$singleTimeout=c,this._GeoBundle=d,this._pubSubService=e,this._$scope.addressForm={countries:this._GeoBundle.countries,stateIsDisabled:!1,stateListIsEmpty:!1,states:this._GeoBundle.usStates,loadedData:!1,isDisabled:this.isDisabled.bind(this)},this._pubSubService.subscribe("addressForm.autocompleteStateVal",function(a){this._$scope.addressForm.autocompleteStateVal=a}.bind(this)),this._zipConfig={US:{validate:"required,usZip",maxLength:5},CA:{validate:"required,caZip",maxLength:7},default:{validate:"required",maxLength:9}}};b.prototype._onStateChange=function(){var a;this._$scope.addressFields.stateSelect&&(a=this._$scope.addressFields.stateSelect.value&&this._$scope.addressFields.stateSelect.value.value),"undefined"==typeof a&&(a=this._$scope.addressFields.state.value,"undefined"!=typeof a&&(a=a.substring(0,3).toUpperCase())),this._$scope.formCtrl.stateValue=a||"",this._$scope.formCtrl.state=a||""},b.prototype._onCountryChange=function(){if(void 0===this._$scope.addressFields.country.value)this._$scope.addressFields.stateSelect.value="",this._$scope.addressFields.stateSelect.isValid=!1;else{var a=this._$scope.addressFields.country,b=a&&a.value&&a.value.value||"US",c=a.value||"defaultOption";this._updateStateList(b,c),this._updateZipValidationRules(b)}},b.prototype._updateStateList=function(a){this._$scope.addressForm.stateIsDisabled=!0,this._updateStateList.cache[a]?this._$singleTimeout(function(){this._updateStateFields(this._updateStateList.cache[a])}.bind(this)):this._$configApi.getStates(a).then(function(b){this._updateStateList.cache[a]=b,this._updateStateFields(b)}.bind(this))},b.prototype._updateStateList.cache={},b.prototype._updateStateFields=function(a){this._$scope.addressForm.stateListIsEmpty=0===a.length;var b=this._getExistingStateValue();this._$scope.formCtrl.stateValue=b||"",this._$singleTimeout(function(){this._$scope.addressForm.stateListIsEmpty?(this._$scope.addressFields.state.value=b,this._$scope.addressFields.stateSelect.isValid=!0):"undefined"==typeof b?this._$scope.addressFields.stateSelect.value||(this._$scope.addressFields.stateSelect.isValid=null):this._$scope.addressFields.stateSelect.setValue(b)}.bind(this)),this._$scope.addressForm.loadedData=!0,this._$scope.addressForm.states=a,this._$scope.addressForm.stateIsDisabled=!1},b.prototype._updateZipValidationRules=function(a){var b=this._$scope.addressFields.zipCode,c=this._zipConfig[a]||this._zipConfig.default;b.setValidationRules(c.validate),b.setMaxLength(c.maxLength)},b.prototype.isDisabled=function(a){var b=this._$scope.disableFields;return b&&b.indexOf(a)!==-1},b.prototype._getExistingStateValue=function(){var a;return this._$scope.addressForm.autocompleteStateVal?(a=this._$scope.addressForm.autocompleteStateVal,this._$scope.addressForm.autocompleteStateVal=null):this._$scope.addressForm.loadedData||(a=this._$scope.addressFields.state.value),a},b.$inject=["$scope","$configApi","$singleTimeout","GeoBundle","pubSubService"];var c=function(a,b,c,d){var e=function(){return b.find('[data-field-group="address"] [autocomplete="on"]')},f=a.$watch(function(){return e.length},function(a){a&&(e.attr("autocomplete",!1),f())}.bind(this)),g=function(a,b){a!==b&&d._onStateChange()};a.$watch("addressFields.state.value",g),a.$watch("addressFields.stateSelect.value",g),d._updateStateList.cache.US=d._GeoBundle.usStates,a.addressForm.isDisabled("country")?d._updateStateList("US"):a.$watch("addressFields.country.value",function(a,b){!a||"US"===a.value&&""===b?void 0===a&&d._onCountryChange():d._onCountryChange()})};return a}),c("common/directives/form-submit",["angular","jquery"],function(a,b){"use strict";var c=function(){return{restrict:"A",scope:!0,replace:!0,controller:d,templateUrl:"/app/common/directives/form-submit.tpl.html",link:e}},d=function(a,b){this._$scope=a,this._$parse=b,a.submit={formSubmit:this.formSubmit.bind(this)}};d.$inject=["$scope","$parse"],d.prototype.formSubmit=function(){return!!this._$scope.formHandler.valid&&void this._$scope.submit.onSuccess(this._$scope)};var e=function(c,d,e,f){a.extend(f._$scope.submit,{altClasses:e.altClasses,onSuccess:f._$parse(e.onSuccess),id:c.formHandler.submitButtonId}),b(d).on("click",function(a){if(!c.formHandler.valid||c.formHandler.isLoading){a.preventDefault();var d=b(this),e=d.closest("form").find("[required]").filter(function(){return""===b(this).val()||b(this).is(":checkbox")&&!b(this).is(":checked")}).eq(0),f=d.closest("form").find(".is-invalid").not(".input-message-validate").eq(0),g=d.closest("form").find("select[required]").not(".select-container").filter(function(){return""===this.value}).eq(0),h=e.length&&e||f.length&&f||g.length&&g,i=f.has("input");d.addClass("is-disabled-animation"),i.length?i.find("[required]").filter(function(){var a=b(this).val();return""===a||0===a}).eq(0).focus():h&&h.focus(),setTimeout(function(){d.removeClass("is-disabled-animation")},350)}})};return c}),c("common/directives/accordion",["angular","jquery","moment"],function(a,b,c){"use strict";var d=function(){return{restrict:"A",replace:!0,scope:{title:"@",headerClass:"@",template:"@",content:"=",contentType:"@",i:"@",expanded:"@",expandable:"@",expandingCall:"="},controller:e,link:f,templateUrl:"/app/common/directives/accordion.tpl.html"}},e=function(b,d,e,f,g){var h;this._$scope=b,this._$http=d,this._$templateCache=e,this._$compile=f,this._$timeout=g,a.extend(this._$scope,{isExpanded:"true"===this._$scope.expanded,isExpandable:"true"===this._$scope.expandable}),this._$scope.accordion={init:!1,idx:parseInt(this._$scope.i,10),content:this._$scope.content,localizeDateTime:this.localizeDateTime.bind(this),contentType:this._$scope.contentType,toggleAccordion:this.toggleAccordion.bind(this),moment:c},h=b.$watch("content",function(a){b.accordion.content=a}),b.$on("$destroy",function(){h()})};e.$inject=["$scope","$http","$templateCache","$compile","$timeout"],e.prototype.localizeDateTime=function(a,b){if(a)return c(a).zone(a).format(b)},e.prototype.toggleAccordion=function(){this._$scope.isExpanded=!this._$scope.isExpanded,this._$scope.accordion.init||(this._$scope.expandingCall?this._$scope.expandingCall(this._$scope.content,this._$scope.accordion.idx).then(function(a){this._$scope.content=a,this._$timeout(function(){this.insertTemplate()}.bind(this))}.bind(this)):this.insertTemplate())},e.prototype.insertTemplate=function(){var a=this,c=b(this._$scope.accordion.el).find(".accordion__main");this._$http.get(this._$scope.template,{cache:this._$templateCache}).then(function(b){c.html(b.data),a._$compile(c)(a._$scope)}),this._$scope.accordion.init=!0};var f=function(b,c,d,e){a.extend(e._$scope.accordion,{el:c}),b.template&&b.isExpanded&&e.insertTemplate()};return d}),c("common/directives/collapsible-table",["angular"],function(a){"use strict";var b=function(){return{restrict:"A",scope:!0,controller:c,link:d}},c=function(a,b){this._$scope=a,this._windowService=b,this._$scope.collapsibleTable={isCollapsed:!1}};c.$inject=["$scope","windowService"],c.prototype.updateTables=function(a){var b=this,c=this._$scope.collapseAtMedium?"small"===a||"medium"===a:"small"===a;c&&!this._$scope.collapsibleTable.isCollapsed?b._$scope.collapsibleTable.isCollapsed=!0:!c&&this._$scope.collapsibleTable.isCollapsed&&(b._$scope.collapsibleTable.isCollapsed=!1)};var d=function(b,c,d,e){function f(a){e.updateTables.call(e,a)}a.extend(b,{collapseAtMedium:d.collapseAtMedium}),b.$watch(e._windowService.breakpoint,f)};return b}),c("common/directives/saved-choices-bar",[],function(){"use strict";var a=function(){return{restrict:"A",controller:b,templateUrl:"/app/common/directives/saved-choices-bar.tpl.html"}},b=function(a,b,c,d,e,f,g){var h=this;this.$scope=a,this.$timeout=b,this.tripService=d,this.locationService=e,this.windowService=f,this.persistenceService=g,this.model={},a.savedChoicesBar={messages:c.savedChoicesBar,load:this.load.bind(this),dismiss:this.dismiss.bind(this),visible:!1},a.$watchCollection(g.getTripModel,function(a,b){a&&a!==b&&this.onPersistenceLoaded(a)}.bind(this)),a.$watch(e.shouldRender,function(a){a&&h.dismiss()})};return b.prototype.load=function(){this.tripService.setLoadModelFromPersistence(!0),this.$scope.savedChoicesBar.visible=!1},b.prototype.dismiss=function(){this.windowService.setDoubleHeader(!1),this.$scope.savedChoicesBar.visible=!1},b.prototype.onPersistenceLoaded=function(a){a.cityPairs&&a.cityPairs.length>0&&a.cityPairs[0].des&&(this.model=a,this.$scope.savedChoicesBar.visible=!0,this.windowService.setDoubleHeader(!0))},b.$inject=["$scope","$timeout","ResourceBundle","tripService","locationService","windowService","persistenceService"],a}),c("common/directives/promo",[],function(){"use strict";var a=function(){return{restrict:"A",replace:!0,controller:b,templateUrl:"/app/common/directives/promo.tpl.html"}},b=function(a,b,c,d,e,f){this._$scope=a,this._pubSubService=b,this._promoService=c,this._windowService=e,this._utilsService=f,this.promoClasses={"1UpLeft":"promo__1up-slide--left","1UpRight":"promo__1up-slide--right","1UpCenter":"promo__1up-slide--center",noDescription:"promo__1up-slide--no-description",noSlides:"promo__no-slides"},this._$scope.promotions={},this._$scope.firstSlider={showArrows:!1,arrowsInContainer:!1,arrowsContainerClass:"arrows",imagesContainer:".promo__1up-container",imagesSelector:".promo__1up-slide",showDots:!0,dotsContainerClass:"dots",dotsClass:"dot",autoChange:!1,interval:5e3,verbose:!1,slideDuration:600,sliderType:2,shouldTransition:!0},this._$scope.secondSlider={showArrows:!1,arrowsInContainer:!1,arrowsContainerClass:"arrows",imagesContainer:".promo__3up-container",imagesSelector:".promo__3up-slide",showDots:!0,dotsContainerClass:"dots",dotsClass:"dot",autoChange:!1,interval:2e3,verbose:!1,slideDuration:400,sliderType:0},this._$scope.getSlideClass=function(a){return this.promoClasses[a]}.bind(this),this._$scope.hasDescription=function(a){if(a.length<=0)return this.promoClasses.noDescription}.bind(this),this._$scope.hasSlides=function(a){if(a<=1)return this.promoClasses.noSlides}.bind(this),this._$scope.getHtmlTitle=function(a){return d.trustAsHtml(a)},this._$scope.onPromoClick=function(a,b){b?this._pubSubService.publish("adobeAnalytics.alaskaCardPromo",[{pageName:"home: AS Bank Card Link FCF"}]):this._pubSubService.publish("adobeAnalytics.promoClicked",["INT=VX_Homepage_M"+(parseInt(a,10)+1)])}.bind(this),this._$scope.isMobile=function(){return"small"===this._windowService.breakpoint()}.bind(this),this._promoService.promise.then(function(a){this._$scope.promotions=a}.bind(this))};return b.$inject=["$scope","pubSubService","promoService","$sce","windowService","utilsService"],a}),function(a){"use strict";function b(a){var b=a.length,d=c.type(a);return"function"!==d&&!c.isWindow(a)&&(!(1!==a.nodeType||!b)||("array"===d||0===b||"number"==typeof b&&b>0&&b-1 in a))}if(!a.jQuery){var c=function(a,b){return new c.fn.init(a,b)};c.isWindow=function(a){return a&&a===a.window},c.type=function(a){return a?"object"==typeof a||"function"==typeof a?e[g.call(a)]||"object":typeof a:a+""},c.isArray=Array.isArray||function(a){return"array"===c.type(a)},c.isPlainObject=function(a){var b;if(!a||"object"!==c.type(a)||a.nodeType||c.isWindow(a))return!1;try{if(a.constructor&&!f.call(a,"constructor")&&!f.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(a){return!1}for(b in a);return void 0===b||f.call(a,b)},c.each=function(a,c,d){var e,f=0,g=a.length,h=b(a);if(d){if(h)for(;f<g&&(e=c.apply(a[f],d),e!==!1);f++);else for(f in a)if(a.hasOwnProperty(f)&&(e=c.apply(a[f],d),e===!1))break}else if(h)for(;f<g&&(e=c.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(a.hasOwnProperty(f)&&(e=c.call(a[f],f,a[f]),e===!1))break;return a},c.data=function(a,b,e){if(void 0===e){var f=a[c.expando],g=f&&d[f];if(void 0===b)return g;if(g&&b in g)return g[b]}else if(void 0!==b){var h=a[c.expando]||(a[c.expando]=++c.uuid);return d[h]=d[h]||{},d[h][b]=e,e}},c.removeData=function(a,b){var e=a[c.expando],f=e&&d[e];f&&(b?c.each(b,function(a,b){delete f[b]}):delete d[e])},c.extend=function(){var a,b,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;for("boolean"==typeof h&&(k=h,h=arguments[i]||{},i++),"object"!=typeof h&&"function"!==c.type(h)&&(h={}),i===j&&(h=this,i--);i<j;i++)if(f=arguments[i])for(e in f)f.hasOwnProperty(e)&&(a=h[e],d=f[e],h!==d&&(k&&d&&(c.isPlainObject(d)||(b=c.isArray(d)))?(b?(b=!1,g=a&&c.isArray(a)?a:[]):g=a&&c.isPlainObject(a)?a:{},h[e]=c.extend(k,g,d)):void 0!==d&&(h[e]=d)));return h},c.queue=function(a,d,e){function f(a,c){var d=c||[];return a&&(b(Object(a))?function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;)a[e++]=b[d++];if(c!==c)for(;void 0!==b[d];)a[e++]=b[d++];return a.length=e,a}(d,"string"==typeof a?[a]:a):[].push.call(d,a)),d}if(a){d=(d||"fx")+"queue";var g=c.data(a,d);return e?(!g||c.isArray(e)?g=c.data(a,d,f(e)):g.push(e),g):g||[]}},c.dequeue=function(a,b){c.each(a.nodeType?[a]:a,function(a,d){b=b||"fx";var e=c.queue(d,b),f=e.shift();"inprogress"===f&&(f=e.shift()),f&&("fx"===b&&e.unshift("inprogress"),f.call(d,function(){c.dequeue(d,b)}))})},c.fn=c.prototype={init:function(a){if(a.nodeType)return this[0]=a,this;throw new Error("Not a DOM node.")},offset:function(){var b=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:b.top+(a.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:b.left+(a.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function a(a){for(var b=a.offsetParent;b&&"html"!==b.nodeName.toLowerCase()&&b.style&&"static"===b.style.position;)b=b.offsetParent;return b||document}var b=this[0],d=a(b),e=this.offset(),f=/^(?:body|html)$/i.test(d.nodeName)?{top:0,left:0}:c(d).offset();return e.top-=parseFloat(b.style.marginTop)||0,e.left-=parseFloat(b.style.marginLeft)||0,d.style&&(f.top+=parseFloat(d.style.borderTopWidth)||0,f.left+=parseFloat(d.style.borderLeftWidth)||0),{top:e.top-f.top,left:e.left-f.left}}};var d={};c.expando="velocity"+(new Date).getTime(),c.uuid=0;for(var e={},f=e.hasOwnProperty,g=e.toString,h="Boolean Number String Function Array Date RegExp Object Error".split(" "),i=0;i<h.length;i++)e["[object "+h[i]+"]"]=h[i].toLowerCase();c.fn.init.prototype=c.fn,a.Velocity={Utilities:c}}}(window),function(a){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=a():"function"==typeof c&&c.amd?c("velocity",a):a()}(function(){"use strict";return function(a,b,c,d){function e(a){for(var b=-1,c=a?a.length:0,d=[];++b<c;){var e=a[b];e&&d.push(e)}return d}function f(a){return t.isWrapped(a)?a=s.call(a):t.isNode(a)&&(a=[a]),a}function g(a){var b=o.data(a,"velocity");return null===b?d:b}function h(a,b){var c=g(a);c&&c.delayTimer&&!c.delayPaused&&(c.delayRemaining=c.delay-b+c.delayBegin,c.delayPaused=!0,clearTimeout(c.delayTimer.setTimeout))}function i(a,b){var c=g(a);c&&c.delayTimer&&c.delayPaused&&(c.delayPaused=!1,c.delayTimer.setTimeout=setTimeout(c.delayTimer.next,c.delayRemaining))}function j(a){return function(b){return Math.round(b*a)*(1/a)}}function k(a,c,d,e){function f(a,b){return 1-3*b+3*a}function g(a,b){return 3*b-6*a}function h(a){return 3*a}function i(a,b,c){return((f(b,c)*a+g(b,c))*a+h(b))*a}function j(a,b,c){return 3*f(b,c)*a*a+2*g(b,c)*a+h(b)}function k(b,c){for(var e=0;e<p;++e){var f=j(c,a,d);if(0===f)return c;var g=i(c,a,d)-b;c-=g/f}return c}function l(){for(var b=0;b<t;++b)x[b]=i(b*u,a,d)}function m(b,c,e){var f,g,h=0;do g=c+(e-c)/2,f=i(g,a,d)-b,f>0?e=g:c=g;while(Math.abs(f)>r&&++h<s);return g}function n(b){for(var c=0,e=1,f=t-1;e!==f&&x[e]<=b;++e)c+=u;--e;var g=(b-x[e])/(x[e+1]-x[e]),h=c+g*u,i=j(h,a,d);return i>=q?k(b,h):0===i?h:m(b,c,c+u)}function o(){y=!0,(a!==c||d!==e)&&l()}var p=4,q=.001,r=1e-7,s=10,t=11,u=1/(t-1),v="Float32Array"in b;if(4!==arguments.length)return!1;for(var w=0;w<4;++w)if("number"!=typeof arguments[w]||isNaN(arguments[w])||!isFinite(arguments[w]))return!1;a=Math.min(a,1),d=Math.min(d,1),a=Math.max(a,0),d=Math.max(d,0);var x=v?new Float32Array(t):new Array(t),y=!1,z=function(b){return y||o(),a===c&&d===e?b:0===b?0:1===b?1:i(n(b),c,e)};z.getControlPoints=function(){return[{x:a,y:c},{x:d,y:e}]};var A="generateBezier("+[a,c,d,e]+")";return z.toString=function(){return A},z}function l(a,b){var c=a;return t.isString(a)?x.Easings[a]||(c=!1):c=t.isArray(a)&&1===a.length?j.apply(null,a):t.isArray(a)&&2===a.length?y.apply(null,a.concat([b])):!(!t.isArray(a)||4!==a.length)&&k.apply(null,a),c===!1&&(c=x.Easings[x.defaults.easing]?x.defaults.easing:w),c}function m(a){if(a){var b=x.timestamp&&a!==!0?a:r.now(),c=x.State.calls.length;c>1e4&&(x.State.calls=e(x.State.calls),c=x.State.calls.length);for(var f=0;f<c;f++)if(x.State.calls[f]){var h=x.State.calls[f],i=h[0],j=h[2],k=h[3],l=!!k,q=null,s=h[5],u=h[6];if(k||(k=x.State.calls[f][3]=b-16),s){if(s.resume!==!0)continue;k=h[3]=Math.round(b-u-16),h[5]=null}u=h[6]=b-k;for(var v=Math.min(u/j.duration,1),w=0,y=i.length;w<y;w++){var A=i[w],C=A.element;if(g(C)){var D=!1;if(j.display!==d&&null!==j.display&&"none"!==j.display){if("flex"===j.display){var E=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];o.each(E,function(a,b){z.setPropertyValue(C,"display",b)})}z.setPropertyValue(C,"display",j.display)}j.visibility!==d&&"hidden"!==j.visibility&&z.setPropertyValue(C,"visibility",j.visibility);for(var F in A)if(A.hasOwnProperty(F)&&"element"!==F){var G,H=A[F],I=t.isString(H.easing)?x.Easings[H.easing]:H.easing;if(t.isString(H.pattern)){var J=1===v?function(a,b,c){var d=H.endValue[b];return c?Math.round(d):d}:function(a,b,c){var d=H.startValue[b],e=H.endValue[b]-d,f=d+e*I(v,j,e);return c?Math.round(f):f};G=H.pattern.replace(/{(\d+)(!)?}/g,J)}else if(1===v)G=H.endValue;else{var K=H.endValue-H.startValue;G=H.startValue+K*I(v,j,K)}if(!l&&G===H.currentValue)continue;if(H.currentValue=G,"tween"===F)q=G;else{var L;if(z.Hooks.registered[F]){L=z.Hooks.getRoot(F);var M=g(C).rootPropertyValueCache[L];M&&(H.rootPropertyValue=M)}var N=z.setPropertyValue(C,F,H.currentValue+(p<9&&0===parseFloat(G)?"":H.unitType),H.rootPropertyValue,H.scrollData);z.Hooks.registered[F]&&(z.Normalizations.registered[L]?g(C).rootPropertyValueCache[L]=z.Normalizations.registered[L]("extract",null,N[1]):g(C).rootPropertyValueCache[L]=N[1]),"transform"===N[0]&&(D=!0)}}j.mobileHA&&g(C).transformCache.translate3d===d&&(g(C).transformCache.translate3d="(0px, 0px, 0px)",D=!0),D&&z.flushTransformCache(C)}}j.display!==d&&"none"!==j.display&&(x.State.calls[f][2].display=!1),j.visibility!==d&&"hidden"!==j.visibility&&(x.State.calls[f][2].visibility=!1),j.progress&&j.progress.call(h[1],h[1],v,Math.max(0,k+j.duration-b),k,q),1===v&&n(f)}}x.State.isTicking&&B(m)}function n(a,b){if(!x.State.calls[a])return!1;for(var c=x.State.calls[a][0],e=x.State.calls[a][1],f=x.State.calls[a][2],h=x.State.calls[a][4],i=!1,j=0,k=c.length;j<k;j++){var l=c[j].element;!b&&!f.loop&&("none"===f.display&&z.setPropertyValue(l,"display",f.display),"hidden"===f.visibility&&z.setPropertyValue(l,"visibility",f.visibility));
var m=g(l);if(f.loop!==!0&&(o.queue(l)[1]===d||!/\.velocityQueueEntryFlag/i.test(o.queue(l)[1]))&&m){m.isAnimating=!1,m.rootPropertyValueCache={};var n=!1;o.each(z.Lists.transforms3D,function(a,b){var c=/^scale/.test(b)?1:0,e=m.transformCache[b];m.transformCache[b]!==d&&new RegExp("^\\("+c+"[^.]").test(e)&&(n=!0,delete m.transformCache[b])}),f.mobileHA&&(n=!0,delete m.transformCache.translate3d),n&&z.flushTransformCache(l),z.Values.removeClass(l,"velocity-animating")}if(!b&&f.complete&&!f.loop&&j===k-1)try{f.complete.call(e,e)}catch(a){setTimeout(function(){throw a},1)}h&&f.loop!==!0&&h(e),m&&f.loop===!0&&!b&&(o.each(m.tweensContainer,function(a,b){if(/^rotate/.test(a)&&(parseFloat(b.startValue)-parseFloat(b.endValue))%360===0){var c=b.startValue;b.startValue=b.endValue,b.endValue=c}/^backgroundPosition/.test(a)&&100===parseFloat(b.endValue)&&"%"===b.unitType&&(b.endValue=0,b.startValue=100)}),x(l,"reverse",{loop:!0,delay:f.delay})),f.queue!==!1&&o.dequeue(l,f.queue)}x.State.calls[a]=!1;for(var p=0,q=x.State.calls.length;p<q;p++)if(x.State.calls[p]!==!1){i=!0;break}i===!1&&(x.State.isTicking=!1,delete x.State.calls,x.State.calls=[])}var o,p=function(){if(c.documentMode)return c.documentMode;for(var a=7;a>4;a--){var b=c.createElement("div");if(b.innerHTML="<!--[if IE "+a+"]><span></span><![endif]-->",b.getElementsByTagName("span").length)return b=null,a}return d}(),q=function(){var a=0;return b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||function(b){var c,d=(new Date).getTime();return c=Math.max(0,16-(d-a)),a=d+c,setTimeout(function(){b(d+c)},c)}}(),r=function(){var a=b.performance||{};if(!Object.prototype.hasOwnProperty.call(a,"now")){var c=a.timing&&a.timing.domComplete?a.timing.domComplete:(new Date).getTime();a.now=function(){return(new Date).getTime()-c}}return a}(),s=function(){var a=Array.prototype.slice;try{a.call(c.documentElement)}catch(b){a=function(){for(var a=this.length,b=[];--a>0;)b[a]=this[a];return b}}return a}(),t={isNumber:function(a){return"number"==typeof a},isString:function(a){return"string"==typeof a},isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},isFunction:function(a){return"[object Function]"===Object.prototype.toString.call(a)},isNode:function(a){return a&&a.nodeType},isWrapped:function(a){return a&&t.isNumber(a.length)&&!t.isString(a)&&!t.isFunction(a)&&!t.isNode(a)&&(0===a.length||t.isNode(a[0]))},isSVG:function(a){return b.SVGElement&&a instanceof b.SVGElement},isEmptyObject:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}},u=!1;if(a.fn&&a.fn.jquery?(o=a,u=!0):o=b.Velocity.Utilities,p<=8&&!u)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(p<=7)return void(jQuery.fn.velocity=jQuery.fn.animate);var v=400,w="swing",x={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:b.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:c.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[],delayedElements:{count:0}},CSS:{},Utilities:o,Redirects:{},Easings:{},Promise:b.Promise,defaults:{queue:"",duration:v,easing:w,begin:d,complete:d,progress:d,display:d,visibility:d,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0,promiseRejectEmpty:!0},init:function(a){o.data(a,"velocity",{isSVG:t.isSVG(a),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:4,patch:3},debug:!1,timestamp:!0,pauseAll:function(a){var b=(new Date).getTime();o.each(x.State.calls,function(b,c){if(c){if(a!==d&&(c[2].queue!==a||c[2].queue===!1))return!0;c[5]={resume:!1}}}),o.each(x.State.delayedElements,function(a,c){c&&h(c,b)})},resumeAll:function(a){var b=(new Date).getTime();o.each(x.State.calls,function(b,c){if(c){if(a!==d&&(c[2].queue!==a||c[2].queue===!1))return!0;c[5]&&(c[5].resume=!0)}}),o.each(x.State.delayedElements,function(a,c){c&&i(c,b)})}};b.pageYOffset!==d?(x.State.scrollAnchor=b,x.State.scrollPropertyLeft="pageXOffset",x.State.scrollPropertyTop="pageYOffset"):(x.State.scrollAnchor=c.documentElement||c.body.parentNode||c.body,x.State.scrollPropertyLeft="scrollLeft",x.State.scrollPropertyTop="scrollTop");var y=function(){function a(a){return-a.tension*a.x-a.friction*a.v}function b(b,c,d){var e={x:b.x+d.dx*c,v:b.v+d.dv*c,tension:b.tension,friction:b.friction};return{dx:e.v,dv:a(e)}}function c(c,d){var e={dx:c.v,dv:a(c)},f=b(c,.5*d,e),g=b(c,.5*d,f),h=b(c,d,g),i=1/6*(e.dx+2*(f.dx+g.dx)+h.dx),j=1/6*(e.dv+2*(f.dv+g.dv)+h.dv);return c.x=c.x+i*d,c.v=c.v+j*d,c}return function a(b,d,e){var f,g,h,i={x:-1,v:0,tension:null,friction:null},j=[0],k=0,l=1e-4,m=.016;for(b=parseFloat(b)||500,d=parseFloat(d)||20,e=e||null,i.tension=b,i.friction=d,f=null!==e,f?(k=a(b,d),g=k/e*m):g=m;h=c(h||i,g),j.push(1+h.x),k+=16,Math.abs(h.x)>l&&Math.abs(h.v)>l;);return f?function(a){return j[a*(j.length-1)|0]}:k}}();x.Easings={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},spring:function(a){return 1-Math.cos(4.5*a*Math.PI)*Math.exp(6*-a)}},o.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(a,b){x.Easings[b[0]]=k.apply(null,b[1])});var z=x.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"],units:["%","em","ex","ch","rem","vw","vh","vmin","vmax","cm","mm","Q","in","pc","pt","px","deg","grad","rad","turn","s","ms"],colorNames:{aliceblue:"240,248,255",antiquewhite:"250,235,215",aquamarine:"127,255,212",aqua:"0,255,255",azure:"240,255,255",beige:"245,245,220",bisque:"255,228,196",black:"0,0,0",blanchedalmond:"255,235,205",blueviolet:"138,43,226",blue:"0,0,255",brown:"165,42,42",burlywood:"222,184,135",cadetblue:"95,158,160",chartreuse:"127,255,0",chocolate:"210,105,30",coral:"255,127,80",cornflowerblue:"100,149,237",cornsilk:"255,248,220",crimson:"220,20,60",cyan:"0,255,255",darkblue:"0,0,139",darkcyan:"0,139,139",darkgoldenrod:"184,134,11",darkgray:"169,169,169",darkgrey:"169,169,169",darkgreen:"0,100,0",darkkhaki:"189,183,107",darkmagenta:"139,0,139",darkolivegreen:"85,107,47",darkorange:"255,140,0",darkorchid:"153,50,204",darkred:"139,0,0",darksalmon:"233,150,122",darkseagreen:"143,188,143",darkslateblue:"72,61,139",darkslategray:"47,79,79",darkturquoise:"0,206,209",darkviolet:"148,0,211",deeppink:"255,20,147",deepskyblue:"0,191,255",dimgray:"105,105,105",dimgrey:"105,105,105",dodgerblue:"30,144,255",firebrick:"178,34,34",floralwhite:"255,250,240",forestgreen:"34,139,34",fuchsia:"255,0,255",gainsboro:"220,220,220",ghostwhite:"248,248,255",gold:"255,215,0",goldenrod:"218,165,32",gray:"128,128,128",grey:"128,128,128",greenyellow:"173,255,47",green:"0,128,0",honeydew:"240,255,240",hotpink:"255,105,180",indianred:"205,92,92",indigo:"75,0,130",ivory:"255,255,240",khaki:"240,230,140",lavenderblush:"255,240,245",lavender:"230,230,250",lawngreen:"124,252,0",lemonchiffon:"255,250,205",lightblue:"173,216,230",lightcoral:"240,128,128",lightcyan:"224,255,255",lightgoldenrodyellow:"250,250,210",lightgray:"211,211,211",lightgrey:"211,211,211",lightgreen:"144,238,144",lightpink:"255,182,193",lightsalmon:"255,160,122",lightseagreen:"32,178,170",lightskyblue:"135,206,250",lightslategray:"119,136,153",lightsteelblue:"176,196,222",lightyellow:"255,255,224",limegreen:"50,205,50",lime:"0,255,0",linen:"250,240,230",magenta:"255,0,255",maroon:"128,0,0",mediumaquamarine:"102,205,170",mediumblue:"0,0,205",mediumorchid:"186,85,211",mediumpurple:"147,112,219",mediumseagreen:"60,179,113",mediumslateblue:"123,104,238",mediumspringgreen:"0,250,154",mediumturquoise:"72,209,204",mediumvioletred:"199,21,133",midnightblue:"25,25,112",mintcream:"245,255,250",mistyrose:"255,228,225",moccasin:"255,228,181",navajowhite:"255,222,173",navy:"0,0,128",oldlace:"253,245,230",olivedrab:"107,142,35",olive:"128,128,0",orangered:"255,69,0",orange:"255,165,0",orchid:"218,112,214",palegoldenrod:"238,232,170",palegreen:"152,251,152",paleturquoise:"175,238,238",palevioletred:"219,112,147",papayawhip:"255,239,213",peachpuff:"255,218,185",peru:"205,133,63",pink:"255,192,203",plum:"221,160,221",powderblue:"176,224,230",purple:"128,0,128",red:"255,0,0",rosybrown:"188,143,143",royalblue:"65,105,225",saddlebrown:"139,69,19",salmon:"250,128,114",sandybrown:"244,164,96",seagreen:"46,139,87",seashell:"255,245,238",sienna:"160,82,45",silver:"192,192,192",skyblue:"135,206,235",slateblue:"106,90,205",slategray:"112,128,144",snow:"255,250,250",springgreen:"0,255,127",steelblue:"70,130,180",tan:"210,180,140",teal:"0,128,128",thistle:"216,191,216",tomato:"255,99,71",turquoise:"64,224,208",violet:"238,130,238",wheat:"245,222,179",whitesmoke:"245,245,245",white:"255,255,255",yellowgreen:"154,205,50",yellow:"255,255,0"}},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var a=0;a<z.Lists.colors.length;a++){var b="color"===z.Lists.colors[a]?"0 0 0 1":"255 255 255 1";z.Hooks.templates[z.Lists.colors[a]]=["Red Green Blue Alpha",b]}var c,d,e;if(p)for(c in z.Hooks.templates)if(z.Hooks.templates.hasOwnProperty(c)){d=z.Hooks.templates[c],e=d[0].split(" ");var f=d[1].match(z.RegEx.valueSplit);"Color"===e[0]&&(e.push(e.shift()),f.push(f.shift()),z.Hooks.templates[c]=[e.join(" "),f.join(" ")])}for(c in z.Hooks.templates)if(z.Hooks.templates.hasOwnProperty(c)){d=z.Hooks.templates[c],e=d[0].split(" ");for(var g in e)if(e.hasOwnProperty(g)){var h=c+e[g],i=g;z.Hooks.registered[h]=[c,i]}}},getRoot:function(a){var b=z.Hooks.registered[a];return b?b[0]:a},getUnit:function(a,b){var c=(a.substr(b||0,5).match(/^[a-z%]+/)||[])[0]||"";return c&&z.Lists.units.indexOf(c)>=0?c:""},fixColors:function(a){return a.replace(/(rgba?\(\s*)?(\b[a-z]+\b)/g,function(a,b,c){return z.Lists.colorNames.hasOwnProperty(c)?(b?b:"rgba(")+z.Lists.colorNames[c]+(b?"":",1)"):b+c})},cleanRootPropertyValue:function(a,b){return z.RegEx.valueUnwrap.test(b)&&(b=b.match(z.RegEx.valueUnwrap)[1]),z.Values.isCSSNullValue(b)&&(b=z.Hooks.templates[a][1]),b},extractValue:function(a,b){var c=z.Hooks.registered[a];if(c){var d=c[0],e=c[1];return b=z.Hooks.cleanRootPropertyValue(d,b),b.toString().match(z.RegEx.valueSplit)[e]}return b},injectValue:function(a,b,c){var d=z.Hooks.registered[a];if(d){var e,f,g=d[0],h=d[1];return c=z.Hooks.cleanRootPropertyValue(g,c),e=c.toString().match(z.RegEx.valueSplit),e[h]=b,f=e.join(" ")}return c}},Normalizations:{registered:{clip:function(a,b,c){switch(a){case"name":return"clip";case"extract":var d;return z.RegEx.wrappedValueAlreadyExtracted.test(c)?d=c:(d=c.toString().match(z.RegEx.valueUnwrap),d=d?d[1].replace(/,(\s+)?/g," "):c),d;case"inject":return"rect("+c+")"}},blur:function(a,b,c){switch(a){case"name":return x.State.isFirefox?"filter":"-webkit-filter";case"extract":var d=parseFloat(c);if(!d&&0!==d){var e=c.toString().match(/blur\(([0-9]+[A-z]+)\)/i);d=e?e[1]:0}return d;case"inject":return parseFloat(c)?"blur("+c+")":"none"}},opacity:function(a,b,c){if(p<=8)switch(a){case"name":return"filter";case"extract":var d=c.toString().match(/alpha\(opacity=(.*)\)/i);return c=d?d[1]/100:1;case"inject":return b.style.zoom=1,parseFloat(c)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(c),10)+")"}else switch(a){case"name":return"opacity";case"extract":return c;case"inject":return c}}},register:function(){function a(a,b,c){var d="border-box"===z.getPropertyValue(b,"boxSizing").toString().toLowerCase();if(d===(c||!1)){var e,f,g=0,h="width"===a?["Left","Right"]:["Top","Bottom"],i=["padding"+h[0],"padding"+h[1],"border"+h[0]+"Width","border"+h[1]+"Width"];for(e=0;e<i.length;e++)f=parseFloat(z.getPropertyValue(b,i[e])),isNaN(f)||(g+=f);return c?-g:g}return 0}function b(b,c){return function(d,e,f){switch(d){case"name":return b;case"extract":return parseFloat(f)+a(b,e,c);case"inject":return parseFloat(f)-a(b,e,c)+"px"}}}(!p||p>9)&&!x.State.isGingerbread&&(z.Lists.transformsBase=z.Lists.transformsBase.concat(z.Lists.transforms3D));for(var c=0;c<z.Lists.transformsBase.length;c++)(function(){var a=z.Lists.transformsBase[c];z.Normalizations.registered[a]=function(b,c,e){switch(b){case"name":return"transform";case"extract":return g(c)===d||g(c).transformCache[a]===d?/^scale/i.test(a)?1:0:g(c).transformCache[a].replace(/[()]/g,"");case"inject":var f=!1;switch(a.substr(0,a.length-1)){case"translate":f=!/(%|px|em|rem|vw|vh|\d)$/i.test(e);break;case"scal":case"scale":x.State.isAndroid&&g(c).transformCache[a]===d&&e<1&&(e=1),f=!/(\d)$/i.test(e);break;case"skew":f=!/(deg|\d)$/i.test(e);break;case"rotate":f=!/(deg|\d)$/i.test(e)}return f||(g(c).transformCache[a]="("+e+")"),g(c).transformCache[a]}}})();for(var e=0;e<z.Lists.colors.length;e++)(function(){var a=z.Lists.colors[e];z.Normalizations.registered[a]=function(b,c,e){switch(b){case"name":return a;case"extract":var f;if(z.RegEx.wrappedValueAlreadyExtracted.test(e))f=e;else{var g,h={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(e)?g=h[e]!==d?h[e]:h.black:z.RegEx.isHex.test(e)?g="rgb("+z.Values.hexToRgb(e).join(" ")+")":/^rgba?\(/i.test(e)||(g=h.black),f=(g||e).toString().match(z.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return(!p||p>8)&&3===f.split(" ").length&&(f+=" 1"),f;case"inject":return/^rgb/.test(e)?e:(p<=8?4===e.split(" ").length&&(e=e.split(/\s+/).slice(0,3).join(" ")):3===e.split(" ").length&&(e+=" 1"),(p<=8?"rgb":"rgba")+"("+e.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")")}}})();z.Normalizations.registered.innerWidth=b("width",!0),z.Normalizations.registered.innerHeight=b("height",!0),z.Normalizations.registered.outerWidth=b("width"),z.Normalizations.registered.outerHeight=b("height")}},Names:{camelCase:function(a){return a.replace(/-(\w)/g,function(a,b){return b.toUpperCase()})},SVGAttribute:function(a){var b="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(p||x.State.isAndroid&&!x.State.isChrome)&&(b+="|transform"),new RegExp("^("+b+")$","i").test(a)},prefixCheck:function(a){if(x.State.prefixMatches[a])return[x.State.prefixMatches[a],!0];for(var b=["","Webkit","Moz","ms","O"],c=0,d=b.length;c<d;c++){var e;if(e=0===c?a:b[c]+a.replace(/^\w/,function(a){return a.toUpperCase()}),t.isString(x.State.prefixElement.style[e]))return x.State.prefixMatches[a]=e,[e,!0]}return[a,!1]}},Values:{hexToRgb:function(a){var b,c=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,d=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;return a=a.replace(c,function(a,b,c,d){return b+b+c+c+d+d}),b=d.exec(a),b?[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]:[0,0,0]},isCSSNullValue:function(a){return!a||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(a)},getUnitType:function(a){return/^(rotate|skew)/i.test(a)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(a)?"":"px"},getDisplayType:function(a){var b=a&&a.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(b)?"inline":/^(li)$/i.test(b)?"list-item":/^(tr)$/i.test(b)?"table-row":/^(table)$/i.test(b)?"table":/^(tbody)$/i.test(b)?"table-row-group":"block"},addClass:function(a,b){if(a)if(a.classList)a.classList.add(b);else if(t.isString(a.className))a.className+=(a.className.length?" ":"")+b;else{var c=a.getAttribute(p<=7?"className":"class")||"";a.setAttribute("class",c+(c?" ":"")+b)}},removeClass:function(a,b){if(a)if(a.classList)a.classList.remove(b);else if(t.isString(a.className))a.className=a.className.toString().replace(new RegExp("(^|\\s)"+b.split(" ").join("|")+"(\\s|$)","gi")," ");else{var c=a.getAttribute(p<=7?"className":"class")||"";a.setAttribute("class",c.replace(new RegExp("(^|s)"+b.split(" ").join("|")+"(s|$)","gi")," "))}}},getPropertyValue:function(a,c,e,f){function h(a,c){var e=0;if(p<=8)e=o.css(a,c);else{var i=!1;/^(width|height)$/.test(c)&&0===z.getPropertyValue(a,"display")&&(i=!0,z.setPropertyValue(a,"display",z.Values.getDisplayType(a)));var j=function(){i&&z.setPropertyValue(a,"display","none")};if(!f){if("height"===c&&"border-box"!==z.getPropertyValue(a,"boxSizing").toString().toLowerCase()){var k=a.offsetHeight-(parseFloat(z.getPropertyValue(a,"borderTopWidth"))||0)-(parseFloat(z.getPropertyValue(a,"borderBottomWidth"))||0)-(parseFloat(z.getPropertyValue(a,"paddingTop"))||0)-(parseFloat(z.getPropertyValue(a,"paddingBottom"))||0);return j(),k}if("width"===c&&"border-box"!==z.getPropertyValue(a,"boxSizing").toString().toLowerCase()){var l=a.offsetWidth-(parseFloat(z.getPropertyValue(a,"borderLeftWidth"))||0)-(parseFloat(z.getPropertyValue(a,"borderRightWidth"))||0)-(parseFloat(z.getPropertyValue(a,"paddingLeft"))||0)-(parseFloat(z.getPropertyValue(a,"paddingRight"))||0);return j(),l}}var m;m=g(a)===d?b.getComputedStyle(a,null):g(a).computedStyle?g(a).computedStyle:g(a).computedStyle=b.getComputedStyle(a,null),"borderColor"===c&&(c="borderTopColor"),e=9===p&&"filter"===c?m.getPropertyValue(c):m[c],""!==e&&null!==e||(e=a.style[c]),j()}if("auto"===e&&/^(top|right|bottom|left)$/i.test(c)){var n=h(a,"position");("fixed"===n||"absolute"===n&&/top|left/i.test(c))&&(e=o(a).position()[c]+"px")}return e}var i;if(z.Hooks.registered[c]){var j=c,k=z.Hooks.getRoot(j);e===d&&(e=z.getPropertyValue(a,z.Names.prefixCheck(k)[0])),z.Normalizations.registered[k]&&(e=z.Normalizations.registered[k]("extract",a,e)),i=z.Hooks.extractValue(j,e)}else if(z.Normalizations.registered[c]){var l,m;l=z.Normalizations.registered[c]("name",a),"transform"!==l&&(m=h(a,z.Names.prefixCheck(l)[0]),z.Values.isCSSNullValue(m)&&z.Hooks.templates[c]&&(m=z.Hooks.templates[c][1])),i=z.Normalizations.registered[c]("extract",a,m)}if(!/^[\d-]/.test(i)){var n=g(a);if(n&&n.isSVG&&z.Names.SVGAttribute(c))if(/^(height|width)$/i.test(c))try{i=a.getBBox()[c]}catch(a){i=0}else i=a.getAttribute(c);else i=h(a,z.Names.prefixCheck(c)[0])}return z.Values.isCSSNullValue(i)&&(i=0),x.debug>=2&&void 0,i},setPropertyValue:function(a,c,d,e,f){var h=c;if("scroll"===c)f.container?f.container["scroll"+f.direction]=d:"Left"===f.direction?b.scrollTo(d,f.alternateValue):b.scrollTo(f.alternateValue,d);else if(z.Normalizations.registered[c]&&"transform"===z.Normalizations.registered[c]("name",a))z.Normalizations.registered[c]("inject",a,d),h="transform",d=g(a).transformCache[c];else{if(z.Hooks.registered[c]){var i=c,j=z.Hooks.getRoot(c);e=e||z.getPropertyValue(a,j),d=z.Hooks.injectValue(i,d,e),c=j}if(z.Normalizations.registered[c]&&(d=z.Normalizations.registered[c]("inject",a,d),c=z.Normalizations.registered[c]("name",a)),h=z.Names.prefixCheck(c)[0],p<=8)try{a.style[h]=d}catch(a){x.debug&&void 0}else{var k=g(a);k&&k.isSVG&&z.Names.SVGAttribute(c)?a.setAttribute(c,d):a.style[h]=d}x.debug>=2&&void 0}return[h,d]},flushTransformCache:function(a){var b="",c=g(a);if((p||x.State.isAndroid&&!x.State.isChrome)&&c&&c.isSVG){var d=function(b){return parseFloat(z.getPropertyValue(a,b))},e={translate:[d("translateX"),d("translateY")],skewX:[d("skewX")],skewY:[d("skewY")],scale:1!==d("scale")?[d("scale"),d("scale")]:[d("scaleX"),d("scaleY")],rotate:[d("rotateZ"),0,0]};o.each(g(a).transformCache,function(a){/^translate/i.test(a)?a="translate":/^scale/i.test(a)?a="scale":/^rotate/i.test(a)&&(a="rotate"),e[a]&&(b+=a+"("+e[a].join(" ")+") ",delete e[a])})}else{var f,h;o.each(g(a).transformCache,function(c){return f=g(a).transformCache[c],"transformPerspective"===c?(h=f,!0):(9===p&&"rotateZ"===c&&(c="rotate"),void(b+=c+f+" "))}),h&&(b="perspective"+h+" "+b)}z.setPropertyValue(a,"transform",b)}};z.Hooks.register(),z.Normalizations.register(),x.hook=function(a,b,c){var e;return a=f(a),o.each(a,function(a,f){if(g(f)===d&&x.init(f),c===d)e===d&&(e=z.getPropertyValue(f,b));else{var h=z.setPropertyValue(f,b,c);"transform"===h[0]&&x.CSS.flushTransformCache(f),e=h}}),e};var A=function(){function a(){return k?y.promise||null:p}function e(a,e){function f(f){var k,n;if(i.begin&&0===C)try{i.begin.call(r,r)}catch(a){setTimeout(function(){throw a},1)}if("scroll"===F){var p,q,v,w=/^x$/i.test(i.axis)?"Left":"Top",A=parseFloat(i.offset)||0;i.container?t.isWrapped(i.container)||t.isNode(i.container)?(i.container=i.container[0]||i.container,p=i.container["scroll"+w],v=p+o(a).position()[w.toLowerCase()]+A):i.container=null:(p=x.State.scrollAnchor[x.State["scrollProperty"+w]],q=x.State.scrollAnchor[x.State["scrollProperty"+("Left"===w?"Top":"Left")]],v=o(a).offset()[w.toLowerCase()]+A),j={scroll:{rootPropertyValue:!1,startValue:p,currentValue:p,endValue:v,unitType:"",easing:i.easing,scrollData:{container:i.container,direction:w,alternateValue:q}},element:a},x.debug&&void 0}else if("reverse"===F){if(k=g(a),!k)return;if(!k.tweensContainer)return void o.dequeue(a,i.queue);"none"===k.opts.display&&(k.opts.display="auto"),"hidden"===k.opts.visibility&&(k.opts.visibility="visible"),k.opts.loop=!1,k.opts.begin=null,k.opts.complete=null,u.easing||delete i.easing,u.duration||delete i.duration,i=o.extend({},k.opts,i),n=o.extend(!0,{},k?k.tweensContainer:null);for(var D in n)if(n.hasOwnProperty(D)&&"element"!==D){var E=n[D].startValue;n[D].startValue=n[D].currentValue=n[D].endValue,n[D].endValue=E,t.isEmptyObject(u)||(n[D].easing=i.easing),x.debug&&void 0}j=n}else if("start"===F){k=g(a),k&&k.tweensContainer&&k.isAnimating===!0&&(n=k.tweensContainer);var G=function(b,c){var d,f,g;return t.isFunction(b)&&(b=b.call(a,e,B)),t.isArray(b)?(d=b[0],!t.isArray(b[1])&&/^[\d-]/.test(b[1])||t.isFunction(b[1])||z.RegEx.isHex.test(b[1])?g=b[1]:t.isString(b[1])&&!z.RegEx.isHex.test(b[1])&&x.Easings[b[1]]||t.isArray(b[1])?(f=c?b[1]:l(b[1],i.duration),g=b[2]):g=b[1]||b[2]):d=b,c||(f=f||i.easing),t.isFunction(d)&&(d=d.call(a,e,B)),t.isFunction(g)&&(g=g.call(a,e,B)),[d||0,f,g]},H=function(e,f){var g,l=z.Hooks.getRoot(e),m=!1,p=f[0],q=f[1],r=f[2];if(!(k&&k.isSVG||"tween"===l||z.Names.prefixCheck(l)[1]!==!1||z.Normalizations.registered[l]!==d))return void(x.debug&&void 0);(i.display!==d&&null!==i.display&&"none"!==i.display||i.visibility!==d&&"hidden"!==i.visibility)&&/opacity|filter/.test(e)&&!r&&0!==p&&(r=0),i._cacheValues&&n&&n[e]?(r===d&&(r=n[e].endValue+n[e].unitType),m=k.rootPropertyValueCache[l]):z.Hooks.registered[e]?r===d?(m=z.getPropertyValue(a,l),r=z.getPropertyValue(a,e,m)):m=z.Hooks.templates[l][1]:r===d&&(r=z.getPropertyValue(a,e));var s,u,v,w=!1,y=function(a,b){var c,d;return d=(b||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(a){return c=a,""}),c||(c=z.Values.getUnitType(a)),[d,c]};if(r!==p&&t.isString(r)&&t.isString(p)){g="";var A=0,B=0,C=[],D=[],E=0,F=0,G=0;for(r=z.Hooks.fixColors(r),p=z.Hooks.fixColors(p);A<r.length&&B<p.length;){var H=r[A],I=p[B];if(/[\d\.-]/.test(H)&&/[\d\.-]/.test(I)){for(var J=H,K=I,M=".",N=".";++A<r.length;){if(H=r[A],H===M)M="..";else if(!/\d/.test(H))break;J+=H}for(;++B<p.length;){if(I=p[B],I===N)N="..";else if(!/\d/.test(I))break;K+=I}var O=z.Hooks.getUnit(r,A),P=z.Hooks.getUnit(p,B);if(A+=O.length,B+=P.length,O===P)J===K?g+=J+O:(g+="{"+C.length+(F?"!":"")+"}"+O,C.push(parseFloat(J)),D.push(parseFloat(K)));else{var Q=parseFloat(J),R=parseFloat(K);g+=(E<5?"calc":"")+"("+(Q?"{"+C.length+(F?"!":"")+"}":"0")+O+" + "+(R?"{"+(C.length+(Q?1:0))+(F?"!":"")+"}":"0")+P+")",Q&&(C.push(Q),D.push(0)),R&&(C.push(0),D.push(R))}}else{if(H!==I){E=0;break}g+=H,A++,B++,0===E&&"c"===H||1===E&&"a"===H||2===E&&"l"===H||3===E&&"c"===H||E>=4&&"("===H?E++:(E&&E<5||E>=4&&")"===H&&--E<5)&&(E=0),0===F&&"r"===H||1===F&&"g"===H||2===F&&"b"===H||3===F&&"a"===H||F>=3&&"("===H?(3===F&&"a"===H&&(G=1),F++):G&&","===H?++G>3&&(F=G=0):(G&&F<(G?5:4)||F>=(G?4:3)&&")"===H&&--F<(G?5:4))&&(F=G=0)}}A===r.length&&B===p.length||(x.debug&&void 0,g=d),g&&(C.length?(x.debug&&void 0,r=C,p=D,u=v=""):g=d)}g||(s=y(e,r),r=s[0],v=s[1],s=y(e,p),p=s[0].replace(/^([+-\/*])=/,function(a,b){return w=b,""}),u=s[1],r=parseFloat(r)||0,p=parseFloat(p)||0,"%"===u&&(/^(fontSize|lineHeight)$/.test(e)?(p/=100,u="em"):/^scale/.test(e)?(p/=100,u=""):/(Red|Green|Blue)$/i.test(e)&&(p=p/100*255,u="")));var S=function(){var d={myParent:a.parentNode||c.body,position:z.getPropertyValue(a,"position"),fontSize:z.getPropertyValue(a,"fontSize")},e=d.position===L.lastPosition&&d.myParent===L.lastParent,f=d.fontSize===L.lastFontSize;L.lastParent=d.myParent,L.lastPosition=d.position,L.lastFontSize=d.fontSize;var g=100,h={};if(f&&e)h.emToPx=L.lastEmToPx,h.percentToPxWidth=L.lastPercentToPxWidth,h.percentToPxHeight=L.lastPercentToPxHeight;else{var i=k&&k.isSVG?c.createElementNS("http://www.w3.org/2000/svg","rect"):c.createElement("div");x.init(i),d.myParent.appendChild(i),o.each(["overflow","overflowX","overflowY"],function(a,b){x.CSS.setPropertyValue(i,b,"hidden")}),x.CSS.setPropertyValue(i,"position",d.position),x.CSS.setPropertyValue(i,"fontSize",d.fontSize),x.CSS.setPropertyValue(i,"boxSizing","content-box"),o.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(a,b){x.CSS.setPropertyValue(i,b,g+"%")}),x.CSS.setPropertyValue(i,"paddingLeft",g+"em"),h.percentToPxWidth=L.lastPercentToPxWidth=(parseFloat(z.getPropertyValue(i,"width",null,!0))||1)/g,h.percentToPxHeight=L.lastPercentToPxHeight=(parseFloat(z.getPropertyValue(i,"height",null,!0))||1)/g,h.emToPx=L.lastEmToPx=(parseFloat(z.getPropertyValue(i,"paddingLeft"))||1)/g,d.myParent.removeChild(i)}return null===L.remToPx&&(L.remToPx=parseFloat(z.getPropertyValue(c.body,"fontSize"))||16),null===L.vwToPx&&(L.vwToPx=parseFloat(b.innerWidth)/100,L.vhToPx=parseFloat(b.innerHeight)/100),h.remToPx=L.remToPx,h.vwToPx=L.vwToPx,h.vhToPx=L.vhToPx,x.debug>=1&&void 0,h};if(/[\/*]/.test(w))u=v;else if(v!==u&&0!==r)if(0===p)u=v;else{h=h||S();var T=/margin|padding|left|right|width|text|word|letter/i.test(e)||/X$/.test(e)||"x"===e?"x":"y";switch(v){case"%":r*="x"===T?h.percentToPxWidth:h.percentToPxHeight;break;case"px":break;default:r*=h[v+"ToPx"]}switch(u){case"%":r*=1/("x"===T?h.percentToPxWidth:h.percentToPxHeight);break;case"px":break;default:r*=1/h[u+"ToPx"]}}switch(w){case"+":p=r+p;break;case"-":p=r-p;break;case"*":p=r*p;break;case"/":p=r/p}j[e]={rootPropertyValue:m,startValue:r,currentValue:r,endValue:p,unitType:u,easing:q},g&&(j[e].pattern=g),x.debug&&void 0};for(var I in s)if(s.hasOwnProperty(I)){var J=z.Names.camelCase(I),K=G(s[I]);if(z.Lists.colors.indexOf(J)>=0){var N=K[0],O=K[1],P=K[2];if(z.RegEx.isHex.test(N)){for(var Q=["Red","Green","Blue"],R=z.Values.hexToRgb(N),S=P?z.Values.hexToRgb(P):d,T=0;T<Q.length;T++){var U=[R[T]];O&&U.push(O),S!==d&&U.push(S[T]),H(J+Q[T],U)}continue}}H(J,K)}j.element=a}j.element&&(z.Values.addClass(a,"velocity-animating"),M.push(j),k=g(a),k&&(""===i.queue&&(k.tweensContainer=j,k.opts=i),k.isAnimating=!0),C===B-1?(x.State.calls.push([M,r,i,null,y.resolver,null,0]),x.State.isTicking===!1&&(x.State.isTicking=!0,m())):C++)}var h,i=o.extend({},x.defaults,u),j={};switch(g(a)===d&&x.init(a),parseFloat(i.delay)&&i.queue!==!1&&o.queue(a,i.queue,function(b){x.velocityQueueEntryFlag=!0;var c=x.State.delayedElements.count++;x.State.delayedElements[c]=a;var d=function(a){return function(){x.State.delayedElements[a]=!1,b()}}(c);g(a).delayBegin=(new Date).getTime(),g(a).delay=parseFloat(i.delay),g(a).delayTimer={setTimeout:setTimeout(b,parseFloat(i.delay)),next:d}}),i.duration.toString().toLowerCase()){case"fast":i.duration=200;break;case"normal":i.duration=v;break;case"slow":i.duration=600;break;default:i.duration=parseFloat(i.duration)||1}if(x.mock!==!1&&(x.mock===!0?i.duration=i.delay=1:(i.duration*=parseFloat(x.mock)||1,i.delay*=parseFloat(x.mock)||1)),i.easing=l(i.easing,i.duration),i.begin&&!t.isFunction(i.begin)&&(i.begin=null),i.progress&&!t.isFunction(i.progress)&&(i.progress=null),i.complete&&!t.isFunction(i.complete)&&(i.complete=null),i.display!==d&&null!==i.display&&(i.display=i.display.toString().toLowerCase(),"auto"===i.display&&(i.display=x.CSS.Values.getDisplayType(a))),i.visibility!==d&&null!==i.visibility&&(i.visibility=i.visibility.toString().toLowerCase()),i.mobileHA=i.mobileHA&&x.State.isMobile&&!x.State.isGingerbread,i.queue===!1)if(i.delay){var k=x.State.delayedElements.count++;x.State.delayedElements[k]=a;var n=function(a){return function(){x.State.delayedElements[a]=!1,f()}}(k);g(a).delayBegin=(new Date).getTime(),g(a).delay=parseFloat(i.delay),g(a).delayTimer={setTimeout:setTimeout(f,parseFloat(i.delay)),next:n}}else f();else o.queue(a,i.queue,function(a,b){return b===!0?(y.promise&&y.resolver(r),!0):(x.velocityQueueEntryFlag=!0,void f(a))});(""===i.queue||"fx"===i.queue)&&"inprogress"!==o.queue(a)[0]&&o.dequeue(a)}var j,k,p,q,r,s,u,w=arguments[0]&&(arguments[0].p||o.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||t.isString(arguments[0].properties));t.isWrapped(this)?(k=!1,q=0,r=this,p=this):(k=!0,q=1,r=w?arguments[0].elements||arguments[0].e:arguments[0]);var y={promise:null,resolver:null,rejecter:null};if(k&&x.Promise&&(y.promise=new x.Promise(function(a,b){y.resolver=a,y.rejecter=b})),w?(s=arguments[0].properties||arguments[0].p,u=arguments[0].options||arguments[0].o):(s=arguments[q],u=arguments[q+1]),r=f(r),!r)return void(y.promise&&(s&&u&&u.promiseRejectEmpty===!1?y.resolver():y.rejecter()));var B=r.length,C=0;if(!/^(stop|finish|finishAll|pause|resume)$/i.test(s)&&!o.isPlainObject(u)){var D=q+1;u={};for(var E=D;E<arguments.length;E++)t.isArray(arguments[E])||!/^(fast|normal|slow)$/i.test(arguments[E])&&!/^\d/.test(arguments[E])?t.isString(arguments[E])||t.isArray(arguments[E])?u.easing=arguments[E]:t.isFunction(arguments[E])&&(u.complete=arguments[E]):u.duration=arguments[E]}var F;switch(s){case"scroll":F="scroll";break;case"reverse":F="reverse";break;case"pause":var G=(new Date).getTime();return o.each(r,function(a,b){h(b,G)}),o.each(x.State.calls,function(a,b){var c=!1;b&&o.each(b[1],function(a,e){var f=u===d?"":u;return f!==!0&&b[2].queue!==f&&(u!==d||b[2].queue!==!1)||(o.each(r,function(a,d){if(d===e)return b[5]={resume:!1},c=!0,!1}),!c&&void 0)})}),a();case"resume":return o.each(r,function(a,b){i(b,G)}),o.each(x.State.calls,function(a,b){var c=!1;b&&o.each(b[1],function(a,e){var f=u===d?"":u;return f!==!0&&b[2].queue!==f&&(u!==d||b[2].queue!==!1)||(!b[5]||(o.each(r,function(a,d){if(d===e)return b[5].resume=!0,c=!0,!1}),!c&&void 0))})}),a();case"finish":case"finishAll":case"stop":o.each(r,function(a,b){g(b)&&g(b).delayTimer&&(clearTimeout(g(b).delayTimer.setTimeout),g(b).delayTimer.next&&g(b).delayTimer.next(),
delete g(b).delayTimer),"finishAll"===s&&(u===!0||t.isString(u))&&(o.each(o.queue(b,t.isString(u)?u:""),function(a,b){t.isFunction(b)&&b()}),o.queue(b,t.isString(u)?u:"",[]))});var H=[];return o.each(x.State.calls,function(a,b){b&&o.each(b[1],function(c,e){var f=u===d?"":u;return f!==!0&&b[2].queue!==f&&(u!==d||b[2].queue!==!1)||void o.each(r,function(c,d){if(d===e)if((u===!0||t.isString(u))&&(o.each(o.queue(d,t.isString(u)?u:""),function(a,b){t.isFunction(b)&&b(null,!0)}),o.queue(d,t.isString(u)?u:"",[])),"stop"===s){var h=g(d);h&&h.tweensContainer&&f!==!1&&o.each(h.tweensContainer,function(a,b){b.endValue=b.currentValue}),H.push(a)}else"finish"!==s&&"finishAll"!==s||(b[2].duration=1)})})}),"stop"===s&&(o.each(H,function(a,b){n(b,!0)}),y.promise&&y.resolver(r)),a();default:if(!o.isPlainObject(s)||t.isEmptyObject(s)){if(t.isString(s)&&x.Redirects[s]){j=o.extend({},u);var I=j.duration,J=j.delay||0;return j.backwards===!0&&(r=o.extend(!0,[],r).reverse()),o.each(r,function(a,b){parseFloat(j.stagger)?j.delay=J+parseFloat(j.stagger)*a:t.isFunction(j.stagger)&&(j.delay=J+j.stagger.call(b,a,B)),j.drag&&(j.duration=parseFloat(I)||(/^(callout|transition)/.test(s)?1e3:v),j.duration=Math.max(j.duration*(j.backwards?1-a/B:(a+1)/B),.75*j.duration,200)),x.Redirects[s].call(b,b,j||{},a,B,r,y.promise?y:d)}),a()}var K="Velocity: First argument ("+s+") was not a property map, a known action, or a registered redirect. Aborting.";return y.promise?y.rejecter(new Error(K)):void 0,a()}F="start"}var L={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},M=[];o.each(r,function(a,b){t.isNode(b)&&e(b,a)}),j=o.extend({},x.defaults,u),j.loop=parseInt(j.loop,10);var N=2*j.loop-1;if(j.loop)for(var O=0;O<N;O++){var P={delay:j.delay,progress:j.progress};O===N-1&&(P.display=j.display,P.visibility=j.visibility,P.complete=j.complete),A(r,"reverse",P)}return a()};x=o.extend(A,x),x.animate=A;var B=b.requestAnimationFrame||q;if(!x.State.isMobile&&c.hidden!==d){var C=function(){c.hidden?(B=function(a){return setTimeout(function(){a(!0)},16)},m()):B=b.requestAnimationFrame||q};C(),c.addEventListener("visibilitychange",C)}return a.Velocity=x,a!==b&&(a.fn.velocity=A,a.fn.velocity.defaults=x.defaults),o.each(["Down","Up"],function(a,b){x.Redirects["slide"+b]=function(a,c,e,f,g,h){var i=o.extend({},c),j=i.begin,k=i.complete,l={},m={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""};i.display===d&&(i.display="Down"===b?"inline"===x.CSS.Values.getDisplayType(a)?"inline-block":"block":"none"),i.begin=function(){0===e&&j&&j.call(g,g);for(var c in m)if(m.hasOwnProperty(c)){l[c]=a.style[c];var d=z.getPropertyValue(a,c);m[c]="Down"===b?[d,0]:[0,d]}l.overflow=a.style.overflow,a.style.overflow="hidden"},i.complete=function(){for(var b in l)l.hasOwnProperty(b)&&(a.style[b]=l[b]);e===f-1&&(k&&k.call(g,g),h&&h.resolver(g))},x(a,m,i)}}),o.each(["In","Out"],function(a,b){x.Redirects["fade"+b]=function(a,c,e,f,g,h){var i=o.extend({},c),j=i.complete,k={opacity:"In"===b?1:0};0!==e&&(i.begin=null),e!==f-1?i.complete=null:i.complete=function(){j&&j.call(g,g),h&&h.resolver(g)},i.display===d&&(i.display="In"===b?"auto":"none"),x(this,k,i)}}),x}(window.jQuery||window.Zepto||window,window,window?window.document:void 0)}),c("common/directives/slider",["modernizr","jquery","angular","velocity"],function(a,b,c){"use strict";var d=function(){return{restrict:"A",replace:!0,controller:e,link:f,scope:{opts:"=opts",numItems:"=numItems"}}},e=function(a,b,c,d){this._$scope=a,this._$swipe=b,this._$timeout=c,this._windowService=d};e.$inject=["$scope","$swipe","$timeout","windowService"];var f=function(d,e,f,g){function h(a){d.bp=a,d.carousel.index=1}function i(a){d.carousel.index=a}function j(){a.touch&&g._$swipe.bind(M,{start:function(a){0===N&&(N=1,O=a.x,Q=b(M.find(".promo__3up-slide")[0]).position(),R=Q.left)},move:function(a){if(0!==N){var b=a.x-O;1===N&&0!==b?(N=2,P=R):2===N&&(R=P+b,M.css("left",R))}},end:function(a){var c=a.x-O;if(c>-S&&c<S)R=P;else{var e=0,f=b(M.find(".promo__3up-slide")[1]).width(),g=Math.abs(c);e=Math.round(g/f),c<0?e>0&&d.carousel.index<T&&d.carousel.index++:c>0?e>0&&d.carousel.index>1&&d.carousel.index--:d.carousel.index=1,M.css("left","auto"),v(0,0,d.carousel.index,!1,!0)}N=0}})}function k(){for(var a=0;a<I.length;a++){K[a]=1;var c=b(I[a]).find(H.imagesSelector).length;!!(H.showDots&&c>1)&&C(I[a]),!!(H.showArrows&&c>1)&&E(I[a]),c>1&&2!==H.sliderType&&p(I[a]),!!(H.autoChange&&c>1)&&A(a),2!==H.sliderType&&q(I[a]),!!H.sliderType&&(L[a]=0),c>0&&l(I[a]),F(a)}H.shouldTransition&&b(I[0]).find(H.imagesSelector).length>1&&setTimeout(function(){H.shouldTransition&&u(0)},1e4)}function l(a){switch(H.sliderType){case 0:n(a);break;case 1:o(a);break;case 2:m(a)}}function m(a){K[I.index(a)]=0,b(b(a).find(H.imagesSelector)[0]).addClass("active"),setTimeout(function(){b(a).find(H.imagesSelector).velocity({opacity:0},{duration:0,complete:function(){b(b(a).find(H.imagesSelector)[0]).velocity({opacity:1},0)}})},100)}function n(a){setTimeout(function(){b(a).find(H.imagesContainer).velocity({translateX:-b(a).width()},0)},100)}function o(a){setTimeout(function(){var c=b(a).find('input[type="hidden"]'),d=0;if(c.length>0){for(var e=0;e<b(a).find(H.imagesSelector).length;e++)b(b(a).find(H.imagesSelector)[e]).text().trim()===b(c[0]).val()&&(d=e,K[I.index(a)]=e,L[I.index(a)]=e);b(a).find(H.imagesContainer).velocity({translateY:-(d*b(a).height())},0)}else b(a).find(H.imagesContainer).velocity({translateY:b(a).height()},0)},100)}function p(a){if(2!==H.sliderType){var c=b(b(a).find(H.imagesContainer)[0]),d=b(b(a).find(H.imagesSelector)[0]).clone();c.append(d);var e=b(b(a).find(H.imagesSelector)[b(a).find(H.imagesSelector).length-2]).clone();c.prepend(e)}}function q(a){switch(H.sliderType){case 0:s(a);break;case 1:r(a)}}function r(){}function s(a){var c=b(b(a).find(H.imagesContainer)[0]),d=100*b(a).find(H.imagesSelector).length;c.width(d+"%")}function t(a){var c=!1;L[a]=K[a],--K[a],K[a]<0&&(2!==H.sliderType?K[a]=0:K[a]=b(I[a]).find(H.imagesSelector).length-1,c=b(I[a]).find(H.imagesSelector).length-2),v(a,H.interval,K[a],c)}function u(a){var c=!1;L[a]=K[a],++K[a],K[a]>=b(I[a]).find(H.imagesSelector).length&&(2!==H.sliderType?K[a]=b(I[a]).find(H.imagesSelector).length-1:K[a]=0,c=1),v(a,H.interval,K[a],c)}function v(a,b,c,d,e){switch(H.sliderType){case 0:w(a,b,c,d,e);break;case 1:x(a,b,c,d,e);break;case 2:y(a,b,c,d,!0)}}function w(a,c,d,e,f){var g=H.slideDuration;B(a),"undefined"!=typeof f&&B(a),K[a]=d;var h=b(b(I[a]).find(H.imagesSelector)[d]).position().left;b(I[a]).find(H.imagesContainer).velocity("stop").velocity({translateX:-h,translateZ:1},{duration:g,easing:"ease",begin:function(){e?z(a,e-1):z(a,d-1)},complete:function(c){e&&(K[a]=e,b(c).velocity({translateX:-(b(I[a]).width()*e)},0)),A(a)}})}function x(a,c,d,e,f){var g=H.slideDuration;B(a),"undefined"!=typeof f&&B(a),K[a]=d,b(I[a]).find(H.imagesContainer).velocity("stop").velocity({translateY:-(b(I[a]).height()*d),translateZ:1},{duration:g,easing:"ease",begin:function(){e?z(a,e-1):z(a,d-1)},complete:function(c){e&&(K[a]=e,b(c).velocity({translateY:-(b(I[a]).height()*e)},0)),A(a),H.callback.call(this,{me:I[a],currentSlide:K[a]-1,currentSlideText:b(b(I[a]).find(H.imagesSelector)[K[a]]).text()})}})}function y(a,c,d,e,f){L[a]=K[a];var g=H.slideDuration;B(a),"undefined"!=typeof f&&B(a),K[a]=d,b(I[a]).find(H.imagesSelector).map(function(a,c){b(c).velocity("stop").velocity({opacity:0},{duration:g,easing:"ease",complete:function(){b(this).removeClass("active")}})}),b(b(I[a]).find(H.imagesSelector)[K[a]]).velocity("stop").velocity({opacity:1},{duration:g,easing:"ease",begin:function(){z(a,K[a])},complete:function(){A(a),b(this).addClass("active")}})}function z(a,c){b(I[a]).find("."+H.dotsClass).removeClass("active"),b(b(I[a]).find("."+H.dotsClass)[c]).addClass("active")}function A(a){H.autoChange&&b(I[a]).find(H.imagesSelector).length>1&&(J[a]=setTimeout(function(){u(a)},H.interval))}function B(a){H.autoChange&&clearTimeout(J[a])}function C(a){var c;c=b("<div />").addClass(H.dotsContainerClass),b(a).append(c),D(c,b(a).find(H.imagesSelector).length)}function D(a,c){for(var d,e=0;e<c;e++)d=b("<span />"),0===e&&d.addClass("active"),d.addClass(H.dotsClass),b(a).append(d)}function E(a){var c=b("<div />").addClass("arrow").addClass("arrow-left"),d=b("<div />").addClass("arrow").addClass("arrow-right"),e=b("<div />").addClass(H.arrowsContainerClass);H.arrowsInContainer?(e.append(c,d),b(a).append(e)):b(a).append(c,d)}function F(a){b(I[a]).mouseover(function(){"undefined"!=typeof J[a]&&B(a)}),b(I[a]).mouseout(function(){"undefined"!=typeof J[a]&&A(a)}),b(I[a]).on("click",function(c){if(b(c.target).hasClass("dot")){H.shouldTransition=!1,B(a),K[a]=b(c.target).parent().children().index(c.target)+1;var d=b(c.target).parent().children().index(c.target)+1;2===H.sliderType&&(d=b(c.target).parent().children().index(c.target)),v(a,0,d)}b(c.target).hasClass("arrow-left")&&(B(a),t(a)),b(c.target).hasClass("arrow-right")&&(B(a),u(a))}),b(window).on("resize",function(){G()})}function G(){for(var a=0;a<I.length;a++){var c=b(I[a]).find(H.imagesSelector).length;c>1&&v(a,0,K[a],!1,!0)}}var H={showArrows:!1,arrowsInContainer:!1,arrowsContainerClass:"arrows",imagesContainer:".promo__1up-container",imagesSelector:".promo__1up-slide",showDots:!0,dotsContainerClass:"dots",dotsClass:"dot",autoChange:!1,interval:2e3,verbose:!1,slideDuration:400,sliderType:1,shouldTransition:!1},I=e,J=new Array(I.length),K=new Array(I.length),L=new Array(I.length),M=e.find(".promo__3up-container"),N=0,O=0,P=0,Q=0,R=0,S=50,T=3;d.$watch("opts",function(){H=c.extend({},H,d.opts),setTimeout(function(){k()},1e3)}),d.$watch(g._windowService.breakpoint,h.bind(this)),d.carousel={index:0,onNavClick:i.bind(this)},j()};return d}),c("common/directives/traveler-form",["angular","moment"],function(a,b){"use strict";var c=function(){return{restrict:"A",replace:!0,scope:!0,controller:d,templateUrl:"/app/common/directives/traveler-form.tpl.html"}},d=function(a,b,c,d){this._$scope=a,this._elevateService=b,this._fareService=c,this._pubSubService=d,this._fieldsRequiredWithPassport=["issuingCountry","expirationDate","citizenship","residence","emergencyName","emergencyPhone"],this._validationMap={MISMATCH:{ruleName:"ffMismatch",errorMessage:"mismatch"},VALIDATING:{ruleName:"ffValidating",errorMessage:"validating..."},INVALID:{ruleName:"ffInvalid"}},a.travelerForm={},a.compareDate=this._getDepartureDate($.map(this._fareService.getSelectedFares(),function(a){return a.legs})),a.$watch("traveler.frequentFlyer",this._onSelectFrequentFlyer.bind(this),!0),a.$watch("travelerInfo.travelerFields[travelerInfo.selectedTravelerModelIndex].frequentFlyerNumber.hasFocus",function(a,b){a===!1&&b===!0&&this._validateFrequentFlyer()}.bind(this),!0),a.$watch("travelerInfo.travelerFields[travelerInfo.selectedTravelerModelIndex].firstName.hasFocus",function(a,b){a===!1&&b===!0&&(this._validateFrequentFlyer(),this._$scope.travelerInfo.updateGreeting())}.bind(this),!0),a.$watch("travelerInfo.travelerFields[travelerInfo.selectedTravelerModelIndex].lastName.hasFocus",function(a,b){a===!1&&b===!0&&(this._validateFrequentFlyer(),this._$scope.travelerInfo.updateGreeting())}.bind(this),!0),a.$watch("travelerInfo.travelerFields[travelerInfo.selectedTravelerModelIndex].firstName.value",function(a,b){a!==b&&this._onFirstNameChange()}.bind(this),!0),a.$watch("travelerInfo.travelerFields[travelerInfo.selectedTravelerModelIndex].lastName.value",function(a,b){a!==b&&this._onLastNameChange()}.bind(this),!0),a.$watch("travelerInfo.travelerFields[travelerInfo.selectedTravelerModelIndex].frequentFlyerNumber.value",function(a,b){a!==b&&this._onFFNumberChange()}.bind(this),!0),a.$watch("travelerInfo.travelerFields[travelerInfo.selectedTravelerModelIndex].passport.value",function(a,b){a!==b&&this._onPassportChange(a)}.bind(this),!0),this._isCheckingFF=!1};return d.$inject=["$scope","elevateService","fareService","pubSubService"],d.prototype._getDepartureDate=function(c){var d=b().subtract("years",2);return a.forEach(c,function(a){var c=b(a.departureDateTime);c>d&&(d=c)}),d},d.prototype._getTravelerForm=function(){var a=this._$scope.travelerInfo;return a.travelerFields[a.selectedTravelerModelIndex]},d.prototype._isElevateChosen=function(){var a=!1,b=this._getTravelerForm();if(b&&b.frequentFlyer&&b.frequentFlyer.value){var c=b.frequentFlyer.value.value;a=c===this._$scope.travelerInfo.constants.VIRGIN_AMERICA_FF}return a},d.prototype._isElevateNumberFieldLocked=function(){var a=this._getTravelerForm();return this._$scope.travelerInfo.elevateBookingForSelf()&&a.frequentFlyer&&a.frequentFlyer.value&&a.frequentFlyer.value.value===this._$scope.travelerInfo.constants.VIRGIN_AMERICA_FF},d.prototype._isElevateLocallyValid=function(){var a=!1;if(this._isElevateChosen()){var b=this._getTravelerForm();if(b){var c=this._getFFNumber(),d=b.frequentFlyer.value.value;a=c&&d&&this._elevateService.locallyValidateFFPNumber(d,c)}}return a},d.prototype._needsElevateRemoteValidation=function(){return this._changedFirstName||this._changedLastName||this._changedFFNumber},d.prototype._onFirstNameChange=function(){this._changedFirstName=!0},d.prototype._onLastNameChange=function(){this._changedLastName=!0},d.prototype._onFFNumberChange=function(){this._changedFFNumber=!0;var a=this._getTravelerForm();a&&a.frequentFlyerNumber&&a.frequentFlyerNumber.value&&this._validateFrequentFlyer()},d.prototype._onPassportChange=function(a){var b,c=this._getTravelerForm(),d="undefined"==typeof a||""===a,e=d?"optional":"required";this._fieldsRequiredWithPassport.forEach(function(a){b=c[a].validate&&c[a].validate.length>1,b?c[a].toggleRequiredValidation(e):c[a].setValidationRules(e,!0)})},d.prototype._onSelectFrequentFlyer=function(a,b){if(a!==b){var c=this._getTravelerForm();if(c)if(null===a)this._$scope.travelerInfo.elevateBookingForSelf()?c.frequentFlyer.value=c.frequentFlyer.options[0]:(c.frequentFlyerNumber&&c.frequentFlyerNumber.setVisibility(!1),this._resetElevateValidationStatus(),this._resetValidations());else if(!this._isElevateChosen()){if(this._resetElevateValidationStatus(),this._resetValidations(),!c.frequentFlyerNumber)return;c.frequentFlyerNumber.value="",c.frequentFlyerNumber.validateValue(""),c.frequentFlyerNumber.setVisibility(!0)}}},d.prototype._getFFNumber=function(){var a=this._getTravelerForm();return a&&a.frequentFlyerNumber?this._isElevateNumberFieldLocked()?this._$scope.traveler.elevateNumber:a.frequentFlyerNumber.value:void 0},d.prototype._validateFrequentFlyer=function(){var a=this._getTravelerForm();if(a&&a.frequentFlyerNumber){var b=a.firstName.value,c=a.lastName.value,d=this._getFFNumber(),e=a.frequentFlyer.value&&a.frequentFlyer.value.value;if(!d)return void this._resetValidations();if(this._isElevateChosen())if(this._isElevateLocallyValid())if(this._needsElevateRemoteValidation()&&b&&c&&d){if(!this._isCheckingFF){this._isCheckingFF=!0,this._triggerValidation(this._validationMap.VALIDATING);var f=this._elevateService.validateElevateId(b,c,d);f.then(this._onFrequentFlyerResponseSuccess.bind(this),this._onFrequentFlyerResponseError.bind(this))}}else this._resetValidations();else this._resetValsThenSetFFInvalid();else d&&e&&this._elevateService.locallyValidateFFPNumber(e,d)?this._resetValidations():this._resetValsThenSetFFInvalid()}},d.prototype._onFrequentFlyerResponseSuccess=function(){this._isCheckingFF=!1,this._resetValidations(),this._resetElevateValidationStatus()},d.prototype._onFrequentFlyerResponseError=function(){this._isCheckingFF=!1,this._triggerValidation(this._validationMap.MISMATCH),this._resetElevateValidationStatus()},d.prototype._resetElevateValidationStatus=function(){this._changedFirstName=!1,this._changedLastName=!1,this._changedFFNumber=!1},d.prototype._triggerValidation=function(a){var b=this._getTravelerForm();this._pubSubService.publish("facadeInput.fullName.setInvalidMessageOverride",[a.errorMessage]),b.firstName&&b.firstName.setValidationRules(a.ruleName),b.lastName&&b.lastName.setValidationRules(a.ruleName),b.frequentFlyerNumber&&b.frequentFlyerNumber.setValidationRules(a.ruleName)},d.prototype._resetValidations=function(){var a=this._getTravelerForm();this._pubSubService.publish("facadeInput.fullName.resetInvalidMessageOverride"),a.firstName&&a.firstName.resetValidationRules(),a.lastName&&a.lastName.resetValidationRules(),a.frequentFlyerNumber&&a.frequentFlyerNumber.resetValidationRules()},d.prototype._resetValsThenSetFFInvalid=function(){this._resetValidations(),this._getTravelerForm().frequentFlyerNumber.setValidationRules(this._validationMap.INVALID.ruleName)},c}),c("common/directives/avatar-picker",["angular"],function(a){"use strict";var b=function(){return{restrict:"A",scope:!0,controller:c,link:d}},c=function(a,b,c){this._$scope=a,this._$parse=b,this._windowService=c,this._$scope.avatarPicker={newAvatarSelected:!1,selectedAvatar:null,toggleAvatars:this.toggleAvatars.bind(this),selectAvatar:this.selectAvatar.bind(this),viewAvatarSelector:!1,isFocused:!1,name:"avatar",isValid:!0,isVisible:!0,value:null},this._$scope.$on("newAvatarList",function(a,b){this._$scope.avatars=b}.bind(this)),this._windowService.setAvatarPickerOpen(!1)};c.$inject=["$scope","$parse","windowService"],c.prototype.toggleAvatars=function(){if(!this._customToggleFn()){var a=!this._$scope.avatarPicker.viewAvatarSelector;this._$scope.avatarPicker.viewAvatarSelector=a,this._windowService.setAvatarPickerOpen(a)}},c.prototype._customToggleFn=function(){if(this._$scope.customToggleFn)return this._$parse(this._$scope.customToggleFn)(this._$scope)},c.prototype.setValue=function(a){this.selectAvatar(a)},c.prototype.selectAvatar=function(b,c,d){a.extend(this._$scope.avatarPicker,{selectedAvatar:b,newAvatarSelected:!0,value:b}),c&&this._$scope.$emit("elevate-avatar-selected",b),d&&this.toggleAvatars()};var d=function(b,c,d,e){a.extend(b,{formHandler:e._$parse(d.formHandler)(b),avatars:e._$parse(d.avatars)(b),selectedAvatar:e._$parse(d.selectedAvatar)(b)||null,customToggleFn:d.customToggleFn});var f=b.selectedAvatar||b.avatars[0];b.avatarPicker.selectedAvatar=f,b.avatarPicker.value=f,e.values=b.avatarPicker,b.formHandler&&b.formHandler.register(b.avatarPicker.name,e),b.$emit("elevate-avatar-selected",f);var g=c.find(".avatar-list-container"),h=function(){g.css("height",e._windowService.getDeviceWindowHeight()+"px")};h(),e._windowService.subscribe("windowService.resize",h)};return b}),c("common/directives/elevate-login-form",["angular"],function(a){"use strict";var b=function(){return{restrict:"A",scope:!0,controller:c,link:d,templateUrl:"/app/common/directives/elevate-login-form.tpl.html"}},c=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){this._$scope=a,this._$modal=b,this._$timeout=c,this._$detection=d,this._windowService=f,this._elevateService=g,this._statusService=h,this._scrollService=i,this._utilsService=j,this._resourceBundle=k,this._locationService=l,this._loadingService=m,this._pubSubService=n,this._$scope.elevateLoginForm={fields:{},isFirefox:this._$detection.isFirefox(),isRecognizedUser:!1,doLogin:this.doLogin.bind(this),destroyRecognized:this.destroyRecognized.bind(this),showForgotPassword:this.showForgotPassword.bind(this)},this._$scope.$watch(this._elevateService.isRecognizedNotLoggedIn,function(a){this._extendScopeRecognized(a)}.bind(this))};c.$inject=["$scope","$modal","$timeout","$detection","cms","windowService","elevateService","statusService","scrollService","utilsService","ResourceBundle","locationService","loadingService","pubSubService"],c.prototype._extendScopeRecognized=function(b){a.extend(this._$scope.elevateLoginForm,{elevateId:this._elevateService.getUserData().elevateId,name:this._elevateService.getUserData().firstName+" "+this._elevateService.getUserData().lastName,email:this._elevateService.getUserData().emailId,avatar:this._elevateService.getUserData().avatar,isRecognizedUser:b}),this._$scope.elevateLoginForm.fields.email&&b&&(this._$scope.elevateLoginForm.fields.email.value=this._elevateService.getUserData().emailId,this._$scope.elevateLoginForm.fields.email.isValid=!0),(this._$scope.elevateLoginForm.fields.password&&this._$scope.elevateLoginForm.fields.password.value||this._$scope.elevateLoginForm.isFirefox)&&(this._$scope.elevateLoginForm.fields.password.isValid=!0)},c.prototype.doLogin=function(){var a,b=this;if(a=this._$scope.elevateLoginForm.isRecognizedUser?this._$scope.elevateLoginForm.email:this._$scope.elevateLoginForm.fields.email.value,"virgindevs@work.co"===a)return void this._locationService.go({target:"/images/oldschool/index.html",external:!0});var c=this._$scope.elevateLoginForm.fields.password.value;this._$scope.elevateLoginForm.fields.password.value="";var d=function(){if(b._locationService.contextIs(b._locationService.contexts.CHECKIN,b._locationService.contexts.MANAGE)){var a=b._elevateService.retrieveAccountInfo({context:"elevateLanding"});b._loadingService.setLoading(a),a.then(function(){b.onUserLoggedIn()})}else b._$scope.contextIsElevateShop?b.submitShopForm():b.onUserLoggedIn()},e=this._elevateService.doLogin(a,c);return e.then(d),e},c.prototype.destroyRecognized=function(){this._$scope.elevateLoginForm.fields.email.value="",this._elevateService.destroyRecognizedUser()},c.prototype.showForgotPassword=function(){var a=this._resourceBundle.modal.forgotPassword;this._$modal.open({size:a.SIZE,title:a.TITLE,templateUrl:a.TEMPLATE_URL})},c.prototype.onUserLoggedIn=function(){this._pubSubService.publish("elevate.loggedIn"),this._windowService.elevateLogin()&&this._$timeout(function(){this._locationService.go({target:"/elevate-frequent-flyer/landing-logged"})}.bind(this))},c.prototype.submitShopForm=function(){var a=this._elevateService.getSSOData();this._loadingService.setLoading(a);var b=function(a){this._$scope.elevateLoginForm.authToken=a.data.response.ssoData,$("#transfer").attr("action",a.data.response.url),this._$timeout(function(){$("#transfer").submit()})}.bind(this),c=function(){};a.then(b,c)};var d=function(b,c,d){b.formContext=d.formContext,a.extend(b,{contextIsElevate:"elevate"===b.formContext,contextIsElevateShop:"elevate-shop"===b.formContext,contextIsChange:"change"===b.formContext,contextIsCheckIn:"check-in"===b.formContext})};return b}),c("common/directives/seat-selector",["angular"],function(a){"use strict";var b=function(){return{restrict:"A",controller:c,link:d,templateUrl:"/app/common/directives/seat-selector.tpl.html"}},c=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){this._numberFilter=a("number"),this._$rootScope=b,this._$scope=c,this._$q=d,this._$modal=e,this._$singleTimeout=f,this._fareService=g,this._changeService=h,this._seatService=i,this._elevateService=j,this._purchaseService=k,this._resourceBundle=l,this._locationService=m,this._statusService=n,this._windowService=o,this._bookingTimerService=p,this._pubSubService=q,this._travelerService=r,this._loadingService=s,this._checkInService=t,this._workflowService=u,this._tripService=v,this._ancillariesService=w,this._accessibleService=x,this._travelerInfo={},this._message={SELECT_SEATS_KNOWN:"known",SELECT_SEATS_CHANGE:"change",SELECT_SEATS_UPGRADED:"upgraded",SELECT_SEATS_UNAVAILABLE:"unavailable"},this._seatChangedStatus={SEAT_NOT_CHANGED:"seatNotChanged",SEAT_CHANGED:"seatChanged"},this._contexts=this._locationService.contexts,this._contextIs=this._locationService.contextIs,this._travelerGuids=[],this._originalFareClasses={},this._$timeout=y,this._orderList=["main","mcs","first"],this.changingSelection=!1,this._skippedSegments={},this._tierMap={main:"main",mainRefundable:"main",mcs:"mcs",mcsRefundable:"mcs",first:"first",firstRefundable:"first"},this._cabinMap={MC:"main",MCS:"mcs",FIRST:"first"},this._rowGroups=[["A","B","C"],["D","E","F"]],this._numberOfInfants=0,this._seatsLockedToInfants=[],this._selectedSeatsBySegment=[[],[],[],[]],this._statusTypeBySegment={},this._selectedTraveler=null,this._requestedQuote=!1,this._configureScope(),this._configurePubSub(),this._updateTravelerData(),this._$scope.$on("$destroy",function(){this._statusService.setStatus([])}.bind(this))};c.$inject=["$filter","$rootScope","$scope","$q","$modal","$singleTimeout","fareService","changeService","seatService","elevateService","purchaseService","ResourceBundle","locationService","statusService","windowService","bookingTimerService","pubSubService","travelerService","loadingService","checkInService","workflowService","tripService","ancillariesService","accessibleService","$timeout"],c.prototype._configureScope=function(){this._$scope.seatSelector={segments:{},typeLabel:[],arrival:[],departure:[],currentSegmentIndex:0,isCollapsed:{},isVisibleSection:this.isVisibleSection.bind(this),mapTitleForSegment:this.mapTitleForSegment.bind(this),sortRows:this.sortRows.bind(this),getTierLabel:this.getTierLabel.bind(this),tierAlterationCost:this.tierAlterationCost.bind(this),tierAlterationLabel:this.tierAlterationLabel.bind(this),isAlterationPermitted:this.isAlterationPermitted.bind(this),previouslySelectedSeat:this.previouslySelectedSeat.bind(this),selectSeat:this.selectSeat.bind(this),isLastSeatInRow:this.isLastSeatInRow.bind(this),openFareInfoModal:this.openFareInfoModal.bind(this),payNow:!1,skipSeatSelection:this.skipSeatSelection.bind(this),selectedTravelerIndex:0,onLocalScrollStart:this.onLocalScrollStart.bind(this),keepCurrentSeat:this.keepCurrentSeat.bind(this),tierExcluded:this.tierExcluded.bind(this),isSeatSelected:this.isSeatSelected.bind(this),transitionToPayment:this.transitionToPayment.bind(this),shouldShowContinueButton:this.shouldShowContinueButton.bind(this),selectedSeatsString:{},selectedSeatsData:[],changeSelection:this.changeSelection.bind(this),getSeatAncillary:this.getSeatAncillary.bind(this),isAncillaryForFree:this.isAncillaryForFree.bind(this),shouldSeatShowAncillary:this.shouldSeatShowAncillary.bind(this)}},c.prototype._configurePubSub=function(){(this._contextIs(this._contexts.BOOK)||this._contextIs(this._contexts.CHANGE))&&(this._pubSubService.subscribe("seatSelector.resetSelectedTravelerIndex",function(){this._$scope.seatSelector.selectedTravelerIndex=0}.bind(this)),this._pubSubService.subscribe("yts.payNow",function(a){this._$scope.seatSelector.payNow=a}.bind(this)),this._$scope.$on("seatService.reset",function(){this._selectedSeatsBySegment=[[],[],[],[]],this._$scope.seatSelector.currentSegmentIndex=0,this._$scope.seatSelector.isCollapsed={}}.bind(this))),this._pubSubService.subscribe("seatSelector.skipSeatSelection",function(a){this.skipSeatSelection(a)}.bind(this)),this._pubSubService.subscribe("seatSelector.updateTravelers",this._updateTravelerData.bind(this)),this._pubSubService.clear("seatSelector.keepCurrentSeat"),this._pubSubService.subscribe("seatSelector.keepCurrentSeat",this.keepCurrentSeat.bind(this)),this._pubSubService.subscribe("expandFirstSeatSelector",function(){this.changeSelection(0)}.bind(this)),this._pubSubService.subscribe("expandSecondSeatSelector",function(){var a=this._$scope.seatSelector.segmentsData.length,b=a>2?2:1;if(3===a){var c=this._fareService.getSelectedFares();b=1===c[0].legs.length?1:2}this.changeSelection(b)}.bind(this)),this._pubSubService.subscribe("alternateFareInventoryLocked",this._areAllSeatsSelected.bind(this)),this._pubSubService.subscribe("legs",this._segmentsDataHandler.bind(this)),this._pubSubService.subscribe("seatSelector.updateSelectedSeatsString",function(){a.forEach(this._$scope.seatSelector.selectedSeatsString,function(a,b){this._updateSelectedSeatsString(b)}.bind(this))}.bind(this))},c.prototype.changeSelection=function(a){this.changingSelection=!0;var b=this._$scope.seatSelector.segmentsData.length;this._$scope.seatSelector.isCollapsed[a]=!1,this._accessibleService.resolveExpand(this._$scope.seatSelector.sectionLength);for(var c=a+1;c<b;c++)this._$scope.seatSelector.isCollapsed[c]=!1;var d=this._seatService.getSelectedSeats(a);for(var e in d)d[e].selected&&this.selectSeat(null,d[e],a);var f=a<=this._$scope.seatSelector.currentSegmentIndex;if(f)for(var g=a;g<b;g++)this._deselectSeatsForSegment(null,g);for(var h=null,i=a;i<b;i++)h=this._getFlightSegmentByIndex(i),this._seatService.setAllSeatsSelected(i,!1,h);this._$scope.seatSelector.currentSegmentIndex=a,this._travelerInfo={currentIndex:this._$scope.seatSelector.currentSegmentIndex,totalSegments:this._$scope.seatSelector.segmentsData.length},this._updateStatus(this._message.SELECT_SEATS_KNOWN),this.changingSelection=!1,this._requestedQuote=!1,this._refreshSeats()},c.prototype.getSeatAncillary=function(a,b){return"undefined"!=typeof this._currentTraveler.guestId&&b&&b.ancilarriesPerPax&&a&&a.ancillaries&&"undefined"!=typeof b.ancilarriesPerPax[this._currentTraveler.guestId]&&a.ancillaries[b.ancilarriesPerPax[this._currentTraveler.guestId]]},c.prototype.isSeatSelected=function(a){return a.selected},c.prototype._updateTravelerData=function(){this._$scope.seatSelector.totalSegments=this._seatService.getRequestModels().length,this._travelerGuids=this._travelerService.getTravelerGuids(!0),this._currentTraveler=this._updateCurrentTraveler()},c.prototype._updateStatus=function(a){var b,c=this._currentTraveler,d=!1;if(!a)return void this._statusService.setStatus([]);if(b=this._getFlightSegmentByIndex(this._$scope.seatSelector.currentSegmentIndex),"undefined"!=typeof b){var e;switch(a){case this._message.SELECT_SEATS_KNOWN:e=this._resourceBundle.statusMessages.seatSelector.selectRemainingSeats;break;case this._message.SELECT_SEATS_CHANGE:e=this._resourceBundle.statusMessages.seatSelector.changeSeat;break;case this._message.SELECT_SEATS_UPGRADED:e=this._resourceBundle.statusMessages.seatSelector.upgradeSeat;break;case this._message.SELECT_SEATS_UNAVAILABLE:e=this._resourceBundle.statusMessages.checkIn.seatSelectionUnavailable,c.avatar=""}a===this._message.SELECT_SEATS_UPGRADED&&(d=!!this._selectedSeatsBySegment[this._$scope.seatSelector.currentSegmentIndex].length),c||(c=this._travelerService.getTravelerByGuid(this._travelerGuids[0])),this._statusService.setStatus({format:this._statusService.format.SUCCESS,copy:e,data:{avatar:c.avatar,canKeepCurrentSeat:d,travelerGuid:c.guid,segmentIndex:this._$scope.seatSelector.currentSegmentIndex,firstName:c.name.first,departure:b.departure,arrival:b.arrival},controls:{back:null},sticky:!0})}},c.prototype._inventoryLocked=function(){this._bookingTimerService.startTimer(),this._isPastExistingSegments()&&this._requestQuote()},c.prototype._inventoryLockFailed=function(){var a=this._$scope.seatSelector.segmentsData[0];this._deselectSeatsForSegment(a,0)},c.prototype._lockInventory=function(){if(this._contextIs(this._contexts.BOOK)){var a=this._fareService.getInventoryLocked();0!==this._$scope.seatSelector.currentSegmentIndex||a?a&&this._$scope.seatSelector.currentSegmentIndex===this._$scope.seatSelector.segmentsData.length&&(this._updateStatus(),this._windowService.setYtsExpanded(!0),this._windowService.setYtsPayNow(!0)):(this._travelerInfo={currentIndex:this._$scope.seatSelector.currentSegmentIndex,totalSegments:this._$scope.seatSelector.segmentsData.length},this._$singleTimeout(function(){var a=this._fareService.lockInventoryCabin().then(this._inventoryLocked.bind(this)).catch(this._inventoryLockFailed.bind(this));this._loadingService.setLoading(a),this._pubSubService.publish("adobeAnalytics.seatSelectionComplete",[this._fareService.getSelectedFares()])}.bind(this)))}},c.prototype.openFareInfoModal=function(a,b){a="MC"===a?"MAIN":a,this._pubSubService.publish("core.openModal",["openFareInfoModal",a.toLowerCase(),b])},c.prototype.sortRows=function(a){return a?Object.keys(a):[]},c.prototype._shouldUpgradeFare=function(a,b){var c,d=this._changeService.isChangeType(this._changeService.CHANGE_TYPES.NEW);c=this._contextIs(this._contexts.BOOK)||this._contextIs(this._contexts.CHANGE)&&d?this._fareService.getCurrentTier(b):this._seatService.getRequestModels()[b].tier;var e=this._cabinMap[a.cabinType],f=this._tierMap[c];this._contextIs(this._contexts.CHECKIN)&&(f=this._checkInService.getCurrentTier(b));
var g=this._orderList.indexOf(e)>this._orderList.indexOf(f);return{valid:g,cabin:e}},c.prototype._shouldDowngradeFare=function(a,b){var c,d=this._changeService.isChangeType(this._changeService.CHANGE_TYPES.NEW);c=this._contextIs(this._contexts.BOOK)||this._contextIs(this._contexts.CHANGE)&&d?this._fareService.getSelectedFares()[this._fareService.getFlightIndexBySegment(b)].tier:this._seatService.getRequestModels()[b].tier;var e=this._cabinMap[a.cabinType],f=this._tierMap[c];this._contextIs(this._contexts.CHECKIN)&&(f=this._checkInService.getCurrentTier(b));var g=this._orderList.indexOf(e)<this._orderList.indexOf(f);return{valid:g,cabin:e}},c.prototype._verifySeat=function(b,c,d,e){var f,g,h=this._$q.defer(),i={},j=!1,k={main:"Main Cabin",mcs:"Main Cabin Select"},l={exitRow:{accept:!0}},m=this._shouldUpgradeFare(c,d),n=this._shouldDowngradeFare(c,d);if(m.valid&&(l.upgradeFare={accept:!0}),n.valid&&(l.downgradeFare={accept:!0},g=k[n.cabin]),c.nonRecline&&(l.nonRecline={accept:!0}),a.forEach(l,function(b,d){(a.isDefined(c[d])&&c[d]===!0||"upgradeFare"===d||"downgradeFare"===d)&&(i[d]=!0,j=!(!b.accept&&"upgradeFare"!==d&&"downgradeFare"!==d)||j)}),this.changingSelection&&(i={}),this._skippedSegments[d]&&this._contextIs(this._contexts.CHECKIN)){var o=this._selectedSeatsBySegment[this._$scope.seatSelector.currentSegmentIndex].length;return h.resolve({tierChanged:0===o}),h.promise}if(c.ancilarriesPerPax&&b.ancillaries){var p=c.ancilarriesPerPax&&b.ancillaries[c.ancilarriesPerPax[this._currentTraveler.guestId]],q=p&&p.finalPrice;f=a.copy(this._ancillariesService.getFormattedAvailableAncillaryList(!0)),q&&!this._didShowAncillaryModal&&f.length&&(i.seatAncillaryPrice=q,j=!0,this._didShowAncillaryModal=!0)}if(Object.size(i)>0){this._modalScope=this._$scope.$new(),this._modalScope.verify=i,this._modalScope.verify.requiresAcceptance=j,n.valid&&(this._modalScope.verify.newCabin=g);var r=this._resourceBundle.modal.seatChangeAccept;this._$modal.open({controller:["$scope",function(a){a.footerLinkFn=function(){h.resolve({tierChanged:this.$parent.verify.upgradeFare||this.$parent.verify.downgradeFare})}}],contentType:"custom",size:r.SIZE,scope:this._modalScope,title:r.TITLE,templateUrl:r.TEMPLATE_URL,showFooter:j,footerLinkText:"I understand, let's do this",origin:e}).result.then(null,function(){h.reject(),this._modalScope&&(this._modalScope.$destroy(),this._modalScope=null),this._didShowAncillaryModal&&this._$singleTimeout(this._ancillariesService.updateAnalyticsData.bind(this,!0,f))}.bind(this))}return!j&&h.resolve({}),h.promise},c.prototype.isLastSeatInRow=function(a,b){var c=!1;if(a&&b){var d=Object.keys(b);c=d.indexOf(a)===d.length-1}return c},c.prototype.skipSeatSelection=function(a){var b;if(this._skippedSegments[a]=!0,this._contextIs(this._contexts.CHANGE)||this._contextIs(this._contexts.CHECKIN)&&!b)return void this.keepCurrentSeat(this._currentTraveler.guid,a);var c=this._$scope.seatSelector.segmentsData[a];b||(b=this._fareService.getCurrentTier(a));var d={main:"MC",mainRefundable:"MC",mcs:"MCS",mcsRefundable:"MCS",first:"FIRST",firstRefundable:"FIRST"},e={aisle:!1,avatarImage:"C4",cabinType:d[b],exitRow:!1,infantAllowed:!0,middle:!0,nonRecline:!1,open:!0,petAllowed:!0,seatLetter:"NA",seatNumber:"NA",window:!1};if(this._seatService.getEmptySeatMapPayload())for(var f=this._seatService.getTravellerCount(),g=0;g<f;g++)this._$singleTimeout(function(){e.selected=!1,this.selectSeat(c,e,a)}.bind(this));else this.selectSeat(c,e,a)},c.prototype.resetSelectedSegmentSeats=function(a){this._selectedSeatsBySegment[a]=[],this._updateCurrentTraveler()},c.prototype.keepCurrentSeat=function(a,b){this._$scope.seatSelector.currentSegmentIndex=b,this._selectedSeatsBySegment[b].push(a),this._updateCurrentTraveler()&&this._seatService.getEmptySeatMapPayload()?this._$singleTimeout(this.keepCurrentSeat.bind(this,this._currentTraveler.guid,b)):this._$singleTimeout(this._areAllSeatsSelected.bind(this))},c.prototype._changeSeatSelection=function(a,b){return a.selected=b,b||(a.avatar=null,a.open=!0),a},c.prototype._changeSeatTempSelection=function(a,b){b?(a.temporarilyLocked=!0,a.open=!1):(a.temporarilyLocked=!1,a.open=!0)},c.prototype._deselectSeatsForSegment=function(a,b){var c=this._seatService.getSelectedSeats(b),d=this._getFlightSegmentByIndex(b);if(c){for(var e in c)this._changeSeatSelection(c[e],!1);this._clearLockedInfantSeats(),this._seatService.deselectSeats(d,b),this._seatService.areAllSeatsSelected(d,b),this._contextIs(this._contexts.BOOK)&&this._updateStatus(this._message.SELECT_SEATS_KNOWN),this.resetSelectedSegmentSeats(b),this._refreshSeats()}},c.prototype._removeTravelerFromSeat=function(a,b){var c=this._selectedSeatsBySegment[b].indexOf(a.travelerGuid);c>-1&&(this._selectedSeatsBySegment[b].splice(c,1),this._$scope.seatSelector.currentSegmentIndex=b,a.avatar=null,a.open=!0,a.travelerGuid=null)},c.prototype._getFlightSegmentByIndex=function(a){var b;return b=this._contextIs(this._contexts.CHECKIN)?this._checkInService.getFlightSegmentByIndex(a):this._fareService.getFlightSegmentByIndex(a)||this._seatService.getRequestModels()[a]},c.prototype.selectSeat=function(a,b,c,d){var e,f;if(d&&(f=$(d.target).closest(".seat-section")),e=this._seatService.areAllSeatsSelected(this._getFlightSegmentByIndex(c),c),b.open)return b.selected?(this._deselectSeat(a,b,c),void(a&&this._updateRowForInfants(a.seatMap,b,!1))):void this._verifySeat(a,b,c,f).then(function(d){var e;if(this._modalScope&&(this._modalScope.$destroy(),this._modalScope=null),d&&d.tierChanged){if(this._deselectSeatsForSegment(a,c),this._contextIs(this._contexts.CHECKIN)){var f=b.cabinType.toLowerCase();this._checkInService.setUpgradedClassByTier(c,f)}else e=this._fareService.findAndSetAlternateFare(b,c,this._originalFareClasses[c]),this._loadingService.setLoading(e),e.then(this._doSeatSelection.bind(this,a,b,c));this.resetSelectedSegmentSeats(c)}this._contextIs(this._contexts.CHECKIN)&&this._checkInService.setCurrentTier(c,b.cabinType.toLowerCase()),!e&&this._doSeatSelection(a,b,c)}.bind(this))},c.prototype._isAdultsWithInfantsSeatsTaken=function(){var a=parseInt(this._currentTraveler.guestId.slice(0,-3));return a>this._numberOfInfants},c.prototype._doSeatSelection=function(b,c,d){var e;if(this._contextIs(this._contexts.CHECKIN)||this._contextIs(this._contexts.CHANGE)){var f=this._seatService.deselectSeat(this._currentTraveler.guid,d);f&&(this._changeSeatSelection(f,!1),this._updateRowForInfants(b.seatMap,f,!1))}var g=this._getFlightSegmentByIndex(d),h=this._seatService.selectSeat(g,b,c,d);if(h){this._changeSeatSelection(c,!0),this._fareService.setTierForSegment(d,c.cabinType);var i=this._currentTraveler;this._selectedSeatsBySegment[d].push(i.guid),c.ancilarriesPerPax&&b.ancillaries&&(e=c.ancilarriesPerPax&&b.ancillaries[c.ancilarriesPerPax[i.guestId]]),a.extend(c,{travelerGuid:i.guid,avatar:i.avatar,ancillaryPrice:e?e.finalPrice:0}),this._updateCurrentTraveler(),this._updateSelectedSeatsString(d),this._$singleTimeout(this._areAllSeatsSelected.bind(this)),this._isReaccommodationPossible(c)&&this._statusService.setAlert({format:this._statusService.format.ALERT,copy:this._statusService.message.TRAVELLER_MIGHT_BE_REACCOMMODATED,recoverable:!0,sticky:!1,controls:{close:!1,hide:"got it"},doNotRollbackOnDismiss:!0})}this._updateRowForInfants(b.seatMap,c,!0),this._refreshSeats()},c.prototype._updateRowForInfants=function(a,b,c){if(c&&(!this._hasMultipleInfants()||this._isAdultsWithInfantsSeatsTaken()))return void this._clearLockedInfantSeats();var d=b.seatNumber.slice(0,-1),e=this._getSeatLettersInRow(b.seatLetter);e.forEach(function(e){var f=d+e,g=this._getSeatByNumber(a,f);if("undefined"!=typeof g){var h=c?g.open:g.temporarilyLocked;b.seatNumber!==f&&h&&(this._changeSeatTempSelection(g,c),c?this._seatsLockedToInfants.push(g):this._seatsLockedToInfants=this._seatsLockedToInfants.filter(function(a){return a.seatNumber!==g.seatNumber}))}}.bind(this))},c.prototype._getSeatLettersInRow=function(a){return this._rowGroups.filter(function(b){return b.indexOf(a)>-1})[0]},c.prototype._hasMultipleInfants=function(){var a=this._travelerService.getTravelers(),b=0;for(var c in a)("INFANT"===a[c].travelerType||"adult_with_infant"===a[c].travelerType)&&b++;return this._numberOfInfants=b,b>1},c.prototype._updateSelectedSeatsString=function(b){this._$scope.seatSelector.selectedSeatsString[b]="",a.forEach(this._seatService.getSelectedSeats(b),function(a){this._$scope.seatSelector.selectedSeatsString[b]+=", "+a.seatNumber}.bind(this)),this._$scope.seatSelector.selectedSeatsString[b]=this._$scope.seatSelector.selectedSeatsString[b].slice(2)},c.prototype._deselectSeat=function(a,b,c){var d=this._getFlightSegmentByIndex(c);if(this._seatService.selectSeat(d,a,b,c)){var e=this._seatService.areAllSeatsSelected(d,c);this._changeSeatSelection(b,!1),this._removeTravelerFromSeat(b,c),this._updateCurrentTraveler(),this._contextIs(this._contexts.BOOK)&&c>0&&this._$singleTimeout(function(){this._updateStatus(this._message.SELECT_SEATS_KNOWN)}.bind(this)),this._contextIs(this._contexts.BOOK)&&0===c&&this._$singleTimeout(function(){!e&&this._updateStatus(this._message.SELECT_SEATS_KNOWN)}.bind(this));var f=c<=this._$scope.seatSelector.currentSegmentIndex;if(f)for(var g=this._$scope.seatSelector.segmentsData.length,h=c;h<g;h++)this._deselectSeatsForSegment(null,h),this._$scope.seatSelector.currentSegmentIndex=c}},c.prototype._refreshSeats=function(a){a=a||this._$scope.seatSelector.currentSegmentIndex,this._$rootScope.$broadcast("seatSelector.refreshSegment"+a),this._$singleTimeout(function(){this._$rootScope.$broadcast("seatSelector.refreshSeats"+a)}.bind(this))},c.prototype._updateCurrentTraveler=function(){var a,b=this._$scope.seatSelector.currentSegmentIndex;if(this._selectedSeatsBySegment[b])for(var c in this._travelerGuids)if(a=this._travelerGuids[c],this._selectedSeatsBySegment[b].indexOf(a)<0)return this._currentTraveler=this._travelerService.getTravelerByGuid(a),this._currentTraveler},c.prototype._getCurrentTraveler=function(){return this._travelerService.getTravelerByGuid(this._travelerGuids[this._$scope.seatSelector.selectedTravelerIndex])},c.prototype._isPastExistingSegments=function(){return this._$scope.seatSelector.currentSegmentIndex===this._$scope.seatSelector.segmentsData.length},c.prototype._areAllSeatsSelected=function(){var a=this._selectedSeatsBySegment[this._$scope.seatSelector.currentSegmentIndex].length;a===this._travelerGuids.length&&(this._$scope.seatSelector.isCollapsed[this._$scope.seatSelector.currentSegmentIndex]=!0,this._$timeout(function(){this._$scope.seatSelector.sectionLength=$(".collapse-container.collapsed-section .collapsed-section").length-1}.bind(this)),this._contextIs(this._contexts.BOOK)&&this._lockInventory(),this._clearLockedInfantSeats(),this._$scope.seatSelector.currentSegmentIndex++,this._updateCurrentTraveler()),this._isPastExistingSegments()?(this._updateStatus(),this._contextIs(this._contexts.BOOK)?this._requestQuote():this._contextIs(this._contexts.CHANGE)?this._requestChangeQuote():this._contextIs(this._contexts.CHECKIN)&&this._$scope.$emit("seatSelector.complete")):this._updateStatusByContext()},c.prototype._clearLockedInfantSeats=function(){for(var a=0;a<this._seatsLockedToInfants.length;a++){var b=this._seatsLockedToInfants[a];b.temporarilyLocked&&this._changeSeatTempSelection(b,!1)}this._seatsLockedToInfants=[]},c.prototype._requestQuote=function(){if(!this._requestedQuote&&this._fareService.getInventoryLocked()){this._requestedQuote=!0;var a=this._purchaseService.requestQuote();this._$singleTimeout(function(){a.then(function(){this._statusService.setStatus([]),this._windowService.setYtsExpanded(!0),this._windowService.setYtsPayNow(!0)}.bind(this))}.bind(this)),this._loadingService.setLoading(a)}},c.prototype._requestChangeQuote=function(){var a=this._fareService.getSelectedFares(),b=this._changeService.getRequestQuoteFlightIds(a);this._changeService.setExchangeFlightList(b);var c=function(){this._$singleTimeout(function(){this._statusService.setChangeGuider(this._statusService.message.CHANGE_REVIEW_CHANGES),this._windowService.setYtsPayNow(!0),this._$singleTimeout(this._windowService.setYtsExpanded.bind(this,!0));var a=this._changeService.getUIAncillariesAmount(),b=this._purchaseService.data().totalExtras;a<b&&this._statusService.setAlert({format:this._statusService.format.ALERT,copy:this._resourceBundle.statusMessages.purchase.extrasPriceIncrease,recoverable:!0,controls:{close:!1,dismiss:"accept"},sticky:!0})}.bind(this))},d=function(){this._changeService.reset(),this._fareService.reset(),this._seatService.resetService(),this._statusService.setStatus([]),this._windowService.setChangeFlow(!1),this._pubSubService.publish("yts.collapseYts",[!0]),this._locationService.setContext("manage"),this._locationService.go({target:"/manage-itinerary"})};b.length>0?this._$singleTimeout(function(){var a=this._changeService.requestQuote();a.then(c.bind(this),d.bind(this)),this._loadingService.setLoading(a)}.bind(this)):(this._changeService.purgeRequestQuote(),c.call(this))},c.prototype.onLocalScrollStart=function(a){this._verifyCabinAvailability(a),this._$rootScope.$broadcast("seatSelector.seatsUnavailable")},c.prototype.tierExcluded=function(a,b){if(this._contextIs(this._contexts.CHECKIN))return!1;var c=this._fareService.selectedTierBySegment[a];return!!c&&c!==b},c.prototype.previouslySelectedSeat=function(a,b,c){var d=this._getFlightSegmentByIndex(b);this._seatService.addExistingSeat(d,a,b);var e=this._travelerService.getTravelerByGuid(a.travelerGuid);"adult_with_infant"===e.travelerType&&this._updateRowForInfants(c,a,!0),a.avatar=e.avatar},c.prototype.getTierLabel=function(a,b){return b&&"MCS"!==a?this._resourceBundle.flightInformation.tier.emergencyExit:b&&"MCS"===a?"MAIN  CABIN  SELECT EXIT  ROW":this._resourceBundle.flightInformation.tier.name[a]},c.prototype._reset=function(){for(var a=0;a<this._$scope.seatSelector.totalSegments;a++){var b=this._getFlightSegmentByIndex(a);b&&(b.selectedSeatsCount=0)}this._$scope.seatSelector.currentSegmentIndex=0,this._$scope.seatSelector.segmentsData=[],this._$scope.seatSelector.isCollapsed={},this._$scope.seatSelector.arrival=[],this._$scope.seatSelector.departure=[],this._$scope.seatSelector.typeLabel=[],this._$scope.seatSelector.selectedSeatsData=[],this._requestedQuote=!1},c.prototype._getSeatByNumber=function(a,b){for(var c in a)for(var d in a[c].rows)for(var e in a[c].rows[d].seats){var f=a[c].rows[d].seats[e];if(f.seatNumber===b)return f}},c.prototype._updateSelectedSeats=function(a){this._changeService.isChangeType(this._changeService.CHANGE_TYPES.NEW)&&this._seatService.resetSelectedSeatModel();var b=this._seatService.getSelectedSeatModel().flightList;for(var c in b){var d=b[c].paxSeatList;for(var e in d){var f=d[e].seatNumber,g=this._getSeatByNumber(a[c].seatMap,f);g&&(g.selected=!0,g.avatar=d[e].avatar,g.avarImage=d[e].avatarImage,g.travelerGuid=d[e].travelerGuid)}}},c.prototype._segmentsDataHandler=function(a){var b=[];return a&&a.length?(this._updateTravelerData(),a.forEach(function(a,c){a?(b.push(a),this._refreshSeats(c)):b.push(this._$scope.seatSelector.segmentsData[c])}.bind(this)),this._updateSelectedSeats(b),this._$scope.seatSelector.segmentsData=b,this._updateStatusByContext(),this._$scope.seatSelector.currency=this._purchaseService.getCurrency(),this._storeOriginalFareClasses(),this._verifyCabinAvailability(0),void 0):void this._reset()},c.prototype._updateStatusByContext=function(){var a;a=this._contextIs(this._contexts.CHECKIN)&&this._checkInService.getFlightUpgraded(this._$scope.seatSelector.currentSegmentIndex)?this._message.SELECT_SEATS_UPGRADED:this._contextIs(this._contexts.CHANGE)?this._message.SELECT_SEATS_CHANGE:this._message.SELECT_SEATS_KNOWN,this._updateStatus(a)},c.prototype._storeOriginalFareClasses=function(){if(this._contextIs(this._contexts.BOOK)||this._contextIs(this._contexts.CHANGE)){var b=this._fareService.getSelectedFares();if(!b||0===b.length||!b[0].legs)return;var c=b[0].legs.length;a.forEach(b,function(a,b){for(var d in a.legs){var e=parseInt(d,10);this._originalFareClasses[b*c+e]=a.tier}}.bind(this))}},c.prototype.mapTitleForSegment=function(a){var b,c,d,e=this._changeService.getPnrModel(),f=this._changeService.isReturningFlight();return e&&(d=e.flightList[e.flightList.length-1]),c=f?this._resourceBundle.flightInformation.leg.name[1]:e&&d.flightId-1>a?this._resourceBundle.flightInformation.leg.name[0]:this._resourceBundle.flightInformation.leg.name[this._fareService.getFlightIndexBySegment(a)],b=this._getFlightSegmentByIndex(a),b||(b=this._seatService.getRequestModels()[a]),this._tripService.getTripType()===this._tripService.MULTI_CITY&&(c=this._resourceBundle.flightInformation.multiCityLeg.name[0]),c=c.toLowerCase(),this._$scope.seatSelector.typeLabel.push(c),this._$scope.seatSelector.departure.push(b.departure),this._$scope.seatSelector.arrival.push(b.arrival),[c," | ",b.departure," - ",b.arrival].join("")},c.prototype._verifyCabinAvailability=function(a){var b,c,d,e,f,g;if(b=this._$scope.seatSelector.segmentsData,this._contextIs(this._contexts.BOOK)&&(c=this._fareService.getSelectedFares(),d=this._fareService.getFlightIndexBySegment(a),c[d]&&(f=c[d].tier),d=a),this._contextIs(this._contexts.CHECKIN)&&(g=this._checkInService.getSelectedUpgradeOption(a+1),e=this._seatService.getRequestModels()[a],d=a,f=g?g.name:e.tier),this._contextIs(this._contexts.CHANGE)&&(e=this._seatService.getRequestModels()[a],d=a,f=e.tier.replace("Refundable","").replace("Upgrade","")),b[d])return e&&e.tier&&e.tier.indexOf("Refundable")>-1&&(f=e.tier),b[d].seatSelectionAvailable=b[d].cabinAvailability[f],b[d].seatSelectionAvailable},c.prototype.isVisibleSection=function(a){return a<=this._$scope.seatSelector.currentSegmentIndex},c.prototype.isAlterationPermitted=function(b,c,d){var e,f,g,h=!1;if(!this._contextIs(this._contexts.CHECKIN)){var i=this._fareService.getFlightIndexBySegment(d),j=this._fareService.getSelectedFares()[i];if(j&&j.cost){var k=j.tier.indexOf("Refundable")!==-1||j.tier.indexOf("Upgrade")!==-1,l=!!j.cost.points,m=l?"pointsFare":"dollarFare",n=l?"totalPoints":"totalFare";g=j.tier.replace("Refundable","").replace("Upgrade","");var o=j.tier;k&&"undefined"!=typeof j.tiers[g][m]&&(o=j.tier.replace("Refundable","").replace("Upgrade",""));var p=j.tiers[o][m][n];h=c>p}return"MC"===b&&(b="MAIN"),e=this._orderList.indexOf(b.toLowerCase()),f=this._orderList.indexOf(g),e>f&&h}var q=this._checkInService.getUpgradeOptions();return a.forEach(q,function(a){h=h||a.name.toUpperCase()===b}),h},c.prototype.tierAlterationCost=function(b,c,d){var e="",f=0;if(this._contextIs(this._contexts.CHECKIN)){var g=this._checkInService.getUpgradeOptions(d),h=this._checkInService.getSelectedUpgradeOption(d);a.forEach(g,function(a){a.name.toUpperCase()===b&&(f=a.fee-(h&&h.fee||0),e="+$"+f)})}else{if(this._changeService.isChangeType(this._changeService.CHANGE_TYPES.EXISTING))return"";var i=this._fareService.getFlightIndexBySegment(d),j=this._fareService.getSelectedFares()[i];if(j&&j.cost){var k,l,m=!!j.cost.points,n=m?"":"$",o=m?"pts":"",p=m?"pointsFare":"dollarFare",q=m?"totalPoints":"totalFare",r=j.tier,s=j.tiers[r][p][q],t=r.indexOf("Refundable")!==-1||j.tier.indexOf("Upgrade")!==-1;if(m){if("MC"!==b){k=j.tiers[b.toLowerCase()][p],l=j.tiers[b.toLowerCase()+"Refundable"][p];var u=k&&!t?k:l;f=u[q]-s}}else f=c-s;e="+"+n+this._numberFilter(Math.abs(f),0)+o}}return f<=0?"":e},c.prototype.tierAlterationLabel=function(a,b,c){return this._changeService.isChangeType(this._changeService.CHANGE_TYPES.EXISTING)?"":this.isAlterationPermitted(a,b,c)?this._resourceBundle.seatMap.UPGRADE:""},c.prototype.shouldShowContinueButton=function(){for(var a=!0,b=this._$scope.seatSelector.segmentsData.length,c=0;c<b;c++)a=a&&this._seatService.areAllSeatsSelected(this._getFlightSegmentByIndex(c),c);return a},c.prototype.transitionToPayment=function(){this._workflowService.transition("SEAT_SELECTOR_STATE")},c.prototype._isReaccommodationPossible=function(a){if(!a||!a.seatNumber)return!1;var b=["3C","3D"];return b.indexOf(a.seatNumber)!==-1};var d=function(a,b,c,d){function e(a,b){if(f=d._workflowService.getCurrentState(),"SEAT_SELECTOR_STATE"===f&&d._contextIs(d._contexts.BOOK)){var c=$("#seatSelector"),e=$("#yts"),h={};h.top=c.offset().top,h.bottom=h.top+c.outerHeight(),b+=e.outerHeight(),b>=h.top&&b<=h.bottom&&g===!0?(d._$singleTimeout(d._updateStatusByContext.bind(d)),g=!1):b<h.top&&g===!1&&(d._$singleTimeout(d._updateStatus.bind(d)),g=!0)}}var f,g=!1;a.$on("$destroy",function(){b.off()}),d._windowService.subscribe("scroll",e)};return c.prototype.isAncillaryForFree=function(a){return!a||0===a.finalPrice},c.prototype.shouldSeatShowAncillary=function(a,b){return a.exitRow===!0&&a.middle===!1&&(a.window=!0),a&&a.open&&"MC"===b.name},b}),c("common/directives/traveler-info",["angular","moment","modernizr","content/constants/content-bundle"],function(a,b,c,d){"use strict";var e=function(){return{restrict:"A",replace:!0,controller:f,templateUrl:"/app/common/directives/traveler-info.tpl.html"}},f=function(a,b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){this._$scope=a,this._$q=b,this._$singleTimeout=d,this._$modal=e,this._resourceBundle=f,this._geoBundle=g,this._travelerService=h,this._tripService=i,this._fareService=j,this._elevateService=k,this._workflowService=l,this._pubSubService=m,this._locationService=n,this._loadingService=o,this._utilsService=p,this._pnrService=q,this._persistenceService=r,this._scrollService=s,this._statusService=t,this._windowService=u,this._scriptLoaderService=v,this._$timeout=x,this._accessibleService=w,c.input.placeholder||this._scriptLoaderService.load("/scripts/placeholder-polyfill.min.js"),this.views={LANDING_PAGE:"LANDING_PAGE",LOGIN_FORM:"LOGIN_FORM",RECOGNIZED_LOGIN_FORM:"RECOGNIZED_LOGIN_FORM",TRAVELER_INFO_FORM:"TRAVELER_INFO_FORM"},this.viewMessages={LOGIN_FORM:"Complete form to sign in.",RECOGNIZED_LOGIN_FORM:"Verify traveler information form.",TRAVELER_INFO_FORM:"Complete traveler information form."},this._context={BOOK:this._locationService.contextIs(n.contexts.BOOK),CHANGE:this._locationService.contextIs(n.contexts.CHANGE),CHECKIN:this._locationService.contextIs(n.contexts.CHECKIN)},this._isUserLoggedIn=!1,this._acctData={},this.paxTypes={PRIMARY:this._travelerService.allPaxTypes.primary.value,ADULT:this._travelerService.allPaxTypes.adult.value,CHILD:this._travelerService.allPaxTypes.child.value,INFANT:this._travelerService.allPaxTypes.infant.value},this.constants={VIRGIN_AMERICA_FF:"VIRGIN_AMERICA"},this._configureScope(),this._configureWatches(),this._configurePubSub()};return f.prototype._configureScope=function(){this._$scope.travelerInfo=this.travelerInfo={},a.extend(this.travelerInfo,{allPaxTypes:this._travelerService.allPaxTypes,applyMinHeight:!0,avatarList:this._utilsService.getRandomAvatarsAll(),bookingForSomeoneElse:!1,changeSection:this.changeSection.bind(this),constants:this.constants,continueAsGuest:this.continueAsGuest.bind(this),countries:this._geoBundle.countries,elevateBookingForSelf:this.elevateBookingForSelf.bind(this),expiryDateStart:b(),expiryDateEnd:b().add("years",100),genders:this._resourceBundle.genders,getFormattedGuestNames:this.getFormattedGuestNames.bind(this),getGreeting:this.getGreeting.bind(this),isCollapsed:!1,isDisclaimerVisible:this.isDisclaimerVisible.bind(this),isInternational:!1,isPrimaryTraveler:this.isPrimaryTraveler.bind(this),isTravelerInfant:this.isTravelerInfant.bind(this),isUserLoggedIn:this.isUserLoggedIn.bind(this),isVisible:!1,loginForm:{},matchesRecognizedEmail:this.matchesRecognizedEmail.bind(this),customAvatarToggle:this.customAvatarToggle.bind(this),openForgotPasswordModal:this.openForgotPasswordModal.bind(this),openPrimaryTravelerModal:this.openPrimaryTravelerModal.bind(this),paxTypes:this.paxTypes,recognizedLoginForm:{},selectedTravelerModelIndex:0,leaveLandingPage:this.leaveLandingPage.bind(this),showFrequentFlyerQuestionsModal:this.showFrequentFlyerQuestionsModal.bind(this),signIn:this.signIn.bind(this),signInFormSubmit:this.signInFormSubmit.bind(this),storeTravelerModel:this.storeTravelerModel.bind(this),toggleBookingForSomeoneElse:this.toggleBookingForSomeoneElse.bind(this),travelerModels:[],getFilledInTravelers:this.getFilledInTravelers.bind(this),showTraveler:this.showTraveler.bind(this),updateGreeting:this.updateGreeting.bind(this),viewIs:this.viewIs.bind(this),views:this.views})},f.prototype._configureWatches=function(){this._$scope.$watch("travelerInfo.selectedTravelerModelIndex",function(a){"undefined"!=typeof a&&(this._refreshAvatars(),this.updateGreeting(),this._triggerPolyfills(),this._$singleTimeout(function(){$($("form")[a]).find("select").trigger("render.customSelect")}))}.bind(this)),this._$scope.$watch(this._tripService.getIsInternational,function(a){this.travelerInfo.isInternational=a}.bind(this)),this._$scope.$watch(this._fareService.isDuringElevateAvailability,function(a){this.travelerInfo.ffPrograms=this._pnrService.getValidFFPrograms(a)}.bind(this))},f.prototype._triggerPolyfills=function(){a.isUndefined(this.travelerInfo.travelerFields)||this._$singleTimeout(function(){var b=this.travelerInfo.travelerFields[this.travelerInfo.selectedTravelerModelIndex];a.forEach(b,function(a){a.triggerPlaceholderPolyfill&&a.triggerPlaceholderPolyfill()}.bind(this))}.bind(this))},f.prototype._refreshAvatars=function(){var b=a.copy(this._utilsService.getRandomAvatarsAll());a.forEach(this.travelerInfo.travelerModels,function(c){if(c.avatar){var d=b.indexOf(c.avatar);d>-1&&b.splice(d,1),0===b.length&&(b=a.copy(this._utilsService.getRandomAvatarsAll()))}}.bind(this)),this.travelerInfo.avatarList=b,this._$scope.$broadcast("newAvatarList",b);var c=[];a.forEach(this.travelerInfo.travelerFields,function(a,d){if(a.avatar&&b.indexOf(a.avatar.selectedAvatar)>-1||c.indexOf(a.avatar.selectedAvatar)>-1){var e=Math.min(d-1,this.travelerInfo.avatarList.length-1);a.avatar.selectedAvatar=a.avatar.value=this.travelerInfo.avatarList[e]}c.push(a.avatar.selectedAvatar)}.bind(this))},f.prototype._configurePubSub=function(){this._pubSubService.subscribe("travelerInfo.init",this._init.bind(this)),this._pubSubService.subscribe("travelerInfo.collapse",this._collapseSection.bind(this)),this._pubSubService.subscribe("travelerInfo.expand",this.changeSection.bind(this)),this._pubSubService.subscribe("travelerInfo.show",function(){this._setVisibility(!0)}.bind(this)),this._pubSubService.subscribe("travelerInfo.hide",function(){this._setVisibility(!1)}.bind(this)),this._pubSubService.subscribe("trip.resetTravelerAmount",this._reset.bind(this))},f.prototype._init=function(){this._setInitialView(),this._setVisibility(!0),this._expand(),this._context.BOOK||this._travelerService.setTravelerFormsComplete(!0),this._setUpTravelers(),this._setUpFormFields(),this.updateGreeting(),this._verifyUserStatus().then(function(){this.travelerInfo.user.recognized&&this._setView(this.views.RECOGNIZED_LOGIN_FORM)}.bind(this))},f.prototype._setVisibility=function(a){this.travelerInfo.isVisible=a},f.prototype._expand=function(){this.travelerInfo.applyMinHeight=!0,this.travelerInfo.isCollapsed=!1,this._$timeout(function(){var a=$(".collapse-container.collapsed-section .collapsed-section").length-1;this._accessibleService.resolveExpand(a)}.bind(this))},f.prototype._reset=function(){this.travelerInfo.selectedTravelerModelIndex=0,this.travelerInfo.travelerModels=[],this.travelerInfo.travelerData=[],this._landingPageChoice=null},f.prototype._setUpTravelers=function(){if(!this.travelerInfo.travelerModels.length){var a=this._tripService.travelerAmount();this.travelerInfo.travelerModels=[];var b=this._travelerService.getAllTravelers(a);this._travelerGuids=[];var c=this._getOrderedListOfPaxTypes();for(var d in b){var e=b[d];e.travelerType=c.shift(),this.travelerInfo.travelerModels.push(e),this._travelerGuids.push(b[d].guid)}}},f.prototype._getOrderedListOfPaxTypes=function(){var a=[],b=this._tripService.travelerAmount(),c={primary:1,adult:b.adults-1,child:b.children,infant:b.infants};for(var d in c)for(var e=0;e<c[d];e++)a.push(d);return a},f.prototype._setUpFormFields=function(){if(!this.travelerInfo.travelerData||!this.travelerInfo.travelerData.length){this.travelerInfo.travelerData=[],this.travelerInfo.travelerFields=[];for(var a=0,b=this.travelerInfo.travelerModels.length;a<b;a++)this.travelerInfo.travelerFields.push({}),this.travelerInfo.travelerData.push(this.travelerInfo.travelerModels[a].serialize("travelerInfo"))}},f.prototype._verifyUserStatus=function(){var b=this._$q.defer();if(this.travelerInfo.user={},this._elevateService.isLoggedIn()){var c=this._getAccountInfo();c.then(function(){b.resolve()}),this._$singleTimeout(function(){this._loadingService.setLoading(c)}.bind(this))}else this._elevateService.isRecognizedNotLoggedIn()?(this.travelerInfo.user.recognized=!0,this._acctData=this._elevateService.getUserData(),a.extend(this.travelerInfo.user,{loginEmail:this._acctData.emailId,elevateId:this._acctData.elevateId,firstName:this._acctData.firstName,avatar:this._acctData.avatar||this._utilsService.getRandomAvatar()}),b.resolve()):b.resolve();return b.promise},f.prototype._getAccountInfo=function(){var a=this._elevateService.retrieveAccountInfo({context:"booking"});return a.then(this._accountInfoSuccess.bind(this),this._accountInfoError.bind(this)),a},f.prototype._accountInfoSuccess=function(){var a=this._elevateService.getUserData();this.travelerInfo.elevateTravelerData=a.serialize("travelerModel").serialize("travelerInfo"),this.updateGreeting(this.travelerInfo.elevateTravelerData.firstName),this._isUserLoggedIn=!0,this._populatePrimaryTravelerForm()},f.prototype._populatePrimaryTravelerForm=function(){if(this._isUserLoggedIn&&!this.travelerInfo.bookingForSomeoneElse){var b=this.travelerInfo.elevateTravelerData;"VIRGIN_AMERICA"!==b.frequentFlyer||this._fareService.isDuringElevateAvailability()?this.travelerInfo.travelerData[0]=b:this.travelerInfo.travelerData[0]=a.extend({},b,{warnFrequentFlyer:!0,frequentFlyer:"ALASKA_AIRLINES",frequentFlyerNumber:null,elevateNumber:null})}},f.prototype._accountInfoError=function(){this._isUserLoggedIn=!1},f.prototype._setInitialView=function(){this._elevateService.isLoggedIn()||this._travelerService.getTravelerFormsComplete()?this._setView(this.views.TRAVELER_INFO_FORM):this._landingPageChoice?this._setView(this._landingPageChoice):(this._setView(this.views.LANDING_PAGE),this._shownLandingPage=!0)},f.prototype.viewIs=function(a){return this._currentView===a},f.prototype._setView=function(a){this._currentView=a,this._backToTop(),this.viewMessages[a]&&this._accessibleService.setText(this.viewMessages[a])},f.prototype.isDisclaimerVisible=function(){return!this.travelerInfo.viewIs(this.travelerInfo.views.LANDING_PAGE)},f.prototype.isUserLoggedIn=function(){return this._isUserLoggedIn},f.prototype.isTravelerInfant=function(a){return a&&a.travelerType===this.paxTypes.INFANT},f.prototype.matchesRecognizedEmail=function(){return this.travelerInfo.user.loginEmail===this._acctData.emailId},f.prototype.customAvatarToggle=function(a,b){var c=!this._windowService.getAvatarPickerOpen()&&(this._avatarModal||"small"===this._windowService.breakpoint());if(c)if(this._avatarModal)this._closeAvatarPickerModal();else{var d=this._$scope.$new();d.avatars=this.travelerInfo.avatarList,d.avatarPicker=b,d.traveler=a,this._openAvatarPickerModal(d)}return c},f.prototype._openAvatarPickerModal=function(a){var b=this._resourceBundle.modal.travelerInfoAvatarPicker;this._avatarModal=this._$modal.open({scope:a,contentType:b.TYPE,templateUrl:b.TEMPLATE_URL}),this._avatarModal.result.then(null,function(){this._avatarModal=null}.bind(this))},f.prototype._closeAvatarPickerModal=function(){this._avatarModal.close(),this._avatarModal=null},f.prototype.openForgotPasswordModal=function(){var a=this._resourceBundle.modal.forgotPassword;this._$modal.open({size:a.SIZE,title:a.TITLE,templateUrl:a.TEMPLATE_URL})},f.prototype.openPrimaryTravelerModal=function(){var a=this._resourceBundle.modal.primaryTraveler;
this._$modal.open({size:a.SIZE,title:a.TITLE,templateUrl:a.TEMPLATE_URL})},f.prototype._collapseSection=function(){this._setFormattedGuestNames(),this._$singleTimeout(function(){$(".traveler-info.wrap").addClass("collapsed-section");var a="#"+this._resourceBundle.states.ANCILLARIES_SELECTOR_STATE.scrollTarget,b=$(a).offset().top-$("#yts").height()-$("#change-guider").height();$(window).scrollTop(b),this.travelerInfo.isCollapsed=!0}.bind(this))},f.prototype.changeSection=function(){this._expand(),this._workflowService.transition(this._workflowService.getCurrentState(),this._workflowService.state.TRAVELER_INFO,!0),this.travelerInfo.selectedTravelerModelIndex=0},f.prototype.continueAsGuest=function(){this._elevateLogOut(),this._setView(this.views.TRAVELER_INFO_FORM),this._pubSubService.publish("adobeAnalytics.continueAsGuest")},f.prototype.signIn=function(){this._setView(this.views.LOGIN_FORM),this._elevateLogOut()},f.prototype._elevateLogOut=function(){(this._isUserLoggedIn||this.travelerInfo.user.recognized)&&(this._isUserLoggedIn=!1,this.travelerInfo.bookingForSomeoneElse=!1,this._persistenceService.clear().then(function(){this._elevateService.doLogout(),this._clearUserData()}.bind(this)))},f.prototype._clearUserData=function(b){if(!a.isUndefined(this.travelerInfo.travelerData)){var c=b&&b.newUserData,d=this.travelerInfo.travelerData[0].avatar;this.travelerInfo.travelerData[0]={avatar:d},this._refreshAvatars(),this._$singleTimeout(function(){"undefined"==typeof c&&(c={travelerType:this.paxTypes.PRIMARY},b&&b.keepAvatar&&(c.avatar=d)),c.someoneElse=this.travelerInfo.bookingForSomeoneElse,this.travelerInfo.travelerData[0]=c,this.updateGreeting()}.bind(this))}},f.prototype.signInFormSubmit=function(){var a=this.travelerInfo.user.loginEmail||this.travelerInfo.user.elevateId,b=this.travelerInfo.user.recognized?"recognizedLoginForm":"loginForm",c=this.travelerInfo[b].loginPassword.value;this.travelerInfo[b].loginPassword.value="";var d=this._elevateService.doLogin(a,c),e=function(){var a=this._getAccountInfo();this._$singleTimeout(function(){this._loadingService.setLoading(a),a.then(function(){this._setView(this.views.TRAVELER_INFO_FORM)}.bind(this))}.bind(this))},f=function(){this.travelerInfo[b].loginPassword.setValidation(!1)};return d.then(e.bind(this),f.bind(this)),this._pubSubService.publish("adobeAnalytics.fillFormSignIn"),d},f.prototype.storeTravelerModel=function(b){var c=this.travelerInfo.travelerData[b],d=c.frequentFlyerNumber;d||(c.frequentFlyer="");var e=function(a){this.travelerInfo.travelerModels[b].deserialize(a,"travelerInfo"),this._nextStep(),this._$scope.$broadcast("travelerInfo.updatedTraveler"),this._pubSubService.publish("adobeAnalytics.completeButton"),this._pubSubService.publish("ancillaries.resetUIAncillaries")}.bind(this,c);c.frequentFlyer===this.constants.VIRGIN_AMERICA_FF?this._elevateService.verifyElevateTiers([d]).then(function(b,c,d){a.extend(b,{tierLevel:d.tier,freeBagAllowance:d.freeBagAllowance}),c()}.bind(this,c,e)):e()},f.prototype._nextStep=function(){return this._isNameUnique()?(this.travelerInfo.selectedTravelerModelIndex++,void("undefined"!=typeof this._getSelectedTraveler()?this._backToTop():(this.travelerInfo.selectedTravelerModelIndex--,this._travelerService.setTravelerFormsComplete(!0),this.travelerInfo.applyMinHeight=!1,this._elevateService.isLoggedIn()&&this.travelerInfo.travelerModels.length>1&&this._elevateService.saveGuests(this.travelerInfo.travelerModels.slice(1)),this._pubSubService.publish("adobeAnalytics.completedTravelerInformation"),this._workflowService.transition(this._workflowService.state.TRAVELER_INFO)))):void this._showNameNotUniqueMessage()},f.prototype._backToTop=function(){this._scrollService.scroll({target:this._workflowService.state.TRAVELER_INFO,delay:0})},f.prototype._isNameUnique=function(){var a=this._getSelectedTraveler();if(!a)return!0;var b=$.map(this.travelerInfo.travelerData,function(a){return[(a.firstName||"").toLowerCase(),(a.middleName||"").toLowerCase(),(a.lastName||"").toLowerCase()].join("-")}).reduce(function(a,b){return a[b]=(a[b]||0)+1,a},{}),c=[(a.firstName||"").toLowerCase(),(a.middleName||"").toLowerCase(),(a.lastName||"").toLowerCase()].join("-");return 1===b[c]},f.prototype._showNameNotUniqueMessage=function(){this._statusService.setAlert({format:this._statusService.format.ERROR,copy:this._resourceBundle.statusMessages.travelerInfo.namesMustBeUnique,sticky:!1,recoverable:!0,controls:{close:!1,hide:"got it"}})},f.prototype._getSelectedTraveler=function(){if("undefined"!=typeof this.travelerInfo.travelerData)return this.travelerInfo.travelerData[this.travelerInfo.selectedTravelerModelIndex]},f.prototype.getGreeting=function(){return this._greeting},f.prototype.isPrimaryTraveler=function(){var a=this._getSelectedTraveler();return a&&a.travelerType===this.paxTypes.PRIMARY},f.prototype.getFormattedGuestNames=function(){return this._formattedGuestNames},f.prototype._setFormattedGuestNames=function(){if(this.travelerInfo.travelerData){var a=[],b="";this.travelerInfo.travelerData.forEach(function(b){b.firstName&&b.lastName&&a.push(b.firstName+" "+b.lastName)}),a.forEach(function(c,d){var e;switch(d){case 0:e="";break;case a.length-1:e=" & ";break;default:e=", "}b+=e+c}.bind(this)),this._formattedGuestNames=b,this._$scope.$broadcast("travelerInfo.setFormattedGuestNames")}},f.prototype.toggleBookingForSomeoneElse=function(){this.travelerInfo.bookingForSomeoneElse=!this.travelerInfo.bookingForSomeoneElse,this.travelerInfo.bookingForSomeoneElse?this._clearUserData({keepAvatar:!0}):this._clearUserData({newUserData:this.travelerInfo.elevateTravelerData})},f.prototype.updateGreeting=function(a){if("undefined"==typeof a&&this.travelerInfo.travelerData){var b=this._getSelectedTraveler();a=b&&b.firstName}this._greeting=a?"Hi, "+a:"",a&&this._accessibleService.setText(this._greeting)},f.prototype.elevateBookingForSelf=function(a){return"undefined"==typeof a&&(a=this._getSelectedTraveler()),a.travelerType===this.paxTypes.PRIMARY&&this._isUserLoggedIn&&!this.travelerInfo.bookingForSomeoneElse},f.prototype.leaveLandingPage=function(a){this._landingPageChoice=a,this._setView(a)},f.prototype.showFrequentFlyerQuestionsModal=function(){this._$modal.open(d.contentMap.FREQUENT_FLYER_QUESTIONS)},f.prototype.getFilledInTravelers=function(){var b=[],c=this.travelerInfo.travelerModels[this.travelerInfo.selectedTravelerModelIndex];return a.forEach(this.travelerInfo.travelerModels,function(a){a.name.first&&a.guid!==c.guid&&b.push(a)}),b},f.prototype.showTraveler=function(a){var b=this._getTravelerIndex(a);this.travelerInfo.selectedTravelerModelIndex=b,this._backToTop(),this._$scope.$broadcast("travelerInfo.updatedTraveler")},f.prototype._getTravelerIndex=function(a){if(a)for(var b=0;b<this.travelerInfo.travelerModels.length;b++)if(this.travelerInfo.travelerModels[b].guid===a.guid)return b},f.$inject=["$scope","$q","$singleTimeout","$modal","ResourceBundle","GeoBundle","travelerService","tripService","fareService","elevateService","workflowService","pubSubService","locationService","loadingService","utilsService","pnrService","persistenceService","scrollService","statusService","windowService","scriptLoaderService","accessibleService","$timeout"],e}),c("common/directives/traveler-docs",["moment"],function(a){"use strict";var b=function(){return{restrict:"A",replace:!0,controller:c,templateUrl:"/app/common/directives/traveler-docs.tpl.html"}},c=function(b,c,d,e,f,g,h,i,j){this.$scope=b,this.$modal=c,this.resourceBundle=i;var k={TILES:0,FORM:1};b.travelerDocs={countries:j.countries,isVisible:!1,isChange:h.getContext()===h.contexts.CHANGE,isInternational:!1,hide:this.hide.bind(this),show:this.show.bind(this),editTravelerInfo:this.editTravelerInfo.bind(this),storeTravelerModel:this.storeTravelerModel.bind(this),closeForm:this.closeForm.bind(this),travelerModels:[],views:k,currentView:k.TILES,currentTraveler:null,showSeatQuestionsModal:this.showSeatQuestionsModal.bind(this),ffPrograms:g.getFFPrograms(),expiryDateStart:a(),expiryDateEnd:a().add("years",100)};var l=h.getContext()!==h.contexts.CHECKIN?e.getPnrModel():g.model();l&&(b.travelerDocs.travelerModels=Object.size(f.getAllTravelers())?f.getAllTravelers():f.createTravelersFromPaxList(l.paxList)),this.$scope.$watch(e.getIsInternational,function(a){this.$scope.travelerDocs.isInternational=!!a}.bind(this))};return c.prototype.show=function(){this.$scope.travelerDocs.isVisible=!0},c.prototype.hide=function(){this.$scope.travelerDocs.isVisible=!1},c.prototype.editTravelerInfo=function(a){this.$scope.travelerDocs.currentView=this.$scope.travelerDocs.views.FORM,this.$scope.travelerDocs.currentTraveler=a,this.$scope.travelerDocs.travelerFields={},this.$scope.travelerDocs.travelerData=this.$scope.travelerDocs.currentTraveler.serialize("travelerInfo")},c.prototype.closeForm=function(){this.$scope.travelerDocs.currentView=this.$scope.travelerDocs.views.TILES,this.$scope.travelerDocs.currentTraveler=null},c.prototype.storeTravelerModel=function(a){this._storeValuesFromFormToTraveler(a),this.closeForm()},c.prototype.showSeatQuestionsModal=function(){var a=this.resourceBundle.modal.seatQuestions;this.$modal.open({size:a.SIZE,type:a.TYPE,title:a.TITLE,templateUrl:a.TEMPLATE_URL})},c.prototype._storeValuesFromFormToTraveler=function(a){this.$scope.travelerDocs.currentTraveler.frequentFlyer={name:a.fields.frequentFlyer.value.name,number:a.fields.frequentFlyerNumber.value,program:a.fields.frequentFlyer.value.value},this.$scope.travelerDocs.currentTraveler.redressNum=a.fields.redressNumber.value,this.$scope.travelerDocs.isInternational&&(this.$scope.travelerDocs.currentTraveler.citizenship=a.fields.citizenship.value.value,this.$scope.travelerDocs.currentTraveler.countryOfResidence=a.fields.residence.value.value,this.$scope.travelerDocs.currentTraveler.passportCountry=a.fields.issuingCountry.value.value,this.$scope.travelerDocs.currentTraveler.international.citizenship=a.fields.citizenship.value.value,this.$scope.travelerDocs.currentTraveler.international.countryOfResidence=a.fields.residence.value.value,this.$scope.travelerDocs.currentTraveler.international.passportCountry=a.fields.issuingCountry.value.value,this.$scope.travelerDocs.currentTraveler.passportNum=a.fields.passport.value,this.$scope.travelerDocs.currentTraveler.passportExpires=a.fields.expirationDate.value,this.$scope.travelerDocs.currentTraveler.international.passportNum=a.fields.passport.value,this.$scope.travelerDocs.currentTraveler.international.passportExpires=a.fields.expirationDate.value,this.$scope.travelerDocs.currentTraveler.emergencyContact={name:a.fields.emergencyName.value,phone:a.fields.emergencyPhone.value},this.$scope.travelerDocs.currentTraveler.international.emergencyContact={name:a.fields.emergencyName.value,phone:a.fields.emergencyPhone.value})},c.$inject=["$scope","$modal","fareService","changeService","travelerService","pnrService","locationService","ResourceBundle","GeoBundle"],b}),c("common/directives/pnr-trip-summary",["angular"],function(a){"use strict";var b=function(){return{restrict:"A",replace:!0,controller:c,link:d,templateUrl:"/app/common/directives/pnr-trip-summary.tpl.html"}},c=function(a,b,c){this._$scope=a,this._$parse=b,this._utilsService=c,a.tripSummary={}};c.$inject=["$scope","$parse","utilsService"];var d=function(b,c,d,e){var f=e._$parse(d.pnr)(b),g=d.context;a.extend(b.tripSummary,{pnr:f,isManage:"manage"===g,isSuccess:"success"===g,isCancel:"cancel"===g})};return b}),c("common/directives/pnr-guest-list",["angular"],function(a){"use strict";var b=function(){return{restrict:"A",replace:!0,scope:{pnr:"=",context:"@"},controller:c,templateUrl:"/app/common/directives/pnr-guest-list.tpl.html"}},c=function(b,c,d,e){this._$scope=b,this._pubSubService=d,this._locationService=e,this._$scope.guestList={bp:"",openFrequentFlierModal:this._openFrequentFlierModal.bind(this),openJoinAlaskaMileagePlan:this._openJoinAlaskaMileagePlan.bind(this)},this._$scope.$watch(c.breakpoint,this.onBreakpointChange.bind(this)),this._$scope.$watch("pnr",function(b){b&&a.extend(this._$scope.guestList,{pnr:b,context:this._$scope.context,successContext:this._locationService.getContext(),isMultiCity:!!b&&"MULTI_CITY"===b.tripType,isOneWay:!!b&&"ONE_WAY"===b.tripType,isRoundTrip:!!b&&"ROUND_TRIP"===b.tripType})}.bind(this)),this._$scope.$on("addKtnSuccess",function(a,b){this._addNewKtn(b)}.bind(this))};return c.$inject=["$scope","windowService","pubSubService","locationService"],c.prototype.onBreakpointChange=function(a){this._$scope.guestList.bp=a},c.prototype._openFrequentFlierModal=function(a){this._pubSubService.publish("core.openModal",["openFrequentFlierModal",{traveler:a,pnr:this._$scope.guestList.pnr}])},c.prototype._openJoinAlaskaMileagePlan=function(){var a;a="manage"===this._$scope.context?"VX_manage-itinerary:MP Join":{book:"VX_booking funnel:payment confirmed:MP Join","check-in":"VX_manage:check-in:completed:MP Join",change:"VX_manage:change:completed:MP Join"}[this._$scope.guestList.successContext],this._pubSubService.publish("core.openModal",["openJoinAlaskaMileagePlan",{linkCid:a}])},c.prototype._addNewKtn=function(b){a.forEach(this._$scope.guestList.pnr.paxList,function(a){a.guestId===b.traveler&&(a.knownTravelerNum=b.ktn)})},b}),c("common/directives/pnr-flight-summary",["angular","moment"],function(a,b){"use strict";var c=function(){return{restrict:"A",replace:!0,scope:{pnr:"=",changeFlight:"=",openFlightAlertModal:"=",context:"@",successContext:"=",parentIndex:"="},controller:d,templateUrl:"/app/common/directives/pnr-flight-summary.tpl.html"}},d=function(b,c,d,e,f,g){this._$scope=b,this._pubSubService=c,this._locationService=e,this._tripService=f,this._elevateService=g,this._operatorConstants={OP_VX:"VIRGIN_AMERICA",OPS_ALASKA:["HORIZON_AIR","SKYWEST_AIRLINES","PENINSULA_AIRWAYS","ALASKA_AIRLINES"]},this._$scope.flightSummary={nPartners:0,breakpoint:"",openModal:this._openModal.bind(this),openCalendarModal:this._openCalendarModal.bind(this),formatDateTime:this.formatDateTime.bind(this),formatOperatorString:this.formatOperatorString.bind(this),contextType:e.getContext(),isEligibleForChange:this.isEligibleForChange.bind(this),isOperatedByAlaska:this._isOperatedByAlaska.bind(this),getPartnerFlightIndex:this._getPartnerFlightIndex.bind(this),getPartnerFlightsNonVX:this._getPartnerFlightsNonVX.bind(this),range:this._range.bind(this)},this._$scope.$watch(d.breakpoint,this.onBreakpointChange.bind(this)),this._$scope.$watch("pnr",function(b){b&&a.extend(this._$scope.flightSummary,{pnr:b,isCancel:this._$scope.context===this._locationService.contexts.CANCEL,isManage:this._$scope.context===this._locationService.contexts.MANAGE,isSuccess:this._$scope.context===this._locationService.contexts.SUCCESS,isMultiCity:b.tripType===this._tripService.MULTI_CITY,isOneWay:b.tripType===this._tripService.ONE_WAY,isRoundTrip:b.tripType===this._tripService.ROUND_TRIP,successContext:this._$scope.successContext,partnerFlights:this._getPartnerFlights(b.flightList),partnerFlightsNonVX:this._getPartnerFlightsNonVX(b.flightList)})}.bind(this)),this._$scope.$watch(this._elevateService.isLoggedIn,function(a){a&&(this._$scope.flightSummary.elevateUser=this._elevateService.getUserData())}.bind(this))};return d.$inject=["$scope","pubSubService","windowService","locationService","tripService","elevateService"],d.prototype.isEligibleForChange=function(a){return"ELIGIBLE"!==a.changeEligibility&&"ELIGIBLE"!==a.changeSeatEligibility},d.prototype.onBreakpointChange=function(a){this._$scope.flightSummary.breakpoint=a},d.prototype._openModal=function(a,b){this._pubSubService.publish("core.openModal",[a,{data:b}])},d.prototype._openCalendarModal=function(a,b){this._pubSubService.publish("core.openModal",["openSaveToCalendarModal",{data:{flightIndex:a,pnr:b}}])},d.prototype.formatDateTime=function(a,c){return a?b(a).zone(a).format(c):""},d.prototype.formatOperatorString=function(a){return a&&a.split("_").join(" ")},d.prototype._getPartnerFlights=function(a){var b=[];return a.forEach(function(a){a.segments.forEach(function(a){a.marketingAirline&&a.marketingAirline!==this._operatorConstants.OP_VX&&b.indexOf(a.marketingAirline)===-1&&b.push(a)}.bind(this))}.bind(this)),b},d.prototype._getPartnerFlightsNonVX=function(a){var b=[];return a.forEach(function(a){a.segments.forEach(function(a){a.marketingAirline&&a.marketingAirline!==this._operatorConstants.OP_VX&&a.operatingAirline!==this._operatorConstants.OP_VX&&b.indexOf(a.marketingAirline)===-1&&b.push(a)}.bind(this))}.bind(this)),b},d.prototype._isOperatedByAlaska=function(a){return this._operatorConstants.OPS_ALASKA.indexOf(a)!==-1},d.prototype._getPartnerFlightIndex=function(a,b){for(var c=this._getPartnerFlightsNonVX(a),d=0;d<c.length;d++)if(c[d]===b)return d;return-1},d.prototype._range=function(a){for(var b=[],c=0;c<a;c++)b.push(c);return b},c}),c("common/directives/pnr-payment-details",["angular"],function(a){"use strict";var b=function(){return{restrict:"A",replace:!0,controller:c,link:d,templateUrl:"/app/common/directives/pnr-payment-details.tpl.html"}},c=function(a,b,c,d,e,f,g){this._$scope=a,this._$parse=b,this._locationService=c,this._utilsService=d,this._ancillariesService=e,this._resourceBundle=f,this._purchaseService=g,this._$scope.paymentDetails={context:this._locationService.getContext(),hasInsuranceOrPet:this.hasInsuranceOrPet.bind(this),hasCheckInUpgrades:this.hasCheckInUpgrades.bind(this),isNewFlight:this.isNewFlight.bind(this),shouldShowAncSummaryList:this.shouldShowAncSummaryList.bind(this),shouldShowChangeSummary:this.shouldShowChangeSummary.bind(this),shouldShowMainCardAndTBInfo:this.shouldShowMainCardAndTBInfo.bind(this)}};c.$inject=["$scope","$parse","locationService","utilsService","ancillariesService","ResourceBundle","purchaseService"],c.prototype.hasInsuranceOrPet=function(){var a=this._$scope.paymentDetails.pnr.extras;return a&&(a.insurance||a.petc)},c.prototype.hasCheckInUpgrades=function(){var a=this._$scope.paymentDetails.pnr.extraPaymentInfo;return a.upgradeFee||a.loungeFee||a.baggagefee||this.shouldShowAncSummaryList()},c.prototype.isNewFlight=function(){var a=this._$scope.paymentDetails;return a.context===this._locationService.contexts.CHANGE&&(a.pnr.amountRefunded||a.pnr.ccAmountCharged||a.totalExtras)},c.prototype.shouldShowChangeSummary=function(){var a=this._$scope.paymentDetails;if(a.context===this._locationService.contexts.CHANGE)return a.totalExtras||a.pnr.amountRefunded||a.pnr.ccAmountCharged||a.pnr.totalMsrRefundAmount},c.prototype.shouldShowAncSummaryList=function(){return this._$scope.paymentDetails.ancillarySummaryList.length||this._$scope.paymentDetails.refundedAncillarySummaryList.length},c.prototype.shouldShowMainCardAndTBInfo=function(){var a=this._$scope.paymentDetails;return a.context===this._locationService.contexts.BOOK||a.context===this._locationService.contexts.CHANGE&&!a.pnr.extraPaymentInfo.creditCardUsed},c.prototype._calculateFaresAndTaxes=function(){var b=this._$scope.paymentDetails;if(b.pnr.fareInfo){var c=b.pnr.fareInfo.fareDetails,d={},e=0;if(a.forEach(c.fareDetails,function(c){a.forEach(c.taxListPerPax,function(a,f){"adult"===c.type?d[f]={name:this._utilsService.taxNameByCode(f,b.pnr.international),amt:a*c.paxAmount}:e+=a*c.paxAmount}.bind(this))}.bind(this)),c.fareDetails[0].taxListPerPax&&a.extend(b.pnr.fareInfo,{taxes:d}),a.extend(b.pnr.fareInfo,{intInfantTaxes:e,total:c.total||b.pnr.pnrTotalAmount}),b.totalExtras=this._ancillariesService.getAPIAncillariesAmount(),b.extrasRefund=this._ancillariesService.getExtrasRefund(),this.shouldShowChangeSummary()){var f=this._purchaseService.data();f.quote&&(b.changeSummaryTotal=f.quote.paymentAmount,b.changeSummaryRefund=Math.abs(f.quote.refundAmount))}}},c.prototype._setAncillarySummaryLists=function(){this._$scope.paymentDetails.ancillarySummaryList=this._ancillariesService.getAncillarySummaryList(),this._$scope.paymentDetails.refundedAncillarySummaryList=this._ancillariesService.getRefundedAncillarySummaryList()};var d=function(b,c,d,e){var f=e._$parse(d.pnr)(b);a.extend(b.paymentDetails,{pnr:f}),e._calculateFaresAndTaxes(),e._setAncillarySummaryLists(),b.$broadcast("paymentDetails.update")};return b}),c("common/directives/app-overlay",[],function(){"use strict";var a=function(){return{restrict:"A",scope:{},controller:b,link:c,templateUrl:"/app/common/directives/app-overlay.tpl.html"}},b=function(a,b,c){this._$scope=a,this._windowService=c,this._locationService=b,this._watches=[],this.context="book",this._$scope.isVisible=!0;var d=this._$scope.$watch(this._locationService.getContext,function(a){this.context=a}.bind(this)),e=this._$scope.$watch(this._windowService.getShowAppLoader,this.onShowAppLoaderChange.bind(this));this._watches.push(d,e)};b.$inject=["$scope","locationService","windowService"],b.prototype.onShowAppLoaderChange=function(a){if(a=!!a&&"book"===this.context,this._$scope.isVisible=a,!a)for(var b in this._watches)this._watches[b](),this._watches[b]=null};var c=function(a,b){b.removeClass("app-overlay")};return a}),c("common/directives/points-slider",[],function(){"use strict";var a=function(){return{restrict:"A",scope:{},controller:b,templateUrl:"/app/common/directives/points-slider.tpl.html"}},b=function(a){this.$scope=a,a.pointsSlider={value:2500,values:{low:0,high:1e5},calcPrice:this.calcPrice.bind(this)}};return b.$inject=["$scope"],b.prototype.calcPrice=function(a){return a>0?a/50*1.075+11:0},a}),c("common/directives/calendar-widget",["angular","moment"],function(a,b){"use strict";var c=function(){return{restrict:"A",replace:!0,scope:{numMonths:"@"},controller:d,templateUrl:"/app/common/directives/calendar-widget.tpl.html"}},d=function(a,c,d,e,f,g){this._$scope=a,this._$rootScope=c,this._windowService=d,this._latestTimeService=f,this._accessibleService=g,this._currentMoment=b(),this._monthsForward=0,this._maxMonths=parseInt(a.numMonths,10),a.calWidget={breakpoint:d.breakpoint(),days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthTitle:"",monthSpelled:"",noPrevMonths:!0,noNextMonths:!1,showPrevMonth:this.showPrevMonth.bind(this),showNextMonth:this.showNextMonth.bind(this),selectDay:this.selectDay.bind(this),close:this.close.bind(this)},e.subscribe("windowService.breakpoint",this.onBreakpointChange.bind(this)),this.setNewMonth(this._currentMoment)};return d.$inject=["$scope","$rootScope","windowService","pubSubService","latestTimeService","accessibleService"],d.prototype.onBreakpointChange=function(a){this._$scope.calWidget.breakpoint=a},d.prototype.setNewMonth=function(c){var d,e,f,g,h,i,j=[],k=c.daysInMonth(),l=c.year()===this._currentMoment.year()&&c.month()===this._currentMoment.month();if(this._$scope.calWidget.monthTitle=c.format("MMMM YYYY"),this._$scope.calWidget.monthSpelled=c.format("MMMM"),l){var m=b();h=m.format("D"),m.startOf("month"),i=m.day()}else h=1,c.startOf("month"),i=c.day();if(f=c.format("M YYYY").split(" "),g=f[0],i)for(e=0;e<i;e++)j.push({isFiller:!0});for(e=1;e<=k;e++)d={day:e,month:g,year:f[1]},d.date=[d.month,d.day,d.year].join("/"),d.dayOfWeek=b(d.date).weekday(),e<h&&(d.isDisabled=!0),j.push(d);a.extend(this._$scope.calWidget,{currentMonth:j})},d.prototype._announceSelectedMonth=function(){this._accessibleService.setAssertiveLevel(this._accessibleService.assertiveLevels.ASSERTIVE),this._accessibleService.setText(this._$scope.calWidget.monthTitle+" selected.")},d.prototype.showPrevMonth=function(){if(!this._$scope.calWidget.noPrevMonths){this._monthsForward=this._monthsForward-1,0===this._monthsForward&&(this._$scope.calWidget.noPrevMonths=!0),this._$scope.calWidget.noNextMonths=!1;var a=b(),c=a.add("months",this._monthsForward);this.setNewMonth(c),this._announceSelectedMonth()}},d.prototype.showNextMonth=function(){if(!this._$scope.calWidget.noNextMonths){this._monthsForward=this._monthsForward+1,this._monthsForward===this._maxMonths-1&&(this._$scope.calWidget.noNextMonths=!0),this._$scope.calWidget.noPrevMonths=!1;var a=b(),c=a.add("months",this._monthsForward);this.setNewMonth(c),this._announceSelectedMonth()}},d.prototype.selectDay=function(a){a.isDisabled||this._$rootScope.$broadcast("calWidgetDateSelected",a.date)},d.prototype.close=function(){this._$rootScope.$broadcast("calWidgetClose")},c}),c("common/directives/click-to-chat",[],function(){"use strict";var a=function(){return{restrict:"A",scope:{},link:b}},b=function(a,b,c){function d(a){window[f]=a,window.c2c_refresh=window.c2c_refresh?window.c2c_refresh+1:1}var e="c2c-"+c.vxCommonC2c,f=e.replace(/-/g,"_");b.attr("id",e);var g=$("<span>").attr("id",e+"-chat-link"),h=$("<span>").attr("id",e+"-chat-link-info"),i=$('<span class="accessible-only-text">').text(" (link opens in new window)");g.append(h),g.append(i),b.append(g),d(!0),a.$on("$destroy",function(){d(!1)})};return a}),c("common/directives/facebook-share",[],function(){"use strict";var a=function(){return{restrict:"A",controller:b,link:c,scope:{shareUrl:"="}}},b=function(a,b,c){this._$scope=a,this._$window=b,this._resourceBundle=c,this._appID=this._resourceBundle.socialClientIds.fb,function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_US/sdk.js",e.parentNode.insertBefore(d,e))}(document,"script","facebook-jssdk"),this._$window.fbAsyncInit=function(){FB.init({appId:this._appID,xfbml:!0,cookie:!0,version:"v2.6"})}.bind(this)};b.$inject=["$scope","$window","ResourceBundle"],b.prototype.initFBShare=function(){var a=this._$scope.shareUrl;FB.ui({method:"share",display:"popup",href:a})};var c=function(a,b,c,d){b.on("click",function(a){a.preventDefault(),d.initFBShare()}),a.$on("$destroy",function(){b.off("click")})};return a}),c("common/directives/google-plus-share",[],function(){"use strict";var a=function(){return{restrict:"A",controller:b,link:c,scope:{shareData:"="}}},b=function(a,b,c){this._$scope=a,this._resourceBundle=b,this._$singleTimeout=c,this._clientID=this._resourceBundle.socialClientIds.google,this._shareSelector=".icon-g-plus-hidden"};b.$inject=["$scope","ResourceBundle","$singleTimeout"],b.prototype.initGoogleShare=function(){var a=$(this._shareSelector);a&&a.click()};var c=function(a,b,c,d){function e(){d._$singleTimeout(function(){f=a.shareData.url,g=a.shareData.name,h=a.shareData.socialButtonsCopy.googlePlus,i={contenturl:f,contentdeeplinkid:"/pages",clientid:d._clientID,cookiepolicy:"single_host_origin",prefilltext:h,calltoactionlabel:"CREATE",calltoactionurl:"http://plus.google.com/pages/create",calltoactiondeeplinkid:"/pages/create"},gapi.interactivepost.render(j,i)},0)}var f,g,h,i,j=$(d._shareSelector)[0];b.on("click",function(a){a.preventDefault(),d.initGoogleShare()}),a.$on("$destroy",function(){b.off("click")}),"undefined"==typeof gapi?function(){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src="https://apis.google.com/js/platform.js",a.onload=e;var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}():e()};return a}),c("common/directives/social-media-buttons",["angular","moment"],function(a,b){"use strict";var c=function(){return{restrict:"A",controller:d,link:e,replace:!0,scope:{flightInfo:"=",isCancel:"="},templateUrl:"/app/common/directives/social-media-buttons.tpl.html"}},d=function(a,b){this._ResourceBundle=b,a.shareData={}};d.prototype._formatDateTime=function(a,c){return a?b(a).zone(a).format(c):""},d.prototype._localizeDateTime=function(a,c){if(a)return b(a).zone(a).format(c)};var e=function(b,c,d,e){var f=e._ResourceBundle.destinationsList[b.flightInfo.destination],g="https://www.virginamerica.com/cms/travel-deals/",h=e._localizeDateTime(b.flightInfo.arrivalDateTime,"ddd, MMMM D"),i=e._formatDateTime(b.flightInfo.arrivalDateTime,"h:mma"),j={default:{twitter:"Aww, yeah! I'm flying @VirginAmerica to "+f.name+".",googlePlus:"Aww, yeah! I'm flying @VirginAmerica to "+f.name+". Movies and mood-lighting here I come! "+f.url+".",email:{subject:"Check out my Virgin America flight info!",body:"Aww, yeah! I'm flying Virgin America to "+f.name+" on Flight "+b.flightInfo.flightNum+" and I arrive "+h+" at "+i+". Movies and mood-lighting here I come! "+f.url+"."}},cancel:{twitter:"Get out of town! Fly @VirginAmerica for movies. mood-lighting, and more!",googlePlus:"Get out of town! Fly @VirginAmerica for movies. mood-lighting, and more! "+g+".",email:{subject:"Get out of town!",body:"Join me at 35,000 ft. on Virgin America for movies, mood-lighting, and more! "+g+"."}}},k=b.isCancel,l=k?j.cancel:j.default,m=k?g:f.url;a.extend(b.shareData,{name:f.name,url:m,socialButtonsCopy:l})};return d.$inject=["$scope","ResourceBundle"],c}),c("common/directives/load-script",[],function(){"use strict";var a=function(){return{restrict:"A",replace:!0,scope:!0,link:b}},b=function(a,b,c){b.html(["<script src=",c.loadScript,"></script>"].join("'"))};return a}),c("common/directives/universal-receipt",[],function(){"use strict";var a=function(){return{restrict:"A",controller:b}},b=function(a,b,c,d,e,f,g){this._$scope=a,this._resourceBundle=b,this._$modal=c,this._$window=e,this._loadingService=f,this._$q=g,this._printReceiptUrl=d("/api/v2/manage/print-changed-itinerary?includeBillingInfo=true&pnr={{pnr}}&lastName={{lastName}}"),this._$scope.universalReceipt={openModal:this.view.bind(this),view:this.view.bind(this)}};return b.$inject=["$scope","ResourceBundle","$modal","$interpolate","$window","loadingService","$q"],b.prototype._closeModal=function(a,b){this._modal&&this._modal.close(),this._modal=null,this._loadReceipt(b,a)},b.prototype._loadReceipt=function(a,b){var c=this._printReceiptUrl({pnr:a,lastName:b.toUpperCase()});this._$window.open(c,"_blank")},b.prototype._createModal=function(){var a=this._resourceBundle.modal.printReceipt,b=this._$scope.$new();b.onComplete=this._closeModal.bind(this);var c=function(a){this._$scope=a,a.printReceipt={fields:{},submit:function(){var b=a.printReceipt.fields.lastName.value,c=a.printReceipt.fields.confirmationCode.value;a.onComplete(b,c)}}};c.$inject=["$scope"],this._modal=this._$modal.open({scope:b,controller:c,size:a.SIZE,templateUrl:a.TEMPLATE_URL,title:a.TITLE})},b.prototype.view=function(a,b){a&&b?this._loadReceipt(a,b):this._createModal()},a}),c("common/directives/e2e-testing",[],function(){"use strict";var a=function(){return{restrict:"A",link:b,scope:{testingTarget:"@",testingAttr:"@",testingPrefix:"@"}}},b=function(a,b){var c,d=$(b),e="data-vx-e2e",f=a.testingPrefix;c=a.testingAttr?"-"+a.$parent[a.testingTarget][a.testingAttr]:"",d.parent().data().e2eParentType&&(f=d.parent().data().e2eParentType+"-"+f),a.$parent.pickerType&&(c="destination"===a.$parent.pickerType?"-arr-"+c:"-dep-"+c),d.attr(e+"-"+f+c,"")};return a}),c("common/directives/conversion-tracking",[],function(){"use strict";var a=function(){return{restrict:"A",controller:b,link:c}},b=function(a){this._$scope=a,"book"===this._$scope.success.context&&this._initConverstion()};b.$inject=["$scope"],b.prototype._initConverstion=function(){this._successScope=this._$scope.$parent.success,this._pnr=this._successScope.pnr,this._flightList=this._pnr.flightList,this._paxList=this._pnr.paxList,this._formatedPaxList={},this._fareDetails=this._pnr.fareInfo.fareDetails,this._flightString=[],this._depDate=this._flightList[0].departureDateFormats,this._depDateFormat=this._depDate.year+"-"+this._depDate.monthNum+"-"+this._depDate.date,this._retDate,this._retDateFormat,this._cabinClasses=[],this._classOfService=[],this._formatedPaxList.adult=0,this._formatedPaxList.children=0,this._formatPaxList(),this._formatFlightList(),this._formatReturnDate(),this._joinLists(),this._$scope.googleParams={gfs_partner_id:"41",gfs_trip_type:this._pnr.tripTypeLabel.split(" ").join(""),gfs_origin:this._flightList[0].origin,gfs_destination:this._flightList[0].destination,gfs_departure_date:this._depDateFormat,gfs_return_date:this._retDateFormat,gfs_total_price:this._fareDetails.totalFare,gfs_base_price:this._fareDetails.totalBaseFare,gfs_currency:"USD",gfs_passengers_total:this._paxList.length,gfs_passengers_adult:this._formatedPaxList.adult,
gfs_passengers_child:this._formatedPaxList.children,gfs_passengers_infant_in_lap:this._pnr.infantsTraveling,gfs_passengers_infant_in_seat:"0",gfs_passengers_senior:"0",gfs_cabins:this._cabinClasses,gfs_booking_codes:this._classOfService,gfs_flights:this._flightString,gfs_fare_basis_codes:"",gfs_ver:"1.0.a"},void(this._$scope.dataString="gfs_partner_id%3D41%3Bgfs_trip_type%3D"+this._pnr.tripTypeLabel.split(" ").join("")+"%3Bgfs_origin%3D"+this._flightList[0].origin+"%3Bgfs_destination%3D"+this._flightList[0].destination+"%3Bgfs_departure_date%3D"+this._depDateFormat+"%3Bgfs_return_date%3D"+this._retDateFormat+"%3Bgfs_total_price%3D"+this._fareDetails.totalFare+"%3Bgfs_base_price%3D"+this._fareDetails.totalBaseFare+"%3Bgfs_currency%3DUSD%3Bgfs_passengers_total%3D"+this._paxList.length+"%3Bgfs_passengers_adult%3D"+this._formatedPaxList.adult+"%3Bgfs_passengers_child%3D"+this._formatedPaxList.children+"%3Bgfs_passengers_infant_in_seat%3D0%3Bgfs_passengers_infant_in_lap%3D"+this._pnr.infantsTraveling+"%3Bgfs_passengers_senior%3D0%3Bgfs_cabins%3D"+this._cabinClasses+"%3Bgfs_booking_codes%3D"+this._classOfService+"%3Bgfs_flights%3D"+this._flightString+"%3Bgfs_fare_basis_codes%3D%3Bgfs_ver%3D1.0.a")},b.prototype._formatPaxList=function(){for(var a=0;a<this._paxList.length;a++)this._paxList[a].paxType.indexOf("ADULT")!==-1?this._formatedPaxList.adult+=1:"CHILD"===this._paxList[a].paxType&&(this._formatedPaxList.children+=1)},b.prototype._formatFlightList=function(){for(var a=0;a<this._flightList.length;a++){this._flightString.push("VX"+this._flightList[a].flightNum),this._getCabinType(a);for(var b=0;b<this._flightList[a].segments.length;b++)this._classOfService.push(this._flightList[a].segments[b].classOfService)}},b.prototype._joinLists=function(){this._flightString.length>1&&(this._flightString=this._flightString.join(",")),this._cabinClasses.length>1&&(this._cabinClasses=this._cabinClasses.join(",")),this._classOfService.length>1&&(this._classOfService=this._classOfService.join(","))},b.prototype._getCabinType=function(a){var b;switch(this._flightList[a].cabinType){case"MAIN CABIN":b="Economy";break;case"MAIN CABIN SELECT":b="PremiumEconomy";break;case"FIRST CLASS":b="First"}this._cabinClasses.push(b)},b.prototype._formatReturnDate=function(){this._flightList[1]?(this._retDate=this._flightList[1].departureDateFormats,this._retDateFormat=this._retDate.year+"-"+this._retDate.monthNum+"-"+this._retDate.date):this._retDateFormat=""};var c=function(a){$("body").append('<div style="display:inline;"><img height="1" width="1" style="borderstyle:none;"alt=""src="https://www.googletraveladservices.com/travel/flights/clk/pagead/conversion/41/?label=GFS&guid=ON&script=0&ord='+parseInt(1e3*Math.random(),10)+"&data="+a.dataString+'"> </img> </div>')};return a}),c("common/directives/address-autocomplete",["jquery"],function(a){"use strict";var b=function(){return{restrict:"A",link:d,controller:c}},c=function(a,b,c,d){this._$scope=a,this._$singleTimeout=b,this._pubSubService=c,this._accessibleService=d,this._fieldMap={city:["sublocality_level_1","locality"],stateSelect:["administrative_area_level_1"],country:["country"],zipCode:["postal_code"]}};c.$inject=["$scope","$singleTimeout","pubSubService","accessibleService"],c.prototype._parseGooglePlacesData=function(a){return a.address_components=a.address_components||[],Object.keys(this._fieldMap).reduce(function(b,c){for(var d=this._fieldMap[c],e=0;e<d.length;e++){var f=this._getAddressComponent(a,d[e]);if(f){b[c]=f;break}}return b}.bind(this),{})},c.prototype._getAddressComponent=function(a,b){return a.address_components.filter(function(a){if("undefined"!=typeof a.types)return a.types.some(function(a){return a===b})})[0]};var d=function(b,c,d,e){function f(){var a=h.val().split(",")[0];b.formHandler.setValue(h.attr("name"),a),h.val(a),e._accessibleService.setText(a)}function g(){var c,g,i,j=e._accessibleService.assertiveLevels.ASSERTIVE,k=new google.maps.places.Autocomplete(h[0],{types:["address"]}),l=new google.maps.places.AutocompleteService;h.on("blur",function(){e._$singleTimeout(function(){f()})}),e._accessibleService.getAssertiveLevel()!==j&&e._accessibleService.setAssertiveLevel(j),google.maps.event.addListener(k,"place_changed",function(){if(b.formHandler&&d.addressAutoCompleteForm){var h=k.getPlace(),j=e._parseGooglePlacesData(h);e._$singleTimeout(function(){f(),a("[data-autocomplete-address-field]").each(function(c,d){0!==c&&(i=a("input, select",d).attr("name"),g=j[i]?j[i].short_name:"",b.formHandler.setValue(i,g))}),c=j.stateSelect?[j.stateSelect.short_name]:[],e._pubSubService.publish("addressForm.autocompleteStateVal",c)})}}),h.on("keydown",function(b){13===b.keyCode&&a(".pac-container:visible").length&&b.preventDefault()}),h.on("keyup",function(b){var c=[38,39,40,37],d=new RegExp("[a-zA-Z0-9]","i"),f=d.test(String.fromCharCode(b.keyCode)),g=a(this).val(),h=function(a){e._accessibleService.setText(a.length+" suggestions are available, use up and down arrows to select.")};f&&g&&l.getQueryPredictions({input:g},h),c.indexOf(b.keyCode)>-1&&a(".pac-container:visible").length&&e._accessibleService.setText(g)})}var h=c.is("input")?a(c):c.find("input");h.attr("placeholder",""),window.google&&window.google.maps&&window.google.maps.places?g():window.AddressAutoCompleteStack?window.AddressAutoCompleteStack.push(g):(window.AddressAutoCompleteStack=[g],window.AddressAutoCompleteGoogleCallback=function(){window.AddressAutoCompleteStack.forEach(function(a){a()}),window.AddressAutoCompleteStack=[]},a.getScript("https://maps.googleapis.com/maps/api/js?libraries=places&sensor=false&callback=AddressAutoCompleteGoogleCallback"))};return b}),c("common/directives/ancillaries-selector",["angular","jquery"],function(a,b){"use strict";var c=function(){return{restrict:"A",replace:!0,scope:{},templateUrl:"/app/common/directives/ancillaries-selector.tpl.html",controller:d}},d=function(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){this._$scope=b,this._$interpolate=c,this._pubSubService=d,this._workflowService=e,this._resourceBundle=f,this._$singleTimeout=g,this._ancillariesService=h,this._locationService=j,this._windowService=i,this._tripService=k,this._changeService=l,this._utilsService=m,this._statusService=n,this._$timeout=p,this._accessibleService=o,this._accordionVisibleMap={},a.extend(this._$scope,{ancSelector:{isAccordionVisible:this.isAccordionVisible.bind(this),changeSection:this.changeSection.bind(this),collapsedAncillaryList:[],continue:this.onContinue.bind(this),getGroupPriceLabel:this.getGroupPriceLabel.bind(this),isCollapsed:!1,isVisible:!1,shouldDisplayAncillaries:this._ancillariesService.shouldDisplayAncillaries.bind(this),toggleAccordion:this.toggleAccordion.bind(this),getButtonText:this.getButtonText.bind(this),showIncludedListFor:this.showIncludedListFor.bind(this),getIncludedTextFor:this.getIncludedTextFor.bind(this),skipSection:this.skipSection.bind(this),formatTierName:this._utilsService.formatTierName.bind(this),getTierBaggageCount:this.getTierBaggageCount.bind(this),onNoThanksClick:this.onNoThanksClick.bind(this),hasFullySelectedParent:this._ancillariesService.hasFullySelectedParent.bind(this)}}),this._initPubSub()};return d.$inject=["$scope","$interpolate","pubSubService","workflowService","ResourceBundle","$singleTimeout","ancillariesService","windowService","locationService","tripService","changeService","utilsService","statusService","accessibleService","$timeout"],d.prototype.onNoThanksClick=function(a){this._ancillariesService.atLeastOneCheckedAncillary(a)?this._ancillariesService.setAncillaryQuantityTo0(a):this._accordionVisibleMap[a]=!1,this._$singleTimeout(this._refreshView.bind(this,!0))},d.prototype.getGroupPriceLabel=function(a){var b,c,d,e=this._ancillariesService.getGroupPricePerAncillary();return e[a.ancillaryId]?"$"+this._utilsService.conditionallyFormatDecimal(e[a.ancillaryId])+" total":this.isAccordionVisible(a.ancillaryId)?"":(a.maxQuantity>1?(c=a.isBag?" per bag":" per item",a._model.level===this._ancillariesService.levels.O_AND_D&&(d=" each way")):a._model.level===this._ancillariesService.levels.O_AND_D?d=" each way":a._model.level===this._ancillariesService.levels.PNR&&(d=" per guest"),b=this._$interpolate("${{price}}{{perItem}}{{perLevel}}")({price:this._utilsService.conditionallyFormatDecimal(a.maxPrice),perItem:c,perLevel:d}))},d.prototype.isAccordionVisible=function(a){return!!this._ancillariesService.atLeastOneCheckedAncillary(a)||!this._ancillariesService.atLeastOneUncheckedAncillary(a)&&this._accordionVisibleMap[a]},d.prototype.toggleAccordion=function(a,c){var d=a.ancillaryId,e=".anc-selector-accordion__content,.anc-selector-accordion__no-thanks";b(e).find(c.target).length||(this._ancillariesService.noAvailableAncillaries(d)?(this._accordionVisibleMap[d]=!this._accordionVisibleMap[d],this._refreshView()):this.isAccordionVisible(d)||(this._ancillariesService.setAncillaryQuantityTo1(d),this._pubSubService.publish("adobeAnalytics.ancillaryOpened"),this._refreshView(),this._$singleTimeout(this._statusService.setStatus.bind(this,{format:this._statusService.format.SUCCESS,copy:this._statusService.message.ANCILLARIES_SELECTED,data:{title:a.title}}),500)))},d.prototype._constructAccordionData=function(){this._updateAncSelectorScope(),this._ancillariesService.setIncludedListData(),this._accordionVisibleMap={}},d.prototype._updateAncSelectorScope=function(){a.extend(this._$scope.ancSelector,{accordionAncillaryList:this._ancillariesService.getFormattedAvailableAncillaryList(),fareLevelData:this._ancillariesService.getFareData(),travelers:this._ancillariesService.getTravelerData()})},d.prototype._refreshView=function(a){this._refreshingView&&!a||(this._refreshingView=!0,this._$singleTimeout(function(){this._refreshingView=!1}.bind(this),500),this._$scope.$broadcast("ancSelector.refreshView"),this._$singleTimeout(function(){this._$scope.$broadcast("ancToggle.refreshView")}.bind(this)))},d.prototype.onContinue=function(){this._ancillariesService.publishAnalyticsData(),this._locationService.contextIs(this._locationService.contexts.BOOK)?this._workflowService.transition(this._workflowService.state.ANCILLARIES_SELECTOR):this._changeService.isChangeType(this._changeService.CHANGE_TYPES.EXISTING)?this._pubSubService.publish("changeExistingCtrl.changeSeats"):this._collapseSection()},d.prototype._initPubSub=function(){this._pubSubService.subscribe("ancillaries.retrieved",this._onAncillariesRetrieved.bind(this)),this._pubSubService.subscribe("ancillariesSelector.collapse",this._collapseSection.bind(this)),this._pubSubService.subscribe("ancillariesSelector.expand",this.changeSection.bind(this)),this._pubSubService.subscribe("ancillariesSelector.setVisibility",this._setVisibility.bind(this)),this._pubSubService.subscribe("ancillariesSelector.reset",this._resetUI.bind(this)),this._pubSubService.subscribe("ancillaries.resetUIAncillaries",function(){this._constructAccordionData(),this._generateCollapsedInfoList(),this._refreshView()}.bind(this)),this._pubSubService.subscribe("ancillaries.updateCollapsedInfoList",this._generateCollapsedInfoList.bind(this)),this._pubSubService.subscribe("ancillaries.refreshView",this._refreshView.bind(this))},d.prototype.changeSection=function(){this._$scope.ancSelector.isCollapsed=!1,this._locationService.contextIs(this._locationService.contexts.BOOK)?(this._accessibleService.resolveExpand(this._$scope.ancSelector.sectionLength),this._workflowService.transition(this._workflowService.getCurrentState(),this._workflowService.state.ANCILLARIES_SELECTOR,!0)):(this._statusService.setChangeGuider(this._statusService.message.CHANGE_EXTRAS),this._pubSubService.publish("seatService.resetService")),this._statusService.setStatus([]),this._pubSubService.publish("ancillaries.resetUIAncillaries"),this._pubSubService.publish("ancillaries.isOnSeatMap",[!1]),this._ancillariesService.publishTotalPrice(),this._refreshView()},d.prototype._resetUI=function(){a.extend(this._$scope.ancSelector,{accordionAncillaryList:[],collapsedAncillaryList:[],fareLevelData:null,isCollapsed:!1,travelers:null}),this._accordionVisibleMap={},this._setVisibility(!1)},d.prototype._collapseSection=function(){var a=function(){var a="#"+this._resourceBundle.states.SEAT_SELECTOR_STATE.scrollTarget,c=b(a).offset().top-b("#yts").height()-b("#change-guider").height();b(window).scrollTop(c)}.bind(this);this._$singleTimeout(function(){this._generateCollapsedInfoList(),b(".anc-selector .collapse-container > .wrap").addClass("collapsed-section collapsed-section--extras"),this._locationService.contextIs(this._locationService.contexts.BOOK)?a():this._changeService.isChangeType(this._changeService.CHANGE_TYPES.EXISTING)?(this._locationService.update("/change/seats"),this._ancillariesService.refreshAncillariesForChangeFlow(!0),a()):(this._locationService.go({target:"/change/seats"}),this._ancillariesService.refreshAncillariesForChangeFlow(!0)),this._$scope.ancSelector.isCollapsed=!0,this._refreshView(!0)}.bind(this)),this._$timeout(function(){this._$scope.ancSelector.sectionLength=b(".collapse-container.collapsed-section .collapsed-section").length-1}.bind(this))},d.prototype._generateCollapsedInfoList=function(){var b,c,d,e=this._ancillariesService.getAvailableAncillaries(!0),f=[];a.forEach(e,function(e){b=e.title,c=0,d=e.getPaxQuantities(!0,this._ancillariesService.selectionTypes.UI),a.forEach(d,function(a){c+=a}),c>0&&f.push([c," ",b].join(""))}.bind(this)),0===f.length&&f.push("None Selected"),this._$scope.ancSelector.collapsedAncillaryList=f,this._refreshView()},d.prototype._onAncillariesRetrieved=function(){this._constructAccordionData(),this._setVisibility(!0)},d.prototype._setVisibility=function(a){this._$scope.ancSelector.isVisible=a,this._$singleTimeout(this._refreshView.bind(this,!0));var b=this._locationService.contextIs(this._locationService.contexts.BOOK)?"_tripService":"_changeService";this[b].setVisibleSection({section:"ANCILLARIES_SELECTOR",isVisible:a})},d.prototype._areAncillariesSelected=function(){return this._ancillariesService.getSelectedAncillaries().some(function(a){return!b.isEmptyObject(a.getPaxQuantities(!0))})},d.prototype._hasPrepurchasedAncillaries=function(){return this._ancillariesService.getSelectedAncillaries([this._ancillariesService.selectionTypes.PNR]).length},d.prototype.showIncludedListFor=function(a){var b=a.isBag||!this._$scope.ancSelector.isAccordionVisible(a.ancillaryId),c=a.includedListData.some(function(b){return this.getIncludedTextFor(a,b)}.bind(this));return!a.isBundle&&c&&b},d.prototype.getIncludedTextFor=function(a,b){var c;if(!a.isBag)return c="Included",c+" for "+b.fullName},d.prototype.getTierBaggageCount=function(a,c,d,e){var f,g,h,i;return c&&a.isBag&&(f=this._resourceBundle.flightInformation.cabinBaggage[c],a.includedListData.some(function(a){if(g=a.guestId===e&&(!b.isEmptyObject(a.oAndDTierMap)||a.oAndDTierMap[d]),h=!a.freeBagAllowance||a.freeBagAllowance<f,g&&h)return i=f,!0}.bind(this))),i},d.prototype.skipSection=function(){this._resetUI(),this._ancillariesService.resetUISelections(),this._pubSubService.publish("ancillaries.resetUIAncillaries"),this._onAncillariesRetrieved(),this.onContinue()},d.prototype.getButtonText=function(){return this._areAncillariesSelected()?"Continue":this._hasPrepurchasedAncillaries()?"Continue with pre-purchased extras":"Continue without extras"},c}),c("common/directives/ancillary-toggle",["angular"],function(a){"use strict";var b=function(){return{restrict:"A",replace:!0,scope:{ancillary:"=",airportCodes:"=",guestId:"@",tripType:"@",level:"@",includedInTier:"=",notEligible:"=",isLastLevel:"=",isPrimaryTraveler:"=",tierName:"=",tierBaggageCount:"=",onSeatMap:"=",priceOverride:"@",accordionIsCollapsed:"="},templateUrl:"/app/common/directives/ancillary-toggle.tpl.html",controller:c,link:d}},c=function(b,c,d,e,f,g,h,i){this._$scope=b,this._$interpolate=c,this._$singleTimeout=d,this._resourceBundle=e,this._travelerService=f,this._ancillariesService=g,this._utilsService=h,this._pubSubService=i,this._levelType={O_AND_D:"IP",PNR:"PNR"},this._tripType={ONE_WAY:"ONE_WAY",ROUND_TRIP:"ROUND_TRIP",MULTI_CITY:"MULTI_CITY"},this._setPriceAndEligibilityDataForTraveler(),this._eligibilityMap={ELIGIBLE:"ELIGIBLE",NOT_ELIGIBLE:"NOT_ELIGIBLE"},this._maxQuantity=parseInt(this._$scope.ancillary.maxQuantity,10),this._isMultiQuantity=this._maxQuantity>1,this._initialQuantity=0,this._allowance=0,this._setInitialQuantity(),this._$scope.$watch("includedInTier",function(){this._updateIncluded(),this._refreshView()}.bind(this));var j=this._getModel().bundleId||this._getModel().ancillaryId;this._pubSubService.subscribe(j+".parentBundledSelected",this._onParentBundleSelected.bind(this)),this._onSeatMap=!!this._$scope.onSeatMap,a.extend(this._$scope,{ancToggle:{airportCodes:this._$scope.airportCodes,decrement:this.decrement.bind(this),increment:this.increment.bind(this),isMultiQuantity:this._isMultiQuantity,isOAndDAncillary:this.isOAndDAncillary.bind(this),isPnrAncillary:this.isPnrAncillary.bind(this),isRoundTrip:this.isRoundTrip.bind(this),isOneWayTrip:this.isOneWayTrip.bind(this),isMultiCityTrip:this.isPnrMultiCity.bind(this),isEligible:this._getEligibility(),isIncluded:!1,isSelected:this._getEligibility()&&this._getInitialSelected(),maxQuantity:this._maxQuantity,onToggle:this.onToggle.bind(this),price:this._getPriceLabel(),quantity:this._initialQuantity,canIncrement:this.canIncrement.bind(this),canDecrement:this.canDecrement.bind(this),getLabel:this.getLabel.bind(this),showToggle:this.showToggle.bind(this),isFullWidth:this.isFullWidth.bind(this),shouldShowCheckIcon:this.shouldShowCheckIcon.bind(this),isAvailable:this.isAvailable.bind(this),setQuantityTo1:this.setQuantityTo1.bind(this),setQuantityTo0:this.setQuantityTo0.bind(this),isUncheckedAndAvailable:this.isUncheckedAndAvailable.bind(this),isAvailableAndSelected:this.isAvailableAndSelected.bind(this),isFreeBundle:this.isFreeBundle.bind(this),isOnSeatMap:this.isOnSeatMap.bind(this)}}),this._updateIncluded(),this._updateProperties(),this._initPubSub(),this._ancillariesService.registerToggle(this._getModel().ancillaryId,this._$scope.guestId,this._$scope.level,this._$scope.ancToggle),!this._getEligibility()&&this._getModel().isBundle&&this._$singleTimeout(function(){this._refreshView()}.bind(this))};c.$inject=["$scope","$interpolate","$singleTimeout","ResourceBundle","travelerService","ancillariesService","utilsService","pubSubService"],c.prototype.isOnSeatMap=function(){return this._onSeatMap},c.prototype._setOnSeatMap=function(a){this._onSeatMap=a,this._refreshView()},c.prototype._initPubSub=function(){this._pubSubService.subscribe("ancillaries.resetUIAncillaries",this._updateProperties.bind(this)),this._pubSubService.subscribe("ancillaries.isOnSeatMap",this._setOnSeatMap.bind(this))},c.prototype._setInitialQuantity=function(){if(this._getEligibility()&&this._isMultiQuantity){var a=this._getModel().getPaxInfo(this._$scope.guestId,this._constructLevelData());this._initialQuantity=a.pnrQuantity}},c.prototype._updateProperties=function(){var b=this._getModel().getUIQuantityForGuestAndLevel(this._$scope.guestId,this._constructLevelData()),c=this._initialQuantity+b;a.extend(this._$scope.ancToggle,{quantity:c,isSelected:!!c}),this._refreshView()},c.prototype._getModel=function(){return this._$scope.ancillary._model},c.prototype._setPriceAndEligibilityDataForTraveler=function(){if(!this._$scope.notEligible){var a=this._getModel(),b=a.levelMap[this._$scope.level].paxPriceMap[this._$scope.guestId];this._priceEligibilityData=a.priceMap[b]}},c.prototype._updateIncluded=function(){var a=this._getModel(),b=a.autoApply&&this._getEligibility()&&this._isFreeForGuest(),c=this._getIsIncluded();this._$scope.ancillary.isBag&&this._updateAllowance(),this._$scope.ancToggle.isIncluded=b||c,b&&!c&&this._emitChange(this._ancillariesService.toggleAction.ADD)},c.prototype._updateAllowance=function(){var a,b,c,d,e,f,g,h=this._allowance;if(a=this._getIncludedDataForTraveler(),a&&(b=this._$scope.tierBaggageCount,!b&&a.freeBagAllowance&&!a.selectedParentBundleName&&(b=a.freeBagAllowance)),!b)if(c=this._ancillariesService.getSelectedBundleParentName(this._getModel(),this._$scope.guestId,{levelData:this._constructLevelData()}),b=c?1:0,d=b-h,e=this._getModel().getPaxInfo(this._$scope.guestId,this._constructLevelData()),f=e&&e.uiQuantity,g=this._$scope.ancToggle.quantity,d>0)for(var i=0;i<Math.min(d,f);i++)this._emitChange(this._ancillariesService.toggleAction.REMOVE);else if(d<0&&g>0)for(var j=Math.min(d,g);j<0;j++)this._emitChange(this._ancillariesService.toggleAction.ADD);this._allowance=b},c.prototype._getIncludedDataForTraveler=function(){var b,c=this._$scope.guestId;return a.forEach(this._$scope.ancillary.includedListData,function(a){a.guestId===c&&(b=a)}),b},c.prototype._isFreeForGuest=function(){return this._priceEligibilityData&&0===this._priceEligibilityData.finalPrice},c.prototype.isFreeBundle=function(a){var b,c=this._getEligibility()&&this._isFreeForGuest()&&this._getModel().isBundle;return!!c||!a&&(b=this._ancillariesService.getSiblingToggle(this._$scope),!this._getEligibility()&&b&&b.isFreeBundle(!0))},c.prototype._getIsIncluded=function(){return!(!this._getEligibility()||!this._isPreExisting()&&!this._$scope.includedInTier)||(!this._isMultiQuantity&&this._ancillariesService.getSelectedBundleParentName(this._getModel(),this._$scope.guestId,{levelData:this._constructLevelData()})?(this._$scope.ancToggle.isSelected=!1,this._emitChange(this._ancillariesService.toggleAction.REMOVE),!0):void 0)},c.prototype._isPreExisting=function(){if(this._$scope.notEligible||this._isMultiQuantity)return!1;var a=this._getModel().getPaxInfo(this._$scope.guestId,this._constructLevelData());return this._levelType.PNR&&a.pnrQuantity>0},c.prototype._getInitialSelected=function(){var a=this._getModel().getPaxInfo(this._$scope.guestId,this._constructLevelData());return a.uiQuantity||a.pnrQuantity},c.prototype._getEligibility=function(){return!this._$scope.includedInTier&&!this._$scope.notEligible&&this._priceEligibilityData&&this._priceEligibilityData.status===this._eligibilityMap.ELIGIBLE&&this._ancillariesService.ancillaryIsAvailable(this._getModel())||this._isPreExisting()},c.prototype._getPriceLabel=function(){return this._getEligibility()&&this._priceEligibilityData&&"$"+this._utilsService.conditionallyFormatDecimal(this._priceEligibilityData.finalPrice)},c.prototype.canDecrement=function(){return this._$scope.ancToggle.quantity>this._initialQuantity},c.prototype.decrement=function(a){var b;this.canDecrement()&&(b=this._$scope.ancToggle.quantity,this._$scope.ancToggle.quantity--,b>this._allowance&&this._emitChange(this._ancillariesService.toggleAction.REMOVE),this._evalMultiSelectedState(),this._refreshView(),!a&&this._$scope.ancToggle.focusOnAccordionOnDeselect())},c.prototype.canIncrement=function(){return this._$scope.ancToggle.quantity<this._$scope.ancToggle.maxQuantity},c.prototype.increment=function(){this.canIncrement()&&(this._$scope.ancToggle.quantity++,this._$scope.ancToggle.quantity>this._allowance&&this._emitChange(this._ancillariesService.toggleAction.ADD),this._evalMultiSelectedState(),this._refreshView())},c.prototype._evalMultiSelectedState=function(){this._$scope.ancToggle.isSelected=this._$scope.ancToggle.quantity>0},c.prototype._emitChange=function(a){this._ancillariesService.onAncillaryToggle(a,this._getModel(),this._$scope.guestId,this._constructLevelData(),this._onSeatMap)},c.prototype.onToggle=function(){if(this._$scope.ancToggle.isEligible&&!this._$scope.ancToggle.isIncluded&&!this._isMultiQuantity&&!this.isFreeBundle()){this._$scope.ancToggle.isSelected=!this._$scope.ancToggle.isSelected;var a=!!this._$scope.ancToggle.isSelected;this._emitChange(a),this._getModel().bundledAncillaryList.forEach(function(a){this._pubSubService.publish(a+".parentBundledSelected")}.bind(this)),this._refreshView(),a===this._ancillariesService.toggleAction.REMOVE&&this._$scope.ancToggle.focusOnAccordionOnDeselect()}},c.prototype._constructLevelData=function(){var a={};return a[this.isOAndDAncillary()?"oAndDId":"PNR"]=this._$scope.level,a},c.prototype._refreshView=function(){this._$scope.$broadcast("ancToggle.refreshView")},c.prototype.isOAndDAncillary=function(){return this._$scope.level.indexOf(this._levelType.O_AND_D)>-1},c.prototype.isPnrAncillary=function(){return this._$scope.level===this._levelType.PNR},c.prototype.isRoundTrip=function(){return this._$scope.level===this._levelType.PNR&&this._$scope.tripType===this._tripType.ROUND_TRIP},c.prototype.isOneWayTrip=function(){return this._$scope.level===this._levelType.PNR&&this._$scope.tripType===this._tripType.ONE_WAY},c.prototype.isPnrMultiCity=function(){return this._$scope.level===this._levelType.PNR&&this._$scope.tripType===this._tripType.MULTI_CITY},c.prototype.getLabel=function(){var a,b;return this._onSeatMap&&this.isAvailable()?a=this._$interpolate("Yes, add {{price}} for {{ancillaryTitle}}")({price:this._$scope.priceOverride||this._getPriceLabel(),ancillaryTitle:this._getModel().title}):this._$scope.ancToggle.isEligible||this.isFreeBundle()?this.isFreeBundle()?a=this._getBundleIncMessage():this._$scope.ancToggle.isIncluded?a="Included":this._isMultiQuantity&&(b=this._$scope.ancillary.isBag?"Bag":"Item",1!==this._$scope.ancToggle.quantity&&(b+="s"),a=this._$interpolate("{{quantity}} {{pluralItem}}")({quantity:this._$scope.ancToggle.quantity,pluralItem:b})):a="Unavailable",a},c.prototype.shouldShowCheckIcon=function(){return this._$scope.ancToggle.isIncluded&&this._$scope.ancToggle.isEligible&&!this.isFreeBundle()},c.prototype._getBundleIncMessage=function(){return this._$interpolate(this._resourceBundle.ancillaryCopy.bundleIncluded)({title:this._$scope.ancillary.title})},c.prototype.isFullWidth=function(){return this.isFreeBundle()&&(this._$scope.tripType===this._tripType.ONE_WAY||!this._$scope.isLastLevel)},c.prototype.showToggle=function(){return!this.isFreeBundle()||!this._$scope.isLastLevel||this._$scope.tripType!==this._tripType.ROUND_TRIP},c.prototype._onParentBundleSelected=function(){this._updateIncluded(),this._refreshView()},c.prototype.setQuantityTo1=function(){this._isMultiQuantity?0===this._$scope.ancToggle.quantity&&this.increment():this.onToggle()},c.prototype.setQuantityTo0=function(){if(this._isMultiQuantity)for(;this.canDecrement();)this.decrement(!0);else this._$scope.ancToggle.isSelected&&this.onToggle()},c.prototype.isAvailable=function(){return this._$scope.ancToggle.isEligible&&!this._$scope.ancToggle.isIncluded&&!this._isFreeForGuest()},c.prototype.isUncheckedAndAvailable=function(){return this.isAvailable()&&!this._$scope.ancToggle.isSelected},c.prototype.isAvailableAndSelected=function(){return this.isAvailable()&&this._$scope.ancToggle.isSelected};var d=function(a,b,c,d){a.ancToggle.focusOnAccordionOnDeselect=function(){d._$singleTimeout(function(){a.accordionIsCollapsed&&b.closest('[tabindex="0"]').focus()})}};return b}),c("common/directives/ally-application",[],function(){"use strict";var a=function(){return{restrict:"A",controller:b,scope:!0,link:c}},b=function(a,b,c,d){this._$scope=a,this._$element=b,this._assistiveText=c,this._tripService=d,this._$scope.allyApp={isFocused:this.isFocused.bind(this),lostFocus:this.lostFocus.bind(this),setText:this.setText.bind(this),setAssertiveLevel:this.setAssertiveLevel.bind(this),assertiveLevels:this._assistiveText.assertiveLevels,childrenObjs:[],inFocus:!1,FocusIndex:0,gridCount:0}};b.$inject=["$scope","$element","accessibleService","tripService"],b.prototype.isFocused=function(a,b,c){var d=c||0;this._$scope.allyApp.childrenObjs=$(b,this._$element).eq(d).find(a),this._$scope.allyApp.gridCount=this._getGridCount(),this._$scope.allyApp.childClass=a,this._$scope.allyApp.inFocus=!0,$(this._$scope.allyApp.parent).find('[aria-selected="true"]').removeAttr("aria-selected"),this._$scope.allyApp.childrenObjs.is(".is-mouseover, .is-departing")?this._provideInstructions($(this._$scope.allyApp.childrenObjs[this._$scope.allyApp.FocusIndex]).text()):(this._initializeFauxFocus(),this._assistiveText.toggleLiveRegion(!0))},b.prototype.lostFocus=function(){$(".is-faux-focused").removeClass("is-faux-focused"),this._$scope.allyApp.inFocus=!1},b.prototype._provideInstructions=function(a){var b="You are currently on "+a||"",c=this._determineDepartureDate(),d=c?c.text()+". ":"";this._$scope.allyApp.setAssertiveLevel(this._assistiveText.assertiveLevels.ASSERTIVE),this._$scope.allyApp.setText(d+"You are able to use the keyboard arrows to move between items. "+b)},b.prototype._initializeFauxFocus=function(){var a,b=this._$scope.allyApp.FocusIndex,c=this._$scope.allyApp.childrenObjs;a=b>0?c[b]:this._determineFirstChild(),$(".is-faux-focused").removeClass("is-faux-focused"),a.classList.add("is-faux-focused"),this._provideInstructions(a.textContent)},b.prototype._determineDepartureDate=function(){var a=this._$scope.allyApp.childrenObjs,b=$(a).filter(".is-departing").eq(0);if(b.length)return b},b.prototype._determineFirstChild=function(){for(var a=this._$scope.allyApp.childrenObjs,b=a.length,c=0;c<b;c++)if(!a[c].classList.contains("is-disabled"))return this._$scope.allyApp.FocusIndex=c,a[c]},b.prototype._getGridCount=function(){for(var a=this._$scope.allyApp.childrenObjs,b=a[0].getBoundingClientRect(),c=b.top,d=b.height,e=0,f=a.length;e<f;e++)if(a[e].getBoundingClientRect().top+d-c>2*d)return e},b.prototype.setText=function(a,b){this._assistiveText.setText(a,b)},b.prototype.setAssertiveLevel=function(a){this._assistiveText.setAssertiveLevel(a)};var c=function(a,b){var c=a.allyApp;c.init=function(){b.on("keydown",c.keyPressed)},c.keyPressed=function(a){var b,d=[38,39,40,37],e=[32,13],f=c.gridCount,g=$(c.childrenObjs[c.FocusIndex]);if(c.inFocus)if(d.indexOf(a.keyCode)>-1){switch(a.preventDefault(),a.keyCode){case 38:b=-f;break;case 39:b=1;break;case 40:b=f;break;case 37:b=-1}c.moveFocus(b)}else e.indexOf(a.keyCode)>-1&&(g.find("[ng-click]").length>0?(g.find("[ng-click]").click(),g.attr("aria-selected",!0),c.setText(g.text()+"has been selected.")):g.attr("ng-click")&&(g.click(),g.attr("aria-selected",!0),c.setText(g.text()+"has been selected.")))},c.moveFocus=function(a){var b,d,e=c.childrenObjs[c.FocusIndex+a],f=[];if(!(c.FocusIndex+a<0||c.FocusIndex+a>c.childrenObjs.length-1||!a||e.classList.contains("is-disabled"))){if(c.setAssertiveLevel(c.assertiveLevels.ASSERTIVE),c.FocusIndex=c.FocusIndex+a,$(".is-faux-focused").removeClass("is-faux-focused"),b=e,b.classList.add("is-faux-focused"),d=b.textContent,b.getAttribute("additional-text")){f=b.getAttribute("additional-text").split(",");for(var g in f)d=d+" "+$(f[g]).eq(0).text()}c.scrollToFocus(b),c.setText(d)}},c.scrollToFocus=function(a){var b=$(window).height()/2,c=$(window).scrollTop(),d=$(a).offset().top-c,e=d+c-b;(d>b||d<200)&&$(window).scrollTop(e)},c.init()};return a}),c("common/directives/ally-focusnav",[],function(){"use strict";var a=function(){return{restrict:"A",controller:b,scope:!0,link:c}},b=function(a,b,c,d){this._$scope=a,this._$element=b,this._accessibleService=c,this._resourceBundle=d,this._$scope.allyFocusNav={initFocus:this.initFocus.bind(this),removeFocus:this.removeFocus.bind(this),setText:this.setText.bind(this)}};b.$inject=["$scope","$element","accessibleService","ResourceBundle"],b.prototype.initFocus=function(a){var b=this._resourceBundle.focusNav[a],c=$(".assistive-focus-nav");c.html("");for(var d in b)c.append(this._createMarkup(b[d].title,b[d].anchor));$(".assistive-focus-nav li").eq(0).addClass("is-faux-focused"),$(".assistive-focus-nav-container").addClass("is-visible"),this._accessibleService.setText("This section has a focusable nav. Use the up and down arrows to move between navigation areas and enter to move into the selected region.","polite")},b.prototype._createMarkup=function(a,b){return'<li> <a href="#" tabindex="-1" data-focus-location="'+b+'"> '+a+"</a> </li>"},b.prototype.removeFocus=function(){$(".is-faux-focused").removeClass("is-faux-focused"),$(".assistive-focus-nav-container").removeClass("is-visible")},b.prototype.setText=function(a,b){
this._accessibleService.setText(a,b)};var c=function(a,b){var c=a.allyFocusNav;c.indexOf=b.closest(".section--book").index()+b.closest(".collapse-container").index()-1,c.init=function(){b.on("keydown",c.keyPressed),c.storedIndex=0},c.keyPressed=function(a){var b,d=[38,39,40,37],e=[32,13];if(d.indexOf(a.keyCode)>-1){switch(a.preventDefault(),a.keyCode){case 38:b=-1;break;case 39:b=1;break;case 40:b=1;break;case 37:b=-1}c.moveFocus(b)}else e.indexOf(a.keyCode)>-1&&c.selectedNavItem()},c.moveFocus=function(a){var b=$(".assistive-focus-nav li").length;c.storedIndex+a>=0&&c.storedIndex+a<b&&(c.storedIndex=c.storedIndex+a,$(".is-faux-focused").removeClass("is-faux-focused"),$(".assistive-focus-nav li").eq(c.storedIndex).addClass("is-faux-focused"),c.setText($(".is-faux-focused").text()))},c.selectedNavItem=function(){var a=$(".is-faux-focused a").attr("data-focus-location");$(".section--book .collapse-container").eq(c.indexOf).find(a).focus()},c.init()};return a}),c("common/directives/ally-movefocus",[],function(){"use strict";var a=function(){return{restrict:"A",scope:!0,controller:b,link:c}},b=function(a,b){this._$scope=a,this._accessibleService=b,this._$scope.allyMoveFocus={mostActiveFocus:this.mostActiveFocus.bind(this)}};b.$inject=["$scope","accessibleService"],b.prototype.mostActiveFocus=function(){this._accessibleService.setMostCurrentFocus()};var c=function(a,b){var c=a.allyMoveFocus;c.init=function(){b.on("keydown mousedown",c.keyPressed),c.focusTarget=b.attr("data-focus-target"),c.activeMove=b.attr("data-active-move")},c.keyPressed=function(a){var b=[32,13];b.indexOf(a.keyCode)>-1||"mousedown"===a.type?(a.preventDefault(),c.moveFocusTo()):c.activeMove&&9===a.keyCode&&c.moveFocusTo()},c.moveFocusTo=function(){c.focusTarget?c.focusTarget.eq(0).focus():c.mostActiveFocus()},c.init()};return a}),c("common/directives/ally-keyclick",[],function(){"use strict";var a=function(){return{restrict:"A",scope:!0,replace:!0,transclude:!0,template:c,controller:b}},b=function(a){this._$scope=a,this._$scope.allyKeyClick={checkKey:this.checkKey.bind(this)},this._keycodes={SPACE:32,ENTER:13}};b.$inject=["$scope"],b.prototype.checkKey=function(a){var b=a.keyCode===this._keycodes.SPACE||a.keyCode===this._keycodes.ENTER;return b&&a.preventDefault(),b};var c=function(a,b){var c=b.vxCommonAllyClick,d=b.role||"link",e=a.prop("nodeName").toLowerCase();return"<"+e+' ng-transclude tabindex="0" role="'+d+'" ng-keydown="allyKeyClick.checkKey($event) && '+c+'"ng-click="'+c+'"></'+e+">"};return a}),c("common/directives/ally-tabs",["angular"],function(){"use strict";var a=function(){return{controller:b,link:c}},b=function(a){this._$singleTimeout=a};b.$inject=["$singleTimeout"],b.prototype._handleKeydown=function(a){var b=[37,38,39,40],c=39===a.keyCode||40===a.keycode,d=37===a.keyCode||38===a.keycode,e=$(a.currentTarget);b.indexOf(a.keyCode)>-1&&(c&&e.next().click().focus(),d&&e.prev().click().focus())};var c=function(a,b,c,d){var e=b[0];d._$singleTimeout(function(){$(e).find('[role="tab"]').on("keydown",d._handleKeydown.bind(d))})};return a}),c("common/directives/link",[],function(){"use strict";function a(a){var b=["virginamerica.com","applyonlinenow.com","alaskaair.com","virginamerica.custhelp.com","virginamericareservations.custhelp.com"],c=/^(?:https?:)?\/\/(?:www.)?([^\/:?#]+)(?:[\/:?#]|$)/gi,d=c.exec(a);return!!d&&b.indexOf(d[1])===-1}var b=function(){return{restrict:"A",link:c}},c=function(b,c,d){var e=d.href||d.ngHref,f='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="external-link-flag"><g><path d="m397 512l-360 0c-21 0-37-17-37-37l0-361c0-20 16-37 37-37l119 0c20 0 36 17 36 37 0 20-16 37-36 37l-82 0 0 287 287 0 0-82c0-20 16-36 36-36 21 0 37 16 37 36l0 119c0 20-16 37-37 37z m78-259c-20 0-37-16-37-36l0-143-142 0c-20 0-36-17-36-37 0-20 16-37 36-37l179 0c20 0 37 17 37 37l0 180c0 20-16 36-37 36z m-178 5c-9 0-18-4-25-11-15-14-15-37-1-51l177-184c14-14 37-15 52-1 15 15 15 38 1 52l-177 184c-8 7-17 11-27 11z"></path></g></svg>';(d.isExternal||e&&a(e))&&$(f).appendTo(c)};return b}),c("common/directives/city-illustration",[],function(){"use strict";var a=function(){return{controller:b,restrict:"A",replace:!0,scope:{size:"@",code:"@"},templateUrl:"/app/common/directives/city-illustration.tpl.html"}},b=function(a,b,c){this._$scope=a;var d=b[this._$scope.code],e=c.destinationsList,f="";e[this._$scope.code]&&(f=e[this._$scope.code].name),this._$scope.cityIllustration={source:d&&d[this._$scope.size],code:this._$scope.code,name:f,size:this._$scope.size}};return b.$inject=["$scope","RoutesBundle","ResourceBundle"],a}),c("common/directives/exclusive-offer",[],function(){"use strict";var a=function(){return{scope:{ninjaMode:"=",metricsContext:"=",linkType:"="},controller:b,templateUrl:"/app/common/directives/exclusive-offer.tpl.html"}},b=function(a,b,c,d){this._$scope=a,this._pubSubService=d,b.info.get(function(a){var b=c.getByPath(a,"alaskaSetup.successExclusiveOffer"),d={"check-in":"linkForCheckIn",booking:"linkForBooking",manage:"linkForManage"}[this._$scope.linkType]||"link";if(b&&Object.size(b)){var e=this._$scope.ninjaMode;this._$scope.exclusiveOffer={subheadText:b.subheadText,subheadImage:e?b.subheadImageNinja:b.subheadImage,headline:b.headline,text:b.text,image:e?b.imageNinja:b.image,link:b[d],linkText:b.linkText,legal:b.legal,onClick:this.onClick.bind(this)}}}.bind(this))};return b.prototype.onClick=function(){var a={"check-in":"check in funnel:success: AS Bank Card Link FCF",booking:"booking funnel:success: AS Bank Card Link FCF",manage:"manage funnel:success: AS Bank Card Link FCF","manage-landing":"manage funnel:landing: AS Bank Card Link FCF"},b=a[this._$scope.metricsContext];b&&this._pubSubService.publish("adobeAnalytics.alaskaCardPromo",[{pageName:b}])},b.$inject=["$scope","cms","utilsService","pubSubService"],a}),c("common/controllers/site-map",[],function(){"use strict";var a=function(a,b){this._$scope=a,a.siteMap=b.siteMap.all};return a.$inject=["$scope","SiteMapBundle"],a}),c("common/controllers/modals/add-passport-info",["angular","moment"],function(a,b){"use strict";var c=function(a,c,d,e,f,g){this._$scope=a,this._$modalInstance=c,this._manageService=d,this._statusService=e,this._loadingService=f,this._$scope.traveler={countries:g.countries,expiryDateStart:b(),expiryDateEnd:b().add("years",100),fields:{},save:this.save.bind(this),changeTraveler:this.changeTraveler.bind(this),getCurrentTravelerIndex:this.getCurrentTravelerIndex.bind(this)};var h=this._manageService.getTravelers();this._$scope.travelers=h&&h.length>0?h:this._$scope.travelers,this._$scope.currentTraveler=this._$scope.travelers[0],this._setTravelersData(),this._parseTravelersNames()};return c.$inject=["$scope","$modalInstance","manageService","statusService","loadingService","GeoBundle"],c.prototype._parseTravelersNames=function(){for(var a=0;a<this._$scope.travelers.length;a++)this._$scope.travelers[a].name=this._$scope.travelers[a].firstName+" "+this._$scope.travelers[a].lastName},c.prototype.changeTraveler=function(a){this._$scope.currentTraveler=a},c.prototype.getCurrentTravelerIndex=function(){var b=0;return a.forEach(this._$scope.travelers,function(a,c){a.guestId===this._$scope.currentTraveler.guestId&&(b=c)}.bind(this)),b},c.prototype._setTravelersData=function(){for(var a,b={},c=0;c<this._$scope.travelers.length;c++){if(a=this._$scope.travelers[c],b={},b=a.international?{passportNumber:a.international.passportNumber,expirationDate:a.international.passportExpiry,issuingCountry:a.international.issuingCountry,citizenship:a.international.citizenship,countryOfResidence:a.international.countryOfResidence}:{passportNumber:"",expirationDate:null,issuingCountry:"",citizenship:"",countryOfResidence:""},a.emergencyContactInfo){var d=a.emergencyContactInfo.emergencyNumber;b.emergencyNumber=d.replace(/[^0-9]/g,"").trim(),b.emergencyContactName=a.emergencyContactInfo.emergencyContactName}else b.emergencyNumber="",b.emergencyContactName="";a.data=b,a.fields={}}},c.prototype.save=function(a){var c=this._$scope.travelers,d={paxPassportInfoList:[{paxDocUpdateInfo:{emergencyContactName:a.fields.emergencyContactName.value.replace(/[^a-zA-Z\s]/g,"").trim(),emergencyContactNumber:a.fields.emergencyNumber.value?a.fields.emergencyNumber.value.replace(/\D/g,""):"",guestId:this._$scope.currentTraveler.guestId,lastName:this._$scope.currentTraveler.lastName,firstName:this._$scope.currentTraveler.firstName},passportInfo:{docNumber:a.fields.passportNumber.value,issueCountry:a.fields.issuingCountry.value.value,countryOfResidence:a.fields.countryOfResidence.value.value,expiryDate:a.fields.expirationDate.value,nationality:a.fields.citizenship.value.value,lastName:this._$scope.currentTraveler.lastName,firstName:this._$scope.currentTraveler.firstName}}],identificationInfo:{pnr:this._$scope.pnr,lastName:this._$scope.currentTraveler.lastName}},e=this._manageService.updatePassport(d);this._loadingService.setLoading(e);var f=this._$scope.currentTraveler.firstName.charAt(0).toUpperCase()+this._$scope.currentTraveler.firstName.slice(1).toLowerCase(),g=this._$scope.currentTraveler.lastName.charAt(0).toUpperCase()+this._$scope.currentTraveler.lastName.slice(1).toLowerCase();e.then(function(a){var d=a.data.response.paxPassportInfoList[0],e=this.getCurrentTravelerIndex(),h=c[e];h.international=h.international||{},h.emergencyContactInfo=h.emergencyContactInfo||{},h.international.passportNumber=d.passportInfo.docNumber,h.international.issuingCountry=d.passportInfo.issueCountry,h.international.countryOfResidence=d.passportInfo.countryOfResidence,h.international.passportExpiry=b(d.passportInfo.expiryDate).format("YYYY-MM-DD"),h.international.citizenship=d.passportInfo.nationality,h.emergencyContactInfo.emergencyContactName=d.paxDocUpdateInfo.emergencyContactName,h.emergencyContactInfo.emergencyNumber=d.paxDocUpdateInfo.emergencyContactNumber,this._manageService.setTravelers(c),this._statusService.setStatus({format:this._statusService.format.SUCCESS,copy:this._statusService.message.PASSPORT_INFO_ADDED,data:{name:f+" "+g}})}.bind(this)),this._$modalInstance.close()},c}),c("common/controllers/modals/ally-departure-date",[],function(){"use strict";var a=function(a,b){a.footerLinkFn=function(){},a.pickSameDay=function(){a.calendar.returnSameDay(),b.close()},a.pickNewDay=function(){a.calendar.resetDates(),b.close()}};return a.$inject=["$scope","$modalInstance"],a}),c("common/controllers/modals/email-itinerary",[],function(){"use strict";var a=function(a,b,c,d,e,f){this._$scope=a,this._$modalInstance=b,this._manageService=c,this._statusService=d,this._locationService=e,this._loadingService=f,this._$scope.emailItinerary={fields:{},sendEmails:this.sendEmails.bind(this)}};return a.$inject=["$scope","$modalInstance","manageService","statusService","locationService","loadingService"],a.prototype.sendEmails=function(){var a=this._$scope.emailItinerary.fields.emailList.value,b=null,c=null;this._$scope.pnr&&(b=this._$scope.pnr.pnr,c=this._$scope.pnr.lastName);var d=this._manageService.emailItinerary(a,b,c);this._loadingService.setLoading(d),d.then(function(a){this._statusService.setStatus({format:this._statusService.format.SUCCESS,copy:this._statusService.message.ITINERARY_SENT,data:{addresses:a.join(","),plural:a.length>1}})}.bind(this)),this._$modalInstance.close()},a}),c("common/controllers/modals/save-to-calendar",[],function(){"use strict";var a=function(a,b,c,d,e,f,g){this._$scope=a,this._$window=b,this._$modalInstance=c,this._locationService=f,this._manageService=d,this._pnrService=e,this.ResourceBundle=g,this._$scope.saveToCalendar={saveToIcal:this.saveToIcal.bind(this),saveToOutlook:this.saveToOutlook.bind(this)}};return a.$inject=["$scope","$window","$modalInstance","manageService","pnrService","locationService","ResourceBundle"],a.prototype.saveToIcal=function(){var a=this._$scope.flightData.flightIndex?this._$scope.flightData.flightIndex:0,b=this._locationService.getContext(),c="manage"===b?this._$scope.flightData.pnr:this._pnrService.model();if(c){var d="manage"===b?c:c[0];d&&this._downloadIcalFile(d,a)}this._$modalInstance.close()},a.prototype.saveToOutlook=function(){this.saveToIcal()},a.prototype._downloadIcalFile=function(a,b){var c=this.ResourceBundle.ical.subjectPrefix+" "+a.flightList[b].flightNum+"|"+a.flightList[b].origin+"-"+a.flightList[b].destination,d=c+"|"+a.pnr,e=a.flightList[b].departureDateFormats.moment.format("YYYY-MM-DDTHH:mm:ss"),f=a.flightList[b].arrivalDateFormats.moment.format("YYYY-MM-DDTHH:mm:ss"),g=this._manageService.getCalendarUrl(c,d,e,f);this._$window.open(g)},a}),c("common/controllers/modals/frequent-flier",[],function(){"use strict";var a=function(a,b,c,d,e,f,g,h){this._$scope=b,this._$modalInstance=c,this._$q=d,this._pnrService=e,this._windowService=f,this._elevateService=g,this._loadingService=h,this._$scope.frequentFlier={fields:{},save:this.save.bind(this),ninjaMode:f.ninjaMode()},this._$scope.programs=this._pnrService.getValidFFPrograms(this._$scope.pnr.isDuringElevateAvailability()),this._$scope.defaultProgramIndex=0,angular.forEach(this._$scope.programs,function(a,b){"ALASKA_AIRLINES"===a.value&&(this._$scope.defaultProgramIndex=b)}.bind(this))};return a.$inject=["$parse","$scope","$modalInstance","$q","pnrService","windowService","elevateService","loadingService"],a.prototype._validateFrequentFlyer=function(a,b,c,d){var e=this._$q.defer();if(d&&c&&this._elevateService.locallyValidateFFPNumber(c,d))if("VIRGIN_AMERICA"===c){if(a&&b){var f=this._elevateService.validateElevateId(a,b,d);this._loadingService.setLoading(f),f.then(this._ffnValidationSucceded.bind(this,e),this._ffnValidationFailed.bind(this,e))}}else this._ffnValidationSucceded(e);else this._ffnValidationFailed(e);return e.promise},a.prototype._ffnValidationSucceded=function(a){this._$scope.frequentFlier.fields.ffn.setValidation(!0),a.resolve(!0)},a.prototype._ffnValidationFailed=function(a){this._$scope.frequentFlier.fields.ffn.setValidation(!1,"invalid number"),a.resolve(!1)},a.prototype.save=function(){var a=this,b=this._$scope.traveler.firstName,c=this._$scope.traveler.lastName,d=this._$scope.frequentFlier.fields.ffname.value.nickname,e=this._$scope.frequentFlier.fields.ffname.value.value,f=this._$scope.frequentFlier.fields.ffn.value,g=this._$scope.pnr.pnr;this._validateFrequentFlyer(b,c,e,f).then(function(h){h&&(a._pnrService.attachElevate(b,c,e,f,g).then(function(b){b&&(a._$scope.traveler.loyaltyId=f,a._$scope.traveler.loyaltyProgramName=d,a._$scope.traveler.loyaltyProgram=e)}),a._$modalInstance.close())})},a}),c("common/controllers/modals/join-alaska-mileage-plan",[],function(){"use strict";var a=function(a,b){this._$scope=a,this._$scope.joinAlaskaMileagePlan={ninjaMode:b.ninjaMode()}};return a.$inject=["$scope","windowService"],a}),c("common/controllers/modals/elevate-turn-down",[],function(){"use strict";var a=function(a,b,c){this._$scope=a,c.info.get(function(a){var c=a.alaskaSetup.elevateTurnDown;this._$scope.elevateTurnDown={image:c.image,headline:c.headline,bodyCopy:b.trustAsHtml(c.bodyCopy),CTACopy:c.CTACopy,CTALink:c.CTALink,secondaryCTACopy:c.secondaryCTACopy,secondaryCTALink:c.secondaryCTALink}}.bind(this))};return a.$inject=["$scope","$sce","cms"],a}),c("common/controllers/modals/known-traveler",["angular"],function(a){"use strict";var b=function(a,b,c,d,e,f){this._$scope=a,this._$rootScope=b,this._$modalInstance=c,this._manageService=d,this._loadingService=e,this._$scope.knownTraveler={fields:{},save:this.save.bind(this),changeTraveler:this.changeTraveler.bind(this),getCurrentTravelerIndex:this.getCurrentTravelerIndex.bind(this),ninjaMode:f.ninjaMode()},this._$scope.travelers=this._$scope.travelers.filter(function(a){return"INFANT"!==a.paxType}),this._$scope.currentTraveler=this._$scope.travelers[0],this._setKnownTravelerData(),this._parseTravelersNames()};return b.$inject=["$scope","$rootScope","$modalInstance","manageService","loadingService","windowService"],b.prototype._parseTravelersNames=function(){for(var a=0;a<this._$scope.travelers.length;a++)this._$scope.travelers[a].name=this._$scope.travelers[a].firstName+" "+this._$scope.travelers[a].lastName},b.prototype.changeTraveler=function(a){this._$scope.currentTraveler=a},b.prototype._setKnownTravelerData=function(){for(var a,b={},c=0;c<this._$scope.travelers.length;c++)a=this._$scope.travelers[c],b={},b.ktn=a.knownTravelerNum,a.data=b,a.fields={}},b.prototype.getCurrentTravelerIndex=function(){var b=0;return a.forEach(this._$scope.travelers,function(a,c){a.guestId===this._$scope.currentTraveler.guestId&&(b=c)}.bind(this)),b},b.prototype.save=function(a){var b=this._$scope.currentTraveler.firstName,c=this._$scope.currentTraveler.lastName,d=this._$scope.pnr,e=a.fields.ktn.value,f=this._manageService.addKnownTravelerNumber(b,c,e,d);f.then(function(a){"SUCCESS"===a.data.status.status&&(this._$scope.currentTraveler.knownTravelerNum=e,this._$rootScope.$broadcast("addKtnSuccess",{ktn:e,traveler:this._$scope.currentTraveler.guestId}))}.bind(this)),this._loadingService.setLoading(f),this._$modalInstance.close()},b}),c("common/controllers/modals/wrong-email",[],function(){"use strict";var a=function(a,b,c,d,e,f){this._$scope=a,this._$modalInstance=c,this._manageService=d,this._loadingService=e,this._statusService=f,this._$scope.wrongEmail={currentEmail:b("currentEmail")(a),fields:{},sendEmail:this.sendEmail.bind(this)}};return a.$inject=["$scope","$parse","$modalInstance","manageService","loadingService","statusService"],a.prototype.sendEmail=function(){var a=this._$scope.wrongEmail.fields.email.value,b=this._manageService.emailItinerary(a);this._loadingService.setLoading(b),b.then(function(a){this._statusService.setStatus({format:this._statusService.format.SUCCESS,copy:this._statusService.message.ITINERARY_SENT,data:{addresses:a.join(","),plural:a.length>1}})}.bind(this)),this._$modalInstance.close()},a}),c("common/controllers/modals/footer",[],function(){"use strict";var a=function(a,b){a.footer={links:b.siteMap.footer}};return a.$inject=["$scope","SiteMapBundle"],a}),c("common/controllers/modals/forgot-password",[],function(){"use strict";var a=function(a,b,c){this._$scope=a,this._elevateService=b,this._statusService=c,a.forgot={fields:{},submit:this._submit.bind(this)}};return a.$inject=["$scope","elevateService","statusService"],a.prototype._submit=function(){var a=this._$scope.forgot.fields.email.value,b=this._elevateService.forgotPassword(a);return b.then(this._onSuccess.bind(this),this._onError.bind(this)),b},a.prototype._onSuccess=function(){this._$scope.forgot.email=this._$scope.forgot.fields.email.value},a.prototype._onError=function(){var a=this._statusService.message.OOPS;this._statusService.setStatus({format:this._statusService.format.ERROR,copy:a})},a}),c("common/controllers/modals/seat-selection",[],function(){"use strict";var a=function(a,b,c,d,e){this._$scope=a,this._utilsService=c,this._ancillariesService=b,this._resourceBundle=d;var f,g;this._ancillariesService.getFormattedAvailableAncillaryList(!0).forEach(function(a){a.ancillaryId===this._resourceBundle.ancillaryIds.BOARD?f=a:a.ancillaryId===this._resourceBundle.ancillaryIds.POWER&&(g=a)}.bind(this)),this._$scope.ancSelector={fareLevelData:this._ancillariesService.getFareData(),travelers:this._ancillariesService.getTravelerData(),priorityBoarding:f,powerTripPackage:g,formatTierName:this._utilsService.formatTierName.bind(this)},this._$scope.verify.exitRow&&e.config.get(function(a){this._$scope.newExitRowRegulation=a.newExitRowFederalAviationRegulation&&a.newExitRowFederalAviationRegulation.enable}.bind(this))};return a.$inject=["$scope","ancillariesService","utilsService","ResourceBundle","cms"],a}),c("common/controllers/modals/universal-receipt",[],function(){"use strict";var a=function(a){this._$scope=a,a.printReceipt={fields:{},submit:this._submit.bind(this)}};return a.$inject=["$scope"],a.prototype._submit=function(){},a}),c("common/controllers/modals/flight-alerts",[],function(){"use strict";var a=function(a,b,c,d,e){this._$scope=a,this._$modalInstance=b,this._statusService=c,this._flightAlertsService=d,this._resourceBundle=e,this._$scope.flightAlertModal={notificationFrequency:this._resourceBundle.flightAlerts.notificationFrequency,submit:this.submit.bind(this),close:this.close.bind(this),data:this._$scope.modalContext,responseData:{},fields:{}}};return a.$inject=["$scope","$modalInstance","statusService","flightAlertsService","ResourceBundle"],a.prototype.submit=function(){var a=this._$scope.flightAlertModal.data,b={email:a.emailAddress,sms:a.smsNumber.replace(/[^0-9]/g,"").trim(),notificationMinutes:a.notifyMinutesPriorToEvent,flightInfo:[{origin:a.origin,destination:a.destination,flightNumber:a.flightNumber,departureDateTime:a.departureDateTime}]},c=this._flightAlertsService.subscribe(b);return c.then(this._onSuccess.bind(this)),c},a.prototype.close=function(){this._$modalInstance.close()},a.prototype._onSuccess=function(a){this._$scope.flightAlertModal.responseData.emsId=a.response.emsId},a}),c("common/services/utils",["angular","moment","content/constants/content-bundle"],function(a,b,c){"use strict";var d=function(b,c){return this._resourceBundle=b,this._$modal=c,this._randomAvatarsDefault=this.randomizeArray(this._resourceBundle.avatarsDefaultMap),this._randomAvatarsAll=this._randomAvatarsDefault.concat(this._resourceBundle.avatarsSpecialMap),this._randomAvatarsAllRemain=a.copy(this._randomAvatarsAll),{randomizeArray:this.randomizeArray.bind(this),getRandomAvatarsDefault:this.getRandomAvatarsDefault.bind(this),getRandomAvatarsAll:this.getRandomAvatarsAll.bind(this),getFFProgramName:this.getFFProgramName.bind(this),getRandomAvatar:this.getRandomAvatar.bind(this),getCabinTypeLabel:this.getCabinTypeLabel.bind(this),getTripTypeLabel:this.getTripTypeLabel.bind(this),formatDates:this.formatDates.bind(this),getTripDatesString:this.getTripDatesString.bind(this),getTripSummaryString:this.getTripSummaryString.bind(this),getElevatePoints:this.getElevatePoints.bind(this),sortListByName:this.sortListByName.bind(this),safeHTML:this.safeHTML.bind(this),formatPhoneNum:this.formatPhoneNum.bind(this),formatPhoneForAPI:this.formatPhoneForAPI.bind(this),openBestFaresModal:this.openBestFaresModal.bind(this),numberToWord:this.numberToWord.bind(this),capitalize:this.capitalize.bind(this),createURL:this.createURL.bind(this),formatTierName:this.formatTierName.bind(this),conditionallyFormatDecimal:this.conditionallyFormatDecimal.bind(this),openExtrasWarningModal:this.openExtrasWarningModal.bind(this),formatLounge:this.formatLounge.bind(this),taxNameByCode:this.taxNameByCode.bind(this),capitilizeWords:this.capitilizeWords.bind(this),getByPath:this.getByPath.bind(this)}};return d.$inject=["ResourceBundle","$modal"],d.prototype.randomizeArray=function(a){for(var b=a.length-1;b>0;b--){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c],a[c]=d}return a},d.prototype.getRandomAvatarsDefault=function(){return this._randomAvatarsDefault},d.prototype.getRandomAvatarsAll=function(){return this._randomAvatarsAll},d.prototype.addAvatarToArray=function(a){this._randomAvatarsAllRemain.unshift(a)},d.prototype.getFFProgramName=function(b,c){var d;return a.forEach(this._resourceBundle.ffPrograms,function(a){!d&&a.value===b&&(d=c?a.nickname:a.name)}),d},d.prototype.getRandomAvatar=function(){var a=this._resourceBundle.avatarsDefaultMap;return a[Math.floor(Math.random()*a.length)]},d.prototype.getCabinTypeLabel=function(b){var c;return a.forEach(this._resourceBundle.flightInformation.tier.name,function(a,d){!c&&d===b&&(c=a)}),c},d.prototype.getTripTypeLabel=function(b){var c;return a.forEach(this._resourceBundle.flightInformation.tripType,function(a,d){!c&&d===b&&(c=a)}),c},d.prototype.formatDates=function(a,c){var d,e,f,g,h=[];for(g in a)d=a[g],d&&(e=b(d),c&&(e=e.zone(d)),f={dayOfWeek:e.format("ddd"),date:e.format("DD"),moment:e,month:e.format("MMM"),monthNum:e.format("MM"),year:e.format("YYYY"),yearAbbr:e.format("YY")},h.push(f));return h},d.prototype.getTripDatesString=function(a,b){var c="",d=a[0],e=a[3]?a[3]:a[1],f=d.date===e.date,g=d.monthNum===e.monthNum;return c=b||f&&g?d.month+" "+d.date:d.month+" "+d.date+" - "+e.month+" "+e.date},d.prototype.getTripSummaryString=function(a){var b="MULTI_CITY"===a.tripType?a.flightList[0].originName+" to "+a.flightList[0].destinationName+", "+a.flightList[1].originName+" to "+a.flightList[1].destinationName:a.flightList[0].originName+" to "+a.flightList[0].destinationName;return a.tripTypeLabel+", "+b},d.prototype.getElevatePoints=function(a,b){var c=this._resourceBundle.elevatePointsMultiplier,d=c[b||"RED"]*a;return.1*d%1<.5?10*Math.floor(d/10):5*Math.round(d/5)},d.prototype.sortListByName=function(a){return a.sort(function(a,b){return a.name>b.name?1:a.name<b.name?-1:0}),a},d.prototype.safeHTML=function(a){if(a){var b=document.createElement("div");b.innerHTML=a;var c=b.childNodes[0].nodeValue;return c}},d.prototype.formatPhoneNum=function(a){if(a)return a.replace(/(\d{3})(\d{3})(\d{4})/,"($1) $2-$3")},d.prototype.formatPhoneForAPI=function(a){if(a)return a=a.replace(/[\+\,\.\-\(\) ]/g,"").slice(-10)},d.prototype.openBestFaresModal=function(){this._$modal.open(c.contentMap.BEST_FARES_GUARANTEED)},d.prototype.openExtrasWarningModal=function(a){var b=this._resourceBundle.modal.extrasWarning;return this._didOpenExtrasWarningModal?void a():(this._didOpenExtrasWarningModal=!0,void this._$modal.open({controller:["$scope",function(b){b.footerLinkFn=a}],contentType:b.TYPE,size:b.SIZE,title:b.TITLE,templateUrl:b.TEMPLATE_URL,footerLinkText:"I understand, let's do this",showFooter:!0}))},d.prototype.numberToWord=function(a,b){var c=["zero","one","two","three","four","five","six","seven","eight","nine"][a];return b&&(c=c[0].toUpperCase()+c.slice(1)),c},d.prototype.capitalize=function(a){return a.split(" ").map(function(a){return a[0].toUpperCase()+a.slice(1).toLowerCase()}).join(" ")},d.prototype.createURL=function(b,c){var d,e=b.indexOf("?")===-1?"?":"&",f="",g=0;return a.forEach(c,function(a,b){d=b+"="+a,f+=0===g?e+d:"&"+d,g++}),b+f},d.prototype.formatTierName=function(a,b){if(a){var c=this._resourceBundle.flightInformation.ancillaryCabinNames[a];return b?this.capitalize(c):c}},d.prototype.conditionallyFormatDecimal=function(a){return a%1===0?a:a.toFixed(2)},d.prototype.formatLounge=function(a){return"LAX"===a?this._resourceBundle.laxAlaskaLounge:a+" lounge"},d.prototype.taxNameByCode=function(a,b){return(b&&this._resourceBundle.intlTaxCodes[a]||this._resourceBundle.taxCodes[a]||this._resourceBundle.taxCodes.UNSUPPORTED).DESC},d.prototype.capitilizeWords=function(a){return a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})},d.prototype.getByPath=function(a,b){return b.split(".").reduce(function(a,b){return a&&a[b]},a)},d}),c("common/services/status",["angular"],function(a){"use strict";var b=[],c=[],d=null,e=function(a){return{status:this.getStatus.bind(this),alert:this.getAlert.bind(this),changeGuider:this.getChangeGuider.bind(this),setStatus:this.setStatus.bind(this),setAlert:this.setAlert.bind(this),setChangeGuider:this.setChangeGuider.bind(this),isStatusSticky:this.isStatusSticky.bind(this),format:{ALERT:"alert",SUCCESS:"success",ERROR:"error",GUIDER:"guider"},message:{OOPS:a.statusMessages.error.general,CITIES_SELECTED:a.statusMessages.booker.citiesSelected,SEASONAL_AVAILABILITY:a.statusMessages.calendar.seasonalAvailability,NO_FLY_DAYS:a.statusMessages.calendar.noFlyDays,CALENDAR_SELECT_RETURN:a.statusMessages.calendar.selectReturnDate,CALENDAR_SELECT_RETURN_MULTI_CITY:a.statusMessages.calendar.selectReturnDateMultiCity,CALENDAR_DONE_ONE_WAY:a.statusMessages.calendar.completeOneWay,CALENDAR_DONE_ROUND_TRIP:a.statusMessages.calendar.completeRoundTrip,CALENDAR_DONE_SAME_DAY:a.statusMessages.calendar.completeSameDay,ONE_WAY:{1:a.statusMessages.fare.complete},ROUND_TRIP:{1:a.statusMessages.fare.pickReturnDate,2:a.statusMessages.fare.complete},MULTI_CITY:{1:a.statusMessages.fare.pickMultiCityLeg2,2:a.statusMessages.fare.complete},FARE_INVALID_DATE:a.statusMessages.fare.invalidDate,FARE_INVALID_DATE_MULTI_CITY:a.statusMessages.fare.invalidDateMultiCity,ANCILLARIES_SELECTED:a.statusMessages.ancillariesSelector.ancillariesSelected,TIMER_START:a.statusMessages.booker.TIMER_START,TIMER_FOUR:a.statusMessages.booker.TIMER_FOUR,TIMER_TWO:a.statusMessages.booker.TIMER_TWO,TIMER_END:a.statusMessages.booker.TIMER_END,LOGIN_FAILED:a.statusMessages.login.failed,PLEASE_LOGIN:a.statusMessages.login.signInChallenge,PURCHASE_DECLINED:a.statusMessages.purchase.purchaseDeclined,ADD_EXTRA:a.statusMessages.checkIn.addExtra,ADD_PASSPORT_INFO:a.statusMessages.checkIn.addPassportInfo,UPGRADE_YOUR_SEAT:a.statusMessages.checkIn.upgradeYourSeat,UPGRADE_YOUR_SEAT_CONNECTING:a.statusMessages.checkIn.upgradeYourSeatConnecting,SELECT_LOUNGE_OPTIONS:a.statusMessages.checkIn.selectLoungeOptions,SELECT_LOUNGE_OPTIONS_CONNECTING:a.statusMessages.checkIn.selectLoungeOptionsConnecting,CHANGE_YOUR_SEAT:a.statusMessages.checkIn.changeYourSeats,NUMBER_OF_BAGS:a.statusMessages.checkIn.numberOfBags,PAYMENT:a.statusMessages.checkIn.payment,CHANGE_DATES:a.changeGuider.changeDates,CHANGE_CITIES:a.changeGuider.changeCities,CHANGE_FARES:a.changeGuider.changeFares,CHANGE_FARES_EXTENDED:a.changeGuider.changeFaresExtended,CHANGE_EXTRAS:a.changeGuider.changeAncillaries,CHANGE_SEATS:a.changeGuider.changeSeats,CHANGE_REVIEW_CHANGES:a.changeGuider.reviewChanges,CHANGE_SUBMIT_PAYMENT:a.changeGuider.submitPayment,FARE_JUMPED:a.statusMessages.fare.jumped,CHECKIN_INTERNATIONAL:a.statusMessages.checkIn.international,PURCHASE_INSURANCE:a.statusMessages.purchase.insuranceTravelBank,PURCHASE_VISA_CHECKOUT_FAILED:a.statusMessages.purchase.visaCheckoutFailed,ITINERARY_SENT:a.statusMessages.modal.itinerarySent,PASSPORT_INFO_ADDED:a.statusMessages.modal.passportInfoAdded,SIGN_UP_SUCCESS:a.statusMessages.elevate.signUpSuccess,IROP_FLIGHT_CANCELLED:a.statusMessages.irop.flightCancelled,IROP_CHANGED_CITIES:a.statusMessages.irop.changedCities,IROP_OUTSIDE_SEGMENT_RANGE:a.statusMessages.irop.outsideSegmentRange,IROP_FARE_NOTIFICATION:a.statusMessages.irop.fareNotification,FS_POINTS_LOGIN_REQUIRED:a.statusMessages.fare.pointsSignIn,TRAVELLER_MIGHT_BE_REACCOMMODATED:a.statusMessages.seatMap.travellerMightBeReaccommodated,FLIGHT_ALERTS_SUCCESS:a.statusMessages.modal.flightAlertsSuccess,ALASKA_ONLY_TOO_MUCH_PASSENGERS:a.statusMessages.fare.alaskaToManyPassengers,INVALID_PETS_NUMBER:a.statusMessages.booker.petsNumberExceeded},TIMEOUT:2500,TIMEOUT_WARNING:6e3,TIMEOUT_MAX:8e3}};return e.$inject=["ResourceBundle"],e.prototype.getStatus=function(){return b},e.prototype.getChangeGuider=function(){return d},e.prototype.getAlert=function(){return c},e.prototype.setChangeGuider=function(a){d=a},e.prototype.setStatus=function(c){a.isArray(c)||(c=[c]),b=c},e.prototype.setAlert=function(b){a.isArray(b)||(b=[b]),c=b},e.prototype.isStatusSticky=function(){if(!b)return!1;for(var a=0;a<b.length;a++)if(b[a]&&b[a].sticky===!0)return!0;return!1},e}),c("common/services/traveler",["angular","common/models/traveler-model"],function(a,b){"use strict";var c=function(a,b,c,d,e,f,g,h){return this._$rootScope=a,this._capitalizeFilter=b("capitalize"),this._locationService=c,this._utilsService=d,this._seatService=e,this._elevateService=f,this._pubSubService=g,this._resourceBundle=h,this._context={BOOK:this._locationService.contextIs(c.contexts.BOOK),CHANGE:this._locationService.contextIs(c.contexts.CHANGE),CHECKIN:this._locationService.contextIs(c.contexts.CHECKIN)},this._travelerFormsComplete=!1,this._travelers={},this.allPaxTypes={primary:{name:"Primary Traveler",value:"primary"},adult:{name:"Adult",value:"adult"},child:{name:"Child",value:"child"},infant:{name:"Lap Infant",value:"infant"}},this._configureWatches(),this._pubSubService.subscribe("trip.resetTravelerAmount",this.reset.bind(this)),{allPaxTypes:this.allPaxTypes,createTravelersFromPaxList:this.createTravelersFromPaxList.bind(this),getAdultTravelers:this.getAdultTravelers.bind(this),getAllTravelers:this.getAllTravelers.bind(this),
getPrimaryTraveler:this.getPrimaryTraveler.bind(this),getTravelerAmounts:this.getTravelerAmounts.bind(this),getTravelerFormsComplete:this.getTravelerFormsComplete.bind(this),setTravelerFormsComplete:this.setTravelerFormsComplete.bind(this),getTravelerGuids:this.getTravelerGuids.bind(this),getTravelerByGuestId:this.getTravelerByGuestId.bind(this),getTravelerByGuid:this.getTravelerByGuid.bind(this),getTravelersByKey:this.getTravelersByKey.bind(this),getTravelers:this.getTravelers.bind(this),reset:this.reset.bind(this)}};return c.$inject=["$rootScope","$filter","locationService","utilsService","seatService","elevateService","pubSubService","ResourceBundle"],c.prototype._configureWatches=function(){this._$rootScope.$watch(function(){return this._travelers}.bind(this),this._onTravelersChanged.bind(this),!0),this._$rootScope.$watch(function(){return this._seatService.getSelectedSeatModel().flightList}.bind(this),this._onFlightListChanged.bind(this),!0)},c.prototype._onTravelersChanged=function(){this._travelersChanged=!0,this._pubSubService.publish("travelers.changed",[this.getAllTravelers()])},c.prototype._onFlightListChanged=function(){this._flightListChanged=!0},c.prototype.createTravelersFromPaxList=function(b){var c,d=[];return a.forEach(b,function(a,b){var e=this._createTravelersObjectFromPaxItem(a,b);if(c=this.createTraveler(e),d.push(c),a.infant){var f=this._createTravelersObjectFromPaxItem(a.infant,b),g=this.createTraveler(f);d.push(g)}}.bind(this)),d},c.prototype._createTravelersObjectFromPaxItem=function(a,b){var c=this._utilsService.getRandomAvatarsAll(),d={};return a&&(d={avatar:a.avatar||c[b],guestId:a.guestId,name:{first:this._capitalizeFilter(a.firstName),last:this._capitalizeFilter(a.lastName)},ticketNum:a.ticketNum,travelerType:a.paxType.toLowerCase(),dob:a.dob,gender:a.gender,primary:0===b},a.international&&(d.international=a.international),a.loyaltyProgram&&(d.frequentFlyer={program:a.loyaltyProgram,number:a.loyaltyId},this._elevateService.getElevateId()===a.loyaltyId&&(d.avatar=this._elevateService.getUserData().avatar)),d.frequentFlyer||(d.frequentFlyer={}),d.frequentFlyer.freeBagAllowance=a.freeBagAllowance),d},c.prototype.getAllTravelers=function(a){return $.isEmptyObject(this._travelers)&&this._createTravelersFromType(a),this._travelers},c.prototype.getAdultTravelers=function(){var b=[];return a.forEach(this._travelers,function(a){a.travelerType.toLowerCase()===this.allPaxTypes.adult.value&&b.push(a)}.bind(this)),b},c.prototype.getPrimaryTraveler=function(){for(var a in this._travelers)if(this._travelers[a].primary)return this._travelers[a]},c.prototype.getTravelers=function(){return!this._buildingTravelerList&&(!this._travelerListBuilt||this._travelersChanged||this._flightListChanged)&&(this._buildingTravelerList=!0,this._travelerList=[],a.forEach(this._travelers,function(b){var c={firstName:b.name.first,lastName:b.name.last,name:b.getFullName(),guid:b.guid,guestId:b.guestId,ff:b.frequentFlyer,travelerType:b.travelerType,seats:[],seatsDescriptions:[]};c.ff.name=this._utilsService.getFFProgramName(c.ff.program);var d=this._seatService.getSelectedSeatModel().flightList.filter(function(a){return void 0!==a});a.forEach(d,function(b){a.forEach(b.paxSeatList,function(a){if(a.travelerGuid===c.guid&&"NA"!==a.seatNumber){var d={flightId:b.flightId,flightNum:b.flightNum,seatType:this._seatService.getSeatType(a),seatNumber:a.seatNumber,mce:a.mce,oAndDId:b.oAndDId};c.seats.push(d)}}.bind(this))}.bind(this));for(var e in c.seats){var f=c.seats[e];c.seatsDescriptions[f.flightId-1]=[f.seatNumber,", ",f.seatType," Seat"].join("")}for(var g in d)c.seatsDescriptions[g]||(c.seatsDescriptions[g]="NA Seat");this._travelerList.push(c)}.bind(this)),this._travelerListBuilt=!0,this._buildingTravelerList=!1,this._travelersChanged=!1,this._flightListChanged=!1),this._travelerList},c.prototype.getTravelerFormsComplete=function(){return this._travelerFormsComplete},c.prototype.setTravelerFormsComplete=function(a){this._travelerFormsComplete=a},c.prototype.reset=function(){this._travelers={},this._travelerFormsComplete=!1},c.prototype._createTravelersFromType=function(a){var b=0;for(var c in a)if("pets"!==c&&"pet"!==c)for(var d=0,e=a[c];d<e;d++,b++)this.createTraveler({travelerIndex:b});return this._travelers},c.prototype.createTraveler=function(c){var d=a.extend({ticketNum:"",travelerType:"",primary:!1,name:{first:"",middle:"",last:""},dob:"",gender:"",contact:{email:"",phone:""},avatar:"",frequentFlyer:{program:"",number:""},redressNum:"",knownTravelerNum:"",international:{passportNum:"",passportCountry:"",passportExpires:"",citizenship:"",countryOfResidence:"",emergencyContact:{name:"",phone:""}}},c),e=new b(d);return e.addGuid(),c.guestId||e.setGuestId(c.travelerIndex||0),this._travelers[e.guestId]=e,e},c.prototype.getTravelerAmounts=function(){var a={adults:0,children:0,infants:0};for(var b in this._travelers){var c=this._travelers[b].travelerType;switch(c){case"adult":case"adult_with_infant":c="adults";break;case"child":c="children";break;case"infant":c="infants"}a[c]++}return a},c.prototype.getTravelerGuids=function(b){var c=[];return a.forEach(this._travelers,function(a){(!b||"INFANT"!==a.travelerType.toUpperCase())&&c.push(a.guid)}),c},c.prototype.getTravelerByGuestId=function(a){for(var b in this._travelers)if(this._travelers[b].guestId===a)return this._travelers[b]},c.prototype.getTravelerByGuid=function(a){for(var b in this._travelers)if(this._travelers[b].guid===a)return this._travelers[b]},c.prototype.getTravelersByKey=function(a,b){var c,d=[];for(c in this._travelers)this._travelers[c][a]===b&&d.push(this._travelers[c]);return d},c}),c("common/services/loading",["angular"],function(){"use strict";var a=function(a,b,c,d){return this._windowService=a,this._statusService=b,this._accessibleService=c,this._$timeout=d,this._loadingCount=0,this._keydownEvent="keydown.trapLoadingFocus",{setLoading:this.setLoading.bind(this),visible:this.getVisibility.bind(this),isOnTop:this.getIsOnTop.bind(this)}};return a.$inject=["windowService","statusService","accessibleService","$timeout"],a.prototype.setLoading=function(a){this._windowService.setUiBlock(!0,null),this.setVisibility(!0),this._loadingCount++,a.finally(this.onLoadingPromise.bind(this)),this._accessibleService.setText("Loading"),this._$timeout(function(){var a=$(".loading .is-visible").eq(0);document.hasFocus()&&a.focus(),$("body").on(this._keydownEvent,this._accessibleService.trapFocus.bind(this,a,null))}.bind(this))},a.prototype.onLoadingPromise=function(){this._loadingCount--,this._loadingCount<0&&(this._loadingCount=0),this.checkIfLoading()},a.prototype.checkIfLoading=function(){0===this._loadingCount&&this._$timeout(function(){0===this._loadingCount&&(this._windowService.setUiBlock(!1,null),this.setVisibility(!1),$("body").off(this._keydownEvent))}.bind(this))},a.prototype.getIsOnTop=function(){return this._statusService.isStatusSticky()},a.prototype.getVisibility=function(){return this.isVisible},a.prototype.setVisibility=function(a){this.isVisible=a},a}),c("common/services/image",["angular","modernizr"],function(a,b){"use strict";var c=function(a,b){return this._$rootScope=a,this._windowService=b,this._images=[],this._triggers={},this.BREAKPOINT="",this._imageCount=0,this._$rootScope.$watch(this._windowService.breakpoint,this.onBreakpointChange.bind(this)),{addImage:this.addImage.bind(this),removeImage:this.removeImage.bind(this),getImages:this.getImages.bind(this),processImages:this.processImages.bind(this)}};return c.prototype.addImage=function(b,c){this._images.push(b);var d="vx-res-image-"+this._imageCount;if(this._imageCount++,b.attr("id",d),c.over){var e=c.rolloverTrigger?b.closest(c.rolloverTrigger):b;this._triggers[d]=e,e.on("mouseover mouseout",function(b){var d=c.rolloverTrigger?a.element($(this).find("img")):a.element(this),e=d.attr("resolution")?d.attr("resolution"):"",f=d.attr("out")+e,g=d.attr("over")+e,h="mouseover"===b.type?g:f;d.attr("src",h)})}this.processImage(b,c.out)},c.prototype.removeImage=function(a){for(var b=0,c=this._images.length;b<c;b++)if(this._images[b][0]===a[0]){var d=a.attr("id");this._triggers[d]&&(this._triggers[d].off("mouseover mouseout"),delete this._triggers[d]),this._images.splice(b,1);break}},c.prototype.onBreakpointChange=function(a){this.BREAKPOINT=a,this.processImages()},c.prototype.processImages=function(){for(var b in this._images){var c=a.element(this._images[b]);this.processImage(c,c.attr("out"))}},c.prototype.processImage=function(a,c){var d=this.BREAKPOINT;if(""!==d){var e=a.attr(d),f=b.highres?1.5*e:e,g="?resize="+f+"px:*";a.attr("resolution",g);var h=c+a.attr("resolution");c.indexOf(".jpg")>=0&&(h+="&output-quality=100&output-format=jpg"),a.attr("src")!==h&&a.attr("src",h)}},c.prototype.getImages=function(){return this._images},c.$inject=["$rootScope","windowService"],c}),c("common/models/seat-model",["common/models/serial-model"],function(a){"use strict";var b=function(a){this.init(a)};return b.prototype=new a,b.prototype._schema={type:"object",properties:{aisle:{type:"boolean"},invisible:{type:"boolean"},cabinType:{type:"string"},exitRow:{type:"boolean"},mce:{type:"boolean"},middle:{type:"boolean"},nonRecline:{type:"boolean"},open:{type:"boolean"},temporarilyLocked:{type:"boolean"},avatarImage:{type:"string"},seatLetter:{type:"string"},seatNumber:{type:"string"},selected:{type:"boolean"},window:{type:"boolean"},ancilarriesPerPax:{type:"object",patternProperties:{"^[0-9.]+$":{type:"number"}}}}},b.prototype._deserializerMappings={seat:{aisle:"aisle",cabinType:"cabinType",exitRow:"exitRow",mce:"mce",middle:"middle",nonRecline:"nonRecline",open:"open",invisible:"invisible",avatarImage:"avatarImage",seatLetter:"seatLetter",seatNumber:"seatNumber",selected:"selected",window:"window",ancilarriesPerPax:"paxPriceMap"}},b}),c("common/models/seatmap-model",["angular","common/models/serial-model","common/models/seat-model"],function(a,b,c){"use strict";var d=function(a){this.init(a)};return d.prototype=new b,d.prototype._schema={type:"object",properties:{cabinAvailability:{type:"object",properties:{first:{type:"boolean"},main:{type:"boolean"},mcs:{type:"boolean"}}},ancillaries:{type:"object",patternProperties:{"^[0-9]+$":{type:"object",properties:{finalPrice:{type:"number"},originalPrice:{type:"number"}}}}},seatMap:{type:"array",items:{cost:{type:"number"},exitRow:{type:"boolean"},name:{type:"string"},rows:{type:"array",items:{type:"object",properties:{exitRow:{type:"boolean"},seats:{type:"array",items:c.prototype._schema}}}}}}}},d.prototype._isSeatOpen=function(a,b,c){var d=b.open;if(!d)return d;var e="FIRST"===b.cabinType,f="MCS"===b.cabinType;return"first"!==a&&"firstRefundable"!==a||(d=d&&e),"mcs"!==a&&"mcsRefundable"!==a||(d=d&&(e||f)),c&&c.indexOf(b.cabinType)>-1&&(d=!1),d},d.prototype._transformPartialRows=function(a){var b=a,c="FIRST",d=4,e=6;if(b.length>1)for(var f=0;f<b.length;f++){var g=Object.keys(b[f].columns),h=g.length,i=g[0],j=b[f].columns[i].cabinType,k=j===c,l=k?d:e;h!==l&&(b[f]=this._transformPartialRow(b[f],k,h,l))}return b},d.prototype._transformPartialRow=function(a,b,c,d){var e={left:["A","B","C"],right:["D","E","F"]},f=[],g=[],h={},i={},j=d/2;if(Object.keys(a.columns).map(function(b){var c=a.columns[b];i=c,e.left.indexOf(c.seatLetter)!==-1?f.push(a.columns[b]):g.push(a.columns[b])}),f.length<j)for(var k=0;k<j;k++)a.columns[a.rowNumber+e.left[k]]||(h=this._generateDefaultVirtualSeat(i),h.aisle=j-1===k,h.window=0===k,h.seatNumber=a.rowNumber+e.left[k],f.push(h));if(g.length<j)for(var l=0;l<j;l++)a.columns[a.rowNumber+e.right[l]]||(h=this._generateDefaultVirtualSeat(i),h.aisle=0===l,h.window=j-1===l,h.seatNumber=a.rowNumber+e.right[l],g.push(h));a.columns={};for(var m in f)a.columns[f[m].seatNumber]=f[m];for(var n in g)a.columns[g[n].seatNumber]=g[n];return a},d.prototype._generateDefaultVirtualSeat=function(a){return{invisible:!0,virtual:!0,cabinType:a.cabinType,exitRow:a.exitRow,open:!1,seatLetter:"VRTL",window:!1}},d.prototype._customDeserializers={seatMap:function(a,b,d){var e,f,g=[],h=d.service,i=b._transformPartialRows(a),j=h.hasInfants(),k=h.hasChildren(),l={main:!1,mcs:!1,first:!1},m={0:"C1",1:"C2",2:"C3",3:"C4"};for(var n in i){var o=!1,p=null!==i[n].physicalCharacteristics&&void 0!==i[n].physicalCharacteristics&&i[n].physicalCharacteristics.indexOf("EXIT")>-1,q=null!==i[n].physicalCharacteristics&&void 0!==i[n].physicalCharacteristics&&i[n].physicalCharacteristics.indexOf("BULKHEAD")>-1;for(var r in i[n].columns){var s={name:null,rows:{},exitRow:p,bulkHead:q},t=i[n].columns[r].infantAllowed;s.name=i[n].fareInfo?i[n].fareInfo.type:i[n].columns[r].cabinType,s.upgradePrice=i[n].fareInfo?i[n].fareInfo.fullPrice:null;var u={FIRST:["first","firstRefundable"],MCS:["mcs","mcsRefundable"],MC:["main","mainRefundable"],MCE:["main","mainRefundable"]},v=h._flatRequestSeatMapModels[d.index],w=~~(v.tier.indexOf("Refundable")>-1),x=u[s.name][w],y=!!v.cost&&!!v.cost.points,z=y?"pointsFare":"dollarFare",A=y?"totalPoints":"totalFare";d.upgradeCosts&&d.upgradeCosts[x]?s.cost=d.upgradeCosts[x]:v.tiers?"undefined"!=typeof v.tiers[x][z]?s.cost=v.tiers[x][z][A]:(w^=1,x=u[s.name][w],s.cost="undefined"!=typeof v.tiers[x][z]?v.tiers[x][z][A]:""):s.cost="";var B=null;i[n].columns[r].aisle===!0&&!o&&(B={isAisle:!0},o=!0),i[n].columns[r].open=e=b._isSeatOpen(v.tier,i[n].columns[r],d.excludedTiers),(j||k)&&p&&(i[n].columns[r].open=!1),j&&!t&&(i[n].columns[r].open=!1),e&&(l[u[s.name][w]]=!0);var C=Math.floor(4*Math.random());i[n].columns[r].avatarImage=m[C>0&&C<5?C:0];var D;if(g.length>0&&(D=g[g.length-1]),D&&D.name===s.name&&D.exitRow===s.exitRow?(g[g.length-1].rows[i[n].rowNumber]=g[g.length-1].rows[i[n].rowNumber]||{},g[g.length-1].rows[i[n].rowNumber].exitRow=p,g[g.length-1].rows[i[n].rowNumber].seats=g[g.length-1].rows[i[n].rowNumber].seats||{},f=g[g.length-1].rows[i[n].rowNumber].seats[r]=new c,f.deserialize(i[n].columns[r],"seat"),null!==B&&(g[g.length-1].rows[i[n].rowNumber].seats[r+n+"aisle"]=new c(B))):(s.rows[i[n].rowNumber]=s.rows[i[n].rowNumber]||{exitRow:p},s.rows[i[n].rowNumber].seats=s.rows[i[n].rowNumber].seats||{},f=s.rows[i[n].rowNumber].seats[r]=new c,f.deserialize(i[n].columns[r],"seat"),null!==B&&(s.rows[i[n].rowNumber].seats[r+n+"aisle"]=new c(B)),g.push(s)),d.existingSeats)for(var E in d.existingSeats)f.seatNumber===d.existingSeats[E].seatNum&&(b.hasExistingSeats=!0,f.selected=!0,f.travelerGuid=d.existingSeats[E].travelerGuid)}}b.ancillaries=d.ancillaryPriceMap,b.cabinAvailability=l,b.seatMap=g,void(b.seatSelectionAvailable=!0)}},d}),c("common/services/seat",["angular","common/models/seat-model","common/models/seatmap-model"],function(a,b,c){"use strict";var d=function(a,b,c,d,e,f,g,h,i,j){return this._api=f,this._resourceBundle=a,this._$timeout=b,this._$rootScope=d,this._$q=c,this._$http=e,this._loadingService=g,this._utilsService=h,this._pubSubService=i,this._windowService=j,this._emptySeatMapPayload=!1,this._selectedSeatModel={flightList:[]},this._checkInResponseSeatModels=[],this._requestSeatMapModels=[],this._maxTravellerCount=1,this._totalAdults=0,this._totalChildren=0,this._totalInfants=0,this._totalPets=0,this._allSeatsSelected={},this._flatRequestSeatMapModels=[],this._isLoaded=!1,this._existingSeats={},this._selectedAncillaries=[],this.selectedFaresModel=[],this._travelers=[],this._isCheckinWithInfantOrPet=!1,this._pubSubService.subscribe("travelers.changed",function(a){this._travelers=a}.bind(this)),this._pubSubService.subscribe("warning",function(a){a===this._resourceBundle.warningCodes.SEAT_PRICE_ERROR&&this._convertSeatsToSkipped()}.bind(this)),this._pubSubService.subscribe("seatService.resetService",this.resetService.bind(this)),{areAllSeatsSelected:this.areAllSeatsSelected.bind(this),getAllSeatsSelected:this.getAllSeatsSelected.bind(this),setAllSeatsSelected:this.setAllSeatsSelected.bind(this),getSeatMaps:this.getSeatMaps.bind(this),getSeatMap:this.getSeatMap.bind(this),selectSeat:this.selectSeat.bind(this),deselectSeats:this.deselectSeats.bind(this),updateTravellers:this.updateTravellers.bind(this),setRequestSeatMapModels:this.setRequestSeatMapModels.bind(this),getTravellerCount:this.getTravellerCount.bind(this),getSelectedSeatModel:this.getSelectedSeatModel.bind(this),getSelectedSeats:this.getSelectedSeats.bind(this),resetService:this.resetService.bind(this),onScrollComplete:this.onScrollComplete.bind(this),isLoaded:function(){return this._isLoaded}.bind(this),getSeatType:this._getSeatType.bind(this),getSeatMapForCheckIn:this.getSeatMapForCheckIn.bind(this),getRemainingSelectedSeats:this.getRemainingSelectedSeats.bind(this),hasInfants:this.hasInfants.bind(this),hasChildren:this.hasChildren.bind(this),addExistingSeat:this.addExistingSeat.bind(this),getRequestModels:this.getRequestModels.bind(this),deselectSeat:this.deselectSeat.bind(this),addToExistingSeats:this.addToExistingSeats.bind(this),clearExistingSeats:this.clearExistingSeats.bind(this),getArrayOfSeats:this.getArrayOfSeats.bind(this),resetSelectedSeatModel:this._resetSelectedSeatModel.bind(this),resetServiceDataExceptReturningFlightSelectedSeats:this._resetServiceDataExceptReturningFlightSelectedSeats.bind(this),updateSelectedFaresModel:this.updateSelectedFaresModel.bind(this),resetFlightList:this.resetFlightList.bind(this),getEmptySeatMapPayload:this.getEmptySeatMapPayload.bind(this),setSelectedAncillaries:this.setSelectedAncillaries.bind(this),calculateTotalAncillaryAmount:this.calculateTotalAncillaryAmount.bind(this)}};return d.$inject=["ResourceBundle","$timeout","$q","$rootScope","$http","api","loadingService","utilsService","pubSubService","windowService"],d.prototype.hasInfants=function(){return this._totalInfants>0||this._isCheckinWithInfantOrPet},d.prototype.hasChildren=function(){return this._totalChildren>0},d.prototype.getEmptySeatMapPayload=function(){return this._emptySeatMapPayload},d.prototype.getArrayOfSeats=function(){var a=$.map(this._selectedSeatModel.flightList,function(a){return a.paxSeatList});return a},d.prototype.resetFlightList=function(){this._selectedSeatModel.flightList=[]},d.prototype.clearExistingSeats=function(){this._existingSeats={}},d.prototype.addToExistingSeats=function(a,b){this._existingSeats[a]=b},d.prototype.getRequestModels=function(){return this._flatRequestSeatMapModels},d.prototype.onScrollComplete=function(){this._isLoaded=!0},d.prototype._getFlightIndexBySegment=function(a){var b={};for(var c in this._selectedFaresModel)b[c]=Object.keys(this._selectedFaresModel[c].legs).length;return a=0===a||1===a&&b[0]>1?0:1},d.prototype._resetServiceDataExceptReturningFlightSelectedSeats=function(){var b=a.copy(this._selectedSeatModel);for(var c in this._selectedSeatModel.flightList){var d=this._getFlightIndexBySegment(parseInt(c,10));d&&b.flightList.splice(d,1)}this.resetService(),this._selectedSeatModel=b},d.prototype._convertSeatsToSkipped=function(){this._selectedSeatModel.flightList.forEach(function(b){b.paxSeatList.forEach(function(b){a.extend(b,{seatLetter:"NA",seatNumber:"NA",ancillaryPrice:0,ancilarriesPerPax:{}})})}),this._pubSubService.publish("seatSelector.updateSelectedSeatsString")},d.prototype.resetService=function(){this._flatRequestSeatMapModels=[],this._selectedSeatModel={flightList:[]},this._isLoaded=!1,this._allSeatsSelected={},this._$rootScope.$broadcast("seatService.reset"),this._pubSubService.publish("legs",[[]]),void this._windowService.setYtsPayNow(!1)},d.prototype.getAllSeatsSelected=function(a){return this._allSeatsSelected[a]},d.prototype.setAllSeatsSelected=function(a,b,c){this._allSeatsSelected[a]=b,b&&this._buildNewFlightListEntry(c,a)},d.prototype.setRequestSeatMapModels=function(a,b){a>b.length||(this._requestSeatMapModels=b)},d.prototype.updateTravellers=function(a){this._totalChildren=parseInt(a.children,10),this._totalAdults=parseInt(a.adults,10),this._totalInfants=parseInt(a.infants,10),this._totalPets=parseInt(a.pets,10),this._maxTravellerCount=this._totalAdults+this._totalChildren},d.prototype.getExcludedCabinClasses=function(a){a=this._resourceBundle.cabinClassToTier[a].toUpperCase();var b=["MAIN","MCS","FIRST"],c=b.indexOf(a);return b.splice(c,1),b},d.prototype._requestSeatMap=function(a,b,d,e){var f=this._$q.defer(),g=function(b,e){var g,h=e.data.response;if(h){var i=new c;for(var j in this._existingSeats)j.indexOf(b.flightNum)>=0&&(g=this._existingSeats[j]);var k=d?this.getExcludedCabinClasses(b.tier):[];i.deserialize(h.seatMap,"seatMap",{service:this,index:a,existingSeats:g,excludedTiers:k||[],ancillaryPriceMap:h.ancillaryPriceMap}),f.resolve(i)}else f.reject(e.data.error)},h=this._api.seatMap.retrieve(b);return!e&&this._loadingService.setLoading(h),h.then(this._checkForEmptyPayload.bind(this)).then(g.bind(this,b)),f.promise},d.prototype._checkForEmptyPayload=function(a){return a.data.response.emptyPayload?(this._emptySeatMapPayload=!0,this._$http.get("/stubs/seat-map-mock.json")):a},d.prototype.getSeatMaps=function(b,c){var d,e=[],f=this._$q.defer(),g=0;return a.forEach(this._requestSeatMapModels,function(f){a.forEach(f.legs,function(a){c&&c.indexOf(a.segNum)<0?e.push(null):(d=a.fareBasisCode,!d&&f.tier&&f.tiers&&f.tiers[f.tier]&&(d=f.tiers[f.tier].fareBasisCode),e.push(this.getSeatMap(e.length,a,b,f.itineraryType,d,f.oAndDId,!!c)),g++)}.bind(this))}.bind(this)),this._$q.all(e).then(function(a){this._pubSubService.publish("legs",[a]),f.resolve(a)}.bind(this)),f.promise},d.prototype.getSeatMap=function(a,b,c,d,e,f,g){var h=b.serialize("defaultMap");return h.fareBasisCode=e,h.itineraryType=d,h.travelerInfoList=this._getTravelers(f),this._flatRequestSeatMapModels[a]=h,this._requestSeatMap(a,h,c,g)},d.prototype._getTravelers=function(b){var c=[];return a.forEach(this._travelers,function(a){var d=a.serialize("apiStandard");d.mcCostExempt=a.isMcCostExempt(this._selectedAncillaries,b),c.push(d)}.bind(this)),c},d.prototype.selectSeat=function(a,b,c,d){var e=!1;if(c.open){var f=c.selected?"_removeFromSelectedSeatModel":"_addToSelectedSeatModel";e=this[f](a,b,c,d)}return e},d.prototype.deselectSeats=function(a,b){var c=this._selectedSeatModel.flightList[b];c&&(c.paxSeatList=[],a.selectedSeatsCount=0)},d.prototype.deselectSeat=function(a,b){var c=this._selectedSeatModel.flightList[b];if(c&&c.paxSeatList)for(var d=0,e=c.paxSeatList.length;d<e;d++){var f=c.paxSeatList[d];if(f.travelerGuid===a)return c.paxSeatList.splice(d,1),f}},d.prototype.addExistingSeat=function(a,b,c){var d=this._selectedSeatModel.flightList[c]||this._buildNewFlightListEntry(a,c);return d.paxSeatList.push(b),!0},d.prototype.areAllSeatsSelected=function(a,b){if(a)return this._allSeatsSelected[b]=a.selectedSeatsCount===this._maxTravellerCount,this._allSeatsSelected[b]},d.prototype.calculateTotalAncillaryAmount=function(){var a=0;return this._selectedSeatModel.flightList.forEach(function(b){b.paxSeatList.forEach(function(b){b.ancillaryPrice&&(a+=b.ancillaryPrice)})}),a},d.prototype._addToSelectedSeatModel=function(a,b,c,d){var e=this._selectedSeatModel.flightList[d]||this._buildNewFlightListEntry(a,d);return!this.areAllSeatsSelected(a,d)&&(a.selectedSeatsCount||(a.selectedSeatsCount=0),e.paxSeatList.push(c),a.selectedSeatsCount++,!0)},d.prototype._removeFromSelectedSeatModel=function(a,b,c,d){var e=!1;if("undefined"!=typeof this._selectedSeatModel.flightList[d])for(var f in this._selectedSeatModel.flightList[d].paxSeatList){var g=this._selectedSeatModel.flightList[d].paxSeatList[f];g.seatNumber===c.seatNumber&&(this._selectedSeatModel.flightList[d].paxSeatList.splice(f,1),a.selectedSeatsCount--,e=!0)}return e},d.prototype._buildNewFlightListEntry=function(a,b){return this._selectedSeatModel.flightList[b]={flightNum:a.flightNum,flightId:b+1,oAndDId:a.oAndDId,paxSeatList:[]},this._selectedSeatModel.flightList[b]},d.prototype._resetSelectedSeatModel=function(){this._selectedSeatModel={flightList:[]}},d.prototype.getTravellerCount=function(){return this._maxTravellerCount},d.prototype.getSelectedSeatModel=function(){return this._selectedSeatModel},d.prototype.getRemainingSelectedSeats=function(a){var b,c=this.getSelectedSeats(a);return b=c?this._maxTravellerCount-c.length:this._maxTravellerCount},d.prototype.getSelectedSeats=function(a){return a||(a=0),this._selectedSeatModel.flightList&&this._selectedSeatModel.flightList[a]?this._selectedSeatModel.flightList[a].paxSeatList:[]},d.prototype._getSeatType=function(a){return a.aisle?"Aisle":a.window?"Window":"Middle"},d.prototype._updateTravelersForCheckIn=function(){this._isCheckinWithInfantOrPet=Object.keys(this._travelers).some(function(a){return"adult_with_infant"===this._travelers[a].travelerType}.bind(this))},d.prototype.getSeatMapForCheckIn=function(b,d,e,f){var g=this._$q.defer(),h=[],i=[];this._flatRequestSeatMapModels=[];for(var j=0,k=b.length;j<k;j++){this._flatRequestSeatMapModels.push(b[j]);var l=this._api.checkin.seatMap(b[j]).then(this._checkForEmptyPayload.bind(this));i.push(l)}var m=function(b){a.forEach(b,function(a,b){if(a.data.error)g.reject();else{this._updateTravelersForCheckIn(),this._checkInResponseSeatModels.push(a.data.response);var i=new c;i.deserialize(a.data.response.seatMap,"seatMap",{service:this,index:b,existingSeats:d[b].seats,excludedTiers:e[b],upgradeCosts:f}),h.push(i)}},this),this._pubSubService.publish("legs",[h]),g.resolve(h)};return this._$q.all(i).then(m.bind(this)),g.promise},d.prototype._getFullName=function(a){return a.first+" "+a.last},d.prototype.updateSelectedFaresModel=function(a){this._selectedFaresModel=a},d.prototype.setSelectedAncillaries=function(a){this._selectedAncillaries=a},d}),c("common/models/ancillary-model",["angular","jquery","common/models/serial-model"],function(a,b,c){"use strict";var d=function(a){this.init(a)};return d.ANCILLARY_MAP={},d.LEVEL={O_AND_D:"O_AND_D",PNR:"PNR",SEGMENT:"SEGMENT"},d.QUANTITY_LIST={UI_QUANTITY_PER_PAX:"uiQuantityPerPax",PNR_QUANTITY_PER_PAX:"pnrQuantityPerPax"},d.QUANTITY_LISTS=[d.QUANTITY_LIST.UI_QUANTITY_PER_PAX,d.QUANTITY_LIST.PNR_QUANTITY_PER_PAX],d.prototype=new c,d.prototype._schema={type:"object",properties:{ancillaryId:{type:"string"}}},d.prototype._createFromCMSDeserializer=function(b,c){a.extend(c,{activeInContext:b.activeInContext,activeInSeatMapContext:b.activeInSeatMapContext,ancillaryId:b.ancillaryId,autoApply:b.autoApply,bundleFeatures:b.bundleFeatures,description:b.description,iconSrc:b.image,title:b.title,bundleId:b.bundleId,pointsBookingEligible:b.pointsBookingEligible})},d.prototype._addAvailableDataDeserializer=function(b,c){var d=b.availableAncillary,e=b.priceMap;c._addBasicAPIData(d),c.priceMap=e;var f=0;a.forEach(c.priceMap,function(a){f="ELIGIBLE"===a.status&&a.finalPrice>f?a.finalPrice:f}),c.maxPrice=f,a.forEach(d.levelMap,function(b,d){a.isUndefined(c.levelMap[d])&&(c.levelMap[d]={}),c.levelMap[d].paxPriceMap=b.paxPriceMap})},d.prototype._addBasicAPIData=function(b){a.isUndefined(this.level)&&(d.ANCILLARY_MAP[this.ancillaryId]=this,a.extend(this,{isBundle:b.bundle,group:b.group,level:b.level,maxQuantity:b.maxQuantityPerPax,mcCostExempt:b.mcCostExempt,bundledAncillaryList:b.bundledAncillaryList||[],levelMap:{}}))},d.prototype.addAPISelectionData=function(b,c){this._addBasicAPIData(b),a.forEach(b.levelMap,function(b,d){a.isUndefined(this.levelMap[d])&&(this.levelMap[d]={}),this.levelMap[d][this._getQuantityListKey(c)]=b.quantityPerPax}.bind(this))},d.prototype.getPaxInfo=function(b,c){var d,e=this._getCurrentLevelMap(c);if(!a.isUndefined(e)){var f=e.pnrQuantityPerPax&&e.pnrQuantityPerPax[b],g=e.uiQuantityPerPax&&e.uiQuantityPerPax[b],h=e.paxPriceMap&&e.paxPriceMap[b];return a.isUndefined(h)||(d=this.priceMap[h]&&this.priceMap[h].finalPrice),{pnrQuantity:f||0,uiQuantity:g||0,finalPrice:d}}},d.prototype.getPaxQuantities=function(b,c){var e={},f=c?[this._getQuantityListKey(c)]:d.QUANTITY_LISTS;return a.forEach(this.levelMap,function(c){f.forEach(function(d){c[d]&&a.forEach(c[d],function(a,d){b&&this.priceMap&&c.paxPriceMap&&this.priceMap[c.paxPriceMap[d]]&&!this.priceMap[c.paxPriceMap[d]].finalPrice||(e[d]||(e[d]=0),e[d]+=a)}.bind(this))}.bind(this))}.bind(this)),e},d.prototype.getTotalCost=function(b){var c=0,e=b?[this._getQuantityListKey(b)]:d.QUANTITY_LISTS;return a.forEach(this.levelMap,function(b){e.forEach(function(e){b[e]&&a.forEach(b[e],function(a,f){b.paxPriceMap&&this.priceMap[b.paxPriceMap[f]]&&(e!==d.QUANTITY_LIST.PNR_QUANTITY_PER_PAX||this.level!==d.LEVEL.PNR)&&(c+=this.priceMap[b.paxPriceMap[f]].finalPrice*a)}.bind(this))}.bind(this))}.bind(this)),c},d.prototype.isMcCostExempt=function(){return this.bundledAncillaryList&&this.bundledAncillaryList.length&&this.bundledAncillaryList.forEach(function(a){var b=d.ANCILLARY_MAP[a];b&&(this.mcCostExempt=this.mcCostExempt||b.mcCostExempt)}.bind(this)),this.mcCostExempt},d.prototype.add=function(b,c){var d=this._getCurrentLevelMap(c);return!(a.isUndefined(d)||d&&d.uiQuantityPerPax&&d.uiQuantityPerPax[b]&&d.uiQuantityPerPax[b]===this.maxQuantity)&&(a.isUndefined(d.uiQuantityPerPax)&&(d.uiQuantityPerPax={}),d.uiQuantityPerPax[b]||(d.uiQuantityPerPax[b]=0),d.uiQuantityPerPax[b]+=1,{finalPrice:this.getFinalPriceForGuest(b,c)})},d.prototype.remove=function(b,c){var d=this._getCurrentLevelMap(c);return!(a.isUndefined(d)||!d.uiQuantityPerPax||!a.isNumber(d.uiQuantityPerPax[b]))&&(d.uiQuantityPerPax[b]-=1,0===d.uiQuantityPerPax[b]&&delete d.uiQuantityPerPax[b],a.equals({},d.uiQuantityPerPax)&&delete d.uiQuantityPerPax,{finalPrice:this.getFinalPriceForGuest(b,c)})},d.prototype.getUIQuantityForGuestAndLevel=function(b,c){var d=this._getCurrentLevelMap(c),e=0;return!a.isUndefined(d)&&d.uiQuantityPerPax&&a.isNumber(d.uiQuantityPerPax[b])&&(e=d.uiQuantityPerPax[b]),e},d.prototype._getCurrentLevelMap=function(a){return this.levelMap&&this.levelMap[this._getLevelKey(a)]},d.prototype.getFinalPriceForGuest=function(b,c){var d=this._getCurrentLevelMap(c),e=d&&d.paxPriceMap&&d.paxPriceMap[b];return a.isDefined(e)?this.priceMap[e].finalPrice:0},d.prototype._getLevelKey=function(a){var b;switch(this.level){case"PNR":b="PNR";break;case"O_AND_D":b=a.oAndDId;break;case"SEGMENT":b=a.segNum}return b},d.prototype.hasSelections=function(b){if(!a.isUndefined(this.levelMap)){var c=!1,d=this._getQuantityListKey(b);return a.forEach(this.levelMap,function(b){b[d]&&a.forEach(b[d],function(a){a&&(c=!0)})}),c}},d.prototype._getQuantityListKey=function(a){return a+"QuantityPerPax"},d.prototype._customDeserializers={addAvailableData:d.prototype._addAvailableDataDeserializer,createFromCMS:d.prototype._createFromCMSDeserializer},d.prototype._apiReqStandardSerializer=function(c,e){var f,g={},h=e.map(function(a){return c._getQuantityListKey(a)});if(a.forEach(c.levelMap,function(e,i){f={},h.forEach(function(b){e[b]&&(b!==d.QUANTITY_LIST.PNR_QUANTITY_PER_PAX||c.level!==d.LEVEL.PNR)&&a.forEach(e[b],function(a,b){f[b]=f[b]?f[b]+a:a})}),b.isEmptyObject(f)||(g[i]={quantityPerPax:f})}),!b.isEmptyObject(g))return{ancillaryId:c.ancillaryId,levelMap:g}},d.prototype.clearSelectionData=function(b,c,d){var e=this._getQuantityListKey(b);a.isUndefined(this.levelMap)||a.forEach(this.levelMap,function(b,f){(!d||f===d)&&a.forEach(b[e],function(a,d){c&&b.paxPriceMap&&this.priceMap[b.paxPriceMap[d]]&&!this.priceMap[b.paxPriceMap[d]].finalPrice||delete b[e][d]}.bind(this))}.bind(this))},d.prototype._customSerializers={apiReqStandard:d.prototype._apiReqStandardSerializer},d}),c("common/services/ancillaries",["angular","common/models/ancillary-model"],function(a,b){"use strict";var c=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){return this._$q=a,this._$singleTimeout=b,this._$interpolate=c,this._api=d,this._fareService=g,this._travelerService=f,this._pubSubService=e,this._cms=h,this._loadingService=i,this._changeService=j,this._locationService=k,this._tripService=l,this._resourceBundle=m,this._elevateService=n,this._seatService=o,this._adobeAnalyticsService=p,this._pnrService=q,this._ancillaries=[],this._ancillarySummaryList=[],this._refundedAncillarySummaryList=[],this._ancillaryEnabledTiers=["main","mainRefundable"],this._tiersWithFreeBags=["mainRefundable","mcs","mcsRefundable","first","firstRefundable"],this.toggleAction={
REMOVE:!1,ADD:!0},this._uiAncillariesAmount=0,this.selectionTypes={UI:"ui",PNR:"pnr"},this._contexts={book:"BOOKING","check-in":"CHECKIN",change:"CHANGE_FLIGHT",manage:"MANAGE_FLIGHT"},this.levels={O_AND_D:"O_AND_D",PNR:"PNR"},this._builtAncillaryListFromCMS=!1,this._assignedPets=!1,this._resetUIAncillaries=!1,this._selectionType=this.selectionTypes.PNR,this._toggleMap={},this._ancillaryFullySelectedParentMap={},this._formattedAvailableAncillaryList=[],this._fareData={},this._travelerData=[],this._groupPricePerAncillary={},this._analyticsData={},this._ancAndPaxSeatInfo={},this._initPubSub(),h.info.get(function(a){this._cmsData=a}.bind(this)),{levels:this.levels,toggleAction:this.toggleAction,ancillaryIsAvailable:this.ancillaryIsAvailable.bind(this),getAPIAncillariesAmount:this.getAPIAncillariesAmount.bind(this),getUIAncillariesAmount:this.getUIAncillariesAmount.bind(this),getAvailableAncillaries:this.getAvailableAncillaries.bind(this),getAncillarySummaryList:this.getAncillarySummaryList.bind(this),getSelectedAncillarySummaryList:this.getSelectedAncillarySummaryList.bind(this),getRefundedAncillarySummaryList:this.getRefundedAncillarySummaryList.bind(this),getBagCountForPax:this.getBagCountForPax.bind(this),newAncillaryDetails:this.newAncillaryDetails.bind(this),setAncillaryDetailsFromPNR:this.setAncillaryDetailsFromPNR.bind(this),requestAvailableAncillaries:this.requestAvailableAncillaries.bind(this),reset:this.reset.bind(this),resetService:this.resetService.bind(this),useUISelections:this.useUISelections.bind(this),serializeSelectedAncillaries:this.serializeSelectedAncillaries.bind(this),getSelectedAncillaries:this.getSelectedAncillaries.bind(this),getAllSelectedAncillaries:this.getAllSelectedAncillaries.bind(this),getSelectedAncillariesAndPax:this.getSelectedAncillariesAndPax.bind(this),shouldDisplayAncillaries:this.shouldDisplayAncillaries.bind(this),getSelectedBundleParentName:this.getSelectedBundleParentName.bind(this),resetUISelections:this.resetUISelections.bind(this),onAncillaryToggle:this.onAncillaryToggle.bind(this),registerToggle:this.registerToggle.bind(this),setAncillaryQuantityTo1:this.setAncillaryQuantityTo1.bind(this),setAncillaryQuantityTo0:this.setAncillaryQuantityTo0.bind(this),getFormattedAvailableAncillaryList:this.getFormattedAvailableAncillaryList.bind(this),getFareData:this.getFareData.bind(this),hasFullySelectedParent:this.hasFullySelectedParent.bind(this),setIncludedListData:this.setIncludedListData.bind(this),getGroupPricePerAncillary:this.getGroupPricePerAncillary.bind(this),getTravelerData:this.getTravelerData.bind(this),getMaxPriceFor:this.getMaxPriceFor.bind(this),publishTotalPrice:this.publishTotalPrice.bind(this),refreshAncillariesForChangeFlow:this.refreshAncillariesForChangeFlow.bind(this),getCheckInTravelerInfoForAncillary:this.getCheckInTravelerInfoForAncillary.bind(this),shouldShowCheckInAncillaries:this.shouldShowCheckInAncillaries.bind(this),atLeastOneCheckedAncillary:this.atLeastOneCheckedAncillary.bind(this),atLeastOneUncheckedAncillary:this.atLeastOneUncheckedAncillary.bind(this),noAvailableAncillaries:this.noAvailableAncillaries.bind(this),getSiblingToggle:this.getSiblingToggle.bind(this),selectionTypes:this.selectionTypes,setSeatInfo:this.setSeatInfo.bind(this),updateAnalyticsData:this.updateAnalyticsData.bind(this),publishAnalyticsData:this.publishAnalyticsData.bind(this),getExtrasRefund:this.getExtrasRefund.bind(this)}};return c.$inject=["$q","$singleTimeout","$interpolate","api","pubSubService","travelerService","fareService","cms","loadingService","changeService","locationService","tripService","ResourceBundle","elevateService","seatService","adobeAnalyticsService","pnrService"],c.prototype._initPubSub=function(){this._pubSubService.subscribe("newAncillaryDetails",this.newAncillaryDetails.bind(this)),this._pubSubService.subscribe("setAncillaryDetailsFromPNR",this.setAncillaryDetailsFromPNR.bind(this)),this._pubSubService.subscribe("refundedAncillaryDetails",this.onRefundedAncillaryDetails.bind(this)),this._pubSubService.subscribe("ancillaries.reset",this.reset.bind(this)),this._pubSubService.subscribe("ancillaries.newUIAmount",this._setUIAncillariesAmount.bind(this)),this._pubSubService.subscribe("fare.setChangedFare",this._onChangedFare.bind(this)),this._pubSubService.subscribe("warning",function(a){a===this._resourceBundle.warningCodes.ANCILLARY_PRICE_ERROR&&(this._resetUIAncillaries=!0)}.bind(this)),this._pubSubService.subscribe("ancillaries.setSeatInfo",this.setSeatInfo.bind(this))},c.prototype._getSeatAncillary=function(){return this._getAncillaryById(this._resourceBundle.ancillaryIds.SEAT)},c.prototype.setSeatInfo=function(a){var b,c,d,e={},f=this._getSeatAncillary(),g=0,h=0;this._ancAndPaxSeatInfo={},f&&f.clearSelectionData(this.selectionTypes.UI),a&&(a.forEach(function(a){a.paxSeatList.forEach(function(a){b=a.pax.guestId,a.amount&&(e[b]=e[b]||{pax:this._travelerService.getTravelerByGuestId(b),quantity:0},g++,e[b].quantity++,h+=a.amount)}.bind(this))}.bind(this)),g&&f&&(this._ancAndPaxSeatInfo={ancillary:f,paxList:e},c=this._getPremiumSeatsContext(),d=this._$interpolate("{{existingAnalyticsData}} {{context}} ({{seatCount}} {{seatTitle}}) |")({existingAnalyticsData:this._buildAnalyticsData(!0),context:c,seatCount:g,seatTitle:f.title}),this._analyticsData[c]={},this._analyticsData[c][f.ancillaryId]={quantity:g,title:f.title},this._adobeAnalyticsService.updateWebData(this._adobeAnalyticsService.WEB_DATA_KEYS.ANCILLARY_SELECTIONS,d)))},c.prototype._setUIAncillariesAmount=function(a){this._uiAncillariesAmount=a},c.prototype.getUIAncillariesAmount=function(){return this._uiAncillariesAmount+this._seatService.calculateTotalAncillaryAmount()},c.prototype.getAPIAncillariesAmount=function(){return this._getAPIAncillariesData().totalExtras},c.prototype._getAPIAncillariesData=function(){var a={totalExtras:0,totalExtrasWithoutSeats:0};return this._ancillarySummaryList.forEach(function(b){a.totalExtras+=b.totalAmount,b.ancillaryId!==this._resourceBundle.ancillaryIds.SEAT&&(a.totalExtrasWithoutSeats+=b.totalAmount)}.bind(this)),this._pubSubService.publish("ancillaries.newAPIAmountData",[a]),a},c.prototype.reset=function(){this.resetUISelections(),this._ancillaries=[],this._ancillarySummaryList=[],this._refundedAncillarySummaryList=[],this._formattedAvailableAncillaryList=[],this._fareData={},this._travelerData=[],this._toggleMap={},this._groupPricePerAncillary={},this._ancillaryFullySelectedParentMap={},this._ancAndPaxSeatInfo={},this._builtAncillaryListFromCMS=!1,this._assignedPets=!1,this._selectionType=this.selectionTypes.PNR},c.prototype.resetService=function(){},c.prototype.newAncillaryDetails=function(a){this._buildAncillaryListFromCMS();var b=a&&a.summaryList;if(this._ancillarySummaryList=this._createAncillarySummary(b),this._pubSubService.publish("ancillaries.newSummaryList",[this._ancillarySummaryList]),this._resetUIAncillaries){var c=a&&a.ancillaryList||[];this._addOrUpdateData(c,this.selectionTypes.UI),this._pubSubService.publish("ancillaries.resetUIAncillaries"),this._resetUIAncillaries=!1}},c.prototype.setAncillaryDetailsFromPNR=function(a){this._buildAncillaryListFromCMS();var b=a&&a.ancillaryList||[];a&&a.priceMap&&this._updateAvailableAncillaryData(b,a.priceMap),this._addOrUpdateData(b,this.selectionTypes.PNR)},c.prototype.onRefundedAncillaryDetails=function(a){var b=a&&a.summaryList;this._refundedAncillarySummaryList=this._createAncillarySummary(b)},c.prototype.getExtrasRefund=function(){return this._refundedAncillarySummaryList.reduce(function(a,b){return a+b.totalAmount},0)},c.prototype._addOrUpdateData=function(a,b){this._ancillaries.forEach(function(c){c.clearSelectionData(b),a.some(function(a){if(a.ancillaryId===c.ancillaryId)return c.addAPISelectionData(a,b),!0})}),this.refreshAncillariesForChangeFlow()},c.prototype.refreshAncillariesForChangeFlow=function(a){var b,c=[];a&&(b=this._isExistingChange()?{selectionType:this.selectionTypes.UI}:{allSelections:!0},c=this.serializeSelectedAncillaries(b)),this._pubSubService.publish("ancillaries.refreshAncillariesForChangeFlow",[c,this.getAllSelectedAncillaries()])},c.prototype._onAvailableAncillaryDataReceived=function(b){var c=b.data.response.ancillaryDetails&&b.data.response.ancillaryDetails.ancillaryList,d=b.data.response.ancillaryDetails&&b.data.response.ancillaryDetails.priceMap;a.isUndefined(c)||a.isUndefined(d)||!c.length?this._locationService.contextIs(this._locationService.contexts.CHECKIN)?this._requestPromise.resolve():this._requestPromise.reject():(this._updateAvailableAncillaryData(c,d),this._requestPromise.resolve()),this._buildTravelerData(),this._pubSubService.publish("ancillaries.retrieved"),this.publishTotalPrice(),this._$singleTimeout(function(){this._buildFormattedAvailableAncillaryList(),this._pubSubService.publish("ancillaries.retrieved")}.bind(this))},c.prototype._updateAvailableAncillaryData=function(b,c){var d;this._ancillaries.forEach(function(e){b.some(function(b){if(b.ancillaryId===e.ancillaryId){d={};for(var f in c)c.hasOwnProperty(f)&&c[f].ancillaryId===e.ancillaryId&&(d[f]=c[f],delete d[f].ancillaryId);var g={availableAncillary:b,priceMap:d};return e.deserialize(g,"addAvailableData"),a.forEach(e.levelMap,function(a,c){b.levelMap[c]||delete e.levelMap[c]}.bind(this)),!0}})})},c.prototype.getTravelerData=function(){return this._travelerData},c.prototype._buildTravelerData=function(){this._travelerData=[],a.forEach(this._travelerService.getAllTravelers(),function(a){if("INFANT"!==a.travelerType.toUpperCase()){var b={avatar:a.avatar,guestId:a.guestId,name:[a.name.first," ",a.name.last].join(""),isPrimary:a.primary};this._travelerData.push(b)}}.bind(this))},c.prototype._createAncillarySummary=function(a){var b=[];return a&&a.forEach(function(a){var c=this._getAncillaryById(a.ancillaryId);c&&a.ancillaryId!==this._resourceBundle.ancillaryIds.PET&&b.push({ancillaryId:a.ancillaryId,title:c.title,totalNumPurchased:a.totalNumPurchased,totalAmount:a.totalAmount})}.bind(this)),b},c.prototype.getAncillarySummaryList=function(){return this._ancillarySummaryList.map(function(b){var c=a.copy(b);return a.forEach(this._analyticsData,function(a,d){var e=a[b.ancillaryId];e&&(c.title=e.title||c.title,c.analyticsState=d)}),c}.bind(this))},c.prototype.getSelectedAncillarySummaryList=function(){return this.getSelectedAncillaries().map(function(b){var c={title:b.title,analyticsTitle:b.isBundle?b.title+" Bundle":b.title,totalNumPurchased:0,totalAmount:0};return a.forEach(b.levelMap,function(d){var e=d[this._selectionType+"QuantityPerPax"];a.forEach(e,function(a,e){var f=b.priceMap[d.paxPriceMap[e]].finalPrice;c.totalNumPurchased+=a,c.totalAmount+=f*a})}.bind(this)),c}.bind(this))},c.prototype.getRefundedAncillarySummaryList=function(){return this._refundedAncillarySummaryList},c.prototype.serializeSelectedAncillaries=function(a){var b,c=[],d=a.allSelections?[this.selectionTypes.UI,this.selectionTypes.PNR]:[a.selectionType||this._selectionType];return a.includePets&&!this._assignedPets&&this._assignPetAncillaries(),this.getSelectedAncillaries(d).forEach(function(a){b=a.serialize("apiReqStandard",d),b&&c.push(b)}.bind(this)),c},c.prototype._assignPetAncillaries=function(){var a,b,c,d,e;if(this._assignedPets=!0,this._locationService.contextIs(this._locationService.contexts.BOOK)&&(a=this._tripService.getSelectedTripPublicModel().travelers.pets,b=this._getAncillaryById(this._resourceBundle.ancillaryIds.PET),a&&b)){c=this._travelerService.getAdultTravelers(),d=this._getSelectedFares(),b.level=this.levels.O_AND_D,b.levelMap={};for(var f=0;f<a;f++)e=c[f].guestId,d.forEach(function(a){b.levelMap[a.oAndDId]=b.levelMap[a.oAndDId]||{},b.add(e,{oAndDId:a.oAndDId})})}},c.prototype._onChangedFare=function(a){var b=0===a?0:1,c=this.getAllSelectedAncillaries(),d="IP"+(b+1),e=this.shouldDisplayAncillaries(),f=this._getSelectedFares()[b];this._ancillaryEnabledTiers.indexOf(f.tier)<0&&c.forEach(function(a){a.level===this.levels.O_AND_D?(a.clearSelectionData(this.selectionTypes.UI,!1,d),a.clearSelectionData(this.selectionTypes.PNR,!1,d)):e||a.clearSelectionData(this.selectionTypes.UI,!1)}.bind(this)),this._buildFormattedAvailableAncillaryList(),this._pubSubService.publish("ancillaries.resetUIAncillaries")},c.prototype.getSelectedAncillaries=function(b){return b=a.isArray(b)?b:[this._selectionType],this._ancillaries.filter(function(a){return b.some(function(b){return a.hasSelections(b)})})},c.prototype.getAllSelectedAncillaries=function(){return this.getSelectedAncillaries([this.selectionTypes.PNR,this.selectionTypes.UI])},c.prototype._isExistingChange=function(){return this._locationService.contextIs(this._locationService.contexts.CHANGE)&&this._changeService.isChangeType(this._changeService.CHANGE_TYPES.EXISTING)},c.prototype.getSelectedAncillariesAndPax=function(){var b,c,d=[];return this.getAllSelectedAncillaries().forEach(function(e){b={},e.ancillaryId!==this._resourceBundle.ancillaryIds.PET&&(c=this._isExistingChange()?e.getPaxQuantities(!0,this.selectionTypes.UI):e.getPaxQuantities(!0),a.forEach(c,function(a,c){b[c]?b[c].quantity+=a:b[c]={pax:this._travelerService.getTravelerByGuestId(c),quantity:a},e.level===this.levels.PNR&&(b[c].quantity=!1)}.bind(this)),Object.keys(b).length&&d.push({ancillary:e,paxList:b}))}.bind(this)),a.equals(this._ancAndPaxSeatInfo,{})||d.push(this._ancAndPaxSeatInfo),d},c.prototype.getAvailableAncillaries=function(a){return this._ancillaries.filter(function(b){return this.ancillaryIsAvailable(b)||b.ancillaryId!==this._resourceBundle.ancillaryIds.PET&&a&&b.hasSelections(this.selectionTypes.PNR)}.bind(this))},c.prototype.ancillaryIsAvailable=function(b){var c=this._locationService.getContext().toUpperCase();return!a.isUndefined(b.priceMap)&&b.activeInContext[c]&&b.ancillaryId!==this._resourceBundle.ancillaryIds.PET},c.prototype.requestAvailableAncillaries=function(a){if(this._buildAncillaryListFromCMS(),this._requestPromise=this._$q.defer(),this.shouldDisplayAncillaries()){var b=this._buildAvailableAncillariesRequest(a||{});this._api.ancillaries.retrieve(b).then(this._onAvailableAncillaryDataReceived.bind(this),function(){this._requestPromise.reject()}.bind(this)),this._loadingService.setLoading(this._requestPromise.promise)}else this._requestPromise.reject();return this._requestPromise.promise},c.prototype._buildAncillaryListFromCMS=function(){this._builtAncillaryListFromCMS||(this._ancillaries=this._cmsData.ancillaries.map(function(a){var c=new b;return c.deserialize(a,"createFromCMS"),c}.bind(this))),this._builtAncillaryListFromCMS=!0},c.prototype._buildAvailableAncillariesRequest=function(b){var c=this._travelerService.getAllTravelers(),d=this._isExistingChange()?this._contexts.manage:this._contexts[this._locationService.getContext()],e={context:d,travelerInfoList:[],oAndDList:b.oAndDList||[]};if(a.forEach(c,function(a){"INFANT"!==a.travelerType&&e.travelerInfoList.push(a.serialize("apiStandard"))}),!e.oAndDList.length){var f=this._getSelectedFares();a.forEach(f,function(a){e.oAndDList.push(a.serialize("ancillaries"))}.bind(this))}return e},c.prototype.useUISelections=function(){this._selectionType=this.selectionTypes.UI,this.refreshAncillariesForChangeFlow()},c.prototype._getSelectedFares=function(){return this._fareService.getSelectedFares().length?this._fareService.getSelectedFares():this._pnrService.getSelectedFares()},c.prototype.shouldDisplayAncillaries=function(){if(this._locationService.contextIs(this._locationService.contexts.CHECKIN))return!0;var b=!1;return a.forEach(this._getSelectedFares(),function(a){this._ancillaryEnabledTiers.indexOf(a.tier)!==-1&&(b=!0)}.bind(this)),b},c.prototype.getBagCountForPax=function(a,b){var c,d,e=0,f=[this._resourceBundle.ancillaryIds.BAG];return this._ancillaries.forEach(function(a){a.isBundle&&a.bundledAncillaryList.indexOf(this._resourceBundle.ancillaryIds.BAG)>-1&&f.push(a.ancillaryId)}.bind(this)),f.forEach(function(f){c=this._getAncillaryById(f),c&&(d=c.getPaxInfo(a.guestId,{oAndDId:b}),d&&d.pnrQuantity&&(e+=d.pnrQuantity))}.bind(this)),e},c.prototype._getAncillaryById=function(a){return this._buildAncillaryListFromCMS(),this._ancillaries.filter(function(b){return b.ancillaryId===a||b.bundleId===a})[0]},c.prototype.getSelectedBundleParentName=function(a,b,c){c=c||{};var d,e,f,g;return this.getAllSelectedAncillaries().some(function(h){if(d=!1,g=a.bundleId||a.ancillaryId,h.bundledAncillaryList&&h.bundledAncillaryList.indexOf(g)>-1&&(c.anyOAndD||a.level===this.levels.PNR?d=h.getPaxQuantities()[b]:(f=h.getPaxInfo(b,c.levelData),d=f&&(f.uiQuantity||f.pnrQuantity)),d))return e=h.title,!0}.bind(this)),e},c.prototype._getIncludedListFor=function(b,c){var d,e,f,g,h=[];return b.ancillaryId===this._resourceBundle.ancillaryIds.BAG?this._getIncludedListForBag(b,c):(a.forEach(c,function(c,i){e=!1,f=!1,a.forEach(b.levelMap,function(a,c){d=b.level===this.levels.O_AND_D?{oAndDId:c}:null,g=b.getPaxInfo(i,d),0===g.finalPrice&&(e=!0)}.bind(this)),e||(f=this.getSelectedBundleParentName(b,i,{anyOAndD:!0})),(e||f)&&h.push({fullName:c.getFullName(),selectedParentBundleName:f})}.bind(this)),h)},c.prototype._getIncludedListForBag=function(b,c){var d,e=[],f={};return this._getSelectedFares().forEach(function(a){this._tiersWithFreeBags.indexOf(a.tier)!==-1&&(f[a.oAndDId]=a.tier)}.bind(this)),a.forEach(c,function(c){c.frequentFlyer&&c.frequentFlyer.freeBagAllowance?e.push({fullName:c.getFullName(),freeBagAllowance:c.frequentFlyer.freeBagAllowance,oAndDTierMap:f,guestId:c.guestId}):(d=this.getSelectedBundleParentName(b,c.guestId,{anyOAndD:!0}),d?e.push({fullName:c.getFullName(),freeBagAllowance:1,selectedParentBundleName:d,oAndDTierMap:f,guestId:c.guestId}):a.equals(f,{})||e.push({oAndDTierMap:f,guestId:c.guestId}))}.bind(this)),e},c.prototype.resetUISelections=function(){this._ancillaries.forEach(function(a){a.clearSelectionData(this.selectionTypes.UI,!0)}.bind(this))},c.prototype.registerToggle=function(a,b,c,d){this._toggleMap[a]=this._toggleMap[a]||{},this._toggleMap[a][b]=this._toggleMap[a][b]||{},this._toggleMap[a][b][c]=d},c.prototype.onAncillaryToggle=function(a,b,c,d,e){var f=a===this.toggleAction.ADD,g=f?b.add(c,d):b.remove(c,d);g&&(b.isBundle&&this._updateChildrenWithParentSelection(b),b.mcCostExempt&&(this._ancAndPaxSeatInfo={},e&&this._$singleTimeout(this._refreshSeatmaps.bind(this,d))),this.setIncludedListData(),this._setGroupPricePerAncillary(b,f,g.finalPrice),this._$singleTimeout(function(){this._pubSubService.publish("ancillaries.updateCollapsedInfoList"),this._pubSubService.publish("ancillaries.refreshView"),this.refreshAncillariesForChangeFlow(!0)}.bind(this)))},c.prototype._refreshSeatmaps=function(a){this._getSelectedFares().forEach(function(b){(a.PNR||a.oAndDId===b.oAndDId)&&b.legs.forEach(function(a){this._seatService.getSeatMaps(!1,[a.segNum])}.bind(this))}.bind(this))},c.prototype._updateChildrenWithParentSelection=function(a){a.bundledAncillaryList.forEach(function(b){this._ancillaryFullySelectedParentMap&&this._ancillaryFullySelectedParentMap[b]&&(this._isFullySelected(a.ancillaryId,b)?this._ancillaryFullySelectedParentMap[b].push(a.ancillaryId):this._ancillaryFullySelectedParentMap[b]=this._ancillaryFullySelectedParentMap[b].filter(function(b){return a.ancillaryId!==b}))}.bind(this))},c.prototype._isFullySelected=function(b,c){var d,e,f=this._fareData.IP2&&this._getAncillaryById(c),g=f&&f.level===this.levels.PNR,h=g?"some":"every",i=!0;return this._toggleMap&&this._toggleMap[b]?a.forEach(this._toggleMap[b],function(a){e=Object.keys(a),d=e[h](function(b){return a[b].isAvailableAndSelected()||a[b].isIncluded}),i=i&&d}):i=!1,i},c.prototype.setAncillaryQuantityTo1=function(a){this._getTogglesByAncId(a).forEach(function(a){a.setQuantityTo1()})},c.prototype.setAncillaryQuantityTo0=function(a){this._getTogglesByAncId(a).forEach(function(a){a.setQuantityTo0()})},c.prototype.atLeastOneCheckedAncillary=function(a){return this._getTogglesByAncId(a).some(function(a){return a.isAvailableAndSelected()})},c.prototype.atLeastOneUncheckedAncillary=function(a){return this._getTogglesByAncId(a).some(function(a){return a.isUncheckedAndAvailable()})},c.prototype.noAvailableAncillaries=function(a){return this._getTogglesByAncId(a).every(function(a){return!a.isAvailable()})},c.prototype._buildFormattedAvailableAncillaryList=function(){this._formattedAvailableAncillaryList=[],this._fareData={};var b,c,d,e,f=this._getSelectedFares(),g=this._tripService.getTripType(),h=f.some(function(a){return this._tiersWithFreeBags.indexOf(a.tier)>-1||this._ancillaryEnabledTiers.indexOf(a.tier)<0}.bind(this)),i=["PNR"],j=[];this._fareData.PNR={airportCodes:[],tripType:g},a.forEach(f,function(a){j.push(a.oAndDId),b=this._fareData[a.oAndDId]={airportCodes:[],tier:h&&a.tier},b.departure=a.legs[0].departure,b.arrival="nonStop"===a.flightType?a.legs[0].arrival:a.legs[a.legs.length-1].arrival,b.airportCodes.push(b.departure,b.arrival),this._fareData.PNR.airportCodes.push(b.departure,b.arrival)}.bind(this)),d=this._fareService.getActiveCurrency();var k=this.getAvailableAncillaries(!0);a.forEach(k,function(a){e="POINTS"!==d||a.pointsBookingEligible;var b={_model:a,ancillaryId:a.ancillaryId,description:a.description,maxQuantity:a.maxQuantity,title:a.title,levelList:[],isBag:a.ancillaryId===this._resourceBundle.ancillaryIds.BAG,bundleFeatures:a.bundleFeatures,isBundle:a.isBundle,includedListData:[],isFreeForAllPax:0===a.maxPrice,bundleId:a.bundleId||a.ancillaryId,isEligibleForActiveCurrency:e,maxPrice:a.maxPrice};a.ancillaryId===this._resourceBundle.ancillaryIds.POWER&&(b.callToAction="Bundle & save 30-50%"),1===a.maxQuantity&&(this._ancillaryFullySelectedParentMap[b.bundleId]=[]),c=a.level===this.levels.PNR?i:j,c.forEach(function(c){b.levelList.push({id:c,includedInTier:this._areAncillariesIncludedInTier(a,c),notEligible:!a.levelMap[c]})}.bind(this)),b.levelList.sort(function(a,b){return a.id<b.id?-1:1}),this._formattedAvailableAncillaryList.push(b)}.bind(this)),a.forEach(k,function(a){a.isBundle&&this._updateChildrenWithParentSelection(a)}.bind(this))},c.prototype._areAncillariesIncludedInTier=function(a,b){var c,d;return!(a.level!==this.levels.O_AND_D||a.maxQuantity>1)&&this._getSelectedFares().some(function(a){return c=b===a.oAndDId,d=this._ancillaryEnabledTiers.indexOf(a.tier)<0,c&&d}.bind(this))},c.prototype.getFormattedAvailableAncillaryList=function(a){var b;return a?(b=this._locationService.getContext().toUpperCase(),this._formattedAvailableAncillaryList.filter(function(a){return a._model.activeInSeatMapContext[b]&&this.atLeastOneUncheckedAncillary(a.ancillaryId)&&!this.hasFullySelectedParent(a.ancillaryId)&&a.isEligibleForActiveCurrency}.bind(this))):this._formattedAvailableAncillaryList},c.prototype.getSiblingToggle=function(b){var c,d=this._toggleMap[b.ancillary.ancillaryId]&&this._toggleMap[b.ancillary.ancillaryId][b.guestId];return a.forEach(d,function(a,d){d!==b.level&&(c=a)}),c},c.prototype.getFareData=function(){return this._fareData},c.prototype.hasFullySelectedParent=function(a){return this._ancillaryFullySelectedParentMap[a]&&this._ancillaryFullySelectedParentMap[a].length},c.prototype.setIncludedListData=function(){var a=this._travelerService.getAllTravelers();this._formattedAvailableAncillaryList.forEach(function(b){b.includedListData=this._getIncludedListFor(b._model,a)}.bind(this))},c.prototype._setGroupPricePerAncillary=function(a,b,c){this._groupPricePerAncillary[a.ancillaryId]=this._groupPricePerAncillary[a.ancillaryId]||0,b?this._groupPricePerAncillary[a.ancillaryId]+=c:this._groupPricePerAncillary[a.ancillaryId]-=c,this.publishTotalPrice()},c.prototype._getTotalAncillariesPrice=function(){var a=0;return this.getAllSelectedAncillaries().forEach(function(b){a+=b.getTotalCost()}),a},c.prototype.publishTotalPrice=function(){var a=0;this.getAllSelectedAncillaries().forEach(function(b){a+=this._isExistingChange()?b.getTotalCost(this.selectionTypes.UI):b.getTotalCost()}.bind(this)),this._pubSubService.publish("ancillaries.newUIAmount",[a])},c.prototype.getGroupPricePerAncillary=function(){return this._groupPricePerAncillary},c.prototype._getTogglesByAncId=function(b){var c=[];return a.forEach(this._toggleMap[b],function(b){a.forEach(b,function(a){c.push(a)})}),c},c.prototype.getMaxPriceFor=function(a){var b=this._getAncillaryById(a);return b?b.maxPrice:0},c.prototype.getCheckInTravelerInfoForAncillary=function(b,c){var d,e,f,g,h,i,j={},k=this._travelerService.getAllTravelers(),l=this.getSelectedAncillaries([this.selectionTypes.PNR]).filter(function(a){return a.isBundle});return a.forEach(k,function(k){"INFANT"!==k.travelerType&&(d=!1,e=!1,f=!1,g=!1,h=b.getPaxInfo(k.guestId,c),a.isUndefined(h)||a.isUndefined(h.finalPrice)?e=!0:0===h.finalPrice&&b.autoApply||h.pnrQuantity?d=!0:h.uiQuantity?f=!0:(d=l.some(function(a){if(a.bundledAncillaryList.indexOf(b.ancillaryId)>-1||a.bundledAncillaryList.indexOf(b.bundleId)>-1)return i=a.getPaxInfo(k.guestId,c),i&&i.pnrQuantity}),d||(g=!0)),j[k.guestId]={traveler:k,isIncluded:d,isUnavailable:e,isSelected:f,isAvailable:g})}.bind(this)),j},c.prototype.shouldShowCheckInAncillaries=function(b){var c,d=!1;return this.getAvailableAncillaries().forEach(function(e){d||(c=this.getCheckInTravelerInfoForAncillary(e,{oAndDId:b}),a.forEach(c,function(a){a.isAvailable&&(d=!0)}))}.bind(this)),d},c.prototype.publishAnalyticsData=function(){this.updateAnalyticsData(),this._pubSubService.publish("adobeAnalytics.skippedOrSelectedExtras",[this._buildAnalyticsData()])},c.prototype.updateAnalyticsData=function(a,b){var c;c=a?this._getSeatMapModalContext():this._getAncSelectorContext(),this._adobeAnalyticsService.updateWebData(this._adobeAnalyticsService.WEB_DATA_KEYS.ANCILLARY_SELECTIONS,this._buildAnalyticsData(a,b)),this._adobeAnalyticsService.updateWebData(this._adobeAnalyticsService.WEB_DATA_KEYS.ANCILLARY_LOCATION,c)},c.prototype._buildAnalyticsData=function(b,c){var d,e,f,g,h=this._getAncSelectorContext(),i=this._getSeatMapModalContext(),j=b?i:h;return b&&!c||(this._analyticsData[j]=this._getCurrentAnalyticsQuantities(c||this.getFormattedAvailableAncillaryList())),f=this._analyticsData[h],e=this._getAnalyticsAncillariesSelected(f),d=this._$interpolate("| {{context}}{{declined}} ({{selections}}) |")({context:h,declined:e?"":" declined",selections:this._analyticsStringifiedData(f)}),b&&(g=this._analyticsData[i],a.forEach(g,function(a,b){f[b]&&(a.quantity-=f[b].quantity,a.quantity<0&&(a.quantity=0))}),e=this._getAnalyticsAncillariesSelected(g),d+=this._$interpolate(" {{context}}{{declined}} ({{selections}}) |")({context:i,declined:e?"":" declined",selections:this._analyticsStringifiedData(g)})),d},c.prototype._getAncSelectorContext=function(){var a=this._adobeAnalyticsService.ANCILLARY_CONTEXTS;switch(this._locationService.getContext()){case this._locationService.contexts.BOOK:return a.BOOKING_ANCILLARY_SCREEN;case this._locationService.contexts.CHANGE:return this._isExistingChange()?a.EXISTING_CHANGE_ANCILLARY_SCREEN:a.NEW_CHANGE_ANCILLARY_SCREEN;case this._locationService.contexts.CHECKIN:return a.CHECKIN_ANCILLARY_SCREEN}},c.prototype._getSeatMapModalContext=function(){var a=this._adobeAnalyticsService.ANCILLARY_CONTEXTS;switch(this._locationService.getContext()){case this._locationService.contexts.BOOK:return a.BOOKING_SEATMAP_MODAL;case this._locationService.contexts.CHANGE:return this._isExistingChange?a.EXISTING_CHANGE_SEATMAP_MODAL:a.NEW_CHANGE_SEATMAP_MODAL}},c.prototype._getPremiumSeatsContext=function(){var a=this._adobeAnalyticsService.ANCILLARY_CONTEXTS;switch(this._locationService.getContext()){case this._locationService.contexts.BOOK:return a.BOOKING_SEATMAP_PREMIUM_SEATS;case this._locationService.contexts.CHANGE:return this._isExistingChange?a.EXISTING_CHANGE_SEATMAP_PREMIUM_SEATS:a.NEW_CHANGE_SEATMAP_PREMIUM_SEATS}},c.prototype._getCurrentAnalyticsQuantities=function(b){var c,d,e,f,g={};return a.forEach(b,function(b){c=this._getAncillaryById(b.ancillaryId),d=c.title,e=0,f=c.getPaxQuantities(!0,this.selectionTypes.UI),a.forEach(f,function(a){e+=a}),c.isBundle&&(d+=" Bundle"),g[b.ancillaryId]={quantity:e,title:d}}.bind(this)),g},c.prototype._getAnalyticsAncillariesSelected=function(a){if(a)return Object.keys(a).some(function(b){return a[b]&&a[b].quantity})},c.prototype._analyticsStringifiedData=function(b){var c=[];return a.forEach(b,function(a){c.push(a.quantity+" "+a.title)}),c.join(", ")},c}),c("common/models/fare-model",["common/models/serial-model"],function(a){"use strict";var b=function(a){this.init(a)};return b.prototype=new a,b.prototype._schema={type:"object",properties:{base:{type:"number"},total:{type:"number"},points:{type:"integer"},isInternational:{type:"boolean",optional:"true"},fareBasisCode:{type:"string"},taxDetails:{type:"array",items:{type:"object",properties:{code:{type:"string"},amount:{type:"number"},name:{type:"string",optional:"true"}}}}}},b.prototype._deserializerMappings={pnr:{base:"BaseFare",total:"totalFare",taxDetails:{code:"taxCode",amount:"taxAmount"},fareBasisCode:"fareBasisCode"},fare:{base:"baseFare",total:"totalFare",isInternational:"international",taxDetails:{code:"taxCode",amount:"taxAmount",name:"taxName"}}},b.prototype._deserializeSelectedFare=function(a,b){b.base=a.cost.dollars.base,b.total=a.cost.dollars.total,a.cost.points&&(b.points=a.cost.points.totalPoints),b.taxDetails=[];for(var c in a.taxes){var d={code:c,amount:a.taxes[c]};b.taxDetails.push(d)}},b.prototype._customDeserializers={tripFare:b.prototype._deserializeSelectedFare},b}),c("common/models/purchase-model",["common/models/serial-model","common/models/payment-option-model"],function(a,b){"use strict";var c=function(a){this.init(a)};return c.prototype=new a,c.prototype._schema={type:"object",properties:{fares:{type:"array"},taxes:{type:"object"},hasTravelInsurance:{type:"boolean"},hasOptIn:{type:"boolean"},travelBank:{type:"object",properties:{accountNum:{type:"string"},balance:{type:"string"},isApplied:{type:"boolean"}}},paymentOption:"#/definitions/PaymentOption",paymentType:{type:"string"}},definitions:{PaymentOption:b.prototype._schema}},c.prototype._customTypes={PaymentOption:b},c.PAYMENT_TYPE_MONEY="money",c.PAYMENT_TYPE_POINTS="points",c.prototype._serializerMappings={purchase:{paymentOption:b.prototype._serializerMappings.purchase}},c.prototype._deserializerMappings={purchase:{paymentOption:b.prototype._deserializerMappings.purchase}},c.prototype.isPaymentPoints=function(){return this.paymentType===c.PAYMENT_TYPE_POINTS},c}),c("common/models/seat-flight-list-model",["angular","common/models/traveler-model","common/models/serial-model"],function(a,b,c){"use strict";var d=function(a){this.init(a),this._regex={ALPHA:new RegExp("[^a-zA-Z\\s]","g")}};return d.prototype=new c,d.prototype._schema={type:"object",properties:{seatFlightList:{type:"array",items:{flightId:{type:"number"},flightNum:{type:"string"},paxSeatList:{type:"array",items:{seat:{type:"object",properties:{pax:{type:"object",properties:{firstName:{type:"string"},guestId:{type:"string"},lastName:{type:"string"}}},seatNum:{type:"string"}}}}}}}}},d.prototype._travelerInfoDeserialize=function(c,d,e){var f=[],g={flightId:null,flightNum:null,paxSeatList:[]};a.forEach(c,function(c){a.forEach(c.seats,function(h){"undefined"==typeof f[h.flightId]&&(f[h.flightId]=a.copy(g),f[h.flightId].flightNum=h.flightNum,f[h.flightId].flightId=h.flightId);var i={pax:{firstName:d._sanitizePaxName(c.firstName),lastName:d._sanitizePaxName(c.lastName),guestId:c.guestId},seatNum:h.seatNumber,mcCostExempt:b.isMcCostExempt(e.ancillaries,h.oAndDId,c.guestId)};f[h.flightId].paxSeatList.push(i)})}),d.seatFlightList=f.filter(function(a){return a})},d.prototype._seatInfoListDeserialize=function(a,b){b.seatFlightList=a},d.prototype._customDeserializers={travelerInfo:d.prototype._travelerInfoDeserialize,seatInfoList:d.prototype._seatInfoListDeserialize},d.prototype._serializerMappings={seatFlightList:{seatFlightList:"seatFlightList"}},d.prototype._sanitizePaxName=function(a){return a.replace(this._regex.ALPHA,"").trim()},d}),c("common/models/price-summary-info-model",["angular","common/models/serial-model"],function(a,b){
"use strict";var c=function(a){this.init(a)};return c.prototype=new b,c.prototype._schema={type:"object",properties:{total:{type:"number"},totalExtras:{type:"number"},totalBaseFareAndExtras:{type:"number"},totalBaseFare:{type:"number",optional:!0},totalFare:{type:"number",optional:!0},totalTax:{type:"number",optional:!0},totalPoints:{type:"number",optional:!0},paxAmount:{type:"number",optional:!0},totalTaxList:{type:"array",optional:!0,items:{taxAmount:{type:"number"},taxCode:{type:"string"}}}}},c.prototype._deserializeTaxes=function(a){var b,c,d,e={};for(b=0,c=a.length;b<c;b++)d=a[b],e[d.taxCode]=d.taxAmount;return e},c.prototype._priceSummaryInfoDeserialize=function(b,c){a.extend(c,{total:b.total,totalExtras:b.totalExtras,totalBaseFare:b.totalBaseFare,totalFare:b.totalFare,totalBaseFareAndExtras:b.totalBaseFareAndExtras,totalTax:b.totalTax,totalPoints:b.totalPoints,paxAmount:b.numOfPax,totalTaxList:a.isArray(b.totalTaxList)?c._deserializeTaxes(b.totalTaxList):{}})},c.prototype._customDeserializers={priceSummaryInfo:c.prototype._priceSummaryInfoDeserialize},c}),c("common/models/quote-model",["angular","common/models/serial-model","common/models/seat-flight-list-model","common/models/price-summary-info-model"],function(a,b,c,d){"use strict";var e=function(a){this.init(a)};return e.prototype=new b,e.prototype.PAYMENT_TYPE={ALL:"ALL",CC_REQUIRED:"CC_REQUIRED"},e.prototype.EXCHANGE_TYPE={PAYMENT:"Payment",NO_PAYMENT:"NoPayment",REFUND:"Refund",AER_PAYMENT:"AerPayment",AER_NO_PAYMENT_REFUND:"AerNoPaymentRefund",AER_REFUND:"AerRefund"},e.prototype._schema={type:"object",properties:{seatInfoList:"#/definitions/SeatFlightListModel",priceSummaryInfo:"#/definitions/PriceSummaryInfoModel",totalSeatPrice:{type:"number"}}},e.prototype._bookingDeserializer=function(b,e){var f=a.element(document.body).injector().get("ResourceBundle");if(b.seatInfo){var g=new c;g.deserialize(b.seatInfo.seatFlightList,"seatInfoList"),e.seatInfoList=g.seatFlightList}e.priceSummaryInfo=new d,e.priceSummaryInfo.deserialize(b.priceSummaryInfo,"priceSummaryInfo"),e.totalSeatPrice=0,b.ancillaryDetails&&b.ancillaryDetails.summaryList&&b.ancillaryDetails.summaryList.some(function(a){if(a.ancillaryId===f.ancillaryIds.SEAT)return e.totalSeatPrice=a.totalAmount,!0})},e.prototype._customDeserializers={booking:e.prototype._bookingDeserializer},e}),c("common/services/purchase",["angular","jquery","common/models/payment-option-model","common/models/address-model","common/models/fare-model","common/models/purchase-model","common/models/quote-model","common/models/seat-flight-list-model","common/models/traveler-model"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=function(a,b,c,d,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t){this._cms=s,this._api=r,this._$q=q,this._pnrService=a,this._tripService=b,this._travelerService=c,this._fareService=d,this._elevateService=e,this._bookingTimerService=g,this._pubSubService=h,this._persistenceService=i,this._resourceBundle=j,this._statusService=k,this._loadingService=l,this._ancillariesService=m,this._locationService=n,this._seatService=o,this._utilsService=p,this._$deviceProvider=t,this._purchaseSelectedModel=new f,this._travelBankInfoRequestModel={userName:null,password:null},this._creditCardList=[],this._addressList=[],this._flightTypes={nonStop:"Non-stop",connecting:"Connecting",thru:"Thru"},this._tierMap={0:["main"],1:["mainRefundable"],2:["mcs"],3:["mcsRefundable"],4:["first"],5:["firstRefundable"]},this._topTier=null,this._travelInsuranceAmount=0,this._travelInsuranceAvailability=!1,this._purchaseResponseModel,this._cmsPurchaseData,this._pectLegs={},this._elevateAccountInfo,this._elevateTier,this.activeView;var u={HOME:"/purchase",ADD_CARD:"/purchase/add",COMPLETE:"/purchase/complete",TRAVEL_BANK:"/purchase/travel-bank"},v={HOME:"select",ADD_CARD:"credit-card",COMPLETE:"selected",TRAVEL_BANK:"travelbank"};return this._selectedFares=null,this.setActiveCurrency("DOLLAR"),h.subscribe("ancillaries.newUIAmount",this.calculateCostAndTaxes.bind(this)),this._pubSubService.subscribe("ancillaries.resetUIAncillaries",function(){this._locationService.contextIs(this._locationService.contexts.BOOK)&&this.calculateCostAndTaxes()}.bind(this)),this._apiErrorField=null,this._pubSubService.subscribe("creditCard.invalidCVV",function(){this._apiErrorField="securityNumber"}.bind(this)),this._petcFails=[],{urlConstants:u,viewConstants:v,getTravelers:this.getTravelers.bind(this),updateTravelers:this.updateTravelers.bind(this),setFares:this.setFares.bind(this),getFares:this.getFares.bind(this),getTaxes:this.getTaxes.bind(this),getTotalTaxes:this.getTotalTaxes.bind(this),getCurrency:this.getCurrency.bind(this),setActiveCurrency:this.setActiveCurrency.bind(this),data:function(){return this._purchaseSelectedModel}.bind(this),getApiErrorField:this.getApiErrorField.bind(this),setApiErrorField:this.setApiErrorField.bind(this),getTravelInsurance:this.getTravelInsurance.bind(this),setTravelInsurance:this.setTravelInsurance.bind(this),setTravelBankCredentials:this.setTravelBankCredentials.bind(this),getTravelBankInfo:this.getTravelBankInfo.bind(this),retrieveTravelBankInfo:this.retrieveTravelBankInfo.bind(this),getAppliedTravelBank:this.getAppliedTravelBank.bind(this),setAppliedTravelBank:this.setAppliedTravelBank.bind(this),getRemainingValue:this.getRemainingValue.bind(this),getActualTravelBankAmount:this.getActualTravelBankAmount.bind(this),getCreditCardList:this.getCreditCardList.bind(this),getAddressList:this.getAddressList.bind(this),getBillingAddress:this.getBillingAddress.bind(this),getPaymentView:this.getPaymentView.bind(this),addCreditCard:this.addCreditCard.bind(this),removeCreditCard:this.removeCreditCard.bind(this),getOptIn:this.getOptIn.bind(this),setOptIn:this.setOptIn.bind(this),setCVV:this.setCVV.bind(this),updateAccountInfo:this.updateAccountInfo.bind(this),updateElevateTier:this.updateElevateTier.bind(this),formatFares:this.formatFares.bind(this),getTopTier:this.getTopTier.bind(this),populateWithStubData:this.populateWithStubData.bind(this),purchase:this.purchase.bind(this),getPurchaseResponse:this.getPurchaseResponse.bind(this),getTravelInsuranceAmount:this.getTravelInsuranceAmount.bind(this),getTravelInsuranceAvailability:this.getTravelInsuranceAvailability.bind(this),updateTravelInsurance:this.updateTravelInsurance.bind(this),getAvailablePETC:this.getAvailablePETC.bind(this),setView:this.setView.bind(this),getView:this.getView.bind(this),editCreditCard:this.editCreditCard.bind(this),getSelectedFares:this.getSelectedFares.bind(this),setSelectedFares:this.setSelectedFares.bind(this),reset:this.reset.bind(this),calculateCostAndTaxes:this.calculateCostAndTaxes.bind(this),setChangeQuote:this.setChangeQuote.bind(this),setCancelQuote:this.setCancelQuote.bind(this),buildPaymentInfoRequest:this._buildPaymentInfoRequest.bind(this),loadDynamicFareRules:this.loadDynamicFareRules.bind(this),setLockInventoryFares:this.setLockInventoryFares.bind(this),petsErrorMessage:this.petsErrorMessage.bind(this),requestQuote:this.requestQuote.bind(this),setCheckInExtraPaymentAmount:this.setCheckInExtraPaymentAmount.bind(this),resetQuoteModel:this.resetQuoteModel.bind(this),hasDollarOrRefundAmounts:this.hasDollarOrRefundAmounts.bind(this),calculatePetsCost:this.calculatePetsCost.bind(this)}};return j.$inject=["pnrService","tripService","travelerService","fareService","elevateService","bookingTimerService","pubSubService","persistenceService","ResourceBundle","statusService","loadingService","ancillariesService","locationService","seatService","utilsService","$q","api","cms","$deviceProvider"],j.prototype.reset=function(){var a=this.getCurrency();this._selectedFares=[],this._creditCardList=[],this._addressList=[],this._pectLegs={},this._topTier=null,this._purchaseSelectedModel=new f,this._travelInsuranceAmount=0,this._travelInsuranceAvailability=!1,this._lockInventoryNewFares=null,this.setActiveCurrency(a),this.calculateCostAndTaxes()},j.prototype.setView=function(a){this.activeView=a},j.prototype.getView=function(){return this.activeView},j.prototype.getTravelers=function(){return this._purchaseSelectedModel.travelers},j.prototype.updateTravelers=function(a){this._purchaseSelectedModel.travelers=a},j.prototype.getFares=function(){return this._purchaseSelectedModel.fares},j.prototype.getSelectedFares=function(){return this._selectedFares},j.prototype.setSelectedFares=function(a){this._selectedFares=[];var b=[];for(var c in a)b.push(a[c].information),this._selectedFares[c]=a[c].information._rawData;this._purchaseSelectedModel.fares=b,this.calculateCostAndTaxes()},j.prototype.setFares=function(a){this._purchaseSelectedModel.fares=a,this.calculateCostAndTaxes()},j.prototype._setQuote=function(a){this._purchaseSelectedModel.quote=a,this.calculateCostAndTaxes()},j.prototype.resetQuoteModel=function(){delete this._purchaseSelectedModel.quote,this._ancillariesService.setSeatInfo(),this.calculateCostAndTaxes()},j.prototype.setCheckInExtraPaymentAmount=function(a){this._purchaseSelectedModel.checkInExtraPaymentAmount=a},j.prototype.setChangeQuote=function(a){this._purchaseSelectedModel.quote=a,this.calculateCostAndTaxesForChangeFlight()},j.prototype.setCancelQuote=function(a){this._purchaseSelectedModel.quote=a,this.calculateCostAndTaxesForCancelFlight()},j.prototype.getTaxes=function(){return this._purchaseSelectedModel.taxes},j.prototype.getTotalTaxes=function(){return this._purchaseSelectedModel.totalTaxes},j.prototype.getCurrency=function(){return this._purchaseSelectedModel.currency},j.prototype.getApiErrorField=function(){return this._apiErrorField},j.prototype.setApiErrorField=function(a){this._apiErrorField=a},j.prototype.updateTravelInsurance=function(a,b){var c=this._fareService.getSelectedFares();if(c&&c[0]&&c[0].legs&&c[0].legs[0]&&c[0].legs[0].departureDateTime){var d=c[0].legs[0].departureDateTime,e=c[c.length-1].legs,f=e[Object.keys(e).length-1];f=f.arrivalDateTime;var g=c[0].legs[0].classOfService,h=this._tripService.getIsInternational(),i={totalPax:this._tripService.getTotalPayingTravelers(),totalFare:this._purchaseSelectedModel.totalFare,departureDate:d,returnDate:f,classOfService:g,international:h,country:a,state:b};this._api.booking.checkTravelInsurance(i).then(function(a){"AVAILABLE"===a.data.response.availability&&"DOLLAR"===this.getCurrency()?(this._travelInsuranceAvailability=!0,this._travelInsuranceAmount=a.data.response.totalPremiumAmount,this.calculateCostAndTaxes()):(this._travelInsuranceAvailability=!1,this.setTravelInsurance(!1))}.bind(this))}},j.prototype.getTravelInsuranceAvailability=function(){return this._travelInsuranceAvailability},j.prototype.getTravelInsuranceAmount=function(){return this._travelInsuranceAmount},j.prototype.getTravelInsurance=function(){return this._purchaseSelectedModel.hasTravelInsurance},j.prototype.setTravelInsurance=function(a){this._purchaseSelectedModel.hasTravelInsurance=a,this.calculateCostAndTaxes()},j.prototype.calculatePetsCost=function(){var b=0,c=this._tripService.getSelectedTripPublicModel().travelers.pets;return c>0&&a.forEach(this._pectLegs,function(a){b+=a*c}),b},j.prototype.calculateCostAndTaxes=function(){if(!this._locationService.contextIs(this._locationService.contexts.CHANGE)){var b=0,c=0,d=this._purchaseSelectedModel.quote&&this._purchaseSelectedModel.quote.priceSummaryInfo,e=0,f=0,g=0,h=0,i=0,j=this._tripService.getPayingTravelerAmount(),k=this._tripService.getSelectedTripPublicModel().travelers.pets;d?(c=d.totalBaseFare,f=d.total,g=d.totalFare,h=d.totalPoints,e=d.totalExtras,b+=j,i=d.totalTax):this._lockInventoryNewFares&&Object.size(this._lockInventoryNewFares)?(f=this._lockInventoryNewFares.totalFare,c=this._lockInventoryNewFares.totalBaseFare,h=this._lockInventoryNewFares.totalPoints,a.forEach(this._lockInventoryNewFares.fareDetails,function(a){b+=j,i+=a.taxPerPax*a.paxAmount}),g=f):(a.forEach(this._purchaseSelectedModel.fares,function(a){"undefined"!=typeof a&&(b+=j,c+=a.totalBaseFare,f+=a.totalFare,i+=a.totalTax,a.totalPoints&&(h+=a.totalPoints))},this),g=f);var l=this.calculatePetsCost();l>0&&(f+=l,d&&(e-=l,f-=l));var m=this._purchaseSelectedModel.hasTravelInsurance,n=this._travelInsuranceAmount;if(m&&n&&(f+=n,i+=n),!d){var o=this._ancillariesService.getUIAncillariesAmount();o&&(e+=o,f+=o)}this._purchaseSelectedModel.checkInExtraPaymentAmount&&(e+=this._purchaseSelectedModel.checkInExtraPaymentAmount,f+=this._purchaseSelectedModel.checkInExtraPaymentAmount),this._purchaseSelectedModel.totalFares=b,this._purchaseSelectedModel.baseDollars=c,this._purchaseSelectedModel.totalDollars=f,this._purchaseSelectedModel.totalPoints=h,this._purchaseSelectedModel.totalTaxes=i,this._purchaseSelectedModel.totalFare=g,this._purchaseSelectedModel.petcTax=l,this._purchaseSelectedModel.paidPets=k,this._purchaseSelectedModel.totalExtras=e}},j.prototype.calculateCostAndTaxesForChangeFlight=function(){var b=0,c=0,d={},e=0,f=this._ancillariesService.getAPIAncillariesAmount()||0,g=this._tripService.getPayingTravelerAmount(),h=this._purchaseSelectedModel.quote,i=h.extraRefundAmount,j=h.newFareInfo;b+=g,c+=j.base,a.forEach(j.taxDetails,function(a){d[a.code]=d[a.code]||0,d[a.code]+=a.amount}),a.forEach(d,function(a){e+=a});var k=0,l=0;for(var m in h.seatInfoList){var n=h.seatInfoList[m].paxSeatList;for(var o in n)n[o].amount&&(k+=n[o].amount,l++)}this._purchaseSelectedModel.totalExtras=f,this._purchaseSelectedModel.extrasRefund=i,this._purchaseSelectedModel.totalFares=b,this._purchaseSelectedModel.baseDollars=c,this._purchaseSelectedModel.totalDollars=h.totalAmount,this._purchaseSelectedModel.taxes=d,this._purchaseSelectedModel.totalTaxes=e,this._purchaseSelectedModel.changeFee=h.changeFee,this._purchaseSelectedModel.seatTotalFares=l,this._purchaseSelectedModel.seatUpgradeValue=k},j.prototype.calculateCostAndTaxesForCancelFlight=function(){var b=0,c=0,d={},e=0,f=this._tripService.getPayingTravelerAmount(),g=0,h=this._purchaseSelectedModel.quote,i=h.originalFareInfo;b+=f,c+=h.originalFareInfo.base,a.forEach(i.taxDetails,function(a){d[a.code]=d[a.code]||0,d[a.code]+=a.amount}),a.forEach(d,function(a){e+=a});var j=0,k=0;for(var l in h.seatInfoList){var m=h.seatInfoList[l].paxSeatList;for(var n in m)m[n].mce&&(j+=m[n].amount,k++)}this._purchaseSelectedModel.totalFares=b,this._purchaseSelectedModel.baseDollars=c,this._purchaseSelectedModel.totalDollars=h.totalAmount,this._purchaseSelectedModel.taxes=d,this._purchaseSelectedModel.totalTaxes=e,this._purchaseSelectedModel.totalUpgradeCosts=g,this._purchaseSelectedModel.changeFee=h.changeFee,this._purchaseSelectedModel.mceTotalFares=k,this._purchaseSelectedModel.mceUpgradeValue=j,this._purchaseSelectedModel.pointsAmount=h.pointsAmount,this._purchaseSelectedModel.cancelFee=h.cancelFee,this._purchaseSelectedModel.refundAmount=h.refundAmount,this._purchaseSelectedModel.totalFare=h.originalFareInfo.total},j.prototype.setActiveCurrency=function(a){this._purchaseSelectedModel.currency=a},j.prototype.getTotalCost=function(){return this._purchaseSelectedModel.totalCost},j.prototype.setTravelBankCredentials=function(a){this._travelBankInfoRequestModel.userName=a.username,this._travelBankInfoRequestModel.password=a.password},j.prototype.getTravelBankInfo=function(){return this._purchaseSelectedModel.travelBank},j.prototype.getRemainingValue=function(a){a=a||this._purchaseSelectedModel.currency;var b=this._purchaseSelectedModel.checkInExtraPaymentAmount,c="POINTS"===a?"totalTaxes":"totalDollars",d=b||this._purchaseSelectedModel[c];return d&&(d=parseFloat(d.toFixed(2))),"POINTS"===a&&(d+=this._purchaseSelectedModel.totalExtras,d+=this._purchaseSelectedModel.petcTax),this.getAppliedTravelBank()&&(d-=this.getActualTravelBankAmount()),d},j.prototype.getActualTravelBankAmount=function(a){a=a||this._purchaseSelectedModel.currency;var b=this._purchaseSelectedModel.checkInExtraPaymentAmount,c="POINTS"===a?"totalTaxes":"totalDollars",d=b||this._purchaseSelectedModel[c];b||(this._purchaseSelectedModel.quote&&this._purchaseSelectedModel.quote.priceSummaryInfo&&"POINTS"!==a?d=this._purchaseSelectedModel.quote.priceSummaryInfo.total:this._purchaseSelectedModel.quote&&this._purchaseSelectedModel.quote.cancelFee&&"POINTS"!==a?d=this._purchaseSelectedModel.quote.cancelFee:"POINTS"===a&&this._purchaseSelectedModel.totalExtras&&(d+=this._purchaseSelectedModel.totalExtras),this.getTravelInsurance()&&(d-=this.getTravelInsuranceAmount()));var e=0;return this._purchaseSelectedModel.travelBank&&this._purchaseSelectedModel.travelBank.balance&&(e=this._purchaseSelectedModel.travelBank.balance,e=Math.min(e,d)),e},j.prototype.retrieveTravelBankInfo=function(){var a=this._$q.defer(),b=function(){this._persistenceService.retrieve().then(a.resolve.bind(this),a.reject.bind(this))},c=this._persistenceService.getPrivateModel();return this._travelBankInfoRequestModel&&this._travelBankInfoRequestModel.userName&&this._travelBankInfoRequestModel.password?this._doGetTravelBankInfo().then(b.bind(this),a.reject.bind(this)):c&&c.travelBankAuthToken&&c.authToken?this._getTravelBankInfoFromElevate(c.travelBankAuthToken).then(b.bind(this),a.reject.bind(this)):a.resolve(),a.promise},j.prototype._doGetTravelBankInfo=function(){var a=this,b=this._$q.defer(),c={userName:this._travelBankInfoRequestModel.userName,password:this._travelBankInfoRequestModel.password};return this._api.booking.travelBankLogin(c).then(function(c){a._purchaseSelectedModel.travelBank={accountNum:c.data.response.tbAccntNum,balance:c.data.response.tbBalance,authToken:c.data.response.authToken,isApplied:!1},b.resolve(c.data)}).catch(function(a){b.reject(a)}),b.promise},j.prototype._getTravelBankInfoFromElevate=function(a){var b=this,c=this._$q.defer(),d={authToken:a};return this._api.elevate.travelBankBalance(d).then(function(d){d.data.response.hasTbAccount===!0&&(b._purchaseSelectedModel.travelBank={accountNum:d.data.response.accountNumber,balance:d.data.response.balance,authToken:a,isApplied:!1}),c.resolve(d.data)}).catch(function(a){c.reject(a)}),c.promise},j.prototype.setAppliedTravelBank=function(a){this._purchaseSelectedModel&&this._purchaseSelectedModel.travelBank&&(this._purchaseSelectedModel.travelBank.isApplied=a)},j.prototype.getAppliedTravelBank=function(){return this._purchaseSelectedModel.travelBank&&this._purchaseSelectedModel.travelBank.isApplied},j.prototype.getElevateAccountInfo=function(){var a={loginID:"fatester@gmail.com",loginPwd:"virgin123"};this._api.elevate.retrieveAccountInfo(a).then(function(a){})},j.prototype.getPaymentView=function(){return this._purchaseSelectedModel},j.prototype.hasDollarOrRefundAmounts=function(){return 0!==this._purchaseSelectedModel.totalDollars||this._purchaseSelectedModel.quote&&this._purchaseSelectedModel.quote.refundAmount&&0!==this._purchaseSelectedModel.quote.refundAmount},j.prototype._removeElevateTravelBank=function(){for(var a in this._creditCardList)if(this._creditCardList[a].type&&this._creditCardList[a].type.toLowerCase()===c.TRAVELBANK){this._creditCardList.splice(a,1);break}},j.prototype.getCreditCardList=function(){var a=this._purchaseSelectedModel.quote;return(!a||a.paymentType!==a.PAYMENT_TYPE.CC_REQUIRED)&&this._addTravelBankCard(),this._creditCardList},j.prototype._addTravelBankCard=function(){for(var a=!1,b=0;b<this._creditCardList.length;b++)if(this._creditCardList[b].type===c.TRAVELBANK){a=!0;break}a||this._creditCardList.push(new c({type:c.TRAVELBANK,summary:"This is where your Virgin America credit is stored"}))},j.prototype.getAddressList=function(){return this._addressList},j.prototype.getBillingAddress=function(){return this._purchaseSelectedModel.paymentOption.address},j.prototype.addCreditCard=function(a){this._creditCardList.push(a)},j.prototype.removeCreditCard=function(a){this._creditCardList.splice(a.sequenceNum-1,1)},j.prototype.editCreditCard=function(a,b){for(var c in this._creditCardList)this._creditCardList[c].guid===b&&(this._creditCardList[c]=a)},j.prototype.getOptIn=function(){return this._purchaseSelectedModel.hasOptIn},j.prototype.setOptIn=function(a){this._purchaseSelectedModel.hasOptIn=a},j.prototype.setCVV=function(a){var b=this._purchaseSelectedModel.paymentOption.securityCode;"undefined"==typeof b&&(this._purchaseSelectedModel.paymentOption.securityCode=a)},j.prototype.updateAccountInfo=function(b){b&&(this._elevateAccountInfo=b,b.creditCardInfo&&(this._creditCardList=a.copy(b.creditCardInfo),this._removeElevateTravelBank()),b.addressInfo&&(this._addressList=b.addressInfo))},j.prototype.updateElevateTier=function(a){this._elevateTier=a},j.prototype._getFlightTypeLabel=function(a){return this._flightTypes[a]},j.prototype.formatFares=function(b){var c,d=[],e=0;return a.forEach(b,function(b,f){c=a.copy(b),c.flightType=this._getFlightTypeLabel(c.flightType),a.forEach(this._tierMap,function(a,b){a.indexOf(c.tier)>-1&&(!e||e<b)&&(e=parseInt(b,10))}),this._topTier=e,c.trip={},a.forEach(b.legs,function(a,b){0===parseInt(b,10)&&(c.trip.departureTime=a.departureTime,c.trip.flightNum=a.flightNum),0===f&&0===parseInt(b,10)&&(c.trip.classOfService=a.classOfService),parseInt(b,10)===c.legs.length-1&&(c.trip.arrivalTime=a.arrivalTime)}),d.push(c)},this),d},j.prototype.getTopTier=function(){return this._topTier},j.prototype.populateWithStubData=function(){var a={title:"My Home (Primary)",name:"Michael Evans",addressOne:"66 Water St.",addressTwo:"Apt. 4",city:"Brooklyn",state:"NY",zipCode:11210,country:"United States"},b={ccNumber:0x3f28cb71571c7,securityCode:123,paymentAmount:1e4,type:"VISA",expiryDate:"14-14-14",address:a,nickname:"foo",shouldSave:!0},c=[{tier:"main",flightType:"nonStop",cost:{dollars:{base:475.35,total:522},points:null},taxes:{US1:35.65,ZP:4,XF:4.5,AY:2.5},legs:{0:{arrival:"BOS",arrivalTime:"7:25am",arrivalDateTime:"2014-01-13 07:25 EST",classOfService:"B",classLabel:"Main Cabin",duration:"5h 35m",departure:"SFO",departureTime:"10:50pm",departureDateTime:"2014-01-12 22:50 PST",flightNum:"358"}}},{tier:"main",flightType:"nonStop",cost:{dollars:{base:259.53,total:290},points:{total:12976}},taxes:{US1:19.47,ZP:4,XF:4.5,AY:2.5},legs:{0:{arrival:"SFO",arrivalTime:"12:30pm",arrivalDateTime:"2014-01-15 12:30 PST",classOfService:"M",classLabel:"Main Cabin",duration:"6h 50m",departure:"BOS",departureTime:"8:40am",departureDateTime:"2014-01-14 08:40 EST",flightNum:"351"}}}],d={accountNum:123456789,balance:150,isApplied:!1};this._purchaseSelectedModel.travelBank=d,this._purchaseSelectedModel.paymentOption=b,this.addCreditCard(b),this.setFares(c),this.setActiveCurrency("DOLLAR")},j.prototype.getPurchaseResponse=function(){return this._purchaseResponseModel},j.prototype._getFeeAmount=function(){var a=this.getTaxes(),b=0;for(var c in a)b+=a[c];return b},j.prototype._buildCreditCardInfo=function(a){var c={},d=a.address,e=this._elevateService.isLoggedIn(),f=a.shouldSave||!a.sequenceNum||a.isEditingPayment;return f?(c=a.serialize("purchase"),e?(c.mapAddressId=d.sequenceNum||0,c.attachToProfile=!!a.shouldSave,!a.callid&&!a.sequenceNum&&(c.sequenceNum=0)):(delete c.sequenceNum,delete c.mapAddressId,delete c.identifiedName)):(d=b.isArray(d)?d[0]:d,c={sequenceNum:a.sequenceNum,mapAddressId:d.sequenceNum,securityCode:a.securityCode}),c},j.prototype._isTravelBank=function(a){return"TRAVELBANK"===a.type},j.prototype._getTravelBankInfo=function(){var a;if(this._locationService.contextIs(this._locationService.contexts.BOOK))a={};else{var b=this._purchaseSelectedModel.travelBank;a={accountNumber:b.accountNum,balance:b.balance,authToken:b.authToken}}return a},j.prototype._buildPaymentInfoRequest=function(a){var b={};if(this._elevateService.isLoggedIn()&&"POINTS"===this.getCurrency())b.pointsDetails={},this.getAppliedTravelBank()||this._isTravelBank(a)?b.pointsDetails.travelBankInfo={}:b.pointsDetails.creditCardInfo=this._buildCreditCardInfo(a);else if(this.getAppliedTravelBank()||this._isTravelBank(a))if(this.getRemainingValue()||this.getTravelInsurance()){var c=this._buildCreditCardInfo(a);c.paymentAmount=this.getRemainingValue(),b.multipleFormInfo={travelBankInfo:this._getTravelBankInfo(),creditCardInfo:c}}else b.travelBankInfo=this._getTravelBankInfo();else if(a){var d=this._buildCreditCardInfo(a);d.paymentAmount=this._purchaseSelectedModel.totalDollars,b.creditCardInfo=d}else b=null;return b},j.prototype.sanitizePaxName=function(a){return a.replace(/[^a-zA-Z ]/g,"").trim()},j.prototype.purchase=function(){var c,d,e=this._fareService.getSelectedFares(),f=this._purchaseSelectedModel,g=this._ancillariesService.getSelectedAncillaries(),h=this._travelerService.getAllTravelers(),j={};this.hasDollarOrRefundAmounts()?(!this.getAppliedTravelBank()||f.paymentOption&&f.paymentOption.address?(j=f.paymentOption,j.type=j.type.toUpperCase(),"TRAVELBANK"===j.type&&(j.address=this._defaultTravelBankAddress())):j.address=this._defaultTravelBankAddress(),d=j.address,c=d.serialize("purchase")):c=f.paymentOption.address;var k=this._travelerService.getTravelersByKey("primary",!0)[0];this._bookingTimerService.stopTimer(),this._pubSubService.publish("statusBar.hide");var l=f.quote.priceSummaryInfo.totalExtras,m=f.quote.totalSeatPrice,n={totalExtrasPrice:this._utilsService.conditionallyFormatDecimal(l-m),totalSeatPrice:m,validatePNR:this._api.getValidationToken(),oAndDList:[],travelerInfoList:[],deviceType:this._$deviceProvider.getDeviceType(),ancillaryDetails:{},bookingInfo:{international:this._tripService.getIsInternational(),addressInfo:c,phoneInfo:{number:k.contact.phone.replace(/[^0-9]/g,"").trim(),contactType:"HOME",phoneRefNumber:"1.1",sequenceNum:0,primary:!0},emailInfo:{address:k.contact.email,emailType:"CC",emailRefNumber:"1.1",sequenceNum:0,primary:!1},bookingType:this._elevateService.isLoggedIn()?"POINTS"===this.getCurrency()?"ELEVATE_LOGIN_POINTS":"ELEVATE_LOGIN_DOLLAR":"ANONYMOUS_DOLLAR",mobile:this._$deviceProvider.isMobile(),insuranceOption:{selected:f.hasTravelInsurance||!1},optInOption:{selected:f.hasOptIn||!1}},seatInfo:{}};a.forEach(h,function(a){n.travelerInfoList.push(a.serialize("purchase"))}.bind(this));var o=this._tripService.getSelectedTripPublicModel().travelers.pets,p=this._tripService.getSelectedTripPublicModel().cityPairs;if(o>0){var q=[],r=[],s=this._travelerService.getTravelers();for(var t in s){var u=s[t];if("ADULT"===u.travelerType){var v={firstName:this.sanitizePaxName(u.firstName),lastName:this.sanitizePaxName(u.lastName),guestId:u.guestId};if(r.push(v),r.length===o)break}}a.forEach(p,function(a){var b={origin:a.dep,dest:a.des,paxList:r};q.push(b)}),n.bookingInfo.petcOption={oAndDList:q}}a.forEach(e,function(a){n.oAndDList.push(a.serialize("ancillaries"))}.bind(this)),this._elevateService.isLoggedIn()?n.authToken=this._elevateService.getAuthToken():this.getAppliedTravelBank()&&(n.authToken=this.getTravelBankInfo().authToken),(0!==f.totalDollars||f.quote.refundAmount&&0!==f.quote.refundAmount)&&(n.paymentInfo=this._buildPaymentInfoRequest(j));var w={flightId:null,flightNum:null,paxSeatList:[]},x=[];return a.forEach(this._travelerService.getTravelers(),function(b){a.forEach(b.seats,function(c){"undefined"==typeof x[c.flightId]&&(x[c.flightId]=a.copy(w),x[c.flightId].flightNum=c.flightNum,x[c.flightId].flightId=c.flightId);var d={pax:{firstName:this.sanitizePaxName(b.firstName),lastName:this.sanitizePaxName(b.lastName),guestId:b.guestId},seatNum:c.seatNumber,mcCostExempt:i.isMcCostExempt(g,c.oAndDId,b.guestId)};x[c.flightId].paxSeatList.push(d)}.bind(this))}.bind(this)),x=b.grep(x,function(a){return a}),x.length>0?n.seatInfo.seatFlightList=x:delete n.seatInfo,this.getTravelInsuranceAvailability()&&(n.bookingInfo.totalPremiumAmount=this.getTravelInsuranceAmount()),n.ancillaryDetails.ancillaryList=this._ancillariesService.serializeSelectedAncillaries({}),this._pnrService.purchase(n)},j.prototype.getAvailablePETC=function(){var b=this._fareService.getSelectedFares(),c=[];if(this._petcFails=[],b.length){this._pectLegs={},a.forEach(b,function(a){var b=a.legs[0],d=new Date(b.departureDateTime),e=b.flightNum+"_"+b.classOfService+"_"+d.getTime();this._pectLegs[e]=0;var f=a.tiers&&a.tiers[a.tier]?a.tiers[a.tier].fareBasisCode:"",g={departure:b.departure,arrival:b.arrival,classOfService:b.classOfService,flightNum:b.flightNum,departureDateTime:b.departureDateTime,arrivalDateTime:b.arrivalDateTime,aircraftType:b.aircraftType,fareBasisCode:f},h=this._$q.defer();c.push(h.promise),this._api.booking.checkAvailablePetc(g).then(function(a){"AVAILABLE"===a.data.response.availability&&void 0!==this._pectLegs[e]?(this._pectLegs[e]=a.data.response.fee,this.calculateCostAndTaxes(),h.resolve()):(this._petcFails.push(g),h.reject(g))}.bind(this))},this);var d=this._$q.all(c);return this._loadingService.setLoading(d),d}},j.prototype.setLockInventoryFares=function(a){this._lockInventoryNewFares=a,this.calculateCostAndTaxes()},j.prototype._defaultTravelBankAddress=function(){return new d({name:"TravelBank",title:"TravelBank",addressOne:"555 Airport Blvs, Ste 200",city:"Burlingame",state:"CA",country:"US",zipCode:"94010"})},j.prototype.loadDynamicFareRules=function(){var a,b=this._$q.defer();return a=void 0===this._pnrService.model()[0]?this._buildDynamicFareRulesRequest():this._locationService.contextIs(this._locationService.contexts.BOOK)?this._buildDynamicFareRulesRequest():this._buildDynamicPnrRulesRequest(),this._api.booking.dynamicAirRule(a).then(function(a){b.resolve(a)},function(a){b.reject(a)}),b.promise},j.prototype._buildDynamicFareRulesRequest=function(){var a={eachOAndDAirRules:[]},b=this._fareService.getSelectedFares();for(var c in b){var d=b[c],e=1===d.legs.length?0:1,f={departure:d.legs[0].departure,arrival:d.legs[e].arrival,departureDateTime:d.legs[0].departureDateTime,fareBasisCode:d.tiers[d.tier].fareBasisCode,marketingCarrier:"VX"};a.eachOAndDAirRules.push(f)}return a},j.prototype._buildDynamicPnrRulesRequest=function(){var a={eachOAndDAirRules:[]},b=this._pnrService.model()[0],c=b.flightList;for(var d in c){var e=c[d],f={departure:e.origin,arrival:e.destination,departureDateTime:e.departureDateTime,fareBasisCode:e.segments[0].fareBasisCode,marketingCarrier:"VX"};a.eachOAndDAirRules.push(f)}return a},j.prototype.petsErrorMessage=function(){this._statusService.setAlert({format:this._statusService.format.ALERT,copy:this._resourceBundle.statusMessages.purchase.petsNotAvailable,data:{flights:this._petcFails},recoverable:!0,controls:{close:!1,dismiss:"got it"},sticky:!0})},j.prototype.requestQuote=function(){var a=this._buildRequestQuote(),b=this._$q.defer();return this._api.booking.requestQuote(a).then(function(a){if("ERROR"!==a.data.status.status){var c=a.data.response;this._quoteModel=new g,this._quoteModel.deserialize(c,"booking"),this._setQuote(this._quoteModel),this._showWarningOnPriceIncrease(),this._ancillariesService.newAncillaryDetails(c.ancillaryDetails),this._ancillariesService.setSeatInfo(this._quoteModel.seatInfoList),b.resolve()}else b.reject()}.bind(this),function(){b.reject()}),b.promise},j.prototype._buildRequestQuote=function(){var b={travelerInfoList:[],oAndDList:[],ancillaryDetails:{}},c=this._travelerService.getAllTravelers();a.forEach(c,function(a){b.travelerInfoList.push(a.serialize("apiStandard"))});var d=this._fareService.getSelectedFares();a.forEach(d,function(a){b.oAndDList.push(a.serialize("ancillaries"))}.bind(this)),b.ancillaryDetails.ancillaryList=this._ancillariesService.serializeSelectedAncillaries({includePets:!0});var e=new h;return e.deserialize(this._travelerService.getTravelers(),"travelerInfo",{ancillaries:this._ancillariesService.getSelectedAncillaries()}),e.seatFlightList.length&&(b.seatInfo=e.serialize("seatFlightList")),b},j.prototype._showWarningOnPriceIncrease=function(){var a=this._ancillariesService.getUIAncillariesAmount()+this._purchaseSelectedModel.petcTax;a<this._quoteModel.priceSummaryInfo.totalExtras&&this._statusService.setAlert({format:this._statusService.format.ALERT,copy:this._resourceBundle.statusMessages.purchase.extrasPriceIncrease,recoverable:!0,controls:{close:!1,dismiss:"accept"},sticky:!0,doNotRollbackOnDismiss:!0})},j}),c("common/services/parameter",["angular","jquery","moment"],function(a,b,c){"use strict";
var d=function(a,b){return this._$location=a,this._localStorageService=b,this._paramToSelectorMap={cid:['a[href^="https://creditcard."]']},this._paramsWithEventHandlers=[],{onLocationChange:this.onLocationChange.bind(this)}};return d.$inject=["$location","localStorageService"],d.prototype.onLocationChange=function(){this._storeNewParams(),this._evaluateExpirationsAndCreateHandlers()},d.prototype._storeNewParams=function(){a.forEach(this._$location.search(),function(a,b){this._localStorageService.remove(b),this._localStorageService.set(b.toLowerCase(),{paramValue:a})}.bind(this))},d.prototype._evaluateExpirationsAndCreateHandlers=function(){var b,d;a.forEach(this._paramToSelectorMap,function(a,e){b=this._localStorageService.get(e),b&&(d=b.expiresOn&&c(b.expiresOn).isBefore(c()),d?this._localStorageService.remove(e):("string"==typeof b&&(b={paramValue:b}),b.expiresOn=c().add("minutes",5),this._localStorageService.set(e,b),this._createEventHandlers(a,e)))}.bind(this))},d.prototype._createEventHandlers=function(a,d){var e,f;this._paramsWithEventHandlers.indexOf(d)<0&&(this._paramsWithEventHandlers.push(d),a.forEach(function(a){b("body").on("click",a,function(a){e=this._localStorageService.get(d),e&&e.paramValue&&!c(e.expiresOn).isBefore(c())&&(f="?"+d+"="+e.paramValue,a.target.href.indexOf(f)<0&&(a.target.href+=f))}.bind(this))}.bind(this)))},d}),c("common/services/accessible",["angular","jquery"],function(a,b){"use strict";var c=function(c,d,e,f){this._$rootScope=c,this._$compile=d,this._$singleTimeout=e,this._resourceBundle=f,this.assertiveLevels={ASSERTIVE:"assertive",POLITE:"polite"},b("body").on("keyup",this._keyboardListener.bind(this)),a.extend(this._$rootScope,{a11y:{isAccessibleMode:this.isAccessibleMode.bind(this),setText:this.setText.bind(this),toggleLiveRegion:this.toggleLiveRegion.bind(this),setAssertiveLevel:this.setAssertiveLevel.bind(this),getAssertiveLevel:this.getAssertiveLevel.bind(this),setFocus:this.setFocus.bind(this),previousFocus:"",text:this._resourceBundle.a11yText}})};return c.$inject=["$rootScope","$compile","$singleTimeout","ResourceBundle"],c.prototype._keyboardListener=function(a){9===a.keyCode&&b("body").addClass("has-been-focused")},c.prototype.isAccessibleMode=function(){return b("body").hasClass("has-been-focused")},c.prototype.toggleLiveRegion=function(a){var c=b(".live-region"),d=b(".live-region-display");d.text(c.text()).toggleClass("is-visible",a),a&&(clearTimeout(this._timeout),this._timeout=setTimeout(function(){d.removeClass("is-visible")}.bind(this),1e4))},c.prototype.setText=function(c,d){var e=b(".live-region");e.html(""),e.html(c),d&&(a.extend(this._$rootScope,d),this._$compile(e)(this._$rootScope.$new()))},c.prototype.setAssertiveLevel=function(a){var c=b(".live-region");a!==c.attr("aria-live")&&c.attr("aria-live",a)},c.prototype.getAssertiveLevel=function(){var a=b(".live-region");return a.attr("aria-live")},c.prototype.setFocus=function(a){document.querySelectorAll(a)[0].focus()},c.prototype.trapFocus=function(a,c,d){var e=b(d.target),f=a&&e.is(a),g=c&&e.is(c);a&&!c&&(d.preventDefault(),a.focus()),d.shiftKey&&9===d.keyCode?f&&c?(d.preventDefault(),c.focus()):g&&!a.length&&d.preventDefault():9===d.keyCode&&g&&a&&(d.preventDefault(),a.focus())},c.prototype.setMostCurrentFocus=function(){var a=b(".collapse-container.collapsed-section").length,c=b(".section--book, .anc-selector, .seat-selector").eq(a),d=c.find('[tabindex="-1"]');0===c.length||0===a?b("#ally-main-content").focus():d.length?d.eq(0).closest(".ng-hide").length?b(".trip-select").eq(0).focus():d.eq(0).focus():c.find("[tabindex]").eq(0).focus()},c.prototype.resolveExpand=function(a){var c=b(".collapse-container.collapsed-section").eq(a);c.find(".collapse-and-hidden").eq(0).focus(),c.find(".collapse-and-hidden").removeClass(".collapse-and-hidden")},c}),c("common/services/promo",["angular"],function(a){"use strict";var b=function(b,c,d,e,f){function g(a,b){for(var c=[],d=null,e=0;e<a.length;e++)e%b===0&&(d=[],c.push(d)),d.push(a[e]);return c}var h=c.defer();return this._pubSubService=e,this._windowService=f,this.rawPromotions=[],this.chunkSize=3,this.onDataReceived=function(a){this.rawPromotions=a.promotional.subsets.static;var b=this.formatData(this.rawPromotions);h.resolve(b)},this.formatData=function(b){var c={"1up":[],"3up":[],"3upMobile":[]};return a.forEach(b,function(a){var b="";switch(a.variant){case"1UpCenter":case"1UpLeft":case"1UpRight":b="1up";break;case"3Up":b="3up"}a.title=a.title.replace(/&lt;/g,"<"),a.title=a.title.replace(/&gt;/g,">"),a.headline=a.headline.replace(/&lt;/g,"<"),a.headline=a.headline.replace(/&gt;/g,">"),a.description=a.description.replace(/&lt;/g,"<"),a.description=a.description.replace(/&gt;/g,">"),c[b].push(a)}),a.copy(c["3up"],c["3upMobile"]),c["3up"]=g(c["3up"],this.chunkSize),c},d.info.get(this.onDataReceived.bind(this)),{promise:h.promise}};return b.$inject=["$http","$q","cms","pubSubService","windowService"],b}),c("common/filters/cardinal",[],function(){"use strict";var a=function(){return function(a){var b=["zero","one","two","three","four","five","six","seven","eight","nine"];return b[a>b.length-1?b.length-1:a]}};return a}),c("common/filters/ordinal",[],function(){"use strict";var a=function(){return function(a){var b=["zero","first","second","third","fourth","fifth","sixth","seventh","eighth","ninth","tenth"];return b[a>b.length-1?b.length-1:a]}};return a}),c("common/filters/capitalize",[],function(){"use strict";var a=function(){return function(a){return a&&a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})}};return a}),c("common/filters/ceiling",[],function(){"use strict";var a=function(){return function(a){return Math.ceil(a)}};return a}),c("common/filters/cut",[],function(){"use strict";var a=function(){return function(a,b,c,d){if(!a)return"";if(c=parseInt(c,10),!c)return a;if(a.length<=c)return a;if(a=a.substr(0,c),b){var e=a.lastIndexOf(" ");e!==-1&&(a=a.substr(0,e))}return a+(d||"…")}};return a}),c("common/filters/timezone-neutral",[],function(){"use strict";var a=function(){return function(a){return null!==a&&a.length>16?a.substring(0,16):a}};return a}),c("common/vx-common-app",["angular","common/constants/model-list","common/providers/modal","common/providers/maxymiser","common/providers/single-timeout","common/providers/device-provider","common/services/modal-stack","common/services/modal-stacked-map","common/directives/modal-backdrop","common/directives/modal-window","common/directives/prevent-default","common/directives/collapsible-section","common/directives/header","common/directives/mobile-nav","common/directives/yts","common/directives/yts-module","common/directives/footer","common/directives/inline-modal","common/directives/number-picker","common/directives/hover-class","common/directives/scroll","common/directives/local-scroll","common/directives/status-bar","common/directives/loading","common/directives/travel-advisory","common/directives/change-guider","common/directives/window","common/directives/click-bg-gradient","common/directives/select-box","common/directives/custom-select","common/directives/bind-html-unsafe","common/directives/global-image","common/directives/form-expiration-date","common/directives/form-handler","common/directives/form-input","common/directives/form-input-composite","common/directives/form-input-facade","common/directives/form-select-array","common/directives/form-select-object","common/directives/form-select-facade","common/directives/country-select","common/directives/form-radio","common/directives/form-checkbox","common/directives/form-creditcard","common/directives/form-textarea","common/directives/form-dob","common/directives/form-date","common/directives/form-address","common/directives/form-submit","common/directives/accordion","common/directives/collapsible-table","common/directives/saved-choices-bar","common/directives/promo","common/directives/slider","common/directives/traveler-form","common/directives/avatar-picker","common/directives/elevate-login-form","common/directives/seat-selector","common/directives/traveler-info","common/directives/traveler-docs","common/directives/pnr-trip-summary","common/directives/pnr-guest-list","common/directives/pnr-flight-summary","common/directives/pnr-payment-details","common/directives/app-overlay","common/directives/points-slider","common/directives/calendar-widget","common/directives/click-to-chat","common/directives/facebook-share","common/directives/google-plus-share","common/directives/social-media-buttons","common/directives/load-script","common/directives/universal-receipt","common/directives/e2e-testing","common/directives/conversion-tracking","common/directives/address-autocomplete","common/directives/ancillaries-selector","common/directives/ancillary-toggle","common/directives/ally-application","common/directives/ally-focusnav","common/directives/ally-movefocus","common/directives/ally-keyclick","common/directives/ally-tabs","common/directives/link","common/directives/city-illustration","common/directives/exclusive-offer","common/controllers/site-map","common/controllers/modals/add-passport-info","common/controllers/modals/ally-departure-date","common/controllers/modals/email-itinerary","common/controllers/modals/save-to-calendar","common/controllers/modals/frequent-flier","common/controllers/modals/join-alaska-mileage-plan","common/controllers/modals/elevate-turn-down","common/controllers/modals/known-traveler","common/controllers/modals/wrong-email","common/controllers/modals/footer","common/controllers/modals/forgot-password","common/controllers/modals/seat-selection","common/controllers/modals/universal-receipt","common/controllers/modals/flight-alerts","common/services/utils","common/services/status","common/services/traveler","common/services/loading","common/services/image","common/services/seat","common/services/ancillaries","common/services/purchase","common/services/parameter","common/services/accessible","common/services/promo","common/filters/cardinal","common/filters/ordinal","common/filters/capitalize","common/filters/ceiling","common/filters/cut","common/filters/timezone-neutral"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb){"use strict";var kb={constant:{modelList:b},provider:{$modal:c,$maxymiser:d,$singleTimeout:e,$deviceProvider:f},factory:{$modalStack:g,$$stackedMap:h},service:{utilsService:Va,loadingService:Ya,imageService:Za,statusService:Wa,travelerService:Xa,seatService:$a,ancillariesService:_a,purchaseService:ab,parameterService:bb,accessibleService:cb,promoService:db},directive:{vxCommonModalBackdrop:i,vxCommonModalWindow:j,vxCommonPreventDefault:k,vxCommonCollapsibleSection:l,vxCommonHeader:m,vxCommonMobileNav:n,vxCommonYts:o,vxCommonYtsModule:p,vxCommonFooter:q,vxCommonInlineModal:r,vxCommonNumberPicker:s,vxCommonScroll:u,vxCommonLocalScroll:v,vxCommonStatusBar:w,vxCommonHoverClass:t,vxCommonTravelAdvisory:y,vxCommonChangeGuider:z,vxCommonWindow:A,vxCommonClickBgGradient:B,vxCommonAppOverlay:ka,vxSelectBox:C,vxCommonCustomSelect:D,vxBindHtmlUnsafe:E,vxGlobalImage:F,vxFormExpirationDate:G,vxFormHandler:H,vxFormInput:I,vxFormInputComposite:J,vxFormInputFacade:K,vxFormSelectObject:M,vxFormSelectArray:L,vxFormSelectFacade:N,vxCountrySelect:O,vxFormRadio:P,vxFormCheckbox:Q,vxFormCreditcard:R,vxFormTextarea:S,vxFormDob:T,vxFormDate:U,vxFormAddress:V,vxFormSubmit:W,vxAccordion:X,vxCommonCollapsibleTable:Y,vxCommonSavedChoicesBar:Z,vxCommonTravelerForm:aa,vxCommonLoading:x,vxCommonAvatarPicker:ba,vxElevateLoginForm:ca,vxCommonSeatSelector:da,vxCommonTravelerInfo:ea,vxCommonTravelerDocs:fa,vxCommonPnrTripSummary:ga,vxCommonPnrGuestList:ha,vxCommonPnrFlightSummary:ia,vxCommonPnrPaymentDetails:ja,vxCommonPointsSlider:la,vxCommonCalendarWidget:ma,vxCommonC2c:na,vxCommonFacebookShare:oa,vxCommonGooglePlusShare:pa,vxCommonSocialMediaButtons:qa,vxCommonLoadScript:ra,vxCommonPromo:$,vxCommonSlider:_,vxCommonUniversalReceipt:sa,vxCommonE2eTesting:ta,vxCommonConversionTracking:ua,vxAddressAutoComplete:va,vxCommonAncillariesSelector:wa,vxCommonAncillaryToggle:xa,vxCommonAllyApplication:ya,vxCommonAllyFocusNav:za,vxCommonAllyMoveFocus:Aa,vxCommonAllyClick:Ba,vxCommonAllyTabs:Ca,vxCommonLink:Da,vxCommonCityIllustration:Ea,vxCommonExclusiveOffer:Fa},controller:{SiteMapCtrl:Ga,AddPassportInfoCtrl:Ha,AllyDepartureDateModalCtrl:Ia,EmailItineraryCtrl:Ja,SaveToCalendarCtrl:Ka,FrequentFlierCtrl:La,JoinAlaskaMileagePlanModalCtrl:Ma,ElevateTurnDownModalCtrl:Na,KnownTravelerCtrl:Oa,WrongEmailCtrl:Pa,FooterModalCtrl:Qa,ForgotPasswordModalCtrl:Ra,SeatSelectionModalCtrl:Sa,PrintReceiptModalCtrl:Ta,FlightAlertsModalCtrl:Ua},filter:{cardinal:eb,ordinal:fb,capitalize:gb,ceil:hb,cut:ib,timezoneneutral:jb}},lb=a.module("vxCommonApp",[]);return a.forEach(kb,function(a,b){for(var c in a)lb[b](c,a[c])}),lb}),c("book/constants/fare-info",[],function(){"use strict";var a={main:{title:"Main Cabin",images:[{src:"/images/cabin/MainCabin1.jpg",caption:"Mood-lit cabin"},{src:"/images/cabin/MainCabin2.jpg",caption:"On-demand entertainment"},{src:"/images/cabin/MainCabin3.jpg",caption:"Custom black leather seats"},{src:"/images/cabin/MainCabin4.jpg",caption:"Custom designed A320 aircraft"}],highlights:[{img:"/images/cabin/icon-seats.png",title:"Devilishly Good Seats",desc:"Sleek black leather seats await you in the Main Cabin."},{img:"/images/cabin/icon-entertainment.png",title:"On-demand Entertainment",desc:"Tap into RED, our entertainment system, and watch live TV, movies on demand, music, and more. "},{img:"/images/cabin/icon-dine.png",title:"Food When You Need It",desc:"Food and drinks, on-demand."},{img:"/images/cabin/icon-wifi.png",title:"Stay Connected",desc:"Personal outlets and on-demand WiFi. This is how flying is supposed to be."}],features:[{title:"Change / Cancel Fee",desc:"$100 western region, $150 all others"},{title:"Elevate Booking Redeposit Fee",desc:"$100"},{title:"Refundable",desc:"Yes - to Travel Bank only"},{title:"Transferable",desc:"Yes"},{title:"Free Checked Bags",desc:"1"},{title:"Food, Beverages & Entertainment",desc:"Lots for Free"},{title:"Leg Room (Seat Pitch)",desc:"32 Inches"},{title:"Seats",desc:"Black Leather"},{title:"Main Cabin Express Seats",desc:"$30"},{title:"Priority Check-In",desc:"No"},{title:"Priority Boarding",desc:"No"},{title:"Dedicated Carry-On Bin Space",desc:"No"},{title:"Pillows & Blankets",desc:"No"},{title:"Free Headset",desc:"No"}]},mce:{title:"Express",images:[{src:"/images/cabin/Express1.jpg",caption:"Mood-lit cabin"}],highlights:[{img:"/images/cabin/icon-priority.png",title:"Priority Treatment",desc:"If you’re looking to make a quick getaway, choose a convenient seat near the front of our Main Cabin for a low additional fee, complete with priority security access, advance boarding Group A, and early access to the overhead bins."}],features:[{title:"Priority security access",desc:""},{title:"Advance boarding in Group A",desc:""},{title:"Early access to the overhead bins",desc:""}]},mcs:{title:"Main Cabin Select",images:[{src:"/images/cabin/MainCabinSelect1.jpg",caption:"Up to six extra inches of legroom*"},{src:"/images/cabin/MainCabinSelect2.jpg",caption:"Extra room to work and play"},{src:"/images/cabin/MainCabinSelect3.jpg",caption:"Unlimited in-flight entertainment"},{src:"/images/cabin/MainCabinSelect4.jpg",caption:"Custom designed A320 aircraft"}],highlights:[{img:"/images/cabin/icon-legroom.png",title:"More Legroom",desc:"Up to six extra inches of legroom that are all yours.*"},{img:"/images/cabin/icon-priority.png",title:"Head of the Class",desc:"Priority security and boarding make the deal even sweeter."},{img:"/images/cabin/icon-dine.png",title:"Treat Your Taste Buds, On Us",desc:"With free select food and drinks, you’ll get the best in-flight eats. "},{img:"/images/cabin/icon-entertainment.png",title:"Stay Entertained With RED",desc:"All your guilty pleasures are a tap away with RED, our in-flight system. Get all the perks of Main Cabin plus free premium movies and shows, music, and more."}],features:[{title:"Change / Cancel Fee",desc:"$0"},{title:"Elevate Booking Redeposit Fee",desc:"$100"},{title:"Refundable",desc:"Yes - to original form of payment"},{title:"Transferable",desc:"Yes"},{title:"Free Checked Bags",desc:"1"},{title:"Food, Beverages & Entertainment",desc:"Lots for Free"},{title:"Leg Room (Seat Pitch)",desc:"38 Inches"},{title:"Seats",desc:"Black Leather"},{title:"Main Cabin Express Seats",desc:"N/A"},{title:"Priority Check-In",desc:"Yes"},{title:"Priority Boarding",desc:"Yes"},{title:"Dedicated Carry-On Bin Space",desc:"Yes"},{title:"Pillows & Blankets",desc:"No"},{title:"Free Headset",desc:"Yes"}]},first:{title:"First Class",images:[{src:"/images/cabin/FirstClass1.jpg",caption:"Curated menu on us"},{src:"/images/cabin/FirstClass2.jpg",caption:"Custom white leather seats"},{src:"/images/cabin/FirstClass3.jpg",caption:"Unlimited in-flight entertainment"},{src:"/images/cabin/FirstClass4.jpg",caption:"Custom designed A320 aircraft"}],highlights:[{img:"/images/cabin/icon-legroom.png",title:"(Maximum) Legroom",desc:"Stretch it all out with nearly two feet of extra legroom in an exclusive cabin."},{img:"/images/cabin/icon-priority.png",title:"Be First",desc:"Breeze through the line with priority boarding and security checks."},{img:"/images/cabin/icon-dine.png",title:"Dine In",desc:"You can’t go wrong in First Class with a curated menu of premium delectables, on us."},{img:"/images/cabin/icon-bags.png",title:"Two Free Checked Bags",desc:"Get two free checked bags, on us."}],features:[{title:"Change / Cancel Fee",desc:"$0"},{title:"Elevate Booking Redeposit Fee",desc:"$100"},{title:"Refundable",desc:"Yes - to original form of payment"},{title:"Transferable",desc:"Yes"},{title:"Free Checked Bags",desc:"1"},{title:"Food, Beverages & Entertainment",desc:"Lots for Free"},{title:"Leg Room (Seat Pitch)",desc:"38 Inches"},{title:"Seats",desc:"Black Leather"},{title:"Main Cabin Express Seats",desc:"N/A"},{title:"Priority Check-In",desc:"Yes"},{title:"Priority Boarding",desc:"Yes"},{title:"Dedicated Carry-On Bin Space",desc:"Yes"},{title:"Pillows & Blankets",desc:"No"},{title:"Free Headset",desc:"Yes"}]}};return a}),c("book/controllers/trip",[],function(){"use strict";var a=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=this;this._$scope=a,this._$modal=b,this._$timeout=c,this._FareInfoBundle=d,this._$location=f,this._URLParser=e,this._tripService=g,this._fareService=h,this._workflowService=i,this._locationService=j,this._persistenceService=k,this._pubSubService=m,this._scrollService=n,this._$http=o,this._$scope.trip={openFareInfoModal:this.openFareInfoModal.bind(this),isBookLanding:!1,bookLandingGo:this.bookLandingGo.bind(this),bookingDeals:[],defaultAirport:"SFO"},this._ResourceBundle=l,this._detectBookLanding(this._locationService.getContext()),this._fareService.setContext("BOOK"),this._locationService.setContext(this._locationService.contexts.BOOK),this._isUrlParsable()&&this._buildTripFromModel(this._getModelFromUrl()),$(document).ready(function(){this._scrollService.go("top",{duration:0})}.bind(this)),a.$watch(g.getLoadModelFromPersistence,function(a){a&&(p._buildTripFromModel(p._persistenceService.getTripModel()),p._locationService.setShouldRender(!0))}),a.$watch(g.inBookingFlow,function(b,c){b===c&&b===a.trip.inBookingFlow||(a.trip.inBookingFlow=b)})};return a.$inject=["$scope","$modal","$timeout","FareInfoBundle","URLParser","$location","tripService","fareService","workflowService","locationService","persistenceService","ResourceBundle","pubSubService","scrollService","$http"],a.prototype._detectBookLanding=function(a){this._getUserLocation(),"book-landing"===a&&(this._$scope.trip.isBookLanding=!0)},a.prototype._getUserLocation=function(){this._getBookLandingData(),this._tripService.getDefaultAirport().then(function(a){this._$scope.trip.defaultAirport=a,this._getBookLandingData()}.bind(this))},a.prototype._getBookLandingData=function(){this._$http.get("/cms/travel-deals.json?airport="+this._$scope.trip.defaultAirport).success(this._formatBookingData.bind(this))},a.prototype.bookLandingGo=function(a,b){var c,d=this._createTravelerHash(this._tripService.travelerAmount()),e="rt/";"ONE_WAY"===this._tripService.getTripType()&&(e="ow/"),c="/book/"+e+d+"/"+a.toLowerCase()+"_"+b.toLowerCase(),this._locationService.go({target:c})},a.prototype._createTravelerHash=function(a){var b,c=a;return c.adults>0&&(b="a"+c.adults),c.children>0&&(b=b+"c"+c.children),c.infants>0&&(b=b+"i"+c.infants),c.pets>0&&(b=b+"p"+c.pets),b},a.prototype._formatBookingData=function(a){this._$scope.trip.bookingDeals=[];for(var b=0;b<a.deals.length;b++)this._$scope.trip.bookingDeals.push(a.deals[b])},a.prototype.openFareInfoModal=function(a){this._pubSubService.publish("core.openModal",["openFareInfoModal",a])},a.prototype._isUrlParsable=function(){return null!==this._getModelFromUrl()},a.prototype._getModelFromUrl=function(){this._URLParser.setContext("BOOK");var a=this._$location.url(),b=this._URLParser.getModel(a);return b?b.parsed:null},a.prototype._buildTripFromModel=function(a){var b=this;if(null!==a){var c=null;this._tripService.setTripType(a.tripType);var d=!0;if(a.cityPairs){this._tripService.setPopulatedFromUrl(!0);for(var e in a.cityPairs){var f=a.cityPairs[e];if(null!==f)if("undefined"!=typeof f.dep&&"undefined"!=typeof f.des)for(var g in f)this._tripService.setAirport(f[g],e,g);else d=!1}d&&(c="DATE_PICKER_STATE")}if(a.travelers&&a.cityPairs&&d&&(this._tripService.setTravelerAmount(a.travelers),c="DATE_PICKER_STATE"),a.dates.length>0){for(var h in a.dates)this._tripService.setDate(a.dates[h]);this._tripService.setLoadCalendarFromPersistence(!0),c="FARE_SELECTOR_STATE"}a.promoCode&&(this._tripService.setPromoCode(a.promoCode),this._fareService.setPromoCode(a.promoCode),this._fareService.setPromoCodeApplied(!0)),a.destinationState&&(c=a.destinationState),null!==c&&b._$timeout(function(){b._workflowService.transition("BOOK_INTRO_STATE",c,!1)}),b._pubSubService.publish("scroll.loadFromPersistence",[])}},a}),c("book/controllers/trip-booker",["angular"],function(a){"use strict";var b=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=this;this._$scope=a,this._$modal=h,this._windowService=c,this._tripService=d,this._changeService=e,this._statusService=f,this._scrollService=g,this._$timeout=i,this._workflowService=j,this._locationService=k,this._ResourceBundle=l,this._utilsService=m,this._$singleTimeout=n,this._breakpointWatch=null,a.tripBooker={departingAirportName:"",originTitles:{departing:"Select departure city",destinations:"Select your arrival city"},currentView:this.currentView.bind(this),setView:this.setView.bind(this),openBestFaresModal:this._utilsService.openBestFaresModal.bind(this),openDeparting:this.openDeparting.bind(this),closeDeparting:this.closeDeparting.bind(this),isTripTypeHidden:this.isTripTypeHidden.bind(this),view:"orig",multiCity:{legOneSelected:!1,allLegsSelected:!1,setView:this.setMultiCityView.bind(this),view:"orig"},changeValues:{},getTravelerLabel:this.getTravelerLabel.bind(this),complete:this.complete.bind(this)},a.changeValues&&(a.tripBooker.changeValues=a.changeValues),a.watchedService=a.context.is(a.context.type.BOOK)?d:e,a.destinationState="PEOPLE_PICKER_STATE",o.getUserLocation(),a.$watch(a.watchedService.getTripType,function(b){a.tripBooker.current=b,a.tripBooker.view="orig",b===o._tripService.MULTI_CITY&&o._windowService.setShowAppLoader(!1)})};return b.$inject=["$scope","$location","windowService","tripService","changeService","statusService","scrollService","$modal","$timeout","workflowService","locationService","ResourceBundle","utilsService","$singleTimeout"],b.prototype.isTripTypeHidden=function(){var a=this._$scope.tripBooker.currentView("departing"),b="MULTI_CITY"!==this._$scope.tripBooker.current,c=!this._$scope.context.is(this._$scope.context.type.BOOK);return a&&b||c},b.prototype.getTravelerLabel=function(){var a=this._changeService.travelerTotalLabel();return a},b.prototype.currentView=function(a){return this._$scope.tripBooker.view===a},b.prototype.closeDeparting=function(){this._removeBreakpointWatch(),this.setView("orig")},b.prototype.openDeparting=function(){this._addBreakpointWatch(),this._$timeout(this.setView.bind(this,"departing"))},b.prototype.getUserLocation=function(){this._tripService.isPopulatedFromUrl()||(this._tripService.getDefaultAirport().then(function(a){this._tripService.setAirport(a,0,this._tripService.DEPARTURE)}.bind(this)),this._locationService.setShouldRender(!1))},b.prototype.onBreakpointChange=function(a){"small"===a?this._createModal():this._removeModal("breakpoint")},b.prototype._addBreakpointWatch=function(){this._breakpointWatch||(this._breakpointWatch=this._breakpointWatch||this._$scope.$watch(this._windowService.breakpoint,this.onBreakpointChange.bind(this)))},b.prototype.complete=function(a){var b=this._$scope.context.is(this._$scope.context.type.BOOK)?"_completeBook":"_completeChange";this[b](a)},b.prototype._completeChange=function(){this._changeService.setVisibleSection({section:"CALENDAR",isVisible:!0}),this._scrollService.scroll({target:"DATE_PICKER_STATE",delay:1e3}),this._statusService.setChangeGuider(this._statusService.message.CHANGE_DATES)},b.prototype._completeBook=function(b){var c,d=this._tripService.getAirport(0).dep.code;if(a.isObject(b)){var e={intro:this._utilsService.safeHTML(b.destinationMsg)||"Nice.",travelers:this._tripService.travelerTotalLabel(),fromAirportCode:d,toAirportCode:b.code};c=[{back:a.noop,format:this._statusService.format.SUCCESS,copy:this._statusService.message.CITIES_SELECTED,data:e}]}else c={format:this._statusService.format.SUCCESS,copy:this._ResourceBundle.statusMessages.booker.multiCitySelected};this._statusService.setStatus(c),this.transitionToNextSection()},b.prototype._createModal=function(){var a=this._$scope.$new();a.departingCities=this._$scope.tripBooker.departingCities,a.citySelected=function(a){this._$scope.watchedService.setAirport(a,0,this._$scope.watchedService.DEPARTURE),this._$scope.$broadcast("updateAirportList",a),this._removeModal("city selected"),this.closeDeparting()}.bind(this),this._departingModal||(this._departingModal=this._$modal.open({contentType:"custom",size:"small",scope:a,templateUrl:"/app/book/templates/modals/departing-cities.tpl.html"}),this._departingModal.result.then(null,function(){this._departingModal=null,this.closeDeparting()}.bind(this)))},b.prototype._removeModal=function(a){this._departingModal&&this._departingModal.close(a),this._departingModal=null},b.prototype._removeBreakpointWatch=function(){this._breakpointWatch&&this._breakpointWatch(),this._breakpointWatch=null},b.prototype.setView=function(a){this._$scope.tripBooker.view=a},b.prototype.transitionToNextSection=function(){this._workflowService.transition("BOOK_INTRO_STATE",this._$scope.destinationState),this._$scope.destinationState="PEOPLE_PICKER_STATE"},b.prototype.setMultiCityView=function(a,b){(1===b||3===b)&&this._$singleTimeout(function(){this._$scope.$broadcast("updateAirportList",this._$scope.watchedService.getAirport(3===b?1:0).dep.code)}.bind(this)),this._$scope.tripBooker.view=0===b||2===b?"departing":"destinations",this._$scope.tripBooker.multiCity.view=a,this._$scope.tripBooker.multiCity.step=b,this._$scope.tripBooker.multiCity.legOneSelected=0!==b&&1!==b},b}),c("book/controllers/trip-news",[],function(){"use strict";var a=function(a,b){a.tripNews={},b.info.get(function(b){a.tripNews.items=b.news})};return a.$inject=["$scope","cms"],a}),c("book/controllers/trip-features",["jquery"],function(a){"use strict";var b=function(b,c){function d(b){var c,d=a(this).find(".feature-image");c="mouseover"===b.type?{src:d.attr("data-rollover"),"data-orig":d.attr("src")}:{src:d.attr("data-orig")},d.attr(c)}c.info.get(function(a){b.slides=a.features});var e=a(".features-list").on("mouseover mouseout",".feature",d);b.$on("$destroy",function(){e.off()})};return b.$inject=["$scope","cms"],b}),c("book/controllers/trip-promotions",[],function(){"use strict";var a=function(a,b){b.info.get(this.onDataReceived.bind(this)),this.$scope=a};return a.$inject=["$scope","cms"],a.prototype.onDataReceived=function(a){a.promotional&&(this.promotionalSlots=a.promotional.slots,this.subsets=a.promotional.subsets,this.$scope.slides=this.selectPromotions())},a.prototype.selectPromotions=function(){for(var a=[],b=0,c=this.promotionalSlots,d=this.subsets;b<c.length;b++)if("static"===c[b].subset){if("specified"===c[b].selection){var e=c[b].id;a.push(d.static[e])}else if("random"===c[b].selection){var f=[];for(var g in d.static)f.push(g);var h=this.getRandomInt(0,f.length-1);a.push(d.static[f[h]])}}else if("staticRandom"===c[b].subset){var i=[];for(var j in d.staticRandom)i.push(j);var k=this.getRandomInt(0,i.length-1);a.push(d.staticRandom[i[k]])}return a},a.prototype.getRandomInt=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},a}),c("book/controllers/trip-fares",["common/models/flight-model","common/models/selected-fare-model","content/constants/content-bundle","angular","moment","jquery"],function(a,b,c,d,e,f){"use strict";var g=function(a,b,c,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A){this._$scope=a,this._$modal=c,this._$timeout=e,this._$singleTimeout=g,this._$q=h,this._windowService=i,this._statusService=j,this._scrollService=k,this._tripService=l,this._fareService=m,this._flightPerformanceService=n,this._changeService=o,this._seatService=p,this._purchaseService=q,this._workflowService=r,this._elevateService=s,this._utilsService=t,this._locationService=u,this._loadingService=v,this._pubSubService=w,this._resourceBundle=x,this._bookingTimerService=y,this._ancillariesService=z,this._accessibleService=A,this._$scope.fares={},this._$scope.isAlaskaOnly=!1,this._$scope.isAlaskaFlightsEnabled=this.isAlaskaFlightsEnabled(),this._paymentTypes=[{name:"US Dollars",val:"DOLLAR"},{name:"Elevate Points",val:"POINTS",pointsDisabled:!0,skippable:!0}],this._allTiersFilterMap={main:["main","mainRefundable"],mcs:["mcs","mcsRefundable"],first:["first","firstRefundable"]},this._ticketType={BEST_FARES:0,REFUNDABLE:1},this._ticketTypes=[{name:"Best Fares",val:this._ticketType.BEST_FARES},{name:"Refundable",val:this._ticketType.REFUNDABLE}],this._pubSubService.subscribe("fareSelectorChangeDate",this._changeDateFromSevenDay.bind(this)),this._pubSubService.subscribe("faresResetCurrentView",this._resetCurrentView.bind(this)),a.isAlaskaVisible=function(){return a.isAlaskaOnly&&this.isAlaskaFlightsEnabled},this._sevenDayFareSelectorModalActive=!1,this._stickyEvt={existingItems:0,stickyClass:"is-sticky",scrollElemPositions:[],scrollElemEnd:[],sectionElem:[]},d.extend(this._$scope.fares,{activeTicketType:"",activeCurrency:"DOLLAR",addPromoCode:this.addPromoCode.bind(this),breakpoint:"",currentView:0,currentTicketType:"BEST_FARES",displayMiniSeatmap:this.displayMiniSeatmap.bind(this),getFlightTypeLabel:this.getFlightTypeLabel.bind(this),getTime:this.getTime.bind(this),isDollarsView:this.isDollarsView.bind(this),isBookingFlow:this._$scope.context.is(this._$scope.context.type.BOOK),isInSelectedFares:this.isInSelectedFares.bind(this),isTicketType:this.isTicketType.bind(this),openBestFaresModal:this._utilsService.openBestFaresModal.bind(this),openCompareFaresModal:this.openCompareFaresModal.bind(this),openFlightPerfModal:this.openFlightPerfModal.bind(this),paymentTypes:this._paymentTypes,promoCode:"",promoCodeApplied:!1,removePromoCode:this.removePromoCode.bind(this),selectedFares:[],selectFare:this.selectFare.bind(this),setCurrency:this.setCurrency.bind(this),showSevenDayModal:this.showSevenDayModal.bind(this),sortTiersForTable:this.sortTiersForTable.bind(this),ticketTypes:this._ticketTypes,ticketType:[],tierIsAvailable:this._tierIsAvailable.bind(this),toggleTicketType:this.toggleTicketType.bind(this),
sevenDayModalActive:!1,selectedTier:{},tierFilter:{},departingOrReturning:this.departingOrReturning.bind(this),selectionVisibility:{},tierIsRefundable:this._tierIsRefundable.bind(this),fareIsRefundable:this._fareIsRefundable.bind(this),fareOnSale:this.fareOnSale.bind(this),allCityTrip:!1,lowestFares:{},isCollapsed:{},changeSection:this._changeSection.bind(this),getCabinClassLabel:this.getCabinClassLabel.bind(this),collapseSection:this._collapseSection.bind(this),getFlightDirectionLabel:this._getFlightDirectionLabel.bind(this),ONE_WAY:this._tripService.ONE_WAY,MULTI_CITY:this._tripService.MULTI_CITY}),this._pubSubService.subscribe("expandFirstFareSelector",function(){this._changeSection(0)}.bind(this)),this._pubSubService.subscribe("expandSecondFareSelector",function(){this._changeSection(1)}.bind(this)),this._pubSubService.subscribe("collapseFirstFareSelector",function(){this._collapseSection(0)}.bind(this)),this._pubSubService.subscribe("collapseSecondFareSelector",function(){this._collapseSection(1)}.bind(this)),this._pubSubService.subscribe("hardCollapseSecondFareSelector",function(){f("#fares .fare-selector-wrap:last-child").addClass("collapsed-section"),this._$scope.fares.isCollapsed[1]=!0}.bind(this)),this._initWatches(),b.$broadcast("ytsAlt",{isAlt:!1})};return g.$inject=["$scope","$rootScope","$modal","$timeout","$singleTimeout","$q","windowService","statusService","scrollService","tripService","fareService","flightPerformanceService","changeService","seatService","purchaseService","workflowService","elevateService","utilsService","locationService","loadingService","pubSubService","ResourceBundle","bookingTimerService","ancillariesService","accessibleService"],g.prototype.getTime=function(a,b,c){var d;return d="arrival"===c?this._$scope.fares.selectedFares[a].legs[b].arrivalTime+"  ("+this._$scope.fares.selectedFares[a].legs[b].arrival+")":this._$scope.fares.selectedFares[a].legs[b].departureTime+"  ("+this._$scope.fares.selectedFares[a].legs[b].departure+")"},g.prototype.isAlaskaFlightsEnabled=function(){return this._$scope.context.is(this._$scope.context.type.BOOK)},g.prototype._collapseSection=function(a){var b=this._$scope.context.is(this._$scope.context.type.BOOK)?this._tripService:this._changeService,c=b.getTripTypeLegs()>1,d=0===a&&c?"#fares .fare-selector-wrap:first-child":"#fares .fare-selector-wrap:last-child",e=0===a&&c?"#fares-1":"#"+this._resourceBundle.states.TRAVELER_INFO_STATE.scrollTarget;f(e).length&&this._$singleTimeout(function(){f(d).addClass("collapsed-section"),f(window).scrollTop(f(e).offset().top-f("#yts").height()-f("#change-guider").height()),c||(a=0),this._$scope.fares.isCollapsed[a]=!0}.bind(this),4)},g.prototype._changeSection=function(a){this._$scope.fares.isCollapsed[a]=!1,this._accessibleService.resolveExpand(2+a);var b=this._$scope.context.is(this._$scope.context.type.BOOK)?this._tripService:this._changeService,c=b.getTripTypeLegs()>1;0===a&&c&&(this._$scope.fares.isCollapsed[1]=!1),this._$scope.context.is(this._$scope.context.type.CHANGE)&&(this._pubSubService.publish("ancillariesSelector.setVisibility",[!1]),this._statusService.setChangeGuider(this._statusService.message.CHANGE_FARES)),this._regressGracefully(a),this._resetStickyFares()},g.prototype.departingOrReturning=function(a){var b=a?"departing":"returning";return b},g.prototype._changeDateFromSevenDay=function(a,b){var c=this._$scope.context.is(this._$scope.context.type.BOOK)?this._tripService:this._changeService,d={},e=0===a?1:0,f=c.getDates()[e],g=null,h=null;1===a&&(g=this._$scope.fares.selectedFares[0],h=this._$scope.fares.selectedTier[0]),d[a]=b,d[e]=f,c.clearDates();for(var i in d)c.setDate(d[i]);this._pubSubService.publish("calendar.datesUpdated"),this._pubSubService.publish("adobeAnalytics.sevenDayContinue"),this._regressGracefully(a),this._$scope.context.is(this._$scope.context.type.BOOK)&&this._workflowService.transition(this._workflowService.state.DATE_PICKER,this._workflowService.state.FARE_SELECTOR,!0),1===a&&g&&h&&(this._fareService.setFare(0,g,h),this._$singleTimeout(function(){this._statusService.setStatus([])}.bind(this),2e3)),this._$scope.context.is(this._$scope.context.type.BOOK)&&this._locationService.setShouldRender(!0)},g.prototype._resetCurrentView=function(){this._$scope.fares.currentView=0,this._$scope.fares.isCollapsed={}},g.prototype._tierIsRefundable=function(a){return a.indexOf("Refundable")!==-1},g.prototype.isTicketType=function(a,b){return this._$scope.fares.ticketType[a]===b},g.prototype.isInSelectedFares=function(a,b,c,d){var e=d?"selectedTier":"tierFilter",f=this._$scope.fares.selectedFares.indexOf(a)!==-1;if(!f)for(var g in this._$scope.fares.selectedFares){var h=this._$scope.fares.selectedFares[g];h.legs.length===a.legs.length&&h.legs[0].flightNum===a.legs[0].flightNum&&h.legs[0].departureDateTime===a.legs[0].departureDateTime&&(1===h.legs.length?f=!0:h.legs[h.legs.length-1].arrivalDateTime===a.legs[h.legs.length-1].arrivalDateTime&&(f=!0))}var i=this._$scope.fares[e][c]===b;return!!this._$scope.fares.selectionVisibility[c]&&f&&i},g.prototype.toggleTicketType=function(a,b){if(a!==this._$scope.fares.ticketType[b]){for(var c=0;c<this._$scope.fares.ticketType.length;c++)this._$scope.fares.ticketType[c]=a;switch(this._$scope.fares.itineraryList=0===this._rawFareData.length?[]:this.sortIntineraryByFlightType(this._rawFareData),this._addFareFlightFlags(this._$scope.fares.itineraryList),this._resetStickyFares(),b){case 0:this._removeSelectedFare(0),this._$scope.fares.currentView=0,this._$scope.fares.isCollapsed={},this._regressGracefully(0);break;case 1:this._removeSelectedFare(1),this._regressGracefully()}var d=0===a?"Best Fares":"Refundable";this._accessibleService.setText("You are now looking at tickets via "+d);var e=this._$q.defer();this._$singleTimeout(function(){e.resolve()},2e3),this._loadingService.setLoading(e.promise),e.promise.then(function(){this._resetRadioFocus("ul.ticket-type",a)}.bind(this))}},g.prototype._resetRadioFocus=function(a,b){this._$singleTimeout(function(){f(a).find("input").each(function(){b.toString()===this.value&&f(this).parents("li").focus()})}.bind(this))},g.prototype.openCompareFaresModal=function(){this._$modal.open(c.contentMap.COMPARE_FARES)},g.prototype.displayMiniSeatmap=function(c,d,e,g,h){var i=this._resourceBundle.modal.miniSeatmap,j=this._resourceBundle,k=f(h.target).closest(".collapsible-table-container"),l={contentType:i.TYPE,size:i.SIZE,scope:this._$scope.$new(),title:"Seats available on Flight "+g.flightNum,templateUrl:i.TEMPLATE_URL,origin:k};l.scope.seatmap={sectionName:function(a){return a.exitRow?"MCS"===a.name?"MAIN CABIN SELECT EXIT ROW":"EXIT ROW":j.flightInformation.tier.name[a.name]},seatClasses:function(a){var b=[];return a.open||a.isAisle||a.virtual||a.invisible?(a.invisible&&b.push("is-invisible"),a.virtual&&b.push("is-virtual"),a.isAisle&&b.push("is-aisle"),b):(b.push("is-taken"),b.push("avatar-"+a.avatarImage),b)}};var m=new a;m.deserialize(g,"defaultMap"),m.tier=this._resourceBundle.cabinClassVXToUiMap.MC_NONREFUNDABLE,this._seatService.getSeatMap(e,m,!1,b.getItineraryType(e,d),c.tiers.main.fareBasisCode).then(function(a){l.scope.seatmap.sections=a.seatMap;for(var b=a.seatMap,c=0;c<b.length;c++){var d=[];b[c].rows&&(d=Object.keys(b[c].rows).map(function(a){return b[c].rows[a]}),b[c].rows=d)}this._$singleTimeout(function(){var a=this._$modal.open(l);a.result.then(null,function(){l.scope.$destroy(),delete l.scope})}.bind(this))}.bind(this))},g.prototype.removePromoCode=function(){this._fareService.setPromoCode(""),this._fareService.setPromoCodeApplied(!1),this._fareService.applyPromoCode(""),this._pubSubService.publish("trip.promoCodeRemoved")},g.prototype.setCurrency=function(a,b,c){return c?void this._pubSubService.publish("core.openModal",["openElevatePointsBlockedModal"]):"POINTS"===a&&b&&!this._elevateService.isLoggedIn()?void this.openSignInModal(a,null):(this._resetStickyFares(),this._fareService.setActiveCurrency(a).then(function(){this._resetRadioFocus("ul.payment-options",a)}.bind(this)),this._workflowService.isBeforeCurrentState(this._workflowService.state.FARE_SELECTOR)&&this._$singleTimeout(function(){this._regressGracefully(0)}.bind(this)),this._workflowService.getCurrentState()===this._workflowService.state.FARE_SELECTOR&&(this._$scope.fares.currentView=0,this._$scope.fares.isCollapsed={},this._fareService.resetSelectedFares(),this._purchaseService.reset()),this._accessibleService.setText("You are now booking with "+a),this._$singleTimeout(function(){this._pubSubService.publish("adobeAnalytics.fareSelectorPointsToggle")}.bind(this)),void 0)},g.prototype._removeSelectedFare=function(a){this._$scope.fares.selectedFares=0===a?[]:this._$scope.fares.selectedFares.slice(a-1,1)},g.prototype.openSignInModal=function(a,b,c){var d=this._resourceBundle.modal.fareSignIn,e=function(){this.setCurrency(a)},f=function(){this.setCurrency(a)};b=b||e,c=c||f,this._$modal.open({size:d.SIZE,type:d.TYPE,title:d.TITLE,templateUrl:d.TEMPLATE_URL,controller:"SignInCtrl",contentType:"form"}).result.then(b.bind(this),c.bind(this))},g.prototype._regressGracefully=function(a){if(0===a){if(this._$scope.context.is(this._$scope.context.type.BOOK)){var b=this._workflowService.getCurrentState();b===this._workflowService.state.FARE_SELECTOR&&(b=this._workflowService.state.TRAVELER_INFO),this._workflowService.transition(b,this._workflowService.state.FARE_SELECTOR,!0)}this._scrollService.go("fares-0",{duration:350})}else this._seatService.resetServiceDataExceptReturningFlightSelectedSeats(),this._bookingTimerService.stopTimer(),this._fareService.setInventoryLocked(!1),this._pubSubService.publish("ancillariesSelector.reset")},g.prototype.isDollarsView=function(){return"DOLLAR"===this._$scope.fares.activeCurrency},g.prototype._tierIsAvailable=function(a){if("undefined"==typeof a)return!1;var b=!0;return"UNSUPPORTED"===a.classOfService&&(b=!1),a.seatsRemaining<=0&&(b=!1),!this.isDollarsView()&&a.pointsFare&&a.pointsFare.totalPoints<=0&&(b=!1),a.notAvailable&&(b=!1),b},g.prototype.getFlightTypeLabel=function(a){var b;switch(a){case"nonStop":b="Non-Stop";break;case"connecting":b="Connecting Flights";break;case"thru":b="Thru-Flights"}return b},g.prototype.sortTiersForTable=function(a,b){if(this._$scope.fares.ticketType[b]===this._ticketType.REFUNDABLE)return["mainRefundable","mcsRefundable","firstRefundable"];var c,e,f=[],g=["main","mcs","first"];return"DOLLAR"===this._$scope.fares.activeCurrency?(c="dollarFare",e="totalFare"):(c="pointsFare",e="totalPoints"),d.forEach(g,function(b){var g,h=1/0;d.forEach(this._allTiersFilterMap[b],function(b){this._tierIsAvailable(a.tiers[b])&&a.tiers[b][c]&&"undefined"!=typeof a.tiers[b][c][e]&&a.tiers[b][c][e]<h&&(g=b,h=a.tiers[b][c][e])}.bind(this)),g?f.push(g):f.push(b)}.bind(this)),f},g.prototype.fareOnSale=function(a){return!!a&&("undefined"!=typeof a.fareBasisCode&&(a.fareBasisCode.indexOf("SL")!==-1||a.fareBasisCode.indexOf("N6")!==-1))},g.prototype._fareIsRefundable=function(a,b){return 0===this._$scope.fares.ticketType[a]&&this._tierIsRefundable(b)},g.prototype._initWatches=function(){var a=this._$scope.context.is(this._$scope.context.type.BOOK)?this._tripService:this._changeService;this._$scope.$watch(this._windowService.breakpoint,function(a){this._$scope.fares.breakpoint=a}.bind(this)),this._$scope.$watch(this._fareService.isAlaskaOnly,function(a){this._$scope.isAlaskaOnly=a}.bind(this)),this._pubSubService.subscribe("sevenDayFareSelector.modalClosed",function(){this._sevenDayFareSelectorModalActive=!1,this._fareService.setOpenSevenDayModalPublished(!1)}.bind(this)),this._pubSubService.subscribe("responseFareModel",this._handleNewFares.bind(this)),this._pubSubService.subscribe("openSevenDayModal",function(a){this._sevenDayFareSelectorModalActive||(this.showSevenDayModal(a),this._sevenDayFareSelectorModalActive=!0)}.bind(this)),this._$scope.$watch(a.getCityPairs,function(b){this._$scope.fares.trip={cityPairs:b,tripType:a.getTripType()},this._detectAllCity(this._$scope.fares.trip.cityPairs)}.bind(this),!0),this._$scope.$watch(a.getDates,function(a){a&&(this._$scope.fares.dates=[e(a[0]).format("MMM D"),e(a[1]).format("MMM D")])}.bind(this),!0),this._$scope.$watch(this._fareService.shouldResetSelectedFares,function(a){a&&(this._$scope.fares.selectedFares=[],this._$scope.fares.currentView=0,this._$scope.fares.tierFilter={},this._$scope.fares.isCollapsed={},this._fareService.setShouldResetSelectedFares(!1))}.bind(this)),this._$scope.$watchCollection(this._fareService.getPromoCode,function(a,b){this._$scope.fares.promoCode=a.promoCode,this._$scope.fares.promoCodeApplied=a.promoCodeApplied,this._workflowService.isBeforeCurrentState(this._workflowService.state.FARE_SELECTOR)&&this._$singleTimeout(function(){this._regressGracefully(0)}.bind(this)),this._workflowService.getCurrentState()===this._workflowService.state.FARE_SELECTOR&&(this._$scope.fares.currentView=0,this._fareService.resetSelectedFares(),this._purchaseService.reset(),this._scrollService.go("fares-0",{duration:350}),this._$scope.fares.isCollapsed={})}.bind(this)),this._$scope.$watch(this._fareService.getActiveCurrency,function(a){this._$scope.fares.activeCurrency=a}.bind(this))},g.prototype._detectAllCity=function(a){var b=this._resourceBundle.cityPicker.airportAliases;if(this._$scope.fares.allCities=!1,a[0].des)for(var c=0;c<a.length;c++)for(var d=0;d<b.length;d++)b[d]!==a[c].des&&b[d]!==a[c].dep||(this._$scope.fares.allCities=!0)},g.prototype.showSevenDayModal=function(a){var b=this._$scope.$new();b.changingDays=a,this._$modal.open({size:"full",templateUrl:"/app/book/templates/modals/seven-day-fare-selector.tpl.html",controller:"SevenDayFareSelectorCtrl",contentType:"seven-day",scope:b}),this._pubSubService.publish("adobeAnalytics.sevenDayComparison")},g.prototype.selectFare=function(a,b,c,e){this._$scope.fares.currentView=c;var f=this._$scope.context.is(this._$scope.context.type.BOOK)?this._tripService:this._changeService,g=f.getTripTypeLegs()>1,h=c+1===f.getTripTypeLegs(),i=0===c&&2===this._$scope.fares.selectedFares.length,j="MULTI_CITY"===f.getTripType(),k=j?this._statusService.message.FARE_INVALID_DATE_MULTI_CITY:this._statusService.message.FARE_INVALID_DATE;if(g&&(h||i)){if(this._departureInConflictWithArrival(b,c))return void this._statusService.setAlert({format:this._statusService.format.ALERT,copy:k,recoverable:!0,controls:{close:!1,dismiss:"got it"}});this._statusService.setAlert([])}var l="POINTS"===this._fareService.getActiveCurrency();if(this._elevateService.isLoggedIn()&&l){var m=this._fareService.getSelectedFares(),n=0;for(var o in m)m[o]&&m[o].cost&&(n+=m[o].cost.points.totalPoints);var p=this._elevateService.getUserData().numOfPointsAvailable;if((n+b.tiers[e].pointsFare.totalPoints)*this._tripService.getTotalTravelers()>p)return void this._statusService.setStatus({format:this._statusService.format.ERROR,copy:this._resourceBundle.statusMessages.fare.notEnoughElevatePoints})}this._$singleTimeout(function(){this._$scope.fares.tierFilter[c]=e,this._$scope.fares.selectedFares[c]=b,this._$scope.fares.selectedFares[c].flightType=a,this._fareService.setFare(c,this._$scope.fares.selectedFares[c],e),this._fareService.setFareIntention(d.copy(this._$scope.fares.selectedFares[c])),f.getTravelerData().pets>0&&this._purchaseService.getAvailablePETC().catch(this._purchaseService.petsErrorMessage.bind(this)),this._resetStickyFares()}.bind(this)),this._pubSubService.publish("adobeAnalytics.fareSelected"),this._$singleTimeout(function(a,b){this.confirmFare(b,a.tiers[b],c)}.bind(this,b,e))},g.prototype.showMessage=function(a,b){var c=this._statusService.message[b.tripType][a];this._statusService.setStatus({format:this._statusService.format.SUCCESS,copy:c,data:b})},g.prototype._departureInConflictWithArrival=function(a,b){var c=0===b?a:this._$scope.fares.selectedFares[0],d=0===b?this._$scope.fares.selectedFares[1]:a,f=c.legs[c.legs.length-1],g=d.legs[0],h=e(g.departureDateTime),i=e(f.arrivalDateTime).add("minutes",this._resourceBundle.fareSelector.invalidDateMinuteBuffer);return h.diff(i)<0},g.prototype.confirmFare=function(a,b,c){var d=this._$scope.context.is(this._$scope.context.type.BOOK)?this._tripService:this._changeService;if(d.getTripTypeLegs()-1===c&&!this._elevateService.isLoggedIn()&&"POINTS"===this._fareService.getActiveCurrency())return void this.openSignInModal("POINTS",this._onPointsBookingForcedLoginSuccess.bind(this,a,b,c),this._onPointsBookingForcedLoginFailure.bind(this,"LOGIN_REQUIRED"));if("UNSUPPORTED"!==b.classOfService){var e=c+1,f=this._$scope.fares.selectedFares[c].legs[0],g={};if(this._$scope.fares.selectedFares[c].classOfService=b.classOfService,this._$scope.fares.selectedTier[c]=a,this._$scope.fares.selectionVisibility[c]=!0,g.tripType=d.getTripType(),e===d.getTripTypeLegs())g.departureTime=f.departureTime,g.classOfService=this.getCabinClassLabel(this._$scope.fares.tierFilter[c].toUpperCase()),this._$scope.context.is(this._$scope.context.type.CHANGE)?this._requestQuoteAndTransition():this._workflowService.transition(this._workflowService.state.FARE_SELECTOR);else if(this._$scope.context.is(this._$scope.context.type.CHANGE)){var h=this._changeService.getPnrModel();h&&h.irop&&this._changeService.isIropFree()&&this._statusService.setAlert({format:this._statusService.format.ALERT,copy:this._statusService.message.IROP_FARE_NOTIFICATION,recoverable:!0,controls:{close:!1,dismiss:"got it"},data:{fareClass:h.flightList[e].cabinType}})}this._$scope.context.is(this._$scope.context.type.CHANGE)&&this._statusService.setChangeGuider(this._statusService.message.CHANGE_FARES),this.showMessage(e,g),this._$scope.fares.currentView=e}},g.prototype._requestQuoteAndTransition=function(){var a=this._fareService.getSelectedFares(),b=this._changeService.getRequestQuoteFlightIds(a),c=this._ancillariesService.getSelectedAncillaries(this._ancillariesService.selectionTypes.PNR);c&&(a.forEach(function(a,b){this._pubSubService.publish("fare.setChangedFare",[b])}.bind(this)),this._ancillariesService.refreshAncillariesForChangeFlow(),this._changeService.setExchangeFlightList(b));var d=function(){this._ancillariesService.requestAvailableAncillaries().then(function(){this._statusService.setChangeGuider(this._statusService.message.CHANGE_EXTRAS),this._scrollService.scroll({target:this._workflowService.state.ANCILLARIES_SELECTOR,delay:0})}.bind(this),function(){this._statusService.setChangeGuider(this._statusService.message.CHANGE_SEATS),this._locationService.go({target:"/change/seats"})}.bind(this))},e=function(){this._fareService.resetSelectedFares(),this._scrollService.scroll({target:this._workflowService.state.FARE_SELECTOR,delay:0})};if(b&&b.length>0){var f=this._changeService.requestQuote();f.then(d.bind(this),e.bind(this)),this._loadingService.setLoading(f)}else d()},g.prototype.getCabinClassLabel=function(a){var b={MAIN:"Main Cabin",MCS:"Main Cabin Select",FIRST:"First Class"};return b[a.toUpperCase()]},g.prototype._handleNewFares=function(a){this._rawFareData=a,this._$scope.fares.itineraryList=0===a.length?[]:this.sortIntineraryByFlightType(a);for(var b in a)this._$scope.fares.ticketType[b]=this._ticketType.BEST_FARES;if(0===a.length&&(this._$scope.fares.currentView=0,this._$scope.fares.selectedFares=[],this._$scope.fares.isCollapsed={}),this._addFareFlightFlags(this._$scope.fares.itineraryList),this._$scope.context.is(this._$scope.context.type.CHANGE)){var c=this._changeService.getPnrModel();c&&c.irop&&this._changeService.isIropFree()&&this._statusService.setAlert({format:this._statusService.format.ALERT,copy:this._statusService.message.IROP_FARE_NOTIFICATION,recoverable:!0,controls:{close:!1,dismiss:"got it"},data:{fareClass:c.flightList[0].cabinType}})}this._bindScrollHandler(!0)},g.prototype._addFareFlightFlags=function(a){a&&a.length&&d.forEach(a,function(b,c){var e=!1;d.forEach(b,function(b,d){if(b.flights.length){for(var f=0;f<d;f++)a[c][f].isLast=!1;b.isLast=!0,e||(b.isFirst=!0,e=!0)}for(var g=0;g<a[c].length;g++)a[c][g].itineraryIndex=c}.bind(this))}.bind(this))},g.prototype._bindScrollHandler=function(a){f.unsubscribe("windowService.scroll",this._scrollEvent.bind(this)),a&&f.subscribe("windowService.scroll",this._scrollEvent.bind(this)),this._resetStickyFares()},g.prototype._resetStickyFares=function(){this._$singleTimeout(function(){this._stickyEvt.previousExistingCache||(this._stickyEvt.previousExistingCache=this._stickyEvt.existingItems),this._stickyEvt.sectionElem=f(".fare-selector-wrap.vh-minimum"),this._updateHeightCombo(),this._stickyEvt.scrollContainer=f(".fare-selector");for(var a=0;a<this._stickyEvt.scrollContainer.length;a++)this._stickyEvt.scrollContainer.eq(a).find('.fare-selector__fare-map:not(".ng-hide")').first().addClass("is-first-visible");this._stickyEvt.scrollElem=!1}.bind(this),50)},g.prototype._updateHeightCombo=function(){this._stickyEvt.scrollOffset=f("#yts").height(),"change"===this._locationService.getContext()&&(this._stickyEvt.scrollOffset=this._stickyEvt.scrollOffset+f("#change-guider").height())},g.prototype._scrollInit=function(){if(!this._stickyEvt.scrollElem||this._stickyEvt.currentBreakpoint!==this._windowService.breakpoint()){var a=this._stickyEvt.sectionElem,b=this._stickyEvt;if(this._clearStickyEvt(),b.scrollElemPositions=[],b.scrollElemEnd=[],b.scrollParent=f('.fare-selector__fare-map:not(".ng-hide")'),b.scrollElem=f('.fare-map-header:not(".ng-hide"):not(".scroll-hidden")',b.scrollParent),b.scrollElemName=f(".fare-map-header__name",b.scrollElem),b.scrollElem.length>0&&a.offset()){b.sectionTop=a.offset().top,b.currentBreakpoint=this._windowService.breakpoint(),b.scrollOffset=f("#yts").height(),b.titleOffset=0,b.titleTop=0,this._updateHeightCombo(),"large"!==this._stickyEvt.currentBreakpoint?f(".fare-map").on("scroll",this._updateFareMobileScroll):f(".fare-map").off("scroll");for(var c=0;c<b.scrollElem.length;c++)b.scrollElemPositions.push(b.scrollElem.eq(c).offset().top),b.scrollElemEnd.push(b.scrollParent.eq(c).height()+b.scrollParent.eq(c).offset().top);b.existingItems=b.scrollElem.length}}},g.prototype._scrollEvent=function(a,b){this._stickyEvt.scrollCombo=b+this._stickyEvt.scrollOffset,0!==this._stickyEvt.sectionElem.length&&this._stickyEvt.scrollCombo>this._stickyEvt.sectionElem.offset().top&&this._scrollInit(),this._stickyEvt.nearestElem=null,this._stickyEvt.titleOffset=this._stickyEvt.titleOffset-b,this._stickyEvt.titleOffset>0?this._stickyEvt.scrollDirection=1:this._stickyEvt.scrollDirection=-1,this._stickyEvt.titleOffset=b;for(var c=0;c<this._stickyEvt.scrollElemPositions.length;c++)if(this._nextPosition=this._stickyEvt.scrollElemPositions[c+1],this._nearestElemObj=f(this._stickyEvt.scrollParent[c]),this._stickyEvt.scrollElemPositions[c]<this._stickyEvt.scrollCombo&&this._stickyEvt.scrollElemPositions[c]>this._stickyEvt.sectionTop?(this._nearestElemObj.addClass(this._stickyEvt.stickyClass),this._nearestElemObj.hasClass("animating-opacity")||(this._stickyEvt.animateIn=window.setTimeout(this._addAnimateClass.bind(this),10,this._nearestElemObj))):(this._nearestElemObj.removeClass(this._stickyEvt.stickyClass),this._nearestElemObj.hasClass("animating-opacity")&&(this._stickyEvt.animateOut=window.setTimeout(this._removeAnimateClass.bind(this),10,this._nearestElemObj))),"large"===this._stickyEvt.currentBreakpoint){var d=f(".fare-map__title--container",this._stickyEvt.scrollElemName[c]);this._nextPosition-122<this._stickyEvt.scrollCombo&&this._nextPosition>this._stickyEvt.scrollCombo?(this._stickyEvt.titleTop=-1*parseInt(122+(this._stickyEvt.scrollCombo-this._nextPosition),10),d.css("top",this._stickyEvt.titleTop+"px")):this._nextPosition-122>this._stickyEvt.scrollCombo||this._nextPosition<this._stickyEvt.sectionTop?d.css("top","0"):this._nextPosition<this._stickyEvt.scrollCombo&&d.css("top","-122px")}this._stickyEvt.scrollElemPositions[0]>this._stickyEvt.scrollCombo?this._clearStickyEvt():this._stickyEvt.scrollCombo>this._stickyEvt.scrollElemEnd[this._stickyEvt.previousExistingCache-1]&&this._stickyEvt.scrollCombo<this._stickyEvt.scrollElemPositions[this._stickyEvt.previousExistingCache]?this._clearStickyEvt():this._stickyEvt.scrollCombo>this._stickyEvt.scrollElemEnd[this._stickyEvt.scrollElemEnd.length-1]-90&&this._clearStickyEvt()},g.prototype._addAnimateClass=function(a){a.addClass("animating-opacity"),window.clearTimeout(this._stickyEvt.animateIn)},g.prototype._removeAnimateClass=function(a){a.removeClass("animating-opacity"),window.clearTimeout(this._stickyEvt.animateOut)},g.prototype._clearStickyEvt=function(){f("#fares ."+this._stickyEvt.stickyClass).removeClass(this._stickyEvt.stickyClass)},g.prototype._updateFareMobileScroll=function(){var a=f(this);a.parents().is(".is-sticky")?a.find(".fare-map-header").css("left",a.scrollLeft()*-1):a.find(".fare-map-header").css("left",0)},g.prototype.sortIntineraryByFlightType=function(a){var b,c,e,f=["nonStop","thru","connecting"],g=[];return d.forEach(a,function(a){b=[],d.forEach(f,function(d){c=a[d],c&&(e={type:d,flights:c},b.push(e))}),g.push(b)}),g},g.prototype.openFlightPerfModal=function(a,b,e){var f=this._$scope.$new(),g=d.copy(c.contentMap.FLIGHT_PERFORMANCE),h=c.contentMap.FLIGHT_PERFORMANCE_ERROR,i=this._flightPerformanceService.getFlightPerformance(a,b,e);i.always(function(b){d.isObject(b)?(g.title=this._$modal.interpolate(g.title,{flightNum:a}),f.perf=b,g.scope=f,this._$modal.open(g)):this._$modal.open(h)}.bind(this))},g.prototype._onPointsBookingForcedLoginSuccess=function(a,b,c){if(this._elevateService.isLoggedIn()){var d=this._fareService.getSelectedFares(),e=0;for(var f in d)d[f]&&d[f].cost&&(e+=d[f].cost.points.totalPoints);var g=this._elevateService.getUserData().numOfPointsAvailable;e>g?this._onPointsBookingForcedLoginFailure("NOT_ENOUGH_PTS"):this.confirmFare(a,b,c)}else this._onPointsBookingForcedLoginFailure("LOGIN_REQUIRED")},g.prototype._onPointsBookingForcedLoginFailure=function(a){this._$scope.fares.currentView=0,this._$scope.fares.isCollapsed={},this._fareService.resetSelectedFares(),this._purchaseService.reset(),this._scrollService.go("fares-0",{duration:350});var b={format:this._statusService.format.ALERT,copy:this._statusService.message.FS_POINTS_LOGIN_REQUIRED,recoverable:!0,controls:{close:!1,dismiss:"got it"}},c={format:this._statusService.format.ERROR,copy:this._resourceBundle.statusMessages.fare.notEnoughElevatePoints},d="NOT_ENOUGH_PTS"===a?"setStatus":"setAlert",e="NOT_ENOUGH_PTS"===a?c:b;this._statusService[d](e)},g.prototype.addPromoCode=function(){this._$modal.open({size:"small",title:"Add promo code",templateUrl:"/app/book/templates/modals/add-promo-code.tpl.html",controller:"AddPromoCodeCtrl",contentType:"form"})},g.prototype._getFlightDirectionLabel=function(a){var b=0===a,c=a===this._$scope.fares.itineraryList.length-1,d=this._$scope.fares.trip.tripType;return d===this._tripService.MULTI_CITY?"Departing":b&&d!==this._tripService.ONE_WAY?"Departing":c&&d!==this._tripService.ONE_WAY?"Returning":""},g}),c("book/controllers/modals/seven-day-fare-selector",[],function(){"use strict";var a=function(a,b,c,d,e,f,g){this._$scope=a,this._$modalInstance=b,this._tripService=c,this._changeService=d,this._workflowService=e,this._locationService=f,this._pubSubService=g,this._watchedService=this._$scope.context.is(this._$scope.context.type.BOOK)?this._tripService:this._changeService;var h=this._$scope.context.is(this._$scope.context.type.CHANGE);this._$scope.sevenDay={dates:{},allDatesSelected:!1,close:this.close.bind(this),saveDates:this.saveDates.bind(this),tripType:this._watchedService.getTripType(),isChange:h},this._$scope.$on("sevenDayFareSelectorDateSelected",this._onDateSelected.bind(this)),this._$scope.$on("sevenDayFareSelectorApiError",this.close.bind(this))};return a.$inject=["$scope","$modalInstance","tripService","changeService","workflowService","locationService","pubSubService"],a.prototype.close=function(){this._$modalInstance.close(),this._pubSubService.publish("sevenDayFareSelector.modalClosed")},a.prototype._updateAllDatesSelected=function(){var a=this._watchedService.getTripType()===this._tripService.ONE_WAY?1:2;this._$scope.sevenDay.allDatesSelected=Object.keys(this._$scope.sevenDay.dates).length===a},a.prototype._onDateSelected=function(a,b,c){var d="departing"===b?0:1;c?this._$scope.sevenDay.dates[d]=c:delete this._$scope.sevenDay.dates[d],this._$scope.$broadcast(b+"DateSelected",c),this._updateAllDatesSelected()},a.prototype.saveDates=function(){if(this._$scope.sevenDay.allDatesSelected){this._watchedService.clearDates();for(var a in this._$scope.sevenDay.dates)this._watchedService.setDate(this._$scope.sevenDay.dates[a]);this._pubSubService.publish("calendar.datesUpdated"),this._pubSubService.publish("adobeAnalytics.sevenDayContinue"),this._pubSubService.publish("faresResetCurrentView"),this._workflowService.isBeforeCurrentState("FARE_SELECTOR_STATE")&&this._workflowService.transition(this._workflowService.getCurrentState(),"FARE_SELECTOR_STATE",!0),this._workflowService.transition("DATE_PICKER_STATE"),this._$scope.context.is(this._$scope.context.type.BOOK)&&this._locationService.setShouldRender(!0),this.close()}},a}),c("book/controllers/modals/add-promo-code",[],function(){"use strict";var a=function(a,b,c,d,e){this._$scope=a,this._$q=b,this._$modalInstance=c,this._fareService=d,this._pubSubService=e,this._$scope.addPromo={applyPromoCode:this.applyPromoCode.bind(this),code:"",fields:{},isValid:null},this._pubSubService=e};return a.$inject=["$scope","$q","$modalInstance","fareService","pubSubService"],a.prototype.applyPromoCode=function(){this._$scope.addPromo.code=this._$scope.addPromo.fields.promocode.value,this._fareService.setPromoCode(this._$scope.addPromo.code),this.loadingPromise=this._$q.defer();var a=this._fareService.retrievePromoCodeInfo();return a.then(this._onCodeResponse.bind(this),this._onCodeResponse.bind(this)),this.loadingPromise.promise},a.prototype._onCodeResponse=function(a){var b={code:this._$scope.addPromo.code};a&&!a.trappedError?(this._fareService.setActiveCurrency("DOLLAR"),this._fareService.applyPromoCode(this._$scope.addPromo.code),this.loadingPromise.resolve(a),b.success=!0,this._$modalInstance.close(),this._pubSubService.publish("trip.promoCodeApplied")):(this.loadingPromise.reject(a),this._$scope.addPromo.fields.promocode.setValidation(!1,"invalid promo code"),b.success=!1,a.status&&a.status.error?(b.errorCode=a.status.error.code,b.developerMessage=a.status.error.developerMessage):a.trappedError&&(b.errorCode=a.trappedError.code,b.developerMessage=a.trappedError.internalMsg)),this._pubSubService.publish("adobeAnalytics.promoAdded",[b])},a}),c("book/controllers/modals/sign-in",[],function(){"use strict";var a=function(a,b,c,d,e){this._$scope=a,this._$modalInstance=b,this._locationService=d,this._$timeout=e,a.$watch(c.isLoggedIn,function(a){a&&this._onSignIn()}.bind(this))};return a.$inject=["$scope","$modalInstance","elevateService","locationService","$timeout"],a.prototype._onSignIn=function(){this._$timeout(function(){this._$modalInstance.close()}.bind(this))},a}),c("book/controllers/trip-seven-day-fares",["jquery","moment"],function(a,b){"use strict";var c=function(a,c,d,e,f,g,h,i,j,k,l){this._$scope=a,this._resourceBundle=c,this._$modal=d,this._$timeout=e,this._fareService=f,this._windowService=i,this._tripService=g,this._pubSubService=k,this._accessibleService=l,a.sevenDayFares={lowestFares:{},selectedDate:null,getDay:this.getDay.bind(this),getWeek:this.getWeek.bind(this),getMonth:this.getMonth.bind(this),fareOnSale:this.fareOnSale.bind(this),selectDate:this.selectDate.bind(this),selectInlineDate:this.selectInlineDate.bind(this),getDayOfWeek:this.getDayOfWeek.bind(this),getLowestFares:this.getLowestFares.bind(this),isDateSelected:this.isDateSelected.bind(this),isDateUnavailable:this.isDateUnavailable.bind(this),isLoading:!1,isDollars:"DOLLAR"===f.getActiveCurrency()};var m="departing"===a.type?0:1,n=j.getContext();this._watchedService=n===j.contexts.BOOK?g:h;var o=this._watchedService.getDates();this._tripDate=o[m],this._today=b(),this._fareDates={};
var p=b.utc(this._tripDate,"YYYY-MM-DD HH:mm Z");this._tripDate=p.format("YYYY-MM-DD"),this.getLowestFares(this._tripDate,!0),this.setNavDates(this._tripDate);var q="returning"===a.type?"departing":"returning";this._$scope.$on(q+"DateSelected",function(a,b){this["_"+q+"DateChangedHandler"](b)}.bind(this))};return c.$inject=["$scope","ResourceBundle","$modal","$timeout","fareService","tripService","changeService","windowService","locationService","pubSubService","accessibleService"],c.prototype.fareOnSale=function(a){return!!a&&("undefined"!=typeof a.fareBasisCode&&(a.fareBasisCode.indexOf("SL")!==-1||a.fareBasisCode.indexOf("N6")!==-1))},c.prototype.selectInlineDate=function(a,c,d){var e={};if(e=this._watchedService.getDates(),"ONE_WAY"!==this._watchedService.getTripType()){if("returning"===this._$scope.type&&b(a).isBefore(e[0]))return void this._openInvalidDateModal(!0);if("departing"===this._$scope.type&&b(a).isAfter(e[1]))return void this._openInvalidDateModal(!1)}this.selectDate(a,c,d)},c.prototype.selectDate=function(a,b,c){if(!this.isDateUnavailable(b.price)&&this._$scope.sevenDayFares.selectedDate!==a&&(this._$scope.sevenDayFares.selectedDate=this._$scope.sevenDayFares.selectedDate===a?null:a,this._$scope.$emit("sevenDayFareSelectorDateSelected",this._$scope.type,this._$scope.sevenDayFares.selectedDate),c)){var d="departing"===this._$scope.type?0:1;this._pubSubService.publish("fareSelectorChangeDate",[d,a])}},c.prototype._openInvalidDateModal=function(a){var b=this._resourceBundle.modal.invalidSevenDayResponse,c=this._$scope.$new();c.acceptOtherDays=function(){this._pubSubService.publish("openSevenDayModal",[!0]),this._closeInvalidDateModal()}.bind(this),c.nevermind=function(){this._closeInvalidDateModal()}.bind(this),a&&(c.isBefore=!0),this._invalidModal=this._$modal.open({contentType:b.TYPE,scope:c,size:b.SIZE,title:b.TITLE,templateUrl:b.TEMPLATE_URL})},c.prototype._closeInvalidDateModal=function(){this._invalidModal&&this._invalidModal.close(),this._invalidModal=null},c.prototype.isDateSelected=function(a){return this._$scope.sevenDayFares.selectedDate===a},c.prototype.isDateUnavailable=function(a){return isNaN(parseFloat(a))||parseFloat(a)<0},c.prototype.getDay=function(a){return b.utc(a,"YYYY-MM-DD HH:mm Z").format("DD")},c.prototype.getMonth=function(a){return b.utc(a,"YYYY-MM-DD HH:mm Z").format("MMM")},c.prototype.getDayOfWeek=function(a,c){var d=c?"dddd":"ddd";return b.utc(a,"YYYY-MM-DD HH:mm Z").format(d)},c.prototype.getLowestFares=function(a,b){this._$scope.sevenDayFares.isLoading=!0,this._fareService.getLowestFares(a,this._$scope.type).then(function(a){this._$scope.sevenDayFares.isLoading=!1,Object.keys(a).length<7&&(a=this._fillInUnavailableFares(a)),this._$scope.sevenDayFares.lowestFares=a,this._$scope.$broadcast("lowestFaresReceived"),b&&this._$scope.sevenDayFares.lowestFares[this._tripDate]&&this._$scope.sevenDayFares.lowestFares[this._tripDate]!==-1&&this.selectDate(this._tripDate,this._$scope.sevenDayFares.lowestFares[this._tripDate])}.bind(this),function(){this._$scope.$emit("sevenDayFareSelectorApiError")}.bind(this))},c.prototype.getWeek=function(a){var c="prev"===a,d=c?"Previous":"Next";if(!c||!this._$scope.sevenDayFares.isPrevInactive){var e=c?this._prevDate:this._nextDate;if(c){var f=b();e.diff(f)<0&&(e=f)}this._tripDate=e.format("YYYY-MM-DD"),this.getLowestFares(this._tripDate,!1),this.setNavDates(this._tripDate),this._accessibleService.setText("Change date selection has been refreshed. "+d+" week days added.")}},c.prototype.setNavDates=function(a){this._prevDate=b(a).subtract("days",7),this._nextDate=b(a).add("days",7),this._$scope.sevenDayFares.isPrevInactive=this._today.isAfter(b(a).subtract("days",1))},c.prototype._fillInUnavailableFares=function(a){function c(b){Object.keys(a).indexOf(b)===-1&&(a[b]={price:-1,tax:null})}for(var d=0;d<=3;d++)c(b(this._tripDate,"YYYY-MM-DD").subtract("days",d).format("YYYY-MM-DD"));for(var e=0;e<=3;e++)c(b(this._tripDate,"YYYY-MM-DD").add("days",e).format("YYYY-MM-DD"));if(Object.keys(a).length>7)for(var f in a)b(f,"YYYY-MM-DD")>b(this._tripDate).add("days",3)&&delete a[f];return a},c.prototype._departingDateChangedHandler=function(a){var c=b(a,"YYYY-MM-DD"),d=b(this._$scope.sevenDayFares.selectedDate,"YYYY-MM-DD");d<c&&(this._$scope.sevenDayFares.selectedDate=null,this._$scope.$emit("sevenDayFareSelectorDateSelected",this._$scope.type,null))},c.prototype._returningDateChangedHandler=function(a){var c=b(this._$scope.sevenDayFares.selectedDate,"YYYY-MM-DD"),d=b(a,"YYYY-MM-DD");d<c&&(this._$scope.sevenDayFares.selectedDate=null,this._$scope.$emit("sevenDayFareSelectorDateSelected",this._$scope.type,null))},c}),c("book/directives/trip-carousel",["modernizr"],function(a){"use strict";var b=function(){return{restrict:"A",scope:!0,controller:c,link:d}},c=function(a,b,c,d){this._$scope=a,this._$swipe=b,this._$timeout=c,this._windowService=d,this._$scope.carousel={index:0,onNavClick:this.onNavClick.bind(this)},a.$watch(this._windowService.breakpoint,this.onBreakpointChange.bind(this))};c.$inject=["$scope","$swipe","$timeout","windowService"],c.prototype.onBreakpointChange=function(a){this._$scope.bp=a,this._$scope.carousel.index=0},c.prototype.onNavClick=function(a){this._$scope.carousel.index=a};var d=function(b,c,d,e){var f=c.find(".carousel-slider__list"),g=0,h=0,i=0,j=0,k=0,l=50,m=d.maxItems-1||2,n=function(a){var c=b.carousel.index,d=b.bp;e._$timeout(function(){if(a<0)switch(d){case"small":if(!(c<m))return;b.carousel.index++;break;case"medium":if(!(c<1))return;b.carousel.index++;break;case"large":return}else switch(d){case"small":if(!(c>0))return;b.carousel.index--;break;case"medium":if(!(c>0))return;b.carousel.index--;break;case"large":return}})};a.touch&&e._$swipe.bind(f,{start:function(a){0===g&&(g=1,h=a.x,j=f.position(),k=j.left)},move:function(a){if(0!==g){var b=a.x-h;1===g&&0!==b?(g=2,i=k):2===g&&(k=i+b,f.css("left",k).removeClass(".bp-medium").removeClass("animating"))}},end:function(a){var b=a.x-h;b>-l&&b<l?k=i:n(b),f.removeAttr("style").addClass(".bp-medium").addClass("animating"),g=0}})};return b}),c("book/directives/trip-type",[],function(){"use strict";var a=function(){return{scope:{typeSuffix:"@"},restrict:"A",controller:b,templateUrl:"/app/book/directives/trip-type.tpl.html"}},b=function(a,b,c,d,e,f){this.$scope=a,this.tripService=b,this.workflowService=c,this.locationService=d,this.accessibleService=e,this.pubSubService=f,a.tripType={options:b.getTripTypeOptions(),select:this.onSelect.bind(this)},a.$watch(b.getTripType,function(b){a.tripType.current=b})};return b.prototype.onSelect=function(a){var b=this.tripService.getTripType();this.tripService.setTripType(a),"/book-travel"!==this.locationService.getPath()&&this.locationService.setShouldRender(!0),a===this.tripService.MULTI_CITY||b===this.tripService.MULTI_CITY?(this.workflowService.transition(this.workflowService.getCurrentState(),"BOOK_INTRO_STATE"),this.pubSubService.publish("resetDestinationAirport")):this.workflowService.isBeforeCurrentState("DATE_PICKER_STATE")&&this.workflowService.transition(this.workflowService.getCurrentState(),"DATE_PICKER_STATE"),this.accessibleService.setText("You are now booking "+a.replace("_"," ")+" Flights")},b.$inject=["$scope","tripService","workflowService","locationService","accessibleService","pubSubService"],a}),c("book/directives/trip-airport-list",["angular"],function(a){"use strict";var b=function(){return{restrict:"A",controller:c}},c=function(a,b,c,d,e,f,g,h,i,j,k,l){var m=this;this.$scope=a,this.$parse=b,this.$singleTimeout=c,this.cms=d,this.tripService=f,this.changeService=g,this.windowService=e,this.statusService=h,this.scrollService=i,this.workflowService=j,this.locationService=k,this.utilsService=l,this.lists={destinations:[],departing:[],orig:[]},a.tripAirportList={airportSelected:this.airportSelected.bind(this),destinationCode:"",expanded:!1,list:[],limit:5,multiCity:{airportSelected:this.airportSelectedMultiCity.bind(this)}},this.watchedService=this.$scope.context.is(this.$scope.context.type.BOOK)?f:g,a.$watch(j.getCurrentState,function(b){"BOOK_INTRO_STATE"===b&&(a.tripAirportList.destinationCode="")}),d.config.get(function(b){m.config=b,m.buildDepartingAirportsList(m.config.airports),a.$watch("tripBooker.view",function(a){m.$scope.tripAirportList.list=l.sortListByName(m.lists[a]),m.setViewLimit.call(m,a)}),a.$on("updateAirportList",function(a,b){m.onDepartingAirportChange.call(m,b)}),a.$watch(function(){return m.watchedService.getAirport(0)},function(a){"object"==typeof a&&"object"==typeof a.dep&&(a.update&&(a.update=!1),m.onDepartingAirportChange.call(m,a.dep.code))}),m.windowService.setShowAppLoader(!1)})};return c.$inject=["$scope","$parse","$singleTimeout","cms","windowService","tripService","changeService","statusService","scrollService","workflowService","locationService","utilsService"],c.prototype.airportSelected=function(a){var b=this.$scope.context.is(this.$scope.context.type.BOOK)?"_airportSelectedBook":"_airportSelectedChange";this[b](a)},c.prototype._airportSelectedChange=function(a){switch(this.$scope.tripBooker.view){case"departing":this.changeService.setAirport(a.code,0,this.tripService.DEPARTURE),this.$scope.tripBooker.setView("destinations"),"large"!==this.windowService.breakpoint()&&(this.scrollService.go("booker"),{duration:350});break;case"orig":case"destinations":this.changeService.setAirport(a.code,0,this.tripService.DESTINATION),this.$scope.tripAirportList.destinationCode=a.code,this.$singleTimeout(this.$scope.tripBooker.complete.bind(null,a))}var b=this.changeService.validateIropChange("CITIES");if(!b.valid){var c={format:this.statusService.format.ALERT,copy:this.statusService.message[b.message],recoverable:!0,controls:{close:!1,dismiss:"got it"}};this.statusService.setAlert(c)}},c.prototype._airportSelectedBook=function(a){switch(this.workflowService.isBeforeCurrentState("BOOK_INTRO_STATE")&&this.workflowService.transition(this.workflowService.getCurrentState(),"BOOK_INTRO_STATE",!0),this.$scope.tripBooker.view){case"departing":this.tripService.setAirport(a.code,0,this.tripService.DEPARTURE),this.$scope.tripBooker.setView("orig"),"large"!==this.windowService.breakpoint()&&(this.scrollService.go("booker"),{duration:350});break;case"orig":case"destinations":this.tripService.setAirport(a.code,0,this.tripService.DESTINATION),this.$scope.tripAirportList.destinationCode=a.code,this.$singleTimeout(this.$scope.tripBooker.complete.bind(null,a)),this.locationService.setShouldRender(!0)}},c.prototype.airportSelectedMultiCity=function(b){var c=this.$scope.tripBooker.multiCity.step,d=this;if(this.workflowService.isBeforeCurrentState("BOOK_INTRO_STATE")){var e=this.watchedService.getAirport(0).dep,f=this.watchedService.getAirport(0).des,g=this.watchedService.getAirport(1).dep,h=this.watchedService.getAirport(1).des;this.workflowService.transition(this.workflowService.getCurrentState(),"BOOK_INTRO_STATE",!0),this.watchedService.setAirport(e.code,0,this.tripService.DEPARTURE),this.watchedService.setAirport(f.code,0,this.tripService.DESTINATION),this.watchedService.setAirport(g.code,1,this.tripService.DEPARTURE),this.watchedService.setAirport(h.code,1,this.tripService.DESTINATION)}this.watchedService.setAirport(b.code,0===c||1===c?0:1,0===c||2===c?this.tripService.DEPARTURE:this.tripService.DESTINATION),this.$singleTimeout(function(){var b;if(0===c&&(b=0),2===c&&(b=1),"undefined"!=typeof b){d.$scope.$broadcast("updateAirportList",d.watchedService.getAirport(b).dep.code);var e=!1;a.forEach(d.lists.destinations,function(a){d.watchedService.getAirport(b).des&&d.watchedService.getAirport(b).des.code===a.code&&(e=!0)}),e||delete d.watchedService.getAirport(b).des}d.watchedService.getAirport(0).dep&&d.watchedService.getAirport(0).des&&(d.$scope.tripBooker.multiCity.legOneSelected=!0,d.watchedService.getAirport(0).dep&&d.watchedService.getAirport(1)&&d.watchedService.getAirport(1).dep&&d.watchedService.getAirport(0).des&&d.watchedService.getAirport(1).des?d.$scope.tripBooker.multiCity.allLegsSelected=!0:d.$scope.tripBooker.multiCity.allLegsSelected=!1),"large"!==d.windowService.breakpoint()&&d.scrollService.go("multi-city-leg-"+(c<2?"one":"two"),{duration:350,offset:-52}),d.$scope.tripBooker.multiCity.view="orig"})},c.prototype.setViewLimit=function(a){var b;switch(a){case"destinations":b=this.lists.destinations.length;break;case"departing":b=this.lists.departing.length;break;default:b="small"===this.windowService.breakpoint?3:5}this.$scope.tripAirportList.limit=b},c.prototype.buildDepartingAirportsList=function(a){for(var b in a){var c=a[b];c.code=b,this.lists.departing.push(c)}this.lists.departing=this.utilsService.sortListByName(this.lists.departing)},c.prototype.onDepartingAirportChange=function(b){var c=this.config.airportMapping[b];this.lists.destinations=[],this.lists.orig=[];var d,e,f;if(a.isObject(c)&&a.isObject(c.to)){if(a.isObject(c.to))for(d in c.to)e=this.config.airports[d],a.isObject(e)&&(e.code=d,this.lists.destinations.push(e));var g=0;if(a.isObject(c.promoted))for(f in c.promoted)g++;if(a.isObject(c.promoted)&&5===g)for(f in c.promoted){var h=this.config.airports[f];a.isObject(h)&&(h.code=f,this.lists.orig.push(h))}else if(a.isObject(c.to))for(d in c.to)e=this.config.airports[d],a.isObject(e)&&(e.code=d,this.lists.orig.push(e))}this.$scope.tripAirportList.fullListLength=this.lists.destinations.length,this.updateList()},c.prototype.updateList=function(){this.$scope.context.is(this.$scope.context.type.CHANGE)&&(this.$scope.tripBooker.view="destinations"),this.$scope.tripAirportList.list=this.utilsService.sortListByName(this.lists[this.$scope.tripBooker.view]),this.$scope.tripBooker.departingCities=this.lists.departing,this.$scope.context.is(this.$scope.context.type.BOOK)||this.setViewLimit("destinations")},b}),c("book/directives/trip-calendar",["jquery","angular","moment","modernizr"],function(a,b,c,d){"use strict";var e=function(){return{restrict:"A",controller:f,link:g,templateUrl:"/app/book/directives/trip-calendar.tpl.html"}},f=function(a,b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){this._$scope=a,this._$singleTimeout=b,this._$q=d,this._$modal=e,this._latestTimeService=f,this._ResourceBundle=g,this._statusService=h,this._scrollService=i,this._tripService=j,this._changeService=k,this._windowService=l,this._fareService=m,this._workflowService=n,this._locationService=o,this._pubSubService=p,this._utilsService=q,this._accessibleService=r,this.moment=c,this.anchorTimeZone="-10:00",this.currentMoment=this._latestTimeService.getTime().startOf("day"),this._lastAvailableDate=null,this.latestMonth=null,this.monthsArray=[],this._lowestFares={},this._returnMessageFlag=!1,this._currentSelectionState=0,this._maxSelectionState=2,this.currentRestrictions=null,this._$timeout=s,this._day=null,this._initVars(),this.loadingState={INITIAL:"initial",LOADING:"loading",LOADED:"loaded"},this.watchedService=this._$scope.context.is(this._$scope.context.type.BOOK)?"_tripService":"_changeService",this._$scope.$watch(this._workflowService.getCurrentState,function(a){("BOOK_INTRO_STATE"===a||"DATE_PICKER_STATE"===a)&&this._$scope.context.is(this._$scope.context.type.BOOK)&&(this._$scope.calendar.isCollapsed=!1,this._accessibleService.resolveExpand(1),this._$scope.stickyBarEnabled(!0))}.bind(this));var t=function(){var a=this[this.watchedService].getDates();this._departingDayObj&&(this._departingDayObj.isDepartingDay=!1),a.length>1&&this._returningDayObj&&(this._returningDayObj.isReturningDay=!1),this._departingDayStoredDate=a[0],a.length>1&&(this._returningDayStoredDate=a[1]),this._$singleTimeout(function(){this._$scope.$apply()}.bind(this))};this._$scope.$watch(j.getLoadCalendarFromPersistence,function(a){this._loadFromPersistence=a,a&&(this._currentSelectionState=2,t.call(this))}.bind(this)),this._$scope.$watch(this[this.watchedService].getDates,function(a,b){a&&b&&0===a.length&&b.length>0&&this.resetDates()}.bind(this)),this._$scope.$watch(this[this.watchedService].getTripType,function(a,b){if(a&&b&&a!==b){this._resetThirtyDaysFareValues(),this.resetDates(),this._thirtyDaysStartDates=this._lastThirtyDaysStartDates.slice(),this._thirtyDaysFareBreakPoints=this._lastThirtyDaysFareBreakPoints.slice();var c=this[this.watchedService].getSelectedTripPublicModel(),d=c.cityPairs,e=this._isTripType(this._tripService.MULTI_CITY,a),f=this._isTripType(this._tripService.MULTI_CITY,b);if(e||f)return;var g=this._isTripType(this._tripService.ROUND_TRIP,a),h=this._isTripType(this._tripService.ONE_WAY,a),i=g&&d[0]&&d[0].dep&&d[0].des&&d[1]&&d[1].dep&&d[1].des,j=h&&d[0]&&d[0].dep&&d[0].des;(i||j)&&this._thirtyDaysFareSearch()}}.bind(this)),this._pubSubService.subscribe("trip.promoCodeApplied",this._thirtyDaysFarePromoCodeSearch.bind(this)),this._pubSubService.subscribe("trip.promoCodeRemoved",this._thirtyDaysFarePromoCodeSearch.bind(this)),this._pubSubService.subscribe("calendar.datesUpdated",t.bind(this)),this._pubSubService.subscribe("calendar.reset",this.resetDates.bind(this)),this._pubSubService.subscribe("expandCalendar",function(){this._changeSection()}.bind(this)),this._pubSubService.subscribe("collapseCalendar",function(){this._collapseAndResolveData()}.bind(this)),this.initScopes()};f.$inject=["$scope","$singleTimeout","$q","$modal","latestTimeService","ResourceBundle","statusService","scrollService","tripService","changeService","windowService","fareService","workflowService","locationService","pubSubService","utilsService","accessibleService","$timeout"],f.prototype._initVars=function(){this._thirtyDaysStartDates=[],this._thirtyDaysFareBreakPoints=[],this._lastThirtyDaysStartDates=[],this._lastThirtyDaysFareBreakPoints=[],this._thirtyDaysFareBreakPointsCurrentIndex=0,this._thirtyDaysFareMonthIndex=0,this._thirtyDaysFareDayIndex=0,this._thirtyDaysFareIsLoadingFares=!1,this._thirtyDaysCalendarRemainingDays=0},f.prototype._collapseAndResolveData=function(){var b=this[this.watchedService].getDates();b&&b.length&&(this._$scope.stickyBarEnabled(!1),this._$scope.calendar.departingDateString=c(b[0]).format("MMM DD"),this._$scope.calendar.returningDateString=b[1]&&c(b[1]).format("MMM DD"),this._$singleTimeout(function(){a("#calendar .calendar-inner").addClass("collapsed-section");var b=a("#fares").offset().top-a("#yts").height()-a("#change-guider").height();a(window).scrollTop(b),this._$scope.calendar.isCollapsed=!0}.bind(this),0))},f.prototype.isAlaskaFlightsEnabled=function(){return this._$scope.context.is(this._$scope.context.type.BOOK)},f.prototype._checkIsAlaskaOnlyCalendar=function(){var a={AS:0,VX:0},c=!1;return b.forEach(this._$scope.calendar.months,function(c){b.forEach(c.days,function(b){"undefined"!=typeof b.bestDepartureFare&&(!b.bestDepartureFare.notAvailable&&b.bestDepartureFare.deepLink?a.AS=a.AS+1:!b.bestDepartureFare.notAvailable&&!b.bestDepartureFare.deepLink&&(a.VX=a.VX+1))})}.bind(this)),c=a.AS>0&&a.VX<=0,this._fareService.setIsAlaskaOnlyCalendar(c),c},f.prototype._calcPassengers=function(a){var b=0,c=!1;"undefined"!=typeof a.numOfAdults&&(b+=a.numOfAdults),"undefined"!=typeof a.numOfChildren&&(b+=a.numOfChildren),"undefined"!=typeof a.numOfInfants&&(b+=a.numOfInfants),"undefined"!=typeof a.numOfPets&&(b+=a.numOfPets),(b>=8||a.numOfPets)&&(c=!0),this._pubSubService.publish("tripCalendar.passengersAlaska",[c]),this._checkIsAlaskaOnlyCalendar()&&this.isAlaskaFlightsEnabled()&&b>7&&this._statusService.setAlert({format:this._statusService.format.ALERT,copy:this._ResourceBundle.statusMessages.fare.alaskaToManyPassengers,recoverable:!0,doNotRollbackOnDismiss:!0,dismissCallBack:function(){this._locationService.resetApp()}.bind(this),controls:{close:!1,dismiss:"start over"}})},f.prototype._nextBestFaresSearch=function(){var a=this._thirtyDaysStartDates.shift(),b=this._$q.defer();return this._fareService.searchThirtyDaysFare(a).then(function(a){if(this._calcPassengers(a),a.oneWaySearchResultList){var c=a.oneWaySearchResultList;this._fareService.appendBestDepartingFares(c[0].departingFlightsInfo.bestFareList),this._fareService.appendBestReturningFares(c[1].departingFlightsInfo.bestFareList)}else this._fareService.setIsAlaskaOnlyCalendar(!1),a.departingFlightsInfo&&this._fareService.appendBestDepartingFares(a.departingFlightsInfo.bestFareList),a.returningFlightsInfo&&this._fareService.appendBestReturningFares(a.returningFlightsInfo.bestFareList);this._updateBestFareMonth(),b.resolve()}.bind(this),b.reject.bind(this)),b.promise},f.prototype._thirtyDaysFarePromoCodeSearch=function(){this._resetThirtyDaysFareValues(),this._thirtyDaysStartDates=this._lastThirtyDaysStartDates.slice(),this._thirtyDaysFareBreakPoints=this._lastThirtyDaysFareBreakPoints.slice(),this._thirtyDaysFareSearch()},f.prototype._resetThirtyDaysFareValues=function(){this._thirtyDaysFareMonthIndex=0,this._thirtyDaysFareDayIndex=0,this._thirtyDaysFareIsLoadingFares=!1,this._thirtyDaysFareBreakPointsCurrentIndex=0;for(var a in this.monthsArray)for(var b in this.monthsArray[a].days){var c=this.monthsArray[a].days[b];c.thirtyDaysFareIsLoadingState=this.loadingState.INITIAL}},f.prototype.shouldShowBestDepartingFare=function(a){return!(this._$scope.calendar.departingDayIsSelected||"loaded"!==a.thirtyDaysFareIsLoadingState||a.isFree&&this._$scope.calendar.isIropFree())&&(a.isDisabled=!1,!0)},f.prototype.shouldShowBestReturningFare=function(a){return!(!this._$scope.calendar.departingDayIsSelected||this._$scope.calendar.showReturnSameDay&&a.isMouseOver&&a.isDepartingDay||"loaded"!==a.thirtyDaysFareIsLoadingState||a.isFree&&this._$scope.calendar.isIropFree())&&(a.isDisabled=!1,!0)},f.prototype.bestFareIsNotUndefined=function(a){return a&&a.fare&&a.fare.dollarFare&&"undefined"!=typeof a.fare.dollarFare.totalFare},f.prototype.anyFareIsAvailable=function(a){return a&&a.fare&&!a.notAvailable},f.prototype.anyFareIsAvailableExceptLowestFare=function(a){return this.anyFareIsAvailable(a)&&a.fare.notAvailable},f.prototype.dayIsDisabled=function(a){return a.isDisabled||this.shouldShowBestDepartingFare(a)&&!this.anyFareIsAvailable(a.bestDepartureFare)||this.shouldShowBestReturningFare(a)&&!this.anyFareIsAvailable(a.bestReturningFare)},f.prototype.isSalesAvailable=function(a){var b=this._$scope.calendar;return(a.returningHasSale&&b.departingDayIsSelected||a.departureHasSale&&!b.departingDayIsSelected)&&!a.dayType&&!a.isToday&&!this.dayIsDisabled(a)},f.prototype.initScopes=function(){this._$scope.calendar={noPrevMonths:!0,currentSelectionState:1,multiCity:{},days:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],showMoreDates:this.showMoreDates.bind(this),weekBarSticky:!1,titleClass:this.getTitleClass.bind(this),isTouch:d.touch,showReturnSameDay:!1,toggleReturnSameDay:this.toggleReturnSameDay.bind(this),selectDay:this.selectDay.bind(this),isSelectedDay:this.isSelectedDay.bind(this),isIropFree:this.isIropFree.bind(this),departingDayIsSelected:!1,isCollapsed:!1,changeSection:this._changeSection.bind(this),isOneWay:this._tripService.getTripType()===this._tripService.ONE_WAY,isDeepLinkOnly:this.isDeepLinkOnly.bind(this)},b.extend(this._$scope,{shouldShowBestDepartingFare:this.shouldShowBestDepartingFare.bind(this),shouldShowBestReturningFare:this.shouldShowBestReturningFare.bind(this),bestFareIsNotUndefined:this.bestFareIsNotUndefined.bind(this),anyFareIsAvailableExceptLowestFare:this.anyFareIsAvailableExceptLowestFare.bind(this),anyFareIsAvailable:this.anyFareIsAvailable.bind(this),dayIsDisabled:this.dayIsDisabled.bind(this),isSalesAvailable:this.isSalesAvailable.bind(this)}),this._$scope.$watch(function(){return this._currentSelectionState}.bind(this),function(a,b){a!==b&&a!==this._maxSelectionState&&(this._$scope.calendar.currentSelectionState=a+1,this.updateMultiCityLabels())}.bind(this))},f.prototype._changeSection=function(){this._$scope.calendar.isCollapsed=!1,this._$scope.stickyBarEnabled(!0),this._accessibleService.resolveExpand(1),this._$scope.context.is(this._$scope.context.type.BOOK)?this._workflowService.transition(this._workflowService.getCurrentState(),"DATE_PICKER_STATE",!0):(this._changeService.clearDates(),this._pubSubService.publish("ancillariesSelector.setVisibility",[!1]),this._statusService.setChangeGuider(this._statusService.message.CHANGE_DATES)),this._fareService.resetService()},f.prototype.isIropFree=function(){return this._changeService.isIropFree()},f.prototype.isSelectedDay=function(a){a.isFiller||(a.date===this._departingDayStoredDate&&(this._departingDayObj=a,a.isDepartingDay=!0,a.dayType="Departing"),a.date===this._returningDayStoredDate&&(this._returningDayObj=a,a.isReturningDay=!0,a.dayType="Returning"))},f.prototype.selectDay=function(a,b){this._departingDayStoredDate=null,this._returningDayStoredDate=null,this.onDaySelect(a,b.currentTarget)},f.prototype.updateMultiCityLabels=function(){var a=this._isTripType(this._tripService.MULTI_CITY,{watchedService:!0});if(this._$scope.calendar.isMultiCity=a,a){var b=this[this.watchedService].getAirport(this._currentSelectionState);for(var c in b)this._$scope.calendar.multiCity[c]=b[c].name}},f.prototype._isTripType=function(a,b){return"object"==typeof b&&(b=b.watchedService===!0?this[this.watchedService].getTripType():b),a===b},f.prototype.getTitleClass=function(){var a="step-";return a+=this._currentSelectionState>=this._maxSelectionState?this._maxSelectionState:this._currentSelectionState+1},f.prototype.resetDates=function(){this._$scope.calendar.departingDayIsSelected=!1,this._departingDayStoredDate=null,this._returningDayStoredDate=null;var a=!!this._departingDayObj&&this._departingDayObj,c=!!this._returningDayObj&&this._returningDayObj;c&&(c.isReturningDay=!1,c.dayType=null),a&&(a.isDepartingDay=!1,a.dayType=null),b.forEach(["_departingDayObj","_departingDate","_firstDate","_returningDayObj","_returningDate","_lastDate"],function(a){this[a]=null},this),this[this.watchedService].clearDates(),this._currentSelectionState=0,this._returnMessageFlag=!1,this.setDateRestrictions(),this.refreshDateRestrictions(),this._$scope.calendar.showReturnSameDay=!1,this._$scope.calendar.clearDateRange(),this._fareService.reset(),this._workflowService.isBeforeCurrentState("DATE_PICKER_STATE")&&this._workflowService.transition(this._workflowService.getCurrentState(),"DATE_PICKER_STATE",!0)},f.prototype.showMoreDates=function(){this.getMonths(3),this._thirtyDaysFareIsLoadingFares||this._thirtyDaysFareSearch(),this._accessibleService.setText("More calendar dates added.")},f.prototype.setDateRestrictions=function(a){a="number"==typeof a?a:this._currentSelectionState,this._dateRestrictions&&(this.currentRestrictions=this._dateRestrictions[a],this.currentRestrictions&&this.currentRestrictions.seasonalAvailability?(this.seasonalStartDate=c(this.currentRestrictions.seasonalAvailability.from),this.seasonalEndDate=c(this.currentRestrictions.seasonalAvailability.to)):(this.seasonalStartDate=this.currentMoment.clone(),this.seasonalEndDate=this.currentMoment.clone().add("days",this._ResourceBundle.calendar.MAX_SELECTABLE_DAYS)))},f.prototype._onFinishInitialScroll=function(){this._$scope.calendar.canDisableScrollUpBar=!0},f.prototype.getMonths=function(a){this.lastFetchedMonthsAmount=a;var b=30;this.setDateRestrictions();for(var d=0;d<a;d++){if(this.latestMonth){if(this._lastAvailableDate&&this.latestMonth.isSame(this._lastAvailableDate,"month"))break;this.latestMonth.add("months",1).startOf("month")}else this.latestMonth=this.currentMoment.clone().min(this.seasonalStartDate);var e=this.latestMonth.date(),f=this.latestMonth.day(),g=this.latestMonth.daysInMonth();this._lastAvailableDate&&this.latestMonth.isSame(this._lastAvailableDate,"month")&&(g=e+this._lastAvailableDate.diff(this.latestMonth,"days"));for(var h=[],i=1;i<=f;i++)h.push({isDisabled:!0,isFiller:!0});for(var i=e;i<=g;i++){var j=this.latestMonth.clone().set("date",i),k={momentDate:j,date:j.format("YYYY-MM-DD"),day:j.format("DD"),month:j.format("MM"),dayShort:j.format("ddd"),year:j.format("YYYY"),isToday:i===parseInt(e)&&0===d,isFree:!1,thirtyDaysFareIsLoadingState:this.loadingState.INITIAL};if(this._$scope.context.is(this._$scope.context.type.CHANGE)){var l=this._changeService.getPnrModel();if(l&&l.irop){var m=c(l.iropInfo.segmentStart,"YYYY-MM-DD"),n=c(l.iropInfo.segmentEnd,"YYYY-MM-DD"),o=c([k.year,k.month,k.day].join("-"));k.isFree=o>=m&&o<=n}}h.push(k),"Sat"===k.dayShort&&this._thirtyDaysFareBreakPoints.push(k),this._thirtyDaysCalendarRemainingDays--,this._thirtyDaysCalendarRemainingDays<0&&(this._thirtyDaysStartDates.push(k.date),this._thirtyDaysCalendarRemainingDays=b,"Sat"!==k.dayShort&&this._thirtyDaysFareBreakPoints.length&&this._thirtyDaysFareBreakPoints.push(k))}this.monthsArray.push({days:h,month:this.latestMonth.month(),year:this.latestMonth.year(),monthYear:this.latestMonth.format("MMMM YYYY")})}this._lastThirtyDaysStartDates=this._thirtyDaysStartDates.slice(),this._lastThirtyDaysFareBreakPoints=this._thirtyDaysFareBreakPoints.slice(),this.refreshDateRestrictions()},f.prototype._isFareSales=function(a){return!(!a||!a.fare||a.fare.notAvailable)&&(a.fare.fareBasisCode.indexOf("SL")!==-1||a.fare.fareBasisCode.indexOf("N6")!==-1)},f.prototype._updateBestFareMonth=function(){for(var a in this.monthsArray){var b=this.monthsArray[a];for(var c in b.days){var d=b.days[c];d.date&&(d.bestDepartureFare=this._fareService.bestDepartureFares()[d.date],d.bestReturningFare=this._fareService.bestReturningFares()[d.date],d.departureHasSale=this._isFareSales(d.bestDepartureFare),d.returningHasSale=this._isFareSales(d.bestReturningFare))}}},f.prototype._handleNextThirtyDaysFareBreakPoints=function(){this._oldThirtyDaysFareDayIndex=this._thirtyDaysFareDayIndex,this._oldThirtyDaysFareMonthIndex=this._thirtyDaysFareMonthIndex,this._oldThirtyDaysFareBreakPoint=this._thirtyDaysFareBreakPoints[this._thirtyDaysFareBreakPointsCurrentIndex];for(var a=this._thirtyDaysFareMonthIndex;a<this.monthsArray.length;a++){for(var b=this.monthsArray[a],c=this._thirtyDaysFareDayIndex,d=c;d<b.days.length;d++){var e=b.days[d];e.thirtyDaysFareIsLoadingState!==this.loadingState.LOADED&&(e.thirtyDaysFareIsLoadingState=this.loadingState.LOADING);var f=this._thirtyDaysFareBreakPoints[this._thirtyDaysFareBreakPointsCurrentIndex];if(e===f)return this._thirtyDaysFareBreakPointsCurrentIndex++,void(d>=b.days.length-1?(this._thirtyDaysFareDayIndex=0,this._thirtyDaysFareMonthIndex++):(this._thirtyDaysFareDayIndex=d+1,this._thirtyDaysFareMonthIndex=a))}this._thirtyDaysFareDayIndex=0}},f.prototype._updatePreviousThirtyDaysFareBreakPoints=function(){for(var a=this._oldThirtyDaysFareMonthIndex;a<this.monthsArray.length;a++){for(var b=this.monthsArray[a],c=this._oldThirtyDaysFareDayIndex,d=c;d<b.days.length;d++){var e=b.days[d];if(e.thirtyDaysFareIsLoadingState=this.loadingState.LOADED,(e.isDepartingDay||e.isReturningDay)&&e.date&&!this.bestFareIsNotUndefined(e.bestDepartureFare)&&this.resetDates(),e===this._oldThirtyDaysFareBreakPoint)return}this._oldThirtyDaysFareDayIndex=0}},f.prototype._isReturnSelectionState=function(){var a=this._isTripType(this._tripService.ONE_WAY,{watchedService:!0});return!a&&this._departingDate&&!this._returningDate},f.prototype.refreshDateRestrictions=function(){var a=this._isReturnSelectionState();b.forEach(this.monthsArray,function(c){b.forEach(c.days,function(b){if(b.momentDate){var c=a&&b.momentDate.isBefore(this._departingDate,"day"),d=this.currentRestrictions&&this.currentRestrictions.noFlyDates&&this.currentRestrictions.noFlyDates.indexOf(b.dayShort)>-1,e=b.momentDate.isBefore(this.seasonalStartDate,"day")||b.momentDate.isAfter(this.seasonalEndDate,"day");b.isDisabled=!b.isDepartingDay&&!b.isReturningDay&&(c||d||e)}},this)},this),this._$scope.calendar.months=this.monthsArray,this._$scope.calendar.reachLastAvailableDate=this._lastAvailableDate&&this._lastAvailableDate.isSame(this.latestMonth,"month"),this._$scope.calendar.noMoreDates=this._$scope.calendar.reachLastAvailableDate||this.monthsArray.length>12||!this.latestMonth||this.latestMonth.isSame(this.seasonalEndDate,"month")||this.latestMonth.isAfter(this.seasonalEndDate,"month"),this._$scope.calendar.onUpdate()},f.prototype.hide=function(){
this._$scope.visible=!1,this._$scope.stickyBarEnabled(!1)},f.prototype.show=function(){this._$scope.calendar.visible=!0,this._$scope.stickyBarEnabled(!0)},f.prototype.destroyCalendar=function(){this.monthsArray.length&&(this.monthsArray=[],this.latestMonth=null)},f.prototype.init=function(){this[this.watchedService].getDateRestrictions().then(function(a){this._lastAvailableDate=this._$scope.core.config.lastAvailableDate&&c(this._$scope.core.config.lastAvailableDate),this._thirtyDaysStartDates=[],this._thirtyDaysFareBreakPoints=[],this._thirtyDaysFareBreakPointsCurrentIndex=0,this._thirtyDaysFareMonthIndex=0,this._thirtyDaysFareDayIndex=0,this._thirtyDaysFareIsLoadingFares=!1,this.destroyCalendar(),this._currentSelectionState=this._loadFromPersistence?2:0,this._dateRestrictions=a,this.getMonths(3),this.show(),this.updateMultiCityLabels(),this._thirtyDaysFareSearch()}.bind(this))},f.prototype._thirtyDaysFareSearch=function(){this._thirtyDaysFareIsLoadingFares=!0,this._handleNextThirtyDaysFareBreakPoints(),this._nextBestFaresSearch().then(function(){this._updatePreviousThirtyDaysFareBreakPoints(),this._handleThirtyDaysFare(),this._checkIsAlaskaOnlyCalendar()}.bind(this),function(){this._updatePreviousThirtyDaysFareBreakPoints()}.bind(this))},f.prototype._handleThirtyDaysFare=function(){return this._handleNextThirtyDaysFareBreakPoints(),this._oldThirtyDaysFareBreakPoint?c(this._oldThirtyDaysFareBreakPoint.date).isSame(this._thirtyDaysStartDates[0])?(this._updatePreviousThirtyDaysFareBreakPoints(),void this._thirtyDaysFareSearch()):void this._$singleTimeout(function(){this._updatePreviousThirtyDaysFareBreakPoints(),this._handleThirtyDaysFare()}.bind(this),300):(this._updatePreviousThirtyDaysFareBreakPoints(),void(this._thirtyDaysFareIsLoadingFares=!1))},f.prototype.showMessage=function(a,b){var d,e,f,g,h=this[this.watchedService].getTripTypeLegs(),i={},j={RETURN_DATE:this._statusService.message.CALENDAR_SELECT_RETURN,RETURN_DATE_MULTI_CITY:this._statusService.message.CALENDAR_SELECT_RETURN_MULTI_CITY,COMPLETE_ONE_WAY:this._statusService.message.CALENDAR_DONE_ONE_WAY,COMPLETE_ROUND_TRIP:this._statusService.message.CALENDAR_DONE_ROUND_TRIP,COMPLETE_SAME_DAY:this._statusService.message.CALENDAR_DONE_SAME_DAY};if(this._currentSelectionState>=h)e=this[this.watchedService].getDates(),f=c(e[0],"YYYY-MM-DD"),g=c(e[1],"YYYY-MM-DD"),i={duration:this[this.watchedService].getTripLength(0),tripStart:f.format("MMMM Do"),tripEnd:g.format("MMMM Do")||"",monthStart:f.format("MMMM"),monthEnd:g.format("MMMM")||"",tripStartDay:f.format("Do"),tripEndDay:g.format("Do")||""},d=a?j.COMPLETE_SAME_DAY:1===h?j.COMPLETE_ONE_WAY:j.COMPLETE_ROUND_TRIP;else{if(this._returnMessageFlag)return;this._returnMessageFlag=!0,d=this._$scope.calendar.isMultiCity?j.RETURN_DATE_MULTI_CITY:j.RETURN_DATE}this._statusService.setStatus({format:this._statusService.format.SUCCESS,copy:d,allyMessage:b,data:i})},f.prototype.toggleReturnSameDay=function(a,b){var c=this._isTripType(this._tripService.ONE_WAY,{watchedService:!0});if(!c&&(this._$scope.calendar.showReturnSameDay=a&&b&&this.anyFareIsAvailable(b.bestReturningFare),b&&"loaded"!==b.thirtyDaysFareIsLoadingState))var d=this._$scope.$watch(function(){return b.thirtyDaysFareIsLoadingState},function(c,e){c!==e&&(d(),this._$scope.calendar.showReturnSameDay=a&&b&&this.anyFareIsAvailable(b.bestReturningFare))}.bind(this))},f.prototype.onDaySelect=function(b,d,e,f){var g=this._accessibleService.isAccessibleMode(),h=a(d).text().replace(/(?:\r\n|\r|\n)/g," ")+" Selected";this._day=b;var i=e||this._currentSelectionState;if(this._loadFromPersistence&&this._tripService.setLoadCalendarFromPersistence(!1),this._day.isDepartingDay&&!f)return void(g&&this._handleDepartureSelectModal(b,d));if(i>=this[this.watchedService].getTripTypeLegs()&&(this.resetDates(),i=this._currentSelectionState,this._$scope.calendar.clearDateRange()),this.dayIsDisabled(this._day)||this._day.isDepartingDay&&!f||this._departingDate&&b.momentDate.isBefore(this._departingDate,"day"))return this.resetDates(),i=this._currentSelectionState,this._$scope.calendar.clearDateRange(),void 0;var j={0:{callback:function(){this.setDateRestrictions(),this.refreshDateRestrictions(),this.toggleReturnSameDay(!0,b),this._$scope.calendar.selectReturningDateIndicator(b,d)},dayObj:"_departingDayObj",date:"_departingDate",day:"isDepartingDay",dayLabel:"Departing"},1:{callback:function(){this.setDateRestrictions(0),this.refreshDateRestrictions(),this.toggleReturnSameDay(!1)},dayObj:"_returningDayObj",date:"_returningDate",day:"isReturningDay",dayLabel:"Returning"}};i||(i=0),this[j[i].dayObj]=this._day,this[j[i].date]=this._day.momentDate,b[j[i].day]=!0,b.dayType=j[i].dayLabel;var k=this._changeService.getExceptions();if(k&&k.flightList[1]){var l=k.flightList[1].departureDateTime,m=k.flightList[0].departureDateTime,n=this[j[i].date].isAfter(c(l,"YYYY-MM-DD")),o=this[j[i].date].isBefore(c(m,"YYYY-MM-DD"));(n||o)&&this._statusService.setAlert({format:this._statusService.format.ERROR,copy:this._statusService.message.FARE_INVALID_DATE,allyMessage:h,data:{}})}this._currentSelectionState++;var p=this._isTripType(this._tripService.ONE_WAY,{watchedService:!0});p?this._currentSelectionState++:this._$scope.calendar.departingDayIsSelected=!0,!p&&!f&&g&&this._day.isDepartingDay&&this._handleDepartureSelectModal(b,d),a(d).siblings(".is-faux-focused").removeClass("is-faux-focused"),this[this.watchedService].setDate(b.date),this.showMessage(f,h),j[i].callback.call(this),this._$singleTimeout(function(){this._$scope.$apply()}.bind(this)),i||this._pubSubService.publish("adobeAnalytics.deptDateSelected",[this._tripService.getSelectedTripPublicModel()])},f.prototype.isDeepLinkOnly=function(a){var b=this._$scope.calendar.departingDayIsSelected?a.bestReturningFare:a.bestDepartureFare;return b&&b.deepLink},f.prototype._handleDepartureSelectModal=function(b,c){var d=this._ResourceBundle.modal.allyDepartureDate,e=a(c).parents(".month__days").eq(0)[0];this.toggleReturnSameDay(!0,b),this._$modal.open({controller:"AllyDepartureDateModalCtrl",contentType:"custom",size:d.SIZE,scope:this._$scope,title:d.TITLE,templateUrl:d.TEMPLATE_URL,showFooter:!0,footerLinkText:"Continue with original date",origin:e})};var g=function(e,f,g,h){function i(b,c){var d=a(c.currentTarget),e=d.scope();if(!(h._currentSelectionState>1&&d.hasClass(E)||e.dayObj.isDisabled||1===h._currentSelectionState&&e.dayObj.momentDate.isBefore(h._departingDate,"day")))if(e.dayObj.isMouseOver=b,h._$singleTimeout(function(){e.$apply()}),b){if(clearTimeout(u),1===h._currentSelectionState){var g=f.find("li.days__day").filter(":not('.days__day--filler')");g.removeClass(E);var i;for(var j in g){var k=a(g[j]).scope();if(k.dayObj.date===h._departingDayObj.date){i=g[j];break}}var l=g.index(i),m=g.index(d);D=g.slice(l+1,m).addClass(E)}}else u=D.length&&h._currentSelectionState<2?setTimeout(function(){D.removeClass(E)},250):null}function j(b){b&&(b.stopPropagation(),a(b.currentTarget).closest(".days__day").removeClass("is-return-same-day is-departing")),D.length&&D.removeClass(E),h.resetDates.call(h)}function k(b){var c=a(b?b.currentTarget:h._day),d=b?c.scope().dayObj:h._day;c.closest(".days__day").addClass("is-return-same-day"),h.onDaySelect.call(h,d,null,1,!0)}function l(){var b=a(".days__day:not(.is-disabled):first"),c=b.index();c<7?n({firstMonth:!0}):h._scrollService.go(a(b),{duration:750,offset:J[e.calendar.bp]})}function m(){A===(z.alaskaLink&&z.alaskaLink.elem)?n({prevElem:z[z.length-1].elem}):e.calendar.canScrollUpFromMiddleOfMonth&&0===A.index()?n({firstMonth:!0}):n(),e.calendar.canScrollUpFromMiddleOfMonth=!1}function n(b){var c=b&&b.prevElem;c||(c=b&&b.firstMonth?H.find("section:first"):A.prev()),c.length&&(h._scrollService.go(c,{duration:750,offset:J[e.calendar.bp]}),p(a(c)))}function o(){e.calendar.canScrollUpFromMiddleOfMonth=!1;var b=A.next();b.length?(h._scrollService.go(b,{duration:750,offset:J[e.calendar.bp]}),p(a(b))):e.calendar.noMoreDates?z.alaskaLink&&h._scrollService.go(z.alaskaLink.elem,{duration:750}):(h.getMonths(1),h._thirtyDaysFareIsLoadingFares||h._thirtyDaysFareSearch())}function p(a){e.calendar.currentMonthLabel=a.attr("data-bo-attr-month-short")}function q(c){if(z&&z[0]){var d=z[0].elem,e=0,f=c||a(window).scrollTop(),g=Math.round(f+a(window).height()/2);return b.forEach(z,function(a,b){g>a.top&&(d=a.elem,e=b)}),z.alaskaLink&&g>z.alaskaLink.top&&(d=z.alaskaLink.elem,e=99),{elem:d,index:e}}}function r(b,c){if(e.calendar.canDisableScrollUpBar&&(e.calendar.scrollUpBarEnabled=!1),z){if(B=e.calendar.noPrevMonths,w=F.offset().top,x=H.offset().top,y=H.offset().top+H.height(),G="large"===e.calendar.bp?e.calendar.showReturnSameDay?150:90:e.calendar.showReturnSameDay?120:60,c>w-G&&c<y-80){var d=q(c);A=d.elem,p(a(A)),e.calendar.noPrevMonths=0===d.index,e.calendar.scroll_up_noDates=!1,!e.calendar.stickyBarEnabled&&!e.calendar.isCollapsed&&(e.calendar.stickyBarEnabled=!0)}else e.calendar.stickyBarEnabled&&(e.calendar.stickyBarEnabled=!1,A=z[0]?z[0].elem:null,e.calendar.noPrevMonths=!0);e.calendar.inFocus=c>x-480&&c<y-80,B!==e.calendar.noPrevMonths&&h._$singleTimeout(function(){e.$apply()})}}function s(){var b=f.find("section.month"),c=[];a.each(b,function(b,d){var e=a(d),f=e.offset();c.push({elem:e,top:Math.round(f.top),bottom:Math.round(f.top+e.height())})});var d=a("[vx-alaska-calendar-link]");if(d.length){var e=d.offset();c.alaskaLink={elem:d,top:Math.round(e.top),bottom:Math.round(e.top+d.height())}}return c}function t(){if(!I){var b=e.calendar.months[0].days,d=b.map(function(a){return a.isFiller}).indexOf(void 0),d=c().format("YYYY-MM-DD")===e.calendar.months[0].days[d].date?d:-1,f=a(".day")[d];a(f).prepend('<div class="day__today">Today</div>'),I=!0}}var u,v,w,x,y,z,A,B,C=".days__day",D=[],E="is-range-date",F=f.find("div[data-js-sticky-bar]"),G=60,H=f.find("[data-js-calendar-months]"),I=!1,J={small:-60,medium:-120,large:-150};e.$watchCollection(h[h.watchedService].getVisibleSections,function(a){var b=!!a.CALENDAR;e.calendar.isVisible&&b||(e.calendar.isVisible=b,b?h.init():h._initVars())});var K=function(a){var b=h._workflowService.getCurrentState();a&&"DATE_PICKER_STATE"===b&&(h._locationService.setShouldRender(!0),h._workflowService.transition("DATE_PICKER_STATE"))},L=function(a){if(a){var b=h._fareService.loadFares(!0);b.then(function(){h._statusService.setChangeGuider(h._statusService.message.CHANGE_FARES),h._scrollService.scroll({target:"FARE_SELECTOR_STATE",delay:1e3}).then(function(){h._collapseAndResolveData()});var a=h._changeService.validateIropChange("DATES");if(!a.valid){var b=h._changeService.getPnrModel(),d=c(b.iropInfo.segmentStart).zone(b.iropInfo.segmentStart),e=c(b.iropInfo.segmentEnd).zone(b.iropInfo.segmentEnd),f={format:h._statusService.format.ALERT,copy:h._statusService.message[a.message],recoverable:!0,controls:{close:!1,dismiss:"got it"},data:{startDate:d.format("MMMM Do YYYY"),endDate:e.format("MMMM Do YYYY")}};h._statusService.setAlert(f)}}.bind(this))}};e.$watch(h._fareService.getAllDatesSelected,function(a){var b=h._$scope.context.is(h._$scope.context.type.BOOK)?K:L;b(a)}.bind(this)),e.$watch(h._windowService.breakpoint,function(a){e.calendar.bp=a}),e.calendar.clearDateRange=function(){D.length>0&&D.removeClass(E)},e.calendar.returnSameDay=k,e.calendar.resetDates=j,e.calendar.nextMonth=o,e.calendar.prevMonth=n,e.calendar.handleUpCaratClick=m,e.calendar.scrollToFirstAvailableFare=l,e.calendar.monthsUpdated=function(){var b,c=H.find("section");e.calendar.ready?(b=c.eq(-h.lastFetchedMonthsAmount),h._scrollService.go(b,{duration:750,offset:J[e.calendar.bp]}),h._$singleTimeout(function(){p(a(b))}),e.calendar.onUpdate()):e.calendar.ready=!0},e.stickyBarEnabled=function(b){e.calendar.stickyBarEnabled=b,b&&!v?a.subscribe("windowService.scroll",r):b||(a.unsubscribe("windowService.scroll",r),e.calendar.weekBarSticky=!1)},e.calendar.onUpdate=function(){h._$singleTimeout(function(){z=s();var a=q();a&&(A=a.elem,t())})},e.calendar.selectReturningDateIndicator=function(b,c){var e=h._isTripType(h._tripService.ONE_WAY,{watchedService:!0});if(!e&&!d.touch){var f,g=a(c),i=g.next(".days__day");f=i.length?i:g.closest(".month").next(".month").find("li:not(.days__day--filler)").eq(0),f.addClass("is-mouseover"),g.one("mouseleave",function(){f.removeClass("is-mouseover")}).one("click",function(){f.removeClass("is-mouseover")})}},e.calendar.isTouch||f.on("mouseenter",C,i.bind(this,!0)).on("mouseleave",C,i.bind(this,!1)),h._pubSubService.subscribe("calendar.datesUpdated",function(){var a=f.find("li.days__day").filter(":not('.days__day--filler')");a.removeClass(E)}),e.$on("$destroy",function(){f.off()})};return e}),c("book/directives/trip-fare-itinerary",[],function(){"use strict";var a=function(){return{restrict:"A",scope:!0,controller:b,link:c}},b=function(a,b){this._$scope=a,this._windowService=b};b.$inject=["$scope","windowService"];var c=function(a,b,c){var d=c.vxTripFareItinerary;a.$watch("fares.expandedView["+d+"]",function(a){})};return a}),c("book/directives/trip-seven-day-fares",["jquery","moment"],function(a){"use strict";var b=function(){return{restrict:"A",scope:{type:"@"},controller:"TripSevenDayFaresCtrl",templateUrl:"/app/book/directives/trip-seven-day-fares.tpl.html",link:c}},c=function(b,c,d,e){var f=e._windowService.dimensions(),g=a(c).find(".seven-days-outer"),h=g.find(".seven-days-inner"),i=function(){var a=(h.width()-f.width)/2;g.scrollLeft(a)},j=function(a){b.bp=a,"small"===a&&i()};b.$watch(e._windowService.breakpoint,j),b.$on("lowestFaresReceived",i)};return b}),c("book/directives/book-airport-picker",["angular","jquery","modernizr"],function(a,b,c){var d=function(){return{scope:{pickerType:"@",airports:"=",preselected:"="},controller:e,restrict:"A",replace:!0,templateUrl:"/app/book/directives/book-airport-picker.tpl.html",link:f}},e=function(a,b,c,d,e,f,g,h,i,j,k,l){this._$scope=a,this._$element=b,this._pubSubService=c,this._resourceBundle=d,this._tripService=f,this._watchedService=j.contextIs(j.contexts.BOOK)?f:g,this._changeService=g,this._scrollService=h,this._windowService=i,this._locationService=j,this._utilsService=k,this._preselected=!1,this._$singleTimeout=e,this._accessibleService=l,a.airports&&a.airports.length>0&&(a.airports=a.airports.sort(function(a,b){return a.name<b.name?-1:a.name>b.name?1:0})),this._pickerTypes={DESTINATION:"destination",DEPARTING:"departing"},this._placeholderText="City",a.airportPicker={airports:[],filteredAirports:[],getAirportList:this._getAirportList.bind(this),isActive:!1,isVisible:!1,originalAirport:null,pickerType:a.pickerType,placeholderText:this._placeholderText,preselected:null,secondAirportList:null,selectAirport:this._selectAirport.bind(this),selectedAirport:this._placeholderText,selectedAirportIndex:0,toggleVisible:this._toggleVisible.bind(this),typeahead:"",typeaheadSuggestion:"",setFocusMessage:this.setFocusMessage.bind(this)},this._$singleTimeout(function(){a.$watch("airports",this._updateAirports.bind(this)),a.$watch("preselected",this._updatePreselected.bind(this))}.bind(this));var m=a.pickerType===this._pickerTypes.DEPARTING?this._pickerTypes.DESTINATION:this._pickerTypes.DEPARTING;this._pubSubService.subscribe(m+"PickerOpened",function(){this._$scope.airportPicker.isVisible&&(this._$scope.airportPicker.isVisible=!1,this._resetPickerState())}.bind(this)),a.pickerType===this._pickerTypes.DESTINATION&&(this._pubSubService.subscribe("bookerAirportSelected",function(a,b){b===this._pickerTypes.DEPARTING&&(this._$scope.airportPicker.isActive=!1,this._$scope.airportPicker.selectedAirport=this._placeholderText,this._$scope.airportPicker.originalAirport="")}.bind(this)),this._pubSubService.subscribe("resetDestinationAirport",function(){this._$scope.airportPicker.isActive=!1,this._$scope.airportPicker.selectedAirport=this._placeholderText,this._$scope.airportPicker.originalAirport=""}.bind(this))),this._pubSubService.subscribe("peoplePicker.visible",function(){this._$scope.airportPicker.isVisible=!1,this._resetPickerState()}.bind(this)),this._pubSubService.subscribe(a.pickerType+"AirportPreselected",function(a){this._$scope.airportPicker.selectedAirport=a,this._$scope.airportPicker.isActive=!0}.bind(this)),this._$scope.$watch("airportPicker.selectedAirport",function(a){a===this._placeholderText&&this._pubSubService.publish("setTripBookerSectionIncomplete")}.bind(this)),this._detectClickCallback=this._detectClick.bind(this),this._locationService.contextIs(this._locationService.contexts.CHANGE)&&this._saveBookingFlowAirport()};e.prototype._enableAlaskaAirports=function(){return this._tripService.isAlaskaFlightsEnabled()},e.prototype._updatePreselected=function(a){this._$scope.airportPicker.selectedAirport=a,a!==this._placeholderText&&(this._$scope.airportPicker.originalAirport=a,this._$scope.airportPicker.isActive=!0)},e.prototype._toggleVisible=function(){var a=b("body"),c=this._$scope.airportPicker.pickerType;this._$scope.airportPicker.isVisible=!this._$scope.airportPicker.isVisible,a.off("click",this._detectClickCallback),this._$scope.airportPicker.isVisible?(a.on("click",this._detectClickCallback),this._pubSubService.publish(c+"PickerOpened"),"large"!==this._windowService.breakpoint()&&(this._scrollService.setOffsetType("nav"),this._scrollService.go(this._$element,{duration:350})),this._accessibleService.setText(c+" picker is expanded.")):(this._resetPickerState(),this._accessibleService.setText(c+" picker is collapsed.")),this._$scope.airportPicker.scrollToTop(-1)},e.prototype._detectClick=function(a){var c=b(a.target);c.hasClass("booker__trip-item")||c.parents(".booker__trip-item-container").length<1&&(this._$scope.airportPicker.isVisible=!0,this._toggleVisible(),this._$scope.$apply())},e.prototype._resetPickerState=function(){this._resetTypeaheadValues();var a=b("body");a.off("click",this._detectClickCallback)},e.prototype._resetTypeaheadValues=function(){this._$scope.airportPicker.typeahead="",this._$scope.airportPicker.typeaheadSuggestion=""},e.prototype._selectAirport=function(b,c){var d=function(){a.extend(this._$scope.airportPicker,{selectedAirport:c,isVisible:!1,isActive:!0,originalAirport:c}),this._resetPickerState(),this._pubSubService.publish("bookerAirportSelected",[b,this._$scope.airportPicker.pickerType]),this._$scope.airportPicker.moveToNextField()}.bind(this),e=this._bookingFlowAirport&&c!==this._bookingFlowAirport;e?this._utilsService.openExtrasWarningModal(d):d()},e.prototype._updateAirports=function(a){var b;if(a[0])this._$scope.airportPicker.airports=a;else{b=Object.keys(a),this._$scope.airportPicker.airports=[];for(var c=0;c<b.length;c++)this._$scope.airportPicker.airports.push(a[b[c]])}this._$scope.airportPicker.airports&&this._$scope.airportPicker.airports.length>0&&(this._$scope.airportPicker.airports=this._$scope.airportPicker.airports.sort(function(a,b){return a.name<b.name?-1:a.name>b.name?1:0}))},e.prototype._saveBookingFlowAirport=function(){if(!this._bookingFlowAirport&&this._changeService.hasPNRAncillarySummary()){var a=this._changeService.getAirportData()[0],b=this._$scope.pickerType===this._pickerTypes.DEPARTING?a.dep:a.des;this._bookingFlowAirport=b&&b.name}},e.prototype._getAirportList=function(){var a=this._$scope.airportPicker.airports;return this._enableAlaskaAirports()||(a=a.filter(function(a){return!a.asCity})),this._$scope.airportPicker.typeahead?this._$scope.airportPicker.filteredAirports:a},e.prototype._announceTypeaheadList=function(){var a=this._getAirportList(),b=a.length>1?"There are "+a.length+" options. ":"There is "+a.length+" option. ",c="You are able to use the keyboard up and down arrows to move between items.";a.length&&this._accessibleService.setText(b+c)},e.prototype.setFocusMessage=function(){this._$scope.airportPicker.pickerType===this._pickerTypes.DEPARTING?this._accessibleService.setText(this._resourceBundle.a11yText.ORIGIN_CITY,{airport:this._$scope.airportPicker.originalAirport}):this._$scope.airportPicker.originalAirport?this._accessibleService.setText(this._resourceBundle.a11yText.DESTINATION_CITY_PICKED,{airport:this._$scope.airportPicker.originalAirport}):this._accessibleService.setText(this._resourceBundle.a11yText.DESTINATION_CITY_EMPTY,{originAirport:this._watchedService.getAirportData()[0][this._watchedService.DEPARTURE].name})},e.$inject=["$scope","$element","pubSubService","ResourceBundle","$singleTimeout","tripService","changeService","scrollService","windowService","locationService","utilsService","accessibleService"];var f=function(a,d,e,f){function g(){var b=o.getAirportList()[o.selectedAirportIndex];o.typeaheadSuggestion=i(b),o.selectedAirport="",a.$root.a11y.setText(b.name),a.$apply()}function h(){o.selectedAirport=o.originalAirport,o.selectedAirport||(o.selectedAirport=o.placeholderText,o.isActive=!1)}function i(a){return a&&a.name.replace(new RegExp("^"+o.typeahead+"(.*)|(.*)","i"),"$1")}function j(){var a=new RegExp("\\b"+o.typeahead.trim().replace(/[\/.,\s]+/g," \\b"),"i");return o.airports.filter(function(b){var c=f._enableAlaskaAirports()||!b.asCity,d=b.name.replace(/\s*\/\s*/g," ")+" "+b.abv;return c&&(a.exec(d)||["code","state","country"].some(function(c){return b[c]&&a.exec(b[c])}))})}function k(c){if(o.isVisible){if(o.selectedAirportIndex<o.getAirportList().length-1){o.selectedAirportIndex++;var e=b(d.find(".trip__list-item")[o.selectedAirportIndex]),h=e.offset().top+e.outerHeight(),i=p.offset().top+p.height();h>i&&p.scrollTop(p.scrollTop()+(h-i)),g()}}else f._toggleVisible(),a.$apply()}function l(c){if(c.preventDefault(),o.isVisible&&o.selectedAirportIndex>0){o.selectedAirportIndex--;var e=b(d.find(".trip__list-item")[o.selectedAirportIndex]),i=e.offset().top,j=p.offset().top;i<j&&p.scrollTop(p.scrollTop()-(j-i)),g()}else o.isVisible&&(o.selectedAirport||h(),f._toggleVisible(),a.$apply())}function m(){if(o.isVisible){var b=o.getAirportList()[o.selectedAirportIndex];b?o.selectAirport(b.code,b.name):(o.selectedAirport=o.placeholderText,o.originalAirport="",o.toggleVisible(),a.$apply())}}function n(){o.isVisible&&(o.selectedAirport||h(),f._toggleVisible(),a.$apply())}var o=a.airportPicker,p=d.find(".trip__list-city"),q=d.find(".booker__typeahead-field");o.getSuggestion=function(){return o.typeahead||o.selectedAirport?o.typeaheadSuggestion:o.placeholderText},o.moveToNextField=function(a){o.pickerType===f._pickerTypes.DEPARTING?(b(".booker__typeahead-field--"+f._pickerTypes.DESTINATION).focus(),a&&a.preventDefault()):o.selectedAirport&&o.selectedAirport!==o.placeholderText&&(f._$singleTimeout(function(){b(".booker__btn-continue").focus()}),a&&a.preventDefault())},o.onTypeaheadChange=function(){o.typeahead?o.scrollToTop():o.scrollToTop(-1),o.isVisible=!0,o.selectedAirport="",o.filteredAirports=j(),f._announceTypeaheadList(),o.typeaheadSuggestion=i(o.filteredAirports[0])},o.scrollToTop=function(a){p.scrollTop(0),o.selectedAirportIndex="undefined"==typeof a?0:a};var r;q.on(c.touch?"touchstart":"mousedown",function(){f._toggleVisible(),a.$apply()}),p.on("mousedown",function(){r=!0}),p.on("mouseup",function(){r=!1}),q.on("focus",function(){o.selectedAirport="",b(window).on("keydown",function(a){switch(a.which){case 40:k(a);break;case 38:l(a);break;case 13:a.preventDefault(),m();break;case 27:n()}}.bind(this))}.bind(this)),q.on("blur",function(){r||setTimeout(function(){o.isVisible&&(f._toggleVisible(),a.$apply())},500),b(window).off("keydown"),r=!1}.bind(this))};return d}),c("book/directives/inline-seven-day-fares",["jquery","moment"],function(a){"use strict";var b=function(){return{restrict:"A",scope:{type:"@"},controller:"TripSevenDayFaresCtrl",templateUrl:"/app/book/directives/inline-seven-day-fares.tpl.html",link:c}},c=function(b,c,d,e){var f=e._windowService.dimensions(),g=a(c).find(".seven-days-outer"),h=g.find(".seven-days-inner"),i=function(){var a=(h.width()-f.width)/2;g.scrollLeft(a)},j=function(a){b.bp=a,"small"===a&&i()};b.$watch(e._windowService.breakpoint,j),b.$on("lowestFaresReceived",i)};return b}),c("book/directives/book-airport-list",["angular"],function(){"use strict";var a=function(){return{controller:b,scope:{airports:"=",limit:"=",visible:"=",onSelect:"&",selected:"=",smallModal:"=",a11y:"=accessibilityService"},restrict:"A",replace:!0,templateUrl:"/app/book/directives/book-airport-list.tpl.html"}},b=function(a,b,c,d,e,f,g,h,i,j){this._$scope=a,this._$modal=b,this._resourceBundle=i,this._windowService=c,this._scrollService=d,this._pubSubService=e,this._$timeout=j,this._shouldAutoShow=!0,this._fullListLength=0,this._listExpanded=!1,a.airportList={allCitiesButtonVisible:this.allCitiesButtonVisible.bind(this),showAll:this.showAllAirports.bind(this),selectAirport:this.selectAirport.bind(this),limit:0};var k=h.getContext();this._watchedService=k===h.contexts.BOOK?f:g,this._$scope.$watch(function(){return this._watchedService.getAirport(1)?this._watchedService.getAirport(1).dep:null}.bind(this),function(a){"object"==typeof a&&null!==a&&this._$timeout(function(){this._shouldAutoShow&&this.showAllAirports()}.bind(this))}.bind(this)),a.$watch("airports",this._onAirportListChange.bind(this)),a.$watch("limit",this._onLimitChange.bind(this))};return b.$inject=["$scope","$modal","windowService","scrollService","pubSubService","tripService","changeService","locationService","ResourceBundle","$timeout"],b.prototype._evaluateModalRequirements=function(){this._$scope.smallModal?this._modalWatch=this._$scope.$watch(this._windowService.breakpoint,function(a){"small"===a?this._createDepartingModal():this._destroyDepartingModal()}.bind(this)):"function"==typeof this._modalWatch&&this._modalWatch()},b.prototype._createDepartingModal=function(){var a=this._$scope.$new();a.departingCities=this._$scope.airports,a.citySelected=function(a){this.selectAirport(a),this._destroyDepartingModal()}.bind(this),this._departingModal=this._$modal.open({contentType:"custom",size:"small",scope:a,title:"Select departure city",templateUrl:"/app/book/templates/modals/departing-cities.tpl.html"}),this._departingModal.result.then(null,function(){this._destroyDepartingModal()}.bind(this))},b.prototype._destroyDepartingModal=function(){this._departingModal&&this._departingModal.close(),this._departingModal=null},b.prototype._onAirportListChange=function(){this._listExpanded=!1,this._$scope.airportList.limit=this._$scope.limit,this._evaluateModalRequirements()},b.prototype._onLimitChange=function(a){this._listExpanded||(this._$scope.airportList.limit=a)},b.prototype.selectAirport=function(a){this._shouldAutoShow=!1,this._$scope.onSelect({airport:a.code,callback:function(){this._pubSubService.publish("bookAirportList.airportSelected"),this._scrollService.go("top"),{duration:150}}.bind(this)})},b.prototype.allCitiesButtonVisible=function(){return!this._listExpanded&&this._$scope.limit<this._$scope.airports.length},b.prototype.showAllAirports=function(){this._listExpanded=!0,this._$scope.airports=this._$scope.airports.sort(function(a,b){return a.name<b.name?-1:a.name>b.name?1:0}),this._$scope.airportList.limit=this._$scope.airports.length},a}),c("book/directives/book-intro-picker",["angular"],function(a){"use strict";var b=function(){return{scope:!0,restrict:"A",controller:c,link:d}},c=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){this._$scope=a,this._windowService=b,this._tripService=c,this._utilsService=d,this._changeService=e,this._workflowService=f,this._locationService=g,this._cms=h,this._pubSubService=i,this._$singleTimeout=j,this._statusService=k,this._resourceBundle=l,this._scrollService=m,this._fareService=n,this._accessibleService=o,this._currentTripType=null,this._tripType={ONE_WAY:0,ROUND_TRIP:1,MULTI_CITY:2},this._isOverlayMode=!1,this.lists={},this._$timeout=p,this._view={DEFAULT:0,DEPARTING_CITIES:1,PEOPLE_PICKER:2,MULTI_CITY:3},this._currentView=this._view.DEFAULT,this._configData={},this._overlayTitle={PEOPLE:"Who's Flying?",DEPARTING_CITIES:"Select departure city"},this._selectedAirportCodes={DEPARTING:null,DESTINATION:null},this._pickerTypes={DESTINATION:"destination",DEPARTING:"departing"},this._context={BOOK:this._$scope.context.is(this._$scope.context.type.BOOK),CHANGE:this._$scope.context.is(this._$scope.context.type.CHANGE)},this._airportSelected=this._context.BOOK?"_airportSelectedBook":"_airportSelectedChange",this._watchedService=this._$scope.context.is(this._$scope.context.type.BOOK)?c:e,this._$scope.bookIntro={airportSelected:this[this._airportSelected].bind(this),airportList:[],arrivingCity:"City",continue:this.onComplete.bind(this),continueButtonLabel:window.alaskaBookIntro&&window.alaskaBookIntro.searchLabel||"Search flights",contextIsBook:this._context.BOOK,currentNumberPicker:0,departingCity:null,departingCityCode:[],depList:[],desList:[],depSelected:"City",desSelected:"City",depListVisible:!1,desListVisible:!1,isDestinationActive:!1,airportListVisible:!1,peoplePickerVisible:!1,destinationCity:null,isOverlayMode:!1,isMultiCity:!1,isRoundTrip:!1,isTripTypeHidden:this.isTripTypeHidden.bind(this),openBestFaresModal:d.openBestFaresModal,overlayTitle:null,resetLists:this.resetLists.bind(this),returningCityCode:[],sectionComplete:!1,setOverlayMode:this.setOverlayMode.bind(this),showDepartingCityList:this.showDepartingCityList.bind(this),showDestinationCityList:this.showDestinationCityList.bind(this),showMultiCityOpts:this.showMultiCityOpts.bind(this),showNonMultiCityOpts:this.showNonMultiCityOpts.bind(this),showPeoplePicker:this.showPeoplePicker.bind(this),showTripTypeOpts:this.showTripTypeOpts.bind(this),startOver:this.startOver.bind(this),travelers:this._tripService.travelerAmount(),travelerSummary:this._watchedService.travelerTotalLabel,travelerIndividual:this._watchedService.travelerIndividualLabel,tripType:this._tripType,typeaheadEnabled:this._typeaheadEnabled.bind(this),showMultiCityAirportList:this.showMultiCityAirportList.bind(this),multiCityAirport:{},airportListSmallModal:!1,isCollapsed:!1,changeSection:this._changeSection.bind(this),assistiveTravelerSummary:this.assistiveTravelerSummary.bind(this),setMCFocus:this.setMCFocus.bind(this),setFocusMessage:this.setFocusMessage.bind(this),setSearchFocus:this.setSearchFocus.bind(this),enableAlaskaAirports:this.enableAlaskaAirports.bind(this),breakpoint:this._windowService.breakpoint()},this._currentBreakpoint=this._windowService.breakpoint(),this._pubSubAction={DEPARTING_PICKER_OPENED:"departingPickerOpened",DESTINATION_PICKER_OPENED:"destinationPickerOpened",EXPAND_CALENDAR:"expandCalendar",PEOPLE_PICKER_VISIBLE:"peoplePicker.visible",RESET:"trip.resetTravelerAmount",RESET_CALENDAR:"calendar.reset"},this._pubSubService.subscribe("windowService.breakpoint",function(a){this._$scope.bookIntro.breakpoint=a,this._currentBreakpoint=a,this._updateAirportListLimit(this._currentView)}.bind(this)),this._pubSubService.clear("bookerAirportSelected"),this._pubSubService.subscribe("bookerAirportSelected",this[this._airportSelected].bind(this)),this._pubSubService.subscribe("peoplePickerClosed",function(){this._setPeoplePickerVisibility(!1),this._isOverlayMode=!1}.bind(this)),this._pubSubService.subscribe("departingPickerOpened",function(){this._setPeoplePickerVisibility(!1)}.bind(this)),this._pubSubService.subscribe("destinationPickerOpened",function(){this._setPeoplePickerVisibility(!1)}.bind(this)),this._pubSubService.subscribe("collapseTripBooker",function(){this._collapseAndResolveData()}.bind(this)),this._pubSubService.subscribe("expandTripBooker",function(){this._changeSection()}.bind(this)),this._pubSubService.subscribe("setTripBookerSectionComplete",function(){this._setSectionComplete(!0)}.bind(this)),this._pubSubService.subscribe("setTripBookerSectionIncomplete",function(){this._setSectionComplete(!1)}.bind(this)),this._$scope.$watch(function(){return this._watchedService.getTripType()}.bind(this),this._setCurrentTripType.bind(this)),this._$scope.$watch(this._watchedService.getAirportData,function(a,b){a[0]&&a[0].des&&(!b[0]||!b[0].des)&&this._setSectionComplete(!0)}.bind(this)),this._$scope.$watch(this._workflowService.getCurrentState,function(a){if(this._$scope.context.is(this._$scope.context.type.BOOK))if("BOOK_INTRO_STATE"!==a)this._$singleTimeout(function(){
"DATE_PICKER_STATE"===a&&!this._$scope.bookIntro.isCollapsed&&this._scrollService.scroll({target:"DATE_PICKER_STATE",delay:2e3}),this._setSectionComplete(!0)}.bind(this));else{var b=this._$scope.bookIntro.peoplePickerVisible;this._$scope.bookIntro.isMultiCity&&(this._windowService.setShowAppLoader(!1),this._isOverlayMode=!1),b&&this.showPeoplePicker(),this._$singleTimeout(function(){this._$scope.bookIntro.isCollapsed=!1,this._accessibleService.resolveExpand(0)}.bind(this))}}.bind(this)),this._cms.info.get(function(a){var b=a.alaskaSetup.bookIntro||{};this._$scope.bookIntro.content={headlineForMobile:window.alaskaBookIntro&&window.alaskaBookIntro.headlineForMobile||b.headlineForMobile||"Now explore over 90 new destinations with Alaska Airlines.",headline:window.alaskaBookIntro&&window.alaskaBookIntro.headline||b.headline||"Your world just got bigger.",subheadline:window.alaskaBookIntro&&window.alaskaBookIntro.subheadline||b.subheadline||"Now explore over 90 new destinations with Alaska Airlines."}}.bind(this)),this.getUserLocation(),this._getCmsConfigData(),this._buildDepartingCitiesList()};c.$inject=["$scope","windowService","tripService","utilsService","changeService","workflowService","locationService","cms","pubSubService","$singleTimeout","statusService","ResourceBundle","scrollService","fareService","accessibleService","$timeout"],c.prototype.isTripTypeHidden=function(){var a=!this._$scope.context.is(this._$scope.context.type.BOOK);return a},c.prototype.enableAlaskaAirports=function(){return this._tripService.isAlaskaFlightsEnabled()},c.prototype._collapseAndResolveData=function(){var a=this._watchedService.getAirportData();if(a){for(var b=0;b<a.length;b++)a[b].dep&&a[b].des&&(this._$scope.bookIntro.departingCityCode.push(a[b].dep.code),this._$scope.bookIntro.returningCityCode.push(a[b].des.code));this._$scope.bookIntro.travelerTotalLabel=this._watchedService.travelerTotalLabel(),this._$scope.bookIntro.travelerIndividualLabel=this._watchedService.travelerIndividualLabel(),this._context.BOOK?this._$scope.bookIntro.isCollapsed=!0:setTimeout(function(){$("#booker .collapse-container").addClass("collapsed-section");var a=$("#calendar").offset().top-$("#yts").height()-$("#change-guider").height();$(window).scrollTop(a),this._$scope.bookIntro.isCollapsed=!0}.bind(this),4)}},c.prototype.startOver=function(){this._context.BOOK&&this._pubSubService.publish(this._pubSubAction.RESET),this._changeSection(),this._pubSubService.publish("yts.detectState",[!1])},c.prototype._changeSection=function(){this._$scope.bookIntro.isCollapsed=!1,this._accessibleService.resolveExpand(0),this._$scope.bookIntro.departingCityCode=[],this._$scope.bookIntro.returningCityCode=[],this._context.CHANGE?(this._statusService.setChangeGuider(this._statusService.message.CHANGE_CITIES),this._changeService.setVisibleSection({section:"BOOK_INTRO_STATE",isVisible:!0}),this._changeService.setVisibleSection({section:"CALENDAR",isVisible:!1}),this._fareService.resetService(),this._pubSubService.publish("ancillariesSelector.setVisibility",[!1]),this._windowService.setYtsFixed(!0)):this._workflowService.transition(this._workflowService.getCurrentState(),"BOOK_INTRO_STATE",!0)},c.prototype.showMultiCityAirportList=function(a,b){this._multiCityState={leg:a,stage:b},this._setAirportListVisibility(!0),0===b?this._setAirportList(this._view.DEPARTING_CITIES):this._setAirportList(this._view.MULTI_CITY)},c.prototype._setAirportListVisibility=function(a){this._$scope.bookIntro.airportListVisible=a},c.prototype._getSelectedAirportCode=function(){switch(this._currentView){case this._view.DEFAULT:return this._selectedAirportCodes.DESTINATION;case this._view.DEPARTING_CITIES:return this._selectedAirportCodes.DEPARTING;case this._view.MULTI_CITY:return null}},c.prototype._informMultiCityPicker=function(a){this._$scope.bookIntro.multiCityAirport={code:a,stage:this._multiCityState.stage,leg:this._multiCityState.leg}},c.prototype._validateMultiCityDestination=function(){var b=this._multiCityState.leg;if(1!==this._multiCityState.stage){var c=!1,d=this._watchedService.getAirport(b).dep.code,e=this._createDestinationList(d);a.forEach(e,function(a){this._watchedService.getAirport(b).des&&this._watchedService.getAirport(b).des.code===a.code&&(c=!0)},this),c||delete this._watchedService.getAirport(b).des}},c.prototype._airportSelectedBook=function(a,b,c){if(this._context.BOOK){var d;b===this._pickerTypes.DEPARTING?(this._selectedAirportCodes.DEPARTING=a,this._selectedAirportCodes.DESTINATION=null,this._tripService.setAirport(a,0,this._tripService.DEPARTURE),this.setOverlayMode({enabled:!1}),this._setSectionComplete(!1),this._$scope.bookIntro.isDestinationActive=!1):b===this._pickerTypes.DESTINATION?this._$singleTimeout(function(){this._selectedAirportCodes.DESTINATION=a,this._tripService.setAirport(a,0,this._tripService.DESTINATION),this._setSectionComplete(!0),this._locationService.setShouldRender(!0),this._$scope.bookIntro.isDestinationActive=!0}.bind(this)):(d=0===this._multiCityState.stage?this._tripService.DEPARTURE:this._tripService.DESTINATION,this._tripService.setAirport(a,this._multiCityState.leg,d),this._$singleTimeout(function(){this._validateMultiCityDestination(),this._informMultiCityPicker(a),this._setAirportListVisibility(!1)}.bind(this))),c&&"function"==typeof c&&c(),this.resetLists()}},c.prototype._airportSelectedChange=function(a,b,c){if(!this._context.BOOK){var d;if(b===this._pickerTypes.DEPARTING)this._selectedAirportCodes.DEPARTING=a,this._selectedAirportCodes.DESTINATION=null,this._changeService.setAirport(a,0,this._tripService.DEPARTURE),this.setOverlayMode({enabled:!1}),this._setSectionComplete(!1),this._$scope.bookIntro.isDestinationActive=!1;else if(b===this._pickerTypes.DESTINATION)this._$singleTimeout(function(){this._selectedAirportCodes.DESTINATION=a,this._changeService.setAirport(a,0,this._tripService.DESTINATION),this._setSectionComplete(!0),this._$scope.bookIntro.isDestinationActive=!0}.bind(this));else{d=0===this._multiCityState.stage?this._tripService.DEPARTURE:this._tripService.DESTINATION;var e=function(){this._changeService.setAirport(a,this._multiCityState.leg,d),this._$singleTimeout(function(){this._validateMultiCityDestination(),this._informMultiCityPicker(a),this._setAirportListVisibility(!1)}.bind(this)),c&&c()}.bind(this),f=this._changeService.getAirportData()[this._multiCityState.leg][d],g=f&&f.code!==a;g&&this._changeService.hasPNRAncillarySummary()?this._utilsService.openExtrasWarningModal(e):e()}var h=this._changeService.validateIropChange("CITIES");if(!h.valid){var i={format:this._statusService.format.ALERT,copy:this._statusService.message[h.message],recoverable:!0,controls:{close:!1,dismiss:"got it"}};this._statusService.setAlert(i)}}},c.prototype._setSectionComplete=function(a){this._$scope.bookIntro.sectionComplete=a,this._setPeoplePickerVisibility(!1)},c.prototype._getCmsConfigData=function(){this._cms.config.get(function(a){var b;this._configData=a;for(var c in this._configData.airports)b=this._configData.airports[c],b.code=b.code||c,"All Airports"===b.state?b.abv=b.code:"USA"!==b.country?b.abv=this._utilsService.capitilizeWords(b.country):b.abv=b.state;this._$scope.bookIntro.depList=this._configData.airports,this._$singleTimeout(function(){this._addWatches()}.bind(this)),this._windowService.setShowAppLoader(!1)}.bind(this))},c.prototype._addWatches=function(){this._$scope.$watch(function(){if(this._watchedService.getAirport(0))return this._watchedService.getAirport(0).dep}.bind(this),function(a){"object"==typeof a&&(a.update&&(a.update=!1),this._onDepartingAirportChange(a.code))}.bind(this)),this._$scope.$watch(function(){return this._watchedService.getAirport(1)?this._watchedService.getAirport(1).dep:null}.bind(this),function(a){"object"==typeof a&&null!==a&&this._$singleTimeout(function(){this._selectedAirportCodes.DESTINATION=a.code}.bind(this))}.bind(this))},c.prototype.onComplete=function(){if(window.alaskaBookIntro&&window.alaskaBookIntro.action){var a=this._tripService.getTravelerData(),b=this._tripService.getCityPairs(),c={roundTrip:"ROUND_TRIP"===this._tripService.getTripType(),adults:a.adults||0,children:a.children||0,lapInfants:a.infants||0,origin:b[0].dep,destination:b[0].des};return void window.alaskaBookIntro.action(c)}this._pubSubService.publish(this._pubSubAction.RESET_CALENDAR);var d=this._context.BOOK?"_completeBook":"_completeChange";this[d](),this._accessibleService.setText("Search in progress. Date selection loaded.")},c.prototype._completeBook=function(){var b,c=this._tripService.getAirport(0),d=c.dep.code,e=c.des,f={intro:this._utilsService.safeHTML(e.destinationMsg)||"Nice.",travelers:this._tripService.travelerTotalLabel(),fromAirportCode:d,toAirportCode:e.code};b=this._currentTripType!==this._tripType.MULTI_CITY?{back:a.noop,format:this._statusService.format.SUCCESS,copy:this._statusService.message.CITIES_SELECTED,data:f}:{format:this._statusService.format.SUCCESS,copy:this._resourceBundle.statusMessages.booker.multiCitySelected},this._statusService.setStatus(b),this.transitionToNextSection()},c.prototype._completeChange=function(){this._changeService.setVisibleSection({section:"CALENDAR",isVisible:!0}),this._pubSubService.publish(this._pubSubAction.EXPAND_CALENDAR),this._scrollService.scroll({target:"DATE_PICKER_STATE",delay:1e3}).then(function(){this._collapseAndResolveData()}.bind(this)),this._statusService.setChangeGuider(this._statusService.message.CHANGE_DATES),this._pubSubService.publish("yts.detectState",[!0])},c.prototype.transitionToNextSection=function(){$("body").off("click",this._detectClick),this._workflowService.transition("BOOK_INTRO_STATE","DATE_PICKER_STATE")},c.prototype.showNonMultiCityOpts=function(){return this._currentTripType!==this._tripType.MULTI_CITY&&!this._isOverlayMode},c.prototype.setOverlayMode=function(a){"object"==typeof a&&(this._$scope.bookIntro.isOverlayMode=this._isOverlayMode=a.enabled,a.enabled?this._$scope.bookIntro.overlayTitle=a.title:(this._setPeoplePickerVisibility(!1),this._currentView!==this._view.MULTI_CITY&&(this._setAirportList(this._view.DEFAULT),this._setView(this._view.DEFAULT),this._$scope.bookIntro.airportListSmallModal=!1)))},c.prototype.showMultiCityOpts=function(){return this._currentTripType===this._tripType.MULTI_CITY&&!this._isOverlayMode},c.prototype._setPeoplePickerVisibility=function(a){this._$scope.bookIntro.peoplePickerVisible=a},c.prototype.showPeoplePicker=function(a){var b=this._$scope.bookIntro.travelerSummary();this._context.CHANGE||(a===!0&&(this._$scope.bookIntro.peoplePickerVisible=a),this._$scope.bookIntro.peoplePickerVisible?(this._$scope.bookIntro.peoplePickerVisible=!1,this._$scope.bookIntro.setOverlayMode({enabled:!1}),this._$scope.$apply(),this._accessibleService.setText(b+". Guest picker is collapsed.")):(this.setOverlayMode({enabled:!0,title:this._overlayTitle.PEOPLE}),this.resetLists(),this._setPeoplePickerVisibility(!0),this._$scope.bookIntro.currentNumberPicker=0,this._pubSubService.publish(this._pubSubAction.PEOPLE_PICKER_VISIBLE),this._accessibleService.setText(b+". Guest picker is expanded.")),$(".number-picker__add, .number-picker__minus").removeClass("is-selected"),$("body").off("click",this._detectClick),this._$scope.bookIntro.peoplePickerVisible&&2!==this._currentTripType&&"large"===this._currentBreakpoint?$("body").on("click",this,this._detectClick):this._resetPickerState(),2===this._currentTripType&&"large"===this._currentBreakpoint&&this._windowService.scrollTop()>54&&this._scrollService.go("top",{duration:150}))},c.prototype._detectClick=function(a){var b=a.data,c=$(a.target),d=$(window);c.hasClass("booker__trip-item")||c.parents(".people-picker").length<1&&(b.showPeoplePicker(!0),window.scrollTo(0,d.scrollTop()+1),window.scrollTo(0,d.scrollTop()-1))},c.prototype._resetPickerState=function(){$("body").off("click",this._detectClick)},c.prototype.showDepartingCityList=function(){this._$scope.bookIntro.depListVisible?this._$scope.bookIntro.depListVisible=!1:(this._setView(this._view.DEPARTING_CITIES),this._$scope.bookIntro.airportListSmallModal=!0,this.resetLists(),this._$scope.bookIntro.depListVisible=!0)},c.prototype.showDestinationCityList=function(){this._$scope.bookIntro.desListVisible?this._$scope.bookIntro.desListVisible=!1:(this._setView(this._view.DEFAULT),this._$scope.bookIntro.airportListSmallModal=!0,this.resetLists(),this._$scope.bookIntro.desListVisible=!0)},c.prototype.resetLists=function(){this._$scope.bookIntro.peoplePickerVisible=!1},c.prototype._setView=function(a){this._currentView=a},c.prototype.showTripTypeOpts=function(){return this._$scope.context.is(this._$scope.context.type.BOOK)&&!this._isOverlayMode},c.prototype._setCurrentTripType=function(a){this._currentTripType=this._tripType[a];var b=this._$scope.bookIntro.isMultiCity=a===this._tripService.MULTI_CITY;this._$scope.bookIntro.isRoundTrip=a===this._tripService.ROUND_TRIP,this._setPeoplePickerVisibility(!1),this._pubSubService.publish(this._pubSubAction.DEPARTING_PICKER_OPENED),this._pubSubService.publish(this._pubSubAction.DESTINATION_PICKER_OPENED),b?(this._setView(this._view.MULTI_CITY),this._windowService.setShowAppLoader(!1),this._isOverlayMode=!1):(this._setView(this._view.DEFAULT),this._setAirportListVisibility(!1))},c.prototype.getUserLocation=function(){var a=this._tripService;a.isPopulatedFromUrl()||(a.getDefaultAirport().then(function(a){this._tripService.setAirport(a,0,this._tripService.DEPARTURE),this._selectedAirportCodes.DEPARTING=a}.bind(this)),this._locationService.setShouldRender(!1))},c.prototype._createDestinationList=function(b){var c,d,e,f=this._configData.airportMapping[b];if(this.lists.destinations=[],this.lists.orig=[],a.isObject(f)&&a.isObject(f.to)){if(a.isObject(f.to))for(c in f.to)d=this._configData.airports[c],a.isObject(d)&&(d.code=c,this.lists.destinations.push(d));var g=0;if(a.isObject(f.promoted))for(e in f.promoted)g++;if(a.isObject(f.promoted)&&5===g)for(e in f.promoted){var h=this._configData.airports[e];a.isObject(h)&&(h.code=e,this.lists.orig.push(h))}else if(a.isObject(f.to))for(c in f.to)d=this._configData.airports[c],a.isObject(d)&&(d.code=c,this.lists.orig.push(d))}return this.lists.destinations},c.prototype._onDepartingAirportChange=function(b){var c,d,e=this._configData.airports,f=e[b].exceptions;if(this.lists.destinations=[],this.lists.orig=[],this.enableAlaskaAirports())for(c in e)d=e[c],a.isObject(d)&&d.code!==b&&f.indexOf(d.code)===-1&&this.lists.destinations.push(d);else{var g=this._configData.airportMapping[b];if(a.isObject(g)&&a.isObject(g.to)&&a.isObject(g.to))for(c in g.to)d=e[c],a.isObject(d)&&!d.asCity&&(d.code=c,this.lists.destinations.push(d))}var h=this._watchedService.getAirport(0).dep?this._watchedService.getAirport(0).dep.name:null,i=this._watchedService.getAirport(0).des?this._watchedService.getAirport(0).des.name:null;h&&(this._$scope.bookIntro.depSelected=h),i&&(this._$scope.bookIntro.desSelected=i),this._selectedAirportCodes.DEPARTING=b,this._setAirportList(this._view.DEFAULT),this._$scope.bookIntro.desList=this.lists.destinations},c.prototype._buildDepartingCitiesList=function(){var a=[];for(var b in this._configData.airports)this._$scope.bookIntro.isMultiCity&&this._configData.airports[b].asCity||a.push(this._configData.airports[b]);return a},c.prototype._updateAirportListLimit=function(a){var b=this._$scope.bookIntro.airportList.length;a===this._view.DEFAULT&&(b="small"===this._currentBreakpoint?3:5),this._$scope.bookIntro.listLimit=b},c.prototype._addSaleFlags=function(a){var b=this._selectedAirportCodes.DEPARTING,c=this._configData.airportMapping[b],d=c&&c.onSale;if("object"!=typeof d)return a;for(var e=0,f=a.length;e<f;e++)d[a[e].code]&&(a[e].onSale=!0);return a},c.prototype._setAirportList=function(b){var c,d,e,f,g;b===this._view.MULTI_CITY?(d=this._multiCityState.leg,e=this._watchedService.getAirport(d).dep.code,c=this._createDestinationList(e)):c=b===this._view.DEPARTING_CITIES?this._buildDepartingCitiesList():a.copy(this.lists.destinations);var h=[];if(c&&(h=this._utilsService.sortListByName(c)),b===this._view.DEFAULT&&this._selectedAirportCodes.DESTINATION)for(var i in h)if(h[i].code===this._selectedAirportCodes.DESTINATION){g="small"===this._currentBreakpoint?2:4,i>g&&(f=h.splice(i,1),h=f.concat(h));break}b===this._view.DEFAULT&&(h=this._addSaleFlags(h)),this._$scope.bookIntro.airportList=h,this._updateAirportListLimit(b)},c.prototype._typeaheadEnabled=function(){return"large"===this._windowService.breakpoint()},c.prototype.assistiveTravelerSummary=function(){return this._watchedService.getTravelerList(this._$scope.bookIntro.travelers,!0)},c.prototype.setMCFocus=function(){this._$singleTimeout(function(){$(".multi-city__city-legs li:first").focus()})},c.prototype.setFocusMessage=function(){var a=this._$scope.bookIntro.peoplePickerVisible,b=a?"expanded.":"collapsed.";this._accessibleService.setText(this._$scope.bookIntro.travelerSummary()+". Guest picker is "+b)},c.prototype.setSearchFocus=function(){var a=this._$scope.bookIntro,b="Search flights from "+a.depSelected+" to "+a.desSelected+" for "+a.travelerSummary()+".";this._accessibleService.setText(b)};var d=function(a,b,c,d){function e(b,c){if(a.bookIntro.peoplePickerVisible){var d=$(".number-picker__add, .number-picker__minus"),e=$(document.activeElement).index(".number-picker__controls a");d[e]?($(".number-picker__controls .is-selected").removeClass("is-selected"),$(d[e]).addClass("is-selected")):g()}else"undefined"==typeof c&&(a.bookIntro.showPeoplePicker(),a.$apply())}function f(b,c){if(a.bookIntro.peoplePickerVisible||c){var d=$(".number-picker__add, .number-picker__minus"),e=$(document.activeElement).index(".number-picker__controls a");d[e]?($(".number-picker__controls .is-selected").removeClass("is-selected"),$(d[e]).addClass("is-selected")):g()}}function g(){a.bookIntro.peoplePickerVisible&&(a.bookIntro.showPeoplePicker(),$(".booker__typeahead-field--people").focus(),a.$apply())}function h(){a.bookIntro.showPeoplePicker(),a.$apply()}d._pubSubService.subscribe("peoplePicker.petsDisclaimerAccepted",function(){d._typeaheadEnabled()&&$(".number-picker__add.is-selected a").focus()}.bind(this));var i=[".booker__typeahead-field--people",".number-picker__add a",".number-picker__minus a"].join(",");b.on("focus",i,function(){$(window).on("keyup",function(b){switch(b.which){case 9:b.shiftKey?f(b,!0):e(b,!0);break;case 40:b.preventDefault(),e(b);break;case 38:f(b);break;case 32:case 13:a.bookIntro.peoplePickerVisible||(b.preventDefault(),h());break;case 27:g()}}.bind(this))}),b.on("blur",i,function(){$(window).off("keyup")}.bind(this))};return b}),c("book/directives/book-people-picker",["angular"],function(a){"use strict";var b=function(){return{scope:{isVisible:"=visible",travelers:"=",onComplete:"&",isModal:"@"},controller:d,restrict:"A",replace:!0,templateUrl:"/app/book/directives/book-people-picker.tpl.html"}},c=5,d=function(b,c,d,e,f,g,h,i,j,k){this._$scope=b,this._$modal=c,this._tripService=d,this._resourceBundle=e,this._windowService=f,this._locationService=g,this._workflowService=h,this._pubSubService=i,this._accessibleService=k,this._statusService=j,this._petsDisclaimerAccepted=!1,this._peopleSingularTitles=["Adult","Child","Lap Infant","Pet"],this._peoplePluralTitles=["Adults","Children","Lap Infants","Pets"],a.extend(b,{showSpecialServicesModal:this.showSpecialServicesModal.bind(this),closePicker:this.closePicker.bind(this),petsChanged:this._petsChangedHandler.bind(this),canIncrement:this.canIncrement.bind(this),petsMax:this.petsMax.bind(this)}),this._$scope.titleHolder={adultTitle:"Adult",childrenTitle:"Children",lapTitle:"Lap Infants",petTitle:"Pets"},this._$scope.titleVal={adultVal:"adult",childrenVal:"child",lapVal:"infant",petVal:"pet"},this._$scope.ages=this._resourceBundle.ages,this._updateButtonLabel(),b.$watchCollection("travelers",this._onTravelerChange.bind(this)),b.isModal||b.$watch("isVisible",this._onVisibilityChange.bind(this)),this._$scope.petsMaxLimitAlerted=!1};return d.$inject=["$scope","$modal","tripService","ResourceBundle","windowService","locationService","workflowService","pubSubService","statusService","accessibleService"],d.prototype._onVisibilityChange=function(a){var b=this._tripService.getTripType()===this._tripService.MULTI_CITY;b||(a?this._modalWatch=this._$scope.$watch(this._windowService.breakpoint,function(a){"large"===a?this._destroyModal():this._createModal()}.bind(this)):(this._modalWatch&&this._modalWatch(),delete this._modalWatch))},d.prototype._createModal=function(){if(!this._pickerModal){var a=this._resourceBundle.modal.peoplePicker,b=this._$scope.$new();b.onComplete=function(){this._destroyModal(),this.closePicker()}.bind(this),this._pickerModal=this._$modal.open({scope:b,contentType:a.TYPE,size:a.SIZE,title:a.TITLE,templateUrl:a.TEMPLATE_URL}),this._pickerModal.result.then(null,function(){this._pubSubService.publish("peoplePickerClosed")}.bind(this)),this._pickerModal.result.finally(function(){delete this._pickerModal}.bind(this))}},d.prototype._destroyModal=function(){this._pickerModal&&this._pickerModal.close()},d.prototype.canIncrement=function(){return this._resourceBundle.urlParser.maximumNumberOfPeople-(this._$scope.travelers.adults+this._$scope.travelers.children)>0},d.prototype._petsChangedHandler=function(b){if(0!=b&&(b>c?(this._statusService.setAlert({format:this._statusService.format.ERROR,copy:this._statusService.message.INVALID_PETS_NUMBER,allyMessage:this._statusService.message.INVALID_PETS_NUMBER,data:{}}),this._$scope.petsMaxLimitAlerted=!0):this._$scope.petsMaxLimitAlerted=!1,!this._petsDisclaimerAccepted)){var d=this._resourceBundle.modal.pets,e=this._$scope.$new();e.accept=a.bind(this,function(){this._pubSubService.publish("peoplePicker.petsDisclaimerAccepted"),this._petsDisclaimerAccepted=!0}),this._petsModal=this._$modal.open({controller:["$scope",function(a){a.footerLinkFn=function(){this.$parent.accept()}}],size:d.SIZE,type:d.TYPE,title:d.TITLE,templateUrl:d.TEMPLATE_URL,showFooter:!0,footerLinkText:"I understand, proceed",footerDisclaimer:!0,scope:e}),this._petsModal.result.then(null,function(){this._petsDisclaimerAccepted||(this._$scope.travelers.pets=0)}.bind(this))}},d.prototype._onTravelerChange=function(b,c){var d;if(!a.equals(b,c)){this._peopleKeys=Object.keys(b),this._titleKeys=Object.keys(this._$scope.titleHolder);for(var e in this._peopleKeys)1===b[this._peopleKeys[e]]?this._$scope.titleHolder[this._titleKeys[e]]=this._peopleSingularTitles[e]:this._$scope.titleHolder[this._titleKeys[e]]=this._peoplePluralTitles[e];this._totalTravelers=this._tripService.getTotalTravelers(),this._isValid=this._totalTravelers>0,b.infants>c.infants&&(d=" Notice: 1 lap infant per adult traveler max"),this._updateButtonLabel(this._totalTravelers,b,d)}},d.prototype.showSpecialServicesModal=function(){this._$modal.open({size:"medium",title:"Any special requests?",templateUrl:"/app/book/templates/modals/special-requests.tpl.html"})},d.prototype.closePicker=function(){this._$scope.isVisible=!1,this._$scope.onComplete(),this._pubSubService.publish("adobeAnalytics.whoIsFlying",[this._tripService.getSelectedTripPublicModel()])},d.prototype.petsMax=function(){var a=this._$scope.travelers.adults-this._$scope.travelers.infants;return this._$scope.petsMaxLimitAlerted?Math.min(c,a):a},d.prototype._updateButtonLabel=function(a,b,c){var c=c||"",d=this._tripService.travelerTotalLabel(),e=1===this._tripService.travelerIndividualLabel().length?this._tripService.travelerTotalLabel():this._tripService.travelerIndividualLabel().join(", "),f="Traveling with "+e;0!==$(document.activeElement).closest(".number-picker__controls").length&&(this._accessibleService.setAssertiveLevel(this._accessibleService.assertiveLevels.ASSERTIVE),this._accessibleService.setText(f+c)),b&&(b.children>0||b.pets>0||b.infants>0)&&(d=a+" Guests"),this._$scope.buttonLabel="Continue with "+d},b}),c("book/directives/book-multi-city",["jquery"],function(a){"use strict";var b=function(){return{controller:c,restrict:"A",scope:{continue:"&onComplete",showPeoplePicker:"&peoplePicker",onSelect:"&",airportUpdate:"=airportUpdated"},templateUrl:"/app/book/directives/book-multi-city.tpl.html"}},c=function(b,c,d,e,f,g,h){this._$scope=b,this._locationService=c,this._tripService=d,this._changeService=e,this._workflowService=f,this._pubSubService=g,this._$singleTimeout=h,this._pickingAirportFor=null,this._contexts={BOOK:this._locationService.contextIs(this._locationService.contexts.BOOK),CHANGE:this._locationService.contextIs(this._locationService.contexts.CHANGE)},this._watchedService=this._contexts.BOOK?d:e,this._$scope.multiCity={legs:[1,2],integerToString:this.integerToString.bind(this),context:this._contexts,allLegsSelected:!1,selectAirport:this.selectAirport.bind(this),travelerLabel:d.travelerTotalLabel,getAirport:this.getAirport.bind(this),isAirportVisible:!1,hideSecondLeg:!1,legInSelection:{0:!1,1:!1},legsSelected:{0:!1,1:!1},setLegFocusMessage:this.setLegFocusMessage.bind(this),setAirportFocusMessage:this.setAirportFocusMessage.bind(this),setContinueButtonFocusMessage:this.setContinueButtonFocusMessage.bind(this),setPeoplePickerFocus:this.setPeoplePickerFocus.bind(this)},this._$scope.$watchCollection("airportUpdate",this._airportSelectionHandler.bind(this)),b.$watch(function(){return this._watchedService.getTripType()}.bind(this),function(a){"MULTI_CITY"===a&&this._resetView()}.bind(this)),this._integerStringMap={0:"zero",1:"one",2:"two",3:"three",4:"four",5:"five"},this._pubSubService.subscribe("bookAirportList.airportSelected",function(){this._$scope.multiCity.isAirportVisible=!1,this._resetSelectionHandler(),this._$singleTimeout(function(){a(this._pickingAirportFor).focus()}.bind(this))}.bind(this))};return c.$inject=["$scope","locationService","tripService","changeService","workflowService","pubSubService","$singleTimeout"],c.prototype._resetView=function(){this._$scope.multiCity.allLegsSelected=!1,this._$scope.multiCity.legsSelected[2]=!1,this._$scope.multiCity.legsSelected[3]=!1;var a=this._watchedService.getAirport(0);if(a){var b=a.dep&&a.dep.asCity,c=a.des&&a.des.asCity;(b||c)&&(this._watchedService.resetCityPairs(),this._pubSubService.publish("resetDestinationAirport"),b&&(this._watchedService.getDefaultAirport().then(function(a){this._watchedService.setAirport(a,0,this._watchedService.DEPARTURE)}.bind(this)),this._locationService.setShouldRender(!1)))}},c.prototype.selectAirport=function(b,c,d){this._$scope.multiCity.legInSelection[b]=!0,this._$scope.multiCity.isAirportVisible=!0,this._pickingAirportFor=d.target,this._$singleTimeout(function(){a("[data-vx-book-airport-list] ul").focus()}),this._$scope.onSelect({leg:b,stage:c})},c.prototype._airportSelectionHandler=function(){this._resetSelectionHandler(),this._$singleTimeout(function(){this._watchedService.getAirport(0).dep&&this._watchedService.getAirport(0).des&&(this._$scope.multiCity.legsSelected[0]=!0,this._watchedService.getAirport(0).dep&&this._watchedService.getAirport(1)&&this._watchedService.getAirport(1).dep&&this._watchedService.getAirport(0).des&&this._watchedService.getAirport(1).des?this._$scope.multiCity.allLegsSelected=!0:this._$scope.multiCity.allLegsSelected=!1)}.bind(this)),this._$scope.multiCity.isAirportVisible=!1},c.prototype._resetSelectionHandler=function(){for(var a in this._$scope.multiCity.legInSelection)this._$scope.multiCity.legInSelection[a]=!1},c.prototype.getAirport=function(a,b){return b=0===b?"dep":"des",this._watchedService.getAirport(a)},c.prototype.integerToString=function(a){return this._integerStringMap[a]},c.prototype.setLegFocusMessage=function(a){var b=this._$scope.$root.a11y;0===a?b.setText(b.text.MC_FIRST_LEG):b.setText(b.text.MC_SECOND_LEG)},c.prototype.setAirportFocusMessage=function(a,b,c){var d=this._$scope.$root.a11y;0===a?b?d.setText(d.text.ORIGIN_CITY,{airport:b.name}):d.setText(d.text.SELECT_ORIGIN_CITY):c?d.setText(d.text.DESTINATION_CITY_PICKED,{airport:c.name}):b?d.setText(d.text.DESTINATION_CITY_EMPTY,{originAirport:b.name}):d.setText(d.text.SELECT_DESTINATION_CITY)},c.prototype.setContinueButtonFocusMessage=function(){var a=this._$scope.$root.a11y;this._$scope.multiCity.allLegsSelected&&a.setText(a.text.MC_SEARCH_FLIGHTS,{originAirport1:this._watchedService.getAirport(0).dep.name,destinationAirport1:this._watchedService.getAirport(0).des.name,originAirport2:this._watchedService.getAirport(1).dep.name,destinationAirport2:this._watchedService.getAirport(1).des.name})},c.prototype.setPeoplePickerFocus=function(){this._$singleTimeout(function(){a(".book-people-original__title").focus()})},b}),c("book/directives/alaska-banner",["angular"],function(a){"use strict";var b=function(){return{controller:c,link:d,restrict:"A",replace:!0,templateUrl:"/app/book/directives/alaska-banner.tpl.html"}},c=function(a,b,c,d,e,f,g){function h(){if(i._loadStatusNumPassengers&&i._loadStatusCodeShare&&(i._$scope.isVisible=i._isVisible(),i._$scope.isVisible&&i._data.departingFlightsInfo)){var a=i._data.departingFlightsInfo.bestFareByAirline,b=a&&a.AS&&a.AS.fare&&a.AS.fare.dollarFare&&a.AS.fare.dollarFare.totalFare||0,c=a&&a.VX&&a.VX.fare&&a.VX.fare.dollarFare&&a.VX.fare.dollarFare.totalFare||0,d=c-b,e=i._data.departingFlightsInfo.flightCountByAirline.AS-i._data.departingFlightsInfo.flightCountByAirline.VX,f="AS"+parseInt(b,10)+"|VX"+parseInt(c,10)+"|-"+parseInt(d,10)+"|"+parseInt(e,10);i._pubSubService.publish("adobeAnalytics.alaskaBannerShown",[f]),i._pubSubService.publish("adobeAnalytics.alaskaRedirectOffered")}}var i=this;this._data={},this._$scope=a,this._$filter=f,this._pubSubService=b,this._tripService=d,this._fareService=e,this._$scope.hiddenByCurrency=!1,this._$scope.bannerType="DEFAULT",this.bannerTypes={default:"DEFAULT"},this._messages={DEFAULT:{numberOfFlightsOnly:'Choose from these flights plus <span class="alaska-banner__bold">###count### more</span>',lowFareMessage:'Choose from these flights plus <span class="alaska-banner__bold">###count### more</span> starting at <span class="Alaska-Banner__Bold">$###price###</span>'}},this._$scope.oTitle="SFO",this._$scope.dTitle="OAK",this._$scope.oDate="",this._$scope.dDate="",this._isCampaign=this.isCampaign(),this._$scope.isVisible=!1,this._visible=!1,this._hasSelectedFares=!1,this._loadStatusNumPassengers=!1,this._loadStatusCodeShare=!1,a.getMessage=function(){return this._prepareMessage(),c.trustAsHtml(this._message)}.bind(this),this._$scope.$watch(this._tripService.getCityPairs,function(a){this._$scope.oTitle=a[0].dep,this._$scope.dTitle=a[0].des}.bind(this),!0),this._$scope.$watch(d.getDates,function(a){this._$scope.oDate=a[0],this._$scope.dDate=a[1]}.bind(this),!0),this._$scope.$watch(this._fareService.getSelectedFares,function(a){a.length>0?(this._$scope.isVisible=!1,this._hasSelectedFares=!0):(this._$scope.isVisible=!0,this._hasSelectedFares=!1)}.bind(this),!0),this._$scope.getLink=function(){return this._tripService.generateAlaskaLink("flight search")}.bind(this),this._$scope.onBookClick=function(a){a.preventDefault(),this._pubSubService.publish("adobeAnalytics.bookOnAlaska"),g(function(){var a=this._$scope.getLink();window.location.href=a}.bind(this))}.bind(this),this._pubSubService.subscribe("tripCalendar.passengersAlaska",function(a){this._visible=!a,this._loadStatusNumPassengers=!0,h()}.bind(this)),this._$scope.$watch(this._fareService.getCodeShareFares,function(a){return!!a&&(this._data=a,this._loadStatusCodeShare=!0,h(),void 0)}.bind(this))};c.prototype.isCampaign=function(){return this._$scope.context.is(this._$scope.context.type.BOOK)},c.prototype._prepareMessage=function(){if("undefined"!=typeof this._data.departingFlightsInfo){var a=this._getLowest(this._data.departingFlightsInfo.bestFareByAirline),b=this._data.departingFlightsInfo.flightCountByAirline.AS-this._data.departingFlightsInfo.flightCountByAirline.VX;"AS"===a.airline?(this._message=this._messages[this.bannerTypes.default].lowFareMessage,this._message=this._message.replace("###price###",Math.ceil(parseFloat(a.totalFare))),this._message=this._message.replace("###count###",b)):(this._message=this._messages[this.bannerTypes.default].numberOfFlightsOnly,
this._message=this._message.replace("###count###",b))}},c.prototype._getLowest=function(a){var b={airline:"",totalFare:9999999};return Object.keys(a).forEach(function(c){"undefined"!=typeof a[c].fare.dollarFare&&b.totalFare>a[c].fare.dollarFare.totalFare&&(b.airline=c,b.totalFare=a[c].fare.dollarFare.totalFare)}),b},c.prototype._hasAlaska=function(){if("undefined"!=typeof this._data.departingFlightsInfo.flightCountByAirline.AS)return!0},c.prototype._isVisible=function(){return!(this._$scope.hiddenByCurrency||this._hasSelectedFares||!this._data.departingFlightsInfo)&&!!(this._fareService.isAlaska()&&!this._fareService.isAlaskaOnly()&&this._visible&&this._data.departingFlightsInfo.flightCountByAirline.AS-this._data.departingFlightsInfo.flightCountByAirline.VX>0&&this._isCampaign)};var d=function(a,b,c,d){function e(){b.velocity("stop").velocity({translateY:85},600)}function f(){b.velocity("stop").velocity({translateY:b.outerHeight()},0),setTimeout(function(){d._isVisible.bind(d)&&b.velocity("stop").velocity({translateY:0},600)},1200)}d._pubSubService.subscribe("yts.collapseYts",function(){d._isVisible()?f():e()}.bind(d)),a.$watch(d._isVisible.bind(d),function(a){a?f():e()}),a.$watch(d._fareService.getActiveCurrency,function(b){"POINTS"===b?a.hiddenByCurrency=!0:a.hiddenByCurrency=!1}),a.closeMe=function(){e(),d._pubSubService.publish("adobeAnalytics.closeBookOnAlaska")}};return c.$inject=["$scope","pubSubService","$sce","tripService","fareService","$filter","$timeout"],b}),c("book/directives/alaska-header-banner",["common/models/trip-model"],function(a){var b=function(){return{controller:c,scope:{bannerType:"=bannerType",backButton:"&backButton"},restrict:"A",link:d,replace:!0,templateUrl:"/app/book/directives/alaska-header-banner.tpl.html"}},c=function(b,c,d,e,f,g){this._pubSubService=c,this._tripModel=a,this._$scope=b,this._tripService=d,this._fareService=e,this._locationService=g,this._$scope.isVisible=!1,this.bannerTypes={alaskaOnly:"ALASKA_ONLY",afterFair:"FAIR"},this._$scope.oTitle="SFO",this._$scope.dTitle="OAK",this._$scope.oDate="",this._$scope.dDate="",this._$scope.isCampaign=this.isCampaign(),this._$scope.getHeadline=function(){switch(this._$scope.bannerType){case this.bannerTypes.afterFair:return"Nice choice. Alaska Airlines can take you there.";case this.bannerTypes.alaskaOnly:return'We’re showing <span class="alaska-header-fair-banner__bold">Alaska Airlines</span> fares for '+this._$scope.oTitle+" to "+this._$scope.dTitle+"."}}.bind(this),b.getMessage=function(){return f.trustAsHtml(this._$scope.getHeadline())}.bind(this),this._$scope.$watch(d.getCityPairs,function(a){this._$scope.oTitle=a[0].dep,this._$scope.dTitle=a[0].des}.bind(this),!0),this._$scope.$watch(d.getDates,function(a){this._$scope.oDate=a[0],this._$scope.dDate=a[1]}.bind(this),!0),this._$scope.$watch(this._fareService.isAlaskaOnly,function(a){this._$scope.isVisible=a}.bind(this)),this._$scope.$watch(this._fareService.getIsAlaskaOnlyCalendar,function(a){this._$scope.isVisible=a}.bind(this))};c.prototype.isCampaign=function(){return this._locationService.contextIs(this._locationService.contexts.BOOK)};var d=function(a,b){function c(){var a="boolean"==typeof arguments[0]?arguments[0]:arguments[1],c=a===!0?"addClass":"removeClass";b[c]("is-fixed"),b.hasClass("is-fixed")?b.show():b.hide()}$.subscribe("windowService.setYtsFixed",c)};return c.$inject=["$scope","pubSubService","tripService","fareService","$sce","locationService"],b}),c("book/directives/alaska-book-link",["angular","moment"],function(a,b){"use strict";var c=function(){return{controller:d,restrict:"A",replace:!0,templateUrl:"/app/book/directives/alaska-book-link.tpl.html"}},d=function(a,c,d,e,f){this._$scope=a,this._pubSubService=c,this._tripService=e,this._message="",this._$scope.oTitle="SFO",this._$scope.dTitle="OAK",this._$scope.dates="",this._$scope.oName="",this._$scope.$watch(this._tripService.getAirportData,function(b){b.length>=1?a.oName=b[0].des?b[0].des.name:"":"undefined"!=typeof b.des?a.oName=b.des.name:a.oName=""}),this._$scope.$watch(this._tripService.getCityPairs,function(a){this._$scope.oTitle=a[0].dep,this._$scope.dTitle=a[0].des}.bind(this),!0),this._$scope.$watch(e.getDates,function(a){var c=b(a[0]);if(this._$scope.dates=c.format("MMM DD"),a[1]){var d=b(a[1]),e=d.isSame(c,"month")?"DD":"MMM DD";this._$scope.dates+="-"+d.format(e)}}.bind(this),!0),this._$scope.getBookLink=function(){return this._tripService.generateAlaskaLink("book on alaska")}.bind(this),this._$scope.onAlaskaOnlyBookClick=function(a){a.preventDefault(),this._pubSubService.publish("adobeAnalytics.bookOnAlaska"),f(function(){var a=this._$scope.getBookLink();window.location.href=a}.bind(this))}.bind(this),this._pubSubService.publish("adobeAnalytics.isAlaskaOnly")};return d.$inject=["$scope","pubSubService","$sce","tripService","$timeout"],c}),c("book/directives/alaska-calendar-link",["angular"],function(a){"use strict";var b=function(){return{controller:c,restrict:"A",replace:!0,templateUrl:"/app/book/directives/alaska-calendar-link.tpl.html"}},c=function(a,b,c,d){var e=a.context.is(a.context.type.BOOK),f=a.core.config[e?"lastAvailableDateBooking":"lastAvailableDateManage"];this._$scope=a,this._$timeout=b,this._pubSubService=c,this._tripService=d,this._$scope.alaskaCalendarLink={isBooking:e,title:f.title,text:f.text,getLink:this.getLink.bind(this),onClick:this.onClick.bind(this)},e?this._pubSubService.publish("adobeAnalytics.reachLastAvailableDateOnBooking"):this._pubSubService.publish("adobeAnalytics.reachLastAvailableDateOnChange")};return c.prototype.getLink=function(){var a=moment(this._$scope.core.config.lastAvailableDate),b="LastAvailDate_HP_"+a.format("YYYYMMDD");return this._tripService.generateAlaskaLink(b,a,window.alaskaCalendarLinkOptions)},c.prototype.onClick=function(a){a.preventDefault(),this._pubSubService.publish("adobeAnalytics.bookOnAlaskaNotAvailableDate"),this._$timeout(function(){window.location.href=this._$scope.alaskaCalendarLink.getLink()}.bind(this))},c.$inject=["$scope","$timeout","pubSubService","tripService"],b}),function(){"use strict";function a(){}function b(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function d(a){return function(){return this[a].apply(this,arguments)}}var e=a.prototype,f=this,g=f.EventEmitter;e.getListeners=function(a){var b,c,d=this._getEvents();if(a instanceof RegExp){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},e.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},e.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},e.addListener=function(a,c){var d,e=this.getListenersAsObject(a),f="object"==typeof c;for(d in e)e.hasOwnProperty(d)&&b(e[d],c)===-1&&e[d].push(f?c:{listener:c,once:!1});return this},e.on=d("addListener"),e.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},e.once=d("addOnceListener"),e.defineEvent=function(a){return this.getListeners(a),this},e.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},e.removeListener=function(a,c){var d,e,f=this.getListenersAsObject(a);for(e in f)f.hasOwnProperty(e)&&(d=b(f[e],c),d!==-1&&f[e].splice(d,1));return this},e.off=d("removeListener"),e.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},e.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},e.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},e.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if(a instanceof RegExp)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},e.removeAllListeners=d("removeEvent"),e.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(e in g)if(g.hasOwnProperty(e))for(d=g[e].length;d--;)c=g[e][d],c.once===!0&&this.removeListener(a,c.listener),f=c.listener.apply(this,b||[]),f===this._getOnceReturnValue()&&this.removeListener(a,c.listener);return this},e.trigger=d("emitEvent"),e.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},e.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},e._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},e._getEvents=function(){return this._events||(this._events={})},a.noConflict=function(){return f.EventEmitter=g,a},"function"==typeof c&&c.amd?c("EventEmitter",[],function(){return a}):"object"==typeof module&&module.exports?module.exports=a:f.EventEmitter=a}.call(this),c("accurate-timer",["EventEmitter"],function(a){"use strict";var b=function(){this.fps=30,this.interval=null,this.intervalStart=null,this.elapsed=null};return b.prototype=new a,b.TICK="tick",b.prototype.start=function(){this.pause(),this.intervalStart||(this.intervalStart=Date.now()),this.interval=setInterval(this.tick.bind(this),1e3/this.fps),this.tick()},b.prototype.tick=function(){this.elapsed=Date.now()-this.intervalStart,this.emitEvent(b.TICK)},b.prototype.pause=function(){this.interval&&clearInterval(this.interval)},b.prototype.stop=function(){this.pause(),this.elapsed=0,this.intervalStart=null},b}),c("book/services/booking-timer",["accurate-timer"],function(a){"use strict";var b=function(b,c,d,e){return this.timer=new a,this.onTimerBind=this._onTimer.bind(this),this.timer.fps=1,this.elapsedTime=0,this._previousBreakpoint,this.hasTimeEnded=!1,this._statusService=b,this._pubSubService=c,this._locationService=d,this._$timeout=e,this._totalTime=9e5,this.breakpoints=[{time:this._totalTime-24e4,status:b.message.TIMER_FOUR,controls:{hide:"got it"},sticky:!1},{time:this._totalTime-12e4,status:b.message.TIMER_TWO,controls:{hide:"got it"},sticky:!0,data:{timeLeft:this.getTimeLeft.bind(this)}},{time:this._totalTime,status:b.message.TIMER_END,controls:{dismiss:"got it"},sticky:!0,dismissCallBack:function(){this._locationService.resetApp()}.bind(this),onClose:this._onEndTimer.bind(this)}],{startTimer:this.startTimer.bind(this),stopTimer:this.stopTimer.bind(this),getTimeLeft:this.getTimeLeft.bind(this),getHasTimeEnded:this.getHasTimeEnded.bind(this)}};return b.$inject=["statusService","pubSubService","locationService","$timeout"],b.prototype.getHasTimeEnded=function(){return this.hasTimeEnded},b.prototype.startTimer=function(){this._previousBreakpoint=null,this.hasTimeEnded=!1,this.timer.addListener(a.TICK,this.onTimerBind),this.timer.start()},b.prototype.stopTimer=function(){this.timer.removeListener(a.TICK,this.onTimerBind),this.timer.stop()},b.prototype.getTimeLeft=function(){return this.breakpoints[this.breakpoints.length-1].time-this.elapsedTime},b.prototype._onEndTimer=function(){this._pubSubService.publish("yts.collapseYts",[!0]),this.hasTimeEnded=!0},b.prototype._onTimer=function(){this.elapsedTime=this.timer.elapsed;var a=this._getBreakpoint(this.elapsedTime);a&&a!==this._previousBreakpoint?(this._previousBreakpoint=a,this._$timeout(function(){this._showBreakpoint(a)}.bind(this))):a&&a.data&&a.data.timeLeft()&&this._$timeout(function(){this.elapsedTime=this.timer.elapsed}.bind(this))},b.prototype._showBreakpoint=function(a){var b={format:this._statusService.format.ALERT,copy:a.status,controls:a.controls,sticky:a.sticky,dismissCallBack:a.dismissCallBack};a.onClose&&this._onEndTimer(),a.data&&(b.data=a.data),this._statusService.setAlert(b)},b.prototype._getBreakpoint=function(a){for(var b,c=this.breakpoints.length-1;c>=0;c--)if(this.breakpoints[c].time<a){b=this.breakpoints[c];break}return b},b}),c("common/endpoints/base-endpoints",["angular"],function(a){"use strict";var b=function(){this._activeVersion="v2"};return b.prototype._init=function(a,b,c,d){this._env=a,this._$http=b,this._$q=c,this._modelList=d},b.prototype._getModelConstructor=function(b){var c,d=null;for(var e in this._modelList){var f=this._modelList[e].mapping;a.isArray(f)||(f=[f]);for(var g=0,h=f.length;g<h;g++)if(c=new RegExp("^"+f[g]+"$"),c.test(b)){d=this._modelList[e];break}if(d)break}return d},b.prototype._buildModel=function(b,c){var d=null,e=this._getModelConstructor(c);if(b){a.isArray(b)?d=[]:a.isObject(b)&&(d=e?new e:{});for(var f in b){var g=b[f];if(a.isObject(g)||a.isArray(g)){var h=a.isArray(d)?c:c+"::"+f,i=this._buildModel(g,h);i&&(a.isArray(d)?d.push(i):d[f]=i)}else d[f]=g}}return d},b.prototype._request=function(a,b,c){var d=this._$q.defer(),e=this._$http.post([this._env.context("api").resourceURL,this._activeVersion,a].join("/"),b);return e.then(function(a){var b=null;a.data.response&&(b=this._buildModel(a.data.response,c)),d.resolve(b)}.bind(this)).catch(function(a){d.reject(a)}.bind(this)),d.promise},b}),c("common/endpoints/booking-endpoints",["common/endpoints/base-endpoints"],function(a){"use strict";var b=function(a,b,c,d){this._init(a,b,c,d)};return b.$inject=["envService","$http","$q","modelList"],b.prototype=new a,b.prototype.doSearch=function(a){return this._request("booking/search",a,"SearchModel")},b.prototype.doSearchCal=function(a){return this._request("booking/search-cal",a,"SearchModel")},b}),c("book/services/fare",["angular","moment","common/models/fare-model","common/models/fareinfo-model","common/models/selected-fare-model","common/endpoints/booking-endpoints"],function(a,b,c,d,e,f){"use strict";var g=function(a,b,c,d,e,g,h,i,j,k,l,m,n,o,p,q){return this._http=q,this._api=e,this._$q=b,this._$timeout=c,this._envService=a,this._fareQueryModel=this._defaultFareQueryModel(),this._promoCodeModel={promoCode:"",promoCodeApplied:""},this._activeCurrency="DOLLAR",this._lockInventoryCabinQueryModel=this._defaultLockInventoryCabinQueryModel(),this._lockInventoryCabinResponseModel={},this._selectedFaresModel=[],this._loadingService=g,this._tripService=h,this._changeService=j,this._statusService=k,this.allDatesSelected=!1,this.inventoryLocked=!1,this.itShouldResetSelectedFares=!1,this._fareJumped=!1,this._openSevenDayModalPublished=!1,this._lockCabinInProgress=!1,this._fareIntention=void 0,this._elevateService=i,this._scrollService=l,this._resourceBundle=m,this._locationService=o,this._pubSubService=p,this._codeShareFares=!1,this._isAlaskaOnlyCalendar=!1,this.context="BOOK",this._flightTypeMap={NON_STOP:"nonStop",CONNECTING:"connecting",THRU:"thru"},this._segFlightType={nonStop:"NON_STOP",connecting:"NON_STOP",thru:"THRU"},this._allFaresSelected=!1,this._$injector=d,this._bookingEndpoints=this._$injector.instantiate(f),this._selectedTierBySegment={},this._noFlyDates=[],this._seasonalAvailability=[],this._selectedSegs=0,this._lockInventoryNewFares={},this._faresCache={search:[],searchCodeShare:[]},this._fareType=void 0,this._bestFares={departureFares:{},returningFares:{}},n.config.get(function(a){this._noFlyDates=a.noFlyDates,this._seasonalAvailability=a.seasonalAvailability}.bind(this)),{isDuringElevateAvailability:this.isDuringElevateAvailability.bind(this),isAllFaresSelected:this.isAllFaresSelected.bind(this),applyPromoCode:this.applyPromoCode.bind(this),findAndSetAlternateFare:this.findAndSetAlternateFare.bind(this),getActiveCurrency:this.getActiveCurrency.bind(this),getAllDatesSelected:this.getAllDatesSelected.bind(this),getCurrentTier:this.getCurrentTier.bind(this),getFlightIndexBySegment:this.getFlightIndexBySegment.bind(this),getFlightSegmentByIndex:this.getFlightSegmentByIndex.bind(this),getInventoryLocked:this.getInventoryLocked.bind(this),getIsInternational:this.getIsInternational.bind(this),getLowestFares:this.getLowestFares.bind(this),getPromoCode:this.getPromoCode.bind(this),getSelectedFares:this.getSelectedFares.bind(this),getFareIntention:this.getFareIntention.bind(this),handleDates:this.handleDates.bind(this),loadFares:this.loadFares.bind(this),isAlaska:this.isAlaska.bind(this),isAlaskaOnly:this.isAlaskaOnly.bind(this),setIsAlaskaOnlyCalendar:this.setIsAlaskaOnlyCalendar.bind(this),getIsAlaskaOnlyCalendar:this.getIsAlaskaOnlyCalendar.bind(this),getCodeShareFares:this.getCodeShareFares.bind(this),getFares:this.getFares.bind(this),lockInventoryCabin:this.lockInventoryCabin.bind(this),reset:this.reset.bind(this),resetSelectedFares:this.resetSelectedFares.bind(this),resetService:this.resetService.bind(this),retrievePromoCodeInfo:this.retrievePromoCodeInfo.bind(this),setActiveCurrency:this.setActiveCurrency.bind(this),setContext:this.setContext.bind(this),setFare:this.setFare.bind(this),unsetFare:this.unsetFare.bind(this),setFareIntention:this.setFareIntention.bind(this),setInventoryLocked:this.setInventoryLocked.bind(this),setPromoCode:this.setPromoCode.bind(this),setPromoCodeApplied:this.setPromoCodeApplied.bind(this),setSelectedFaresForPnr:this.setSelectedFaresForPnr.bind(this),setShouldResetSelectedFares:this.setShouldResetSelectedFares.bind(this),shouldResetSelectedFares:this.shouldResetSelectedFares.bind(this),setTierForSegment:this._setTierForSegment.bind(this),selectedTierBySegment:this._selectedTierBySegment,lockInventoryNewFares:this.lockInventoryNewFares.bind(this),releaseLockInventoryCabin:this.releaseLockInventoryCabin.bind(this),setOpenSevenDayModalPublished:this.setOpenSevenDayModalPublished.bind(this),searchThirtyDaysFare:this.searchThirtyDaysFare.bind(this),bestDepartureFares:this.bestDepartureFares.bind(this),bestReturningFares:this.bestReturningFares.bind(this),appendBestDepartingFares:this.appendBestDepartingFares.bind(this),appendBestReturningFares:this.appendBestReturningFares.bind(this)}};return g.$inject=["envService","$q","$timeout","$injector","api","loadingService","tripService","elevateService","changeService","statusService","scrollService","ResourceBundle","cms","locationService","pubSubService","$http"],g.prototype.isDuringElevateAvailability=function(){return!1},g.prototype.getLastFlightArrivalDate=function(){var a=this._selectedFaresModel[this._selectedFaresModel.length-1];return b(a.legs[a.legs.length-1].arrivalDateTime)},g.prototype.setOpenSevenDayModalPublished=function(a){this._openSevenDayModalPublished=a},g.prototype.lockInventoryNewFares=function(){return this._lockInventoryNewFares},g.prototype.isAllFaresSelected=function(){return this._allFaresSelected},g.prototype.setContext=function(a){this.context=a},g.prototype.shouldResetSelectedFares=function(){return this.itShouldResetSelectedFares},g.prototype.setShouldResetSelectedFares=function(a){this.itShouldResetSelectedFares=a},g.prototype.setInventoryLocked=function(a,b){var c=this.inventoryLocked?this.releaseLockInventoryCabin(b):this._$q.defer();return!this.inventoryLocked&&c.resolve(),this.inventoryLocked=a,c.promise},g.prototype.getInventoryLocked=function(){return this.inventoryLocked},g.prototype.getFlightSegmentByIndex=function(a){var b=0;for(var c in this._selectedFaresModel)for(var d in this._selectedFaresModel[c].legs){if(b===a)return this._selectedFaresModel[c].legs[d];b++}},g.prototype.getFlightIndexBySegment=function(a){var b={};for(var c in this._selectedFaresModel)b[c]=Object.keys(this._selectedFaresModel[c].legs).length;return a=0===a||1===a&&b[0]>1?0:1},g.prototype.getAllDatesSelected=function(){return this.allDatesSelected},g.prototype.getSelectedFares=function(){return this._selectedFaresModel},g.prototype.resetSelectedFares=function(){this._selectedFaresModel=[],this._selectedSegs=0,this.itShouldResetSelectedFares=!0,this._allFaresSelected=!1},g.prototype.resetService=function(){this._selectedFaresModel=[],this.allDatesSelected=!1,this._pubSubService.publish("responseFareModel",[[]])},g.prototype._getChangedTierType=function(a,b,c){var d,e=this._selectedFaresModel[b].tiers,f={FIRST:["first","firstRefundable"],MCS:["mcs","mcsRefundable"],MC:["main","mainRefundable"]};if(c&&f[a].indexOf(c)!==-1)return c;for(var g in f[a]){var h=f[a][g];if(!(c.indexOf("Refundable")>-1&&h.indexOf("Refundable")===-1)&&e[h]&&!e[h].notAvailable){d=h,this._setTierForSegment(b,a);break}}return d},g.prototype._setTierForSegment=function(a,b){this._selectedFaresModel[a]&&Object.size(this._selectedFaresModel[a].legs)>1&&(this._selectedTierBySegment[2*a+1]=b,1===a&&1===Object.size(this._selectedFaresModel[0].legs)&&2===Object.size(this._selectedFaresModel[1].legs)&&(this._selectedTierBySegment[2]=b))},g.prototype.setFareIntention=function(a){this._fareIntention=a},g.prototype.getFareIntention=function(){return this._fareIntention},g.prototype.unsetFare=function(a){this._selectedFaresModel[a]={}},g.prototype.setFare=function(a,b,c){var d,f,g=new e;"CHANGE"===this.context&&this._changeService.isReturningFlight()&&(d=this._changeService.getPnrModel().flightList[0],f=d.segments[0].segNum-1),g.deserialize(b,"defaultMap",{direction:a,tier:c,oldFare:this._selectedFaresModel[a],tripType:this._tripService.getTripType(),segNum:f||this._selectedSegs,originalOAndD:d}),this._selectedSegs+=g.getNumberOfLegs(),this._selectedFaresModel[a]=g;var h=this._tripService.getTripType()===this._tripService.ONE_WAY?1:2;this._selectedFaresModel.length===h&&(this._allFaresSelected=!0)},g.prototype._buildQuery=function(){var b={},c={ROUND_TRIP:"roundTrip",ONE_WAY:"oneWay",MULTI_CITY:"multiCity"},d="BOOK"===this.context?"_tripService":"_changeService",e=this[d].getSelectedTripPublicModel();this._fareQueryModel=e.serialize("search"),this._fareQueryModel.bookingType=this._activeCurrency;var f=a.copy(this._fareQueryModel);for(var g in f)f[g]||delete f[g];return delete f.tripType,b[c[e.tripType]]=f,this._lockInventoryCabinQueryModel.tripDetails=a.copy(this._fareQueryModel),this._promoCodeModel.promoCode&&this._promoCodeModel.promoCode.length&&(b.promoCode=this._promoCodeModel.promoCode),b},g.prototype.searchThirtyDaysFare=function(a){var b=this._buildQuery(),c=this._$q.defer();if(delete b.departureDate,b.roundTrip)b.roundTrip.departureDate=a,b.roundTrip.returningDate=a;else if(b.oneWay)b.oneWay.departureDate=a;else for(var d in b.multiCity.oneWayList){var e=b.multiCity.oneWayList[d];e.departureDate=a}return this._bookingEndpoints.doSearchCal(b).then(function(a){c.resolve(a)}.bind(this),c.reject.bind(this)),c.promise},g.prototype.formatLowestFares=function(a){var b={};for(var c in a)if(!a[c].notAvailable){var d="DOLLAR"===this._activeCurrency?"dollarFare":"pointsFare",e="DOLLAR"===this._activeCurrency?"totalFare":"totalPoints",f=a[c].fare[d];b[c]={price:f&&Math.ceil(f[e]),tax:f&&f.totalTax,fareBasisCode:a[c].fare.fareBasisCode}}return b},g.prototype.getLowestFares=function(a,c){function d(a){var b=f===o._tripService.MULTI_CITY?a.response.oneWaySearchResultList[g].departingFlightsInfo:a.response[c+"FlightsInfo"],d=b.bestFareList,h=o.formatLowestFares(d);e.resolve(h)}var e=this._$q.defer(),f=this._tripService.getTripType(),g="departing"===c?0:1,h="departing"===c?"setDepartingDate":"setReturningDate",i="departing"===c?"setReturningDate":"setDepartingDate",j="BOOK"===this.context?"_tripService":"_changeService",k=this[j].getDates()[g],l=null;if(this._fareType=c,this[j][h](a),f===this._tripService.ROUND_TRIP){var m="departing"===c?a:this[j].getDates()[0],n="returning"===c?a:this[j].getDates()[1];l="departing"===c?n:m,b(m)>b(n)&&this[j][i](a)}var o=this;return this.getFares(!0).then(d.bind(this),function(){e.reject()}),this[j][h](k),l&&this[j][i](l),e.promise},g.prototype.getFares=function(b,c){var d="search";"undefined"!=typeof c&&(d=c),b||(this._selectedFaresModel=[]);var e=this._buildQuery(),f=this._faresCache[d].filter(function(b){return a.equals(e,b.query)}.bind(this))[0];if(f)return f.result;var g=this._api.booking[d](e).then(function(a){return a.data});return this._faresCache[d].push({query:e,result:g}),g},g.prototype._convertDuration=function(a){var b=Math.floor(a/60),c=Math.floor(a-60*b);return b+"h "+c+"m"},g.prototype._formatLeg=function(c,d){var e=a.copy(c),f=b(e.departureDateTime,"YYYY-MM-DD HH:mm Z"),g=b(e.arrivalDateTime,"YYYY-MM-DD HH:mm Z");return e.departureTime=f.zone(e.departureDateTime).format("h:mma"),e.arrivalTime=g.zone(e.arrivalDateTime).format("h:mma"),e.duration=this._convertDuration(c.elapsedTime),e},g.prototype._formatTierList=function(b){var c={},d={FIRST_NONREFUNDABLE:"first",FIRST_REFUNDABLE:"firstRefundable",MCS_NONREFUNDABLE:"mcs",MCS_REFUNDABLE:"mcsRefundable",MC_NONREFUNDABLE:"main",MC_REFUNDABLE:"mainRefundable"},e={main:"MC",mainRefundable:"MC",mcs:"MCS",mcsRefundable:"MCS",first:"FIRST",firstRefundable:"FIRST"};return a.forEach(b,function(a,b){var f=d[b];a.originalKey=b,a.cabinType=e[f];var g=0;for(var h in a.taxList){var i=parseFloat(a.taxList[h].taxAmount);g+=i}a.totalTax=g.toFixed(2),c[f]=a}),c},g.prototype._formatFare=function(b,c){var d,e,f,g=!1;if(e=b.flightSegment?b.flightSegment:b.flightList[0].flightSegment,d=e.departureDateTime.match(/^\d{4}-\d{2}-\d{2}/)[0],c=c.match(/^\d{4}-\d{2}-\d{2}/)[0],d!==c)return!1;var h={tiers:this._formatTierList(b.fareList),legs:[]};switch(this._flightTypeMap[b.flightType]){case this._flightTypeMap.NON_STOP:h.legs.push(this._formatLeg(b.flightSegment,null));break;case this._flightTypeMap.CONNECTING:g=!0,a.forEach(b.flightList,function(b){b.flightType===this._segFlightType.thru?(h.isConnectingThru=!0,f=a.copy(h.legs),h.thruFlightLegs=h.thruFlightLegs||f,h.thruFlightLegs=h.thruFlightLegs.concat(this._getThruLegs(b.flightSegment,b.airportStopList))):h.thruFlightLegs&&h.thruFlightLegs.push(this._formatLeg(b.flightSegment,b.flightType)),h.legs.push(this._formatLeg(b.flightSegment,b.flightType))}.bind(this));break;case this._flightTypeMap.THRU:h.thruFlightLegs=this._getThruLegs(b.flightSegment,b.airportStopList),h.legs.push(this._formatLeg(b.flightSegment,null))}return h=this._formatLayoverAndTotalTime(h,g)},g.prototype._getThruLegs=function(b,c){var d,e=[];return d=a.copy(a.copy(b)),d.arrival=c[0].location,d.arrivalDateTime=c[0].arrivalDate,e.push(this._formatLeg(d,null)),d=a.copy(a.copy(b)),d.departure=c[0].location,d.departureDateTime=c[0].departureDate,e.push(this._formatLeg(d,null)),e},g.prototype._buildFlightListObject=function(b,c){var d,e={};return a.forEach(this._flightTypeMap,function(a){e[a]=[]}),a.forEach(b,function(b,f){a.forEach(b,function(a){d=this._formatFare(a,c),d&&e[this._flightTypeMap[f]].push(d)},this)},this),e},g.prototype._deserializeApiResponse=function(b){var c="BOOK"===this.context?"_tripService":"_changeService",d=[];return this[c].getTripType()!==this._tripService.MULTI_CITY?a.forEach([{leg:"departingFlightsInfo",date:"departureDate"},{leg:"returningFlightsInfo",date:"returningDate"}],function(a){b[a.leg]&&d.push(this._buildFlightListObject(b[a.leg].flightList,b[a.date]))}.bind(this)):a.forEach(b.oneWaySearchResultList,function(a){a.departingFlightsInfo&&d.push(this._buildFlightListObject(a.departingFlightsInfo.flightList,a.departureDate))}.bind(this)),d},g.prototype._createAlertModelForNotAvailableDates=function(a,b){var c={format:this._statusService.format.ALERT,copy:a.copy,sticky:!0,data:a.data,recoverable:!0,controls:{dismiss:a.dismiss},dismissCallBack:function(){b?this._locationService.go({target:"/cms/seasonal-schedule",newTab:!0}):this._scrollService.go("calendar")}.bind(this)};return c},g.prototype.isAlaska=function(){return this._codeShareFares&&this._codeShareFares.departingFlightsInfo&&"undefined"!=typeof this._codeShareFares.departingFlightsInfo.flightCountByAirline.AS},g.prototype.isAlaskaOnly=function(){return this.isAlaska()&&"undefined"==typeof this._codeShareFares.departingFlightsInfo.flightCountByAirline.VX},g.prototype.setIsAlaskaOnlyCalendar=function(a){this._isAlaskaOnlyCalendar=a},g.prototype.getIsAlaskaOnlyCalendar=function(){return this._isAlaskaOnlyCalendar},g.prototype.getCodeShareFares=function(){return this._codeShareFares},g.prototype._loadCodeShareFares=function(){var a=this._$q.defer();return this._codeShareFares=!1,this.getFares(!0,"searchCodeShare").then(function(b){this._codeShareFares=b.response,a.resolve()}.bind(this),function(b){a.reject(b)}),a.promise},g.prototype.loadFares=function(a){var b=this._$q.defer(),c=this._loadCodeShareFares(),d=this.getFares(!!a).then(function(a){if(a.error||!a.response||a.response.error)b.reject(a.error);else{var d=this._deserializeApiResponse(a.response);for(var e in d)d&&d[e]&&d[e].nonStop&&0===d[e].nonStop.length&&d[e].connecting&&0===d[e].connecting.length&&d[e].thru&&0===d[e].thru.length?c.then(function(){this.isAlaskaOnly()||this._openSevenDayModalPublished?b.resolve(a):(this._openSevenDayModalPublished=!0,this._pubSubService.publish("openSevenDayModal",[!1]),b.reject())}.bind(this)):b.resolve(a);this._pubSubService.publish("responseFareModel",[d])}}.bind(this));return this._loadingService.setLoading(d),b.promise},g.prototype.setSelectedFaresForPnr=function(b){var c,d,e=this._$q.defer();return c=a.isArray(b)?b:b.flightList?b.flightList:[b],this.loadFares().then(function(b,c,d){var f,g,h,i,j=[],k=[];for(var l in b){var m=b[l];k.push(this._uniqueFlightKeyFromFlight(m)),j.push({flightType:this._flightTypeMap[m.flightType],cabinClass:c?m.cabinClass:m.segments[0].cabinClass})}a.forEach(k,function(a,b){try{f=d[b][j[b].flightType]}catch(a){f=null}i=!1,h=this._resourceBundle.cabinClassVXToUiMap[j[b].cabinClass];for(var c in f){g=f[c];var e=this._uniqueFlightKeysFromFare(g);for(var k in e)if(a===e[k]){this.setFare(b,g,h),i=!0;break}if(i)break}},this),e.resolve()}.bind(this,c,d)),e.promise},g.prototype._uniqueFlightKeyFromFlight=function(a){var b=a.cabinClass+"|";for(var c in a.segments){var d=a.segments[c];b+=parseInt(d.flightNum,10)+"_"+d.departure+"_"+d.arrival+"_"+d.departureDateTime+"_"+d.arrivalDateTime+"|"}return b},g.prototype._uniqueFlightKeysFromFare=function(a){var b=[],c="";for(var d in a.legs){var e=a.legs[d];c+=parseInt(e.flightNum)+"_"+e.departure+"_"+e.arrival+"_"+e.departureDateTime+"_"+e.arrivalDateTime+"|"}for(var f in a.tiers){var g=a.tiers[f];b.push(g.originalKey+"|"+c)}return b},g.prototype.setActiveCurrency=function(a){var b=this._$q.defer(),c=this._activeCurrency;return a!==c&&(this._activeCurrency=a,this.loadFares().then(function(){b.resolve()})),b.promise},g.prototype.getActiveCurrency=function(){return this._activeCurrency},g.prototype.applyPromoCode=function(a){this._tripService.setPromoCode(a),this.loadFares()},g.prototype.getPromoCode=function(){return this._promoCodeModel},g.prototype.setPromoCode=function(a){this._promoCodeModel.promoCode=a},g.prototype.setPromoCodeApplied=function(a){this._promoCodeModel.promoCodeApplied=a},g.prototype.retrievePromoCodeInfo=function(){var a=this._validatePromoCode();return a},g.prototype._validatePromoCode=function(){var a=this,b=this._$q.defer(),c={promoCode:this._promoCodeModel.promoCode,origin:this._fareQueryModel.origin,tripType:this._tripService.getTripType()};return this._api.booking.validatePromoCode(c).then(function(c){"SUCCESS"===c.data.status.status?(a.setPromoCodeApplied(!0),b.resolve(c.data)):b.reject(c.data.error)},function(a){b.reject(a)}),b.promise},g.prototype.handleDates=function(a,b){if(b===this.context){var c="BOOK"===this.context?"_tripService":"_changeService";this.allDatesSelected=!1;var d=this[c].getSelectedTripPublicModel();if(a&&a.length){var e=d.tripType===this._tripService.ONE_WAY;e||!e&&a.length>1?this._$timeout(function(){this.allDatesSelected=!0}.bind(this)):d.dates.length>1&&this._$timeout(function(){this.allDatesSelected=!0}.bind(this))}}},g.prototype.getCurrentTier=function(a){return this._currentTier||this.getSelectedFares()[this.getFlightIndexBySegment(a)].tier},g.prototype._onLockInventoryFail=function(a){this._lockCabinInProgress=!1,a.reject()},g.prototype._onLockInventorySuccess=function(a,b){this._lockCabinInProgress=!1;var e=b.data.response;if(e.fareJumped){var f={format:this._statusService.format.ALERT,copy:this._statusService.message.FARE_JUMPED,controls:{hide:"got it"},sticky:!1};this._statusService.setAlert(f)}e.fareInformation&&(this._lockInventoryNewFares=new d,this._lockInventoryNewFares.deserialize(e.fareInformation,"fare"));var g=new c;g.deserialize(b.data.response,"fare"),
this._lockInventoryCabinResponseModel=g,this.setInventoryLocked(!0),a.resolve()},g.prototype.releaseLockInventoryCabin=function(b){var c=b&&a.isObject(b)?b:this._$q.defer();return this.inventoryLocked?this._api.booking.releaseLockInventoryCabin().then(function(){this.inventoryLocked=!1,c.resolve()}.bind(this)):c.resolve(),c},g.prototype.lockInventoryCabin=function(){var a=this._$q.defer();if(this._lockCabinInProgress)a.resolve();else{this._lockCabinInProgress=!0;var b=this._buildLockInventoryCabinQuery();this._api.booking.lockInventoryCabin(b).then(this._onLockInventorySuccess.bind(this,a),this._onLockInventoryFail.bind(this,a))}return a.promise},g.prototype._buildLockInventoryCabinQuery=function(){var b=this._tripService.getTripType(),c=this._lockInventoryCabinQueryModel.tripDetails.bookingType,d="DOLLAR"===c?"dollarFare":"pointsFare";this._lockInventoryCabinQueryModel.tripDetails.origin=this._fareQueryModel.origin,this._lockInventoryCabinQueryModel.tripDetails.destination=this._fareQueryModel.dest,"ONE_WAY"===b||"ROUND_TRIP"===b?(this._buildDepartingFlightInfoForLockInventory(),"ROUND_TRIP"===b&&this._buildReturningFlightInfoForLockInventory()):this._buildMultiCityFlightInfoForLockInventory();var e=a.copy(this._lockInventoryCabinQueryModel);return e.tripDetails.tripType=b,(!e.tripDetails.promoCode||"DOLLAR"!==c)&&delete e.tripDetails.promoCode,this._elevateService.isLoggedIn()&&"pointsFare"===d&&(e.tripDetails.authToken=this._elevateService.getAuthToken()),delete e.tripDetails.dest,delete e.tripDetails.departureDate,delete e.tripDetails.returningDate,e},g.prototype._buildFlightSegmentForLockInventory=function(a){return{flightNum:a.flightNum,departure:a.departure,arrival:a.arrival,departureDateTime:a.departureDateTime,arrivalDateTime:a.arrivalDateTime,aircraftType:a.aircraftType,classOfService:a.classOfService}},g.prototype._getFlightTypeConstant=function(b){var c;return a.forEach(this._flightTypeMap,function(a,d){b===a&&(c=d)}.bind(this)),c},g.prototype._buildDepartingFlightInfoForLockInventory=function(){var a=this._selectedFaresModel[0];this._lockInventoryCabinQueryModel.tripDetails.departingFlightList=[],this._lockInventoryCabinQueryModel.tripDetails.departingSelectedFare={},this._lockInventoryCabinQueryModel.tripDetails.departingFlightType=this._getFlightTypeConstant(a.flightType);var b=[];for(var c in a.legs){var d={flightSegment:this._buildFlightSegmentForLockInventory(a.legs[c]),flightType:this._segFlightType[a.flightType]};b.push(d)}this._lockInventoryCabinQueryModel.tripDetails.departingFlightList.push({departingFlights:b}),this._lockInventoryCabinQueryModel.tripDetails.departingSelectedFare.fareInformation=a.information.serialize("lockInventory")},g.prototype._buildReturningFlightInfoForLockInventory=function(){var a=this._selectedFaresModel[1];this._lockInventoryCabinQueryModel.tripDetails.returningSelectedFare={},this._lockInventoryCabinQueryModel.tripDetails.returningFlightList=[],this._lockInventoryCabinQueryModel.tripDetails.returningFlightType=this._getFlightTypeConstant(a.flightType);for(var b in a.legs){var c={flightSegment:this._buildFlightSegmentForLockInventory(a.legs[b]),flightType:this._segFlightType[a.flightType]};this._lockInventoryCabinQueryModel.tripDetails.returningFlightList.push(c)}this._lockInventoryCabinQueryModel.tripDetails.returningSelectedFare.fareInformation=a.information.serialize("lockInventory")},g.prototype._buildMultiCityFlightInfoForLockInventory=function(){this._lockInventoryCabinQueryModel.tripDetails.departingFlightList=[],a.forEach(this._selectedFaresModel,function(a){this._lockInventoryCabinQueryModel.tripDetails.origin||(this._lockInventoryCabinQueryModel.tripDetails.origin=a.legs[0].departure),this._lockInventoryCabinQueryModel.tripDetails.destination||(this._lockInventoryCabinQueryModel.tripDetails.destination=a.legs[0].arrival);var b=[];for(var c in a.legs){var d={flightSegment:this._buildFlightSegmentForLockInventory(a.legs[c]),flightType:this._segFlightType[a.flightType]};b.push(d)}var e={departingFlights:b,departingFlightType:this._getFlightTypeConstant(a.flightType),departingSelectedFare:{}};e.departingSelectedFare.fareInformation=a.information.serialize("lockInventory"),delete this._lockInventoryCabinQueryModel.tripDetails.returningDate,delete this._lockInventoryCabinQueryModel.tripDetails.oneWayList,this._lockInventoryCabinQueryModel.tripDetails.departingFlightList.push(e)}.bind(this))},g.prototype.findAndSetAlternateFare=function(a,b,c){var d,e=this._$q.defer(),f={};for(var g in this._selectedFaresModel)f[g]=Object.keys(this._selectedFaresModel[g].legs).length;var h=0;return 0===b||1===b&&f[0]>1?h=0:b>=1&&f[1]&&(h=1),d=this._getChangedTierType(a.cabinType,h,c),0===b||1===b&&f[0]>1?this.setFare(0,this._selectedFaresModel[0]._rawData,d):b>=1&&f[1]&&this.setFare(1,this._selectedFaresModel[1]._rawData,d),this.inventoryLocked?this.setInventoryLocked(!1,e).then(function(){var a=this.lockInventoryCabin();this._loadingService.setLoading(a),a.then(function(){this._pubSubService.publish("alternateFareInventoryLocked")}.bind(this))}.bind(this)):e.resolve(),this._pubSubService.publish("fare.setChangedFare",[b]),e.promise},g.prototype.getIsInternational=function(){return this._lockInventoryCabinResponseModel&&this._lockInventoryCabinResponseModel.isInternational},g.prototype._formatLayoverAndTotalTime=function(a,c){var d,e,f=b(a.legs[0].departureDateTime).zone(a.legs[0].departureDateTime),g=b(a.legs[0].arrivalDateTime).zone(a.legs[0].arrivalDateTime);if(c){d=b(a.legs[1].departureDateTime).zone(a.legs[1].departureDateTime),e=b(a.legs[1].arrivalDateTime).zone(a.legs[1].arrivalDateTime);var h=b.duration(e.diff(f)),i=b.duration(d.diff(g));a.totalTime=h.get("hours")+"h "+h.get("minutes")+"m",a.layoverTime=i.get("hours")+"h "+i.get("minutes")+"m"}return a.isRedeye=c?f.format("YYYYMMDD")!==e.format("YYYYMMDD"):f.format("YYYYMMDD")!==g.format("YYYYMMDD"),a},g.prototype.bestDepartureFares=function(){return this._bestFares.departureFares},g.prototype.bestReturningFares=function(){return this._bestFares.returningFares},g.prototype.appendBestDepartingFares=function(b){a.extend(this._bestFares.departureFares,b)},g.prototype.appendBestReturningFares=function(b){a.extend(this._bestFares.returningFares,b)},g.prototype._defaultFareQueryModel=function(){return{departureDate:"",returningDate:"",numOfAdults:null,numOfChildren:null,numOfInfants:null,bookingType:"DOLLAR",tripType:"roundTrip"}},g.prototype._defaultLockInventoryCabinQueryModel=function(){return{tripDetails:{departingFlightList:[],origin:null,destination:null,tripType:null,numOfAdults:null,numOfChildren:null,numOfInfants:null,bookingType:"DOLLAR"}}},g.prototype.reset=function(){this._fareQueryModel=this._defaultFareQueryModel(),this._promoCodeModel={promoCode:"",promoCodeApplied:""},this._tripService.setPromoCode(""),this._activeCurrency="DOLLAR",this._lockInventoryCabinQueryModel=this._defaultLockInventoryCabinQueryModel(),this._lockInventoryCabinResponseModel={},this._selectedFaresModel=[],this._selectedTierBySegment={},this._allFaresSelected=!1,this.allDatesSelected=!1,this.inventoryLocked=!1,this.itShouldResetSelectedFares=!1,this._fareJumped=!1,this._selectedSegs=0},g}),c("book/services/flight-performance",["jquery"],function(a){"use strict";var b=function(a){this._envService=a};return b.prototype.getFlightPerformance=function(b,c,d){var e=("000"+b).toString().slice(-4),f=[this._envService.flightPerformance().resourceURL,"VX",e,c,d,".xml"],g=a.Deferred();return a.get(f.join("")).success(function(b){var c=a(b),d={onTime:c.find("OnTimeArrivalPctg").text(),late:c.find("LateArrivalPctg").text(),cancelled:c.find("CancellationPctg").text()};g.resolve(d)}).error(function(a,b){g.reject(b)}),g.promise()},b.$inject=["envService"],b}),c("book/services/trip",["angular","moment","common/models/trip-model","common/models/elevate-model"],function(a,b,c,d){"use strict";var e=function(a,b,d,e,f,g,h,i,j){return this.constants={DEPARTURE:"dep",DESTINATION:"des",MULTI_CITY:"MULTI_CITY",ONE_WAY:"ONE_WAY",ROUND_TRIP:"ROUND_TRIP",TRIP_TYPE_OPTIONS:[{name:"Round Trip",val:"ROUND_TRIP"},{name:"One Way",val:"ONE_WAY"},{name:"Multi City",val:"MULTI_CITY"}]},this._tripSelectedModel=new c(this._defaultTripModel()),this._airportData=[],this._travelerTotalLabel="1 Adult",this._loadCalendarFromPersistence=!1,this._$rootScope=a,this._$q=b,this._cms=d,this._locationService=e,this._cms=d,this._windowService=f,this._pubSubService=g,this._elevateService=h,this._resourceBundle=i,this._$filter=j,this._travelerTypes={adults:{single:"Adult",plural:"Adults"},children:{single:"Child",plural:"Children"},infants:{single:"Infant",plural:"Infants"},pets:{single:"Pet",plural:"Pets"}},this._isPopulatedFromUrl=!1,this._visibleSections={},this._originalCityPairs={},this.shouldLoadModelFromPersistence=!1,this._inBookingFlow=!1,this._isAlaskaCalendar=!1,this.alaskaLinkDefaultParams={O:"",D:"",OD:"",DD:"",OT:"",DT:"",A:"",C:"",L:"",F:"",RT:!1,FRM:"avail"},this.setupWatches(),{DEPARTURE:this.constants.DEPARTURE,DESTINATION:this.constants.DESTINATION,MULTI_CITY:this.constants.MULTI_CITY,ONE_WAY:this.constants.ONE_WAY,ROUND_TRIP:this.constants.ROUND_TRIP,clearPets:this.clearPets.bind(this),setVisibleSection:this.setVisibleSection.bind(this),getVisibleSections:this.getVisibleSections.bind(this),getAirport:this.getAirport.bind(this),getAirportData:this.getAirportData.bind(this),getDefaultAirport:this.getDefaultAirport.bind(this),getCityPairs:this.getCityPairs.bind(this),getDateRestrictions:this.getDateRestrictions.bind(this),getTotalTravelers:this.getTotalTravelers.bind(this),getTotalPayingTravelers:this.getTotalPayingTravelers.bind(this),getTravelerData:this.getTravelerData.bind(this),getTravelerList:this.getTravelerList.bind(this),getTripType:this.getTripType.bind(this),getTripTypeLegs:this.getTripTypeLegs.bind(this),getTripTypeOptions:this.getTripTypeOptions.bind(this),getTripTypeLabel:this.getTripTypeLabel.bind(this),getDates:this.getDates.bind(this),getTripLength:this.getTripLength.bind(this),getIsInternational:this.getIsInternational.bind(this),isVisible:this.isVisible.bind(this),setAirport:this.setAirport.bind(this),setTripType:this.setTripType.bind(this),travelerAmount:this.getTravelerData.bind(this),travelerAmountHash:this.getTravelerAmountHash.bind(this),clearDates:this.clearDates.bind(this),setDate:this.setDate.bind(this),setDepartingDate:this.setDepartingDate.bind(this),setReturningDate:this.setReturningDate.bind(this),setTravelerAmount:this.setTravelerAmount.bind(this),travelerTotalLabel:this.getTravelerTotalLabel.bind(this),travelerIndividualLabel:this.getTravelerIndividualLabel.bind(this),getSelectedTripPublicModel:this.getSelectedTripPublicModel.bind(this),getLoadModelFromPersistence:this.getLoadModelFromPersistence.bind(this),setLoadModelFromPersistence:this.setLoadModelFromPersistence.bind(this),getPayingTravelerAmount:this.getPayingTravelerAmount.bind(this),formatCityPair:this.formatCityPair.bind(this),isPopulatedFromUrl:this.isPopulatedFromUrl.bind(this),setPopulatedFromUrl:this.setPopulatedFromUrl.bind(this),resetCityPairs:this.resetCityPairs.bind(this),resetTravelers:this.resetTravelers.bind(this),setBookingFlow:this.setBookingFlow.bind(this),inBookingFlow:function(){return this._inBookingFlow}.bind(this),setLoadCalendarFromPersistence:this.setLoadCalendarFromPersistence.bind(this),getLoadCalendarFromPersistence:this.getLoadCalendarFromPersistence.bind(this),setPromoCode:this.setPromoCode.bind(this),populateWithStubData:this.populateWithStubData.bind(this),getAirportNames:this.getAirportNames.bind(this),reset:this.reset.bind(this),updateCityPairs:this.updateCityPairs.bind(this),validateCityPairs:this.validateCityPairs.bind(this),setIsAlaskaCalendar:this.setIsAlaskaCalendar.bind(this),getIsAlaskaCalendar:this.getIsAlaskaCalendar.bind(this),generateAlaskaLink:this.generateAlaskaLink.bind(this),isAlaskaFlightsEnabled:this.isAlaskaFlightsEnabled.bind(this)}};return e.$inject=["$rootScope","$q","cms","locationService","windowService","pubSubService","elevateService","ResourceBundle","$filter"],e.prototype.isAlaskaFlightsEnabled=function(){return this._locationService.contextIs(this._locationService.contexts.BOOK)},e.prototype.getTravelerAmountHash=function(){var a=this._tripSelectedModel.travelers;return a.adults+a.children+a.infants+a.pets},e.prototype.setBookingFlow=function(a){this._inBookingFlow=a},e.prototype.setLoadModelFromPersistence=function(a){this.shouldLoadModelFromPersistence=a},e.prototype.getLoadModelFromPersistence=function(){return this.shouldLoadModelFromPersistence},e.prototype.getSelectedTripPublicModel=function(){return this._tripSelectedModel},e.prototype.clearPets=function(){this._tripSelectedModel.travelers.pets=0},e.prototype.isPopulatedFromUrl=function(){return this._isPopulatedFromUrl},e.prototype.setPopulatedFromUrl=function(a){this._isPopulatedFromUrl=a},e.prototype.getIsAlaskaCalendar=function(){return this._isAlaskaCalendar},e.prototype.setIsAlaskaCalendar=function(a){this._isAlaskaCalendar=a},e.prototype.isVisible=function(a){return!!this._visibleSections[a]},e.prototype.setVisibleSection=function(a){this.setBookingFlow(!0),this._visibleSections[a.section]=a.isVisible},e.prototype.getVisibleSections=function(){return this._visibleSections},e.prototype.getCityPairs=function(){return this._tripSelectedModel.cityPairs},e.prototype.pluralizeTravelerType=function(a,b){return 1===b?this._travelerTypes[a].single:this._travelerTypes[a].plural},e.prototype.getTripLength=function(){var a=this._tripSelectedModel.dates;return b(a[1]).diff(a[0],"days")},e.prototype.getPayingTravelerAmount=function(){var a=this._tripSelectedModel.travelers;return a.adults+a.children},e.prototype.getTravelerList=function(b,c){b=b||this._tripSelectedModel.travelers;var d=[],e=0;return a.forEach(b,function(a,b){a>0&&(e++,d.push(a+" "+this.pluralizeTravelerType(b,a)))}.bind(this)),!!(e>1||c)&&d.join(", ")},e.prototype.getTripTypeLegs=function(){return this.getTripType()===this.constants.ONE_WAY?1:2},e.prototype.getDates=function(){return this._tripSelectedModel.dates},e.prototype.generateAlaskaLink=function(c,d,e){var f="https://www.alaskaair.com/planbook/shoppingstart/",g=a.extend({},this.alaskaLinkDefaultParams,g);d&&(f="https://www.alaskaair.com/",g.RequestType="calendar"),g.O=this.getCityPairs()[0].dep,g.D=this.getCityPairs()[0].des,g.RT=this.getTripType()===this.constants.ROUND_TRIP,g.OD=b(this.getDates()[0]||d).format("MM/DD/YYYY"),g.RT&&(g.DD=b(this.getDates()[1]||d).format("MM/DD/YYYY"));var h=this.getTravelerData();return g.A=h.adults||0,g.C=h.children||0,g.L=h.infants||0,g.cid="VX_booking funnel:"+c,"object"==typeof e&&(f=e.baseUrl||f,g=a.extend(g,e.params)),f+"?"+$.param(g)},e.prototype.setDate=function(a){this._tripSelectedModel.dates.push(a)},e.prototype.setDepartingDate=function(a){this._tripSelectedModel.dates[0]=a},e.prototype.setReturningDate=function(a){this._tripSelectedModel.dates[1]=a},e.prototype.clearDates=function(){this._tripSelectedModel.dates=[]},e.prototype.setTravelerAmount=function(a){this._tripSelectedModel.travelers=a},e.prototype.getTravelerData=function(){return this._tripSelectedModel.travelers},e.prototype.getTotalTravelers=function(){var a,b=this._tripSelectedModel.travelers,c=0;for(var d in b)a=b[d],c+=a;return c},e.prototype.getTotalPayingTravelers=function(){return this._tripSelectedModel.travelers.adults+this._tripSelectedModel.travelers.children},e.prototype.getIsInternational=function(){var b=!1,c=this._airportData;return a.forEach(c,function(c){a.forEach(c,function(a){a.international&&(b=!0)})}),b},e.prototype.setupWatches=function(){var a=this;this._$rootScope.$watch(function(){return a._tripSelectedModel.cityPairs},this.onCityPairUpdate.bind(this),!0),this._$rootScope.$watchCollection(function(){return a._tripSelectedModel.travelers},a._onTravelerAmountChange.bind(this))},e.prototype._onTravelerAmountChange=function(){this._inBookingFlow&&!this._tripSelectedModel.dates.length&&this._pubSubService.publish("trip.resetTravelerAmount");var a,b=this._tripSelectedModel,c={adults:{singular:"Adult",plural:"Adults"},children:{singular:"Child",plural:"Children"},infants:{singular:"Lap Infant",plural:"Lap Infants"},pets:{singular:"Pet",plural:"Pets"}},d=0,e=[],f=[],g="Guests",h=["Guests"];for(var i in b.travelers)a=b.travelers[i],d+=a,a>0&&$.inArray(i,e)<0&&e.push(i),a>0&&(i=1===a?c[i].singular:c[i].plural,f.push(a+" "+i));1===e.length&&(g=1===d?c[e[0]].singular:c[e[0]].plural),this._travelerTotalLabel=d+" "+g,this._eachTraveler=1===e.length?h:f},e.prototype.getTravelerTotalLabel=function(){return this._travelerTotalLabel},e.prototype.getTravelerIndividualLabel=function(){return this._eachTraveler},e.prototype.getAirport=function(a){return this._airportData[a]},e.prototype.getAirportData=function(){return this._airportData},e.prototype.onCityPairUpdate=function(){var a,b,c=function(c){var d=[];try{for(var e in this._tripSelectedModel.cityPairs){if(b={},a=this._tripSelectedModel.cityPairs[e],a.dep)switch(b.dep=c.airports[a.dep],b.dep.code=a.dep,b.dep.msaCode){case"5602":b.dep.shortName="New York City";break;case"8872":b.dep.shortName="Washington, DC";break;default:b.dep.shortName=b.dep.name}a.des&&(b.des=c.airports[a.des],b.des.code=a.des),d.push(b)}this._airportData=d}catch(a){}};this._cms.config.get(c.bind(this))},e.prototype.resetCityPairs=function(){for(var a=!0,b=this._tripSelectedModel.cityPairs,c=0;c<b.length;c++)a||delete this._tripSelectedModel.cityPairs[c],this._tripSelectedModel.cityPairs[c]&&this._tripSelectedModel.cityPairs[c].des&&delete this._tripSelectedModel.cityPairs[c].des,a=!1},e.prototype.resetTravelers=function(){this._tripSelectedModel.travelers={adults:1,children:0,infants:0,pets:0}},e.prototype.getAirportNames=function(b){var c=this._$q.defer(),d={};return b=a.isArray(b)?[b]:b,this._cms.config.get(function(e){a.forEach(b,function(a,b){d[b]=e.airports[b].name}),c.resolve(d)}),c.promise},e.prototype.updateCityPairs=function(a){for(var b in a){var c=a[b].legs.length;this._tripContainsAirportAlias()&&(this._originalCityPairs[b]=this._tripSelectedModel.cityPairs[b]),this._tripSelectedModel.cityPairs[b]={dep:a[b].legs[0].departure,des:a[b].legs[c-1].arrival}}},e.prototype.formatCityPair=function(a){for(var b=!0,c=this._tripSelectedModel.cityPairs,d=0;d<c.length;d++)b||this._tripSelectedModel.cityPairs.splice(d,1),b=!1;if(a===this.constants.ROUND_TRIP){var e=this._tripSelectedModel.cityPairs[0];e&&(this._tripSelectedModel.cityPairs[1]={dep:e.des,des:e.dep})}},e.prototype.setAirport=function(a,b,c){if("undefined"==typeof this._tripSelectedModel.cityPairs[b]&&(this._tripSelectedModel.cityPairs[b]={dep:null,des:null}),this._tripSelectedModel.cityPairs[b][c]=a,this.getTripType()===this.constants.ROUND_TRIP){var d=this._tripSelectedModel.cityPairs[0];d&&(this._tripSelectedModel.cityPairs[1]={dep:d.des,des:d.dep})}},e.prototype.getDefaultAirport=function(){var b=this._$q.defer();return this._cms.config.get(function(c){var d;a.forEach(c.airports,function(a,b){!this.isAlaskaFlightsEnabled()&&a.asCity||a.msaCode===c.geoData.MSA&&(d=b)}.bind(this)),d||a.forEach(c.airports,function(a,b){!this.isAlaskaFlightsEnabled()&&a.asCity||a.state===c.geoData.State&&a.mainInState&&(d=b)}.bind(this)),d||(d="SFO"),b.resolve(d)}.bind(this)),b.promise},e.prototype.setTripType=function(a){this.formatCityPair(a),this._tripSelectedModel.tripType=a},e.prototype.getTripType=function(){return this._tripSelectedModel.tripType},e.prototype.getTripTypeOptions=function(){return this.constants.TRIP_TYPE_OPTIONS},e.prototype.getTripTypeLabel=function(b){var c="",d=this.getTripTypeOptions();return a.forEach(d,function(a){a.val===b&&(c=a.name)}),c},e.prototype.setPromoCode=function(a){this._tripSelectedModel.promoCode=a},e.prototype.setLoadCalendarFromPersistence=function(a){this._loadCalendarFromPersistence=a},e.prototype.getLoadCalendarFromPersistence=function(){return this._loadCalendarFromPersistence},e.prototype.getDateRestrictions=function(){var b=this._$q.defer();return this._cms.config.get(function(c){var d,e=this.getAirport(0),f=[],g="",h="";e&&e.dep&&e.des&&(g=[e.dep.code,"_",e.des.code].join(""),f.push(g)),this.getTripType()===this.constants.ROUND_TRIP?h=g.split("_").reverse().join("_"):this.getTripType()===this.constants.MULTI_CITY&&(d=this.getAirport(1),d&&(h=[d.dep.code,"_",d.des.code].join(""))),h&&f.push(h);var i=[];a.forEach(f,function(a){i.push({noFlyDates:c.noFlyDates[a]||!1,seasonalAvailability:c.seasonalAvailability[a]||!1})}),b.resolve(i)}.bind(this)),b.promise},e.prototype.populateWithStubData=function(){this._tripSelectedModel=new c({bookingType:"DOLLAR",cityPairs:[{dep:"SFO",des:"BOS"},{dep:"BOS",des:"SFO"}],dates:["2014-02-12","2014-02-14"],promoCode:"",tripType:"ROUND_TRIP",travelers:{adults:1,children:0,infants:0,pets:0}})},e.prototype.validateCityPairs=function(){for(var a=this.getTripTypeLegs(),b=0;b<a;b++)this._originalCityPairs[b]&&(this._tripSelectedModel.cityPairs[b]={dep:this._originalCityPairs[b].dep,des:this._originalCityPairs[b].des});this._originalCityPairs={}},e.prototype._tripContainsAirportAlias=function(){for(var a=!1,b=this._resourceBundle.cityPicker.airportAliases,c=this.getTripTypeLegs(),d=0;d<c;d++)if(b.indexOf(this._tripSelectedModel.cityPairs[d].dep)!==-1||b.indexOf(this._tripSelectedModel.cityPairs[d].des)!==-1){a=!0;break}return a},e.prototype._defaultTripModel=function(){return{bookingType:"DOLLAR",cityPairs:[{},{}],dates:[],promoCode:"",tripType:this.constants.ROUND_TRIP,travelers:{adults:1,children:0,infants:0,pets:0}}},e.prototype.reset=function(){this._tripSelectedModel=new c(this._defaultTripModel()),this._travelerTotalLabel="1 Adult",this._isPopulatedFromUrl=!1,this._visibleSections={},this.shouldLoadModelFromPersistence=!1,this._inBookingFlow=!1,this._originalCityPairs={},this.resetCityPairs()},e}),c("book/vx-book-app",["angular","book/constants/fare-info","book/controllers/trip","book/controllers/trip-booker","book/controllers/trip-news","book/controllers/trip-features","book/controllers/trip-promotions","book/controllers/trip-fares","book/controllers/modals/seven-day-fare-selector","book/controllers/modals/add-promo-code","book/controllers/modals/sign-in","book/controllers/trip-seven-day-fares","book/directives/trip-carousel","book/directives/trip-type","book/directives/trip-airport-list","book/directives/trip-calendar","book/directives/trip-fare-itinerary","book/directives/trip-seven-day-fares","book/directives/book-airport-picker","book/directives/inline-seven-day-fares","book/directives/book-airport-list","book/directives/book-intro-picker","book/directives/book-people-picker","book/directives/book-multi-city","book/directives/alaska-banner","book/directives/alaska-header-banner","book/directives/alaska-book-link","book/directives/alaska-calendar-link","book/services/booking-timer","book/services/fare","book/services/flight-performance","book/services/trip"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F){"use strict";return a.module("vxBookApp",[]).constant("FareInfoBundle",b).controller("TripCtrl",c).controller("TripNewsCtrl",e).controller("TripFeaturesCtrl",f).controller("TripPromotionsCtrl",g).controller("TripFaresCtrl",h).controller("SevenDayFareSelectorCtrl",i).controller("AddPromoCodeCtrl",j).controller("SignInCtrl",k).controller("TripSevenDayFaresCtrl",l).directive("vxBookIntroPicker",v).directive("vxTripCarousel",m).directive("vxTripType",n).directive("vxTripAirportList",o).directive("vxTripCalendar",p).directive("vxTripFareItinerary",q).directive("vxTripSevenDay",r).directive("vxInlineSevenDay",t).directive("vxBookAirportList",u).directive("vxBookAirportPicker",s).directive("vxBookPeoplePicker",w).directive("vxBookMultiCity",x).directive("vxAlaskaBanner",y).directive("vxAlaskaHeaderBanner",z).directive("vxAlaskaBookLink",A).directive("vxAlaskaCalendarLink",B).service("bookingTimerService",C).service("fareService",D).service("flightPerformanceService",E).service("tripService",F)}),c("common/endpoints/visa-checkout-endpoints",["common/endpoints/base-endpoints"],function(a){"use strict";var b=function(a,b,c,d){this._init(a,b,c,d)};return b.$inject=["envService","$http","$q","modelList"],b.prototype=new a,b.prototype.customerInfo=function(a){var b={callId:a};return this._request("visaco/customer-info",b,"VisaCheckoutCustomerInfoModel")},b}),c("purchase/controllers/purchase",["angular","moment","jquery","common/models/address-model","common/models/payment-option-model","common/endpoints/visa-checkout-endpoints"],function(a,b,c,d,e,f){"use strict";var g=function(a,b,c,d,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=this;this._$scope=a,this._$rootScope=b,this._$timeout=c,this._$injector=h,this._$singleTimeout=i,this._$location=d,this._windowService=j,this._purchaseService=k,this._purchaseModel=k.getPaymentView(),this._elevateService=l,this._scrollService=m,this._locationService=n,this._statusService=o,this._resourceBundle=p,this._pubSubService=q,this._loadingService=r,this._envService=s,this._seatService=t,this._accessibleService=u,this.creditCardSources={SAVED:"savedCard",NEW:"newCard"};var w={};w[e.VISA]="icon-visa",w[e.AMEX]="icon-amex",w[e.MASTER]="icon-mastercard",w[e.VIRGIN]="icon-virgin",w[e.TRAVELBANK]="icon-travelbank",w[e.DISCOVER]="icon-discover",w[e.UATP]="icon-uatp",w[e.VXPREMIUM]="icon-creditcardpremium",w[e.VXBASE]="icon-creditcardbase";var x=n.getContext();this._$scope.purchase={changePaymentView:this.changePaymentView.bind(this),setPaymentOption:this.setPaymentOption.bind(this),editPaymentOption:this.editPaymentOption.bind(this),removeCard:this.removeCard.bind(this),removeTravelBank:this.removeTravelBank.bind(this),purchaseModel:this._purchaseModel,getCardList:this.getCardList.bind(this),getAddressList:k.getAddressList.bind(k),paymentView:"select",isPaymentSelected:!1,paymentClass:"",paymentIconClasses:w,isElevateUser:!1,context:x,isEditingPayment:!1,insuranceIsSelected:k.getTravelInsurance.bind(this),isTravelBankApplied:k.getAppliedTravelBank.bind(this),isCardDisabled:this.isCardDisabled.bind(this),clearPaymentOption:this.clearPaymentOption.bind(this),fireAnalyticsAddNewCard:this.fireAnalyticsAddNewCard.bind(this),fireAnalyticsVisaCoClicked:this.fireAnalyticsVisaCoClicked.bind(this),travelBankIsApplied:this._purchaseService.getAppliedTravelBank.bind(this),visaCoCardInfo:{},visaCheckoutScriptSource:g.trustAsResourceUrl(this._getVisaCheckoutSDK()),visaCheckoutButton:g.trustAsResourceUrl(this._getVisaCheckoutButton()),hasExistingCreditCards:this.hasExistingCreditCards.bind(this),paymentFormData:{},paymentFormFields:{},creditCardSources:this.creditCardSources,onPaymentFormSubmit:this.onPaymentFormSubmit.bind(this),updatePaymentFormButton:this.updatePaymentFormButton.bind(this),addAnotherPayment:this.addAnotherPayment.bind(this),showCVVTooltip:!1,hasDollarOrRefundAmounts:this._purchaseService.hasDollarOrRefundAmounts.bind(this)},this._$scope.creditCardResponse={isPayingWithTemporaryCreditCard:!1,temporaryCreditLimit:0},this._purchasePageInit(),this.setContainerHeight(this._windowService.dimensions()),this._windowService.subscribe("resize",function(a,b){this.setContainerHeight(b)}.bind(this)),this._$scope.$watch("purchase.purchaseModel",this._checkEmptyPaymentOptions.bind(this),!0),this._$scope.$watch(this._elevateService.isLoggedIn,this._updateElevateStatus.bind(this),!0),this._$scope.$watch(function(){return d.url()},function(){var a=v._purchaseService.getView(),b="selected"===a;v._$scope.purchase.paymentView=a,v._$scope.purchase.isPaymentSelected=b,b&&v._accessibleService.setFocus("[data-purchase-section-details]")},!0),this._$scope.$on("goBackToPurchaseSelectView",function(){this.changePaymentView("select")}.bind(this)),this._$scope.$on("$destroy",function(){v._windowService.setHeaderVisible(!0),v._windowService.setChromeHidden(!1),v._scrollService.go("top",{duration:0}),v.removeTravelBank()}),this._pubSubService.publish("adobeAnalytics.flightCheckout",[]),this._visaCheckoutEndpoints=this._$injector.instantiate(f),this._initializeVisaCheckout()};return g.$inject=["$scope","$rootScope","$timeout","$location","$sce","$injector","$singleTimeout","windowService","purchaseService","elevateService","scrollService","locationService","statusService","ResourceBundle","pubSubService","loadingService","envService","seatService","accessibleService"],g.prototype._visaCheckoutFailedMessage=function(){var a={format:this._statusService.format.ALERT,copy:this._statusService.message.PURCHASE_VISA_CHECKOUT_FAILED,recoverable:!0,controls:{close:!1,hide:"Got It"}};this._statusService.setAlert(a)},g.prototype._getVisaCheckoutButton=function(){return["production"!==this._envService.meta("hostType")?"https://sandbox-assets.secure.checkout.visa.com":"https://secure.checkout.visa.com","wallet-services-web/xo/button.png?size=154"].join("/")},g.prototype._getVisaCheckoutSDK=function(){return["production"!==this._envService.meta("hostType")?"https://sandbox-assets.secure.checkout.visa.com":"https://assets.secure.checkout.visa.com","checkout-widget/resources/js/integration/v1/sdk.js"].join("/")},g.prototype._getVisaCheckoutApiKey=function(){return"production"!==this._envService.meta("hostType")?this._resourceBundle.statusMessages.purchase.visaCheckoutSandboxAPIKey:this._resourceBundle.statusMessages.purchase.visaCheckoutProdApiKey},g.prototype._initializeVisaCheckout=function(){var a=function(){V.init({apikey:this._getVisaCheckoutApiKey(),paymentRequest:{currencyCode:"USD",total:this._purchaseModel.totalDollars},settings:{locale:"en_US",countryCode:"US",displayName:"Virgin America",logoUrl:[this._$location.protocol(),[[this._$location.host(),this._$location.port()].join(":"),"images/vx-logo-checkout.png"].join("/")].join("://"),websiteUrl:"www.virginamerica.com",customerSupportUrl:"http://virginamerica.custhelp.com/",shipping:{collectShipping:!1}}}),V.on("payment.success",function(a){this._$scope.purchase.visaCoCardInfo.callid=a.callid;var b=this._visaCheckoutEndpoints.customerInfo(a.callid).then(function(a){this._$scope.purchase.visaCoCardInfo.addressInfo=a.getAddressInfo().serialize("visaCheckout"),this._$scope.purchase.visaCoCardInfo.creditCard=a.getPaymentInfo(),this.clearPaymentOption(),this.changePaymentView("credit-card"),this._$singleTimeout(function(){this._pubSubService.publish("adobeAnalytics.visaCheckoutSelected")}.bind(this))}.bind(this));this._loadingService.setLoading(b)}.bind(this)),V.on("payment.error",function(a,b){this._visaCheckoutFailedMessage()}.bind(this))};window.onVmeReady=a.bind(this)},g.prototype.getCardList=function(a){for(var b=this._$scope.purchase.context,c=this._purchaseService.getCreditCardList(b),d=0;d<c.length;d++)"travelbank"!==c[d].type&&c[d].isExpired()&&c.splice(d,1);return a&&a.excludeTB?c=c.filter(function(a){return"travelbank"!==a.type}):a&&a.onlyTB&&(c=c.filter(function(a){return"travelbank"===a.type})[0]),c},g.prototype._purchasePageInit=function(){var a=this._$scope.purchase;this._scrollService.go("top",{duration:0}),this._windowService.setHeaderVisible(!1),this._windowService.setChromeHidden(!0),this._windowService.setYtsExpanded(!1),this._windowService.setChangeFlow(!1),this._$rootScope.$broadcast("ytsAlt",{isAlt:!0}),a.paymentFormData.creditCardSource=this.hasExistingCreditCards()?this.creditCardSources.SAVED:this.creditCardSources.NEW,a.paymentFormData.addressSource=this._purchaseService.getAddressList().length&&"PENDING_SIGNUP_ADDRESS"!==this._purchaseService.getAddressList()[0].addressName?"savedAddress":"newAddress",a.travelBank=this.getCardList({onlyTB:!0}),this._$singleTimeout(function(){this._$scope.purchase.isElevateUser&&(this._$scope.$watch("purchase.paymentFormData.creditCardSource",function(a){this._$scope.purchase.formHandler&&this._$scope.purchase.formHandler.setGroupVisibility("creditCard",a===this.creditCardSources.NEW)}.bind(this)),this._$scope.$watch("purchase.paymentFormData.addressSource",function(a){this._$singleTimeout(function(){this._$scope.purchase.formHandler&&this._$scope.purchase.formHandler.setGroupVisibility("address","newAddress"===a);
}.bind(this))}.bind(this))),this._$scope.purchase.isElevateUser&&this._$scope.$watch("purchase.formHandler.isGroupValid('creditCard')",function(a,b){!b&&a&&this._scrollService.go("top",{duration:0})}.bind(this)),this._$scope.$watch("purchase.paymentFormData.ccType",function(a,b){var c=this._$scope.purchase.paymentFormFields.securityNumber;"uatp"===a&&"uatp"!==b?(c.setVisibility(!1),c.setValidationRules("optional")):"uatp"!==a&&"uatp"===b&&c.setVisibility(!0)}.bind(this)),this.updatePaymentFormButton()}.bind(this))},g.prototype.setContainerHeight=function(a){var b=c(".purchase"),d=a.height-80;b.css("min-height",d)},g.prototype.clearPaymentOption=function(){this._$scope.purchase.purchaseModel.paymentOption=null},g.prototype.setPaymentOption=function(a){!this._$scope.purchase.isEditingPayment&&a&&("travelbank"===a.type.toLowerCase()?(this.changePaymentView("travelbank"),this._pubSubService.publish("adobeAnalytics.travelBank")):a.isExpired()?(this.editPaymentOption(a),this._statusService.setAlert({format:this._statusService.format.ERROR,copy:this._resourceBundle.statusMessages.purchase.cardExpired,recoverable:!0})):(this._purchaseModel.paymentOption=a,this.changePaymentView("selected")),a&&a.address&&this._purchaseService.updateTravelInsurance(a.address.country,a.address.state))},g.prototype.editPaymentOption=function(a){this._$scope.purchase.isEditingPayment=!0,this._purchaseModel.paymentOption=a,this.changePaymentView("credit-card")},g.prototype.removeCard=function(a){this._purchaseService.removeCreditCard(a)},g.prototype.changePaymentView=function(a){this._purchaseService.setView(a),this._scrollService.go("top",{duration:0}),"select"===a&&(this.clearPaymentOption(),delete this._$scope.purchase.visaCoCardInfo.callid,this._$scope.purchase.isEditingPayment=!1);var b=this._getLocationTarget(a);b&&this._locationService.update(b),"selected"===a&&this._getCardType(),this._$scope.purchase.paymentView=a,this._$scope.purchase.isPaymentSelected="selected"===a},g.prototype._getCardType=function(){var a,b,c=this._$scope.purchase;c.purchaseModel.paymentOption?(b=c.purchaseModel.paymentOption.typeTempCard?c.purchaseModel.paymentOption.typeTempCard.toLowerCase():c.purchaseModel.paymentOption.type.toLowerCase(),a=c.paymentIconClasses[b]):a=c.paymentIconClasses[e.TRAVELBANK],this._$scope.purchase.paymentClass=a},g.prototype.removeTravelBank=function(){this._purchaseModel.travelBank=null,this._purchaseService.setAppliedTravelBank(!1)},g.prototype._checkEmptyPaymentOptions=function(){this._$scope.purchase.context||this._locationService.resetApp(),!this._purchaseModel.travelBank&&!this._purchaseModel.paymentOption&&"selected"===this._$scope.purchase.paymentView&&this.changePaymentView("select")},g.prototype._updateElevateStatus=function(a){this._$scope.purchase.isElevateUser=a},g.prototype._getLocationTarget=function(a){var b={select:this._purchaseService.urlConstants.HOME,travelbank:this._purchaseService.urlConstants.TRAVEL_BANK,selected:this._purchaseService.urlConstants.COMPLETE,"credit-card":this._purchaseService.urlConstants.ADD_CARD};return b[a]},g.prototype.fireAnalyticsAddNewCard=function(){this._locationService.getContext()===this._locationService.contexts.BOOK&&this._pubSubService.publish("adobeAnalytics.addedNewCard")},g.prototype.fireAnalyticsVisaCoClicked=function(){this._pubSubService.publish("adobeAnalytics.visaCheckoutClicked")},g.prototype.isCardDisabled=function(a){return a.type.toLowerCase()===this._purchaseService.viewConstants.TRAVEL_BANK&&this._$scope.purchase.isTravelBankApplied()},g.prototype.hasExistingCreditCards=function(){return this.getCardList({excludeTB:!0}).length},g.prototype.onPaymentFormSubmit=function(){var a=this._$scope.purchase;if(a.paymentFormData.creditCardSource===this.creditCardSources.SAVED&&this._purchaseService.hasDollarOrRefundAmounts())this.setPaymentOption(a.paymentFormData.savedCreditCard);else{var b={};this._purchaseService.hasDollarOrRefundAmounts()&&(b=new e({ccNumber:a.paymentFormData.ccNumber,securityCode:a.paymentFormData.securityNumber,cardHolderName:a.paymentFormData.cardholderName,type:a.paymentFormData.ccType.toUpperCase(),expiryDate:a.paymentFormFields.expireDate.getExpirationValue(),nickname:this._getNickname(a.paymentFormData.ccType.toLowerCase(),a.paymentFormData.ccNumber),shouldSave:a.paymentFormData.shouldSave,sequenceNum:0})),"savedAddress"===a.paymentFormData.addressSource?b.address=a.paymentFormData.savedAddress:b.address=new d({addressOne:a.paymentFormData.addressOne,addressTwo:a.paymentFormData.addressTwo,city:a.paymentFormData.city,state:a.paymentFormData.stateSelect,zipCode:a.paymentFormData.zipCode,country:a.paymentFormData.country,type:"HOME"}),this._purchaseService.addCreditCard(b),this._purchaseService.hasDollarOrRefundAmounts()?this.setPaymentOption(b):(this._purchaseModel.paymentOption=b,this.changePaymentView("selected"))}},g.prototype._getNickname=function(a,b){var c=b.toString().substr(-4);return a+" "+c},g.prototype.updatePaymentFormButton=function(){var b=this._$scope.purchase;if(b.formHandler&&!a.equals(b.formHandler.fields,{}))if(b.paymentFormData.creditCardSource===this.creditCardSources.SAVED&&this._purchaseService.hasDollarOrRefundAmounts()){var c=b.paymentFormData.savedCreditCard?b.paymentFormData.savedCreditCard.type:"card";b.formHandler.updateMessages("Continue with saved "+c)}else!b.formHandler.isGroupValid("creditCard")&&this._purchaseService.hasDollarOrRefundAmounts()?!this._$scope.purchase.isElevateUser&&b.formHandler.isGroupEmpty("creditCard")?b.formHandler.updateMessages("Select payment method to continue"):b.formHandler.updateMessages("Fix new card info"):"savedAddress"===b.paymentFormData.addressSource?b.formHandler.updateMessages("Continue with saved address"):b.formHandler.valid||b.formHandler.updateMessages("Fix new address info")},g.prototype.addAnotherPayment=function(){var a=this._$scope.purchase,b=a.getCardList();this._scrollService.go("top"),a.formHandler.clear(),this._$singleTimeout(function(){a.isElevateUser&&this.hasExistingCreditCards()?(a.paymentFormFields.creditCardSource.validateValue(this.creditCardSources.SAVED),a.paymentFormFields.addressSource&&a.paymentFormFields.addressSource.validateValue("savedAddress"),a.paymentFormData.savedCreditCard=this.getCardList({excludeTB:!0})[0]):(2===b.length?b=b.splice(0,1):b.length>2&&b.pop(),a.paymentFormFields.creditCardSource&&a.paymentFormFields.creditCardSource.validateValue(this.creditCardSources.NEW),a.paymentFormFields.addressSource&&a.paymentFormFields.addressSource.validateValue("newAddress"))}.bind(this))},g}),c("purchase/controllers/purchase-credit-card",["angular","moment","common/models/payment-option-model","common/models/address-model"],function(a,b,c,d){"use strict";var e=function(c,d,e,f,g,h,i,j,k){this._$scope=c,this._$singleTimeout=d,this._$modal=e,this._$configApi=f,this._purchaseService=h,this._elevateService=i,this._scrollService=j,this._resourceBundle=g,this._pubSubService=k,this._creditCardNotFoundMessage="Invalid card #",this._$scope.creditCard={onAddCard:this.onAddCard.bind(this),addressOption:"use-stored-address",isCardReadonly:!1,addressData:{},addressFields:{},cardData:{},cardFields:{},selectAddressOption:this.selectAddressOption.bind(this),selectedAddress:{},updateSelectedAddress:this.updateSelectedAddress.bind(this),view:c.purchase.visaCoCardInfo.callid?"billing-address":"add-card",saveBillingAddress:this.saveBillingAddress.bind(this),showCVVInfo:this.showCVVInfo.bind(this),storedAddresses:null};var l=0;for(this._$scope.months=[],l=0;l<12;l++)this._$scope.months.push({name:b().month(l).format("MMMM"),value:l+1});for(this._$scope.years=[],l=0;l<12;l++){var m=b().year()+l;this._$scope.years.push({name:m,value:m})}this._$scope.$watch("creditCard.cardFields.expireMonth.value",function(){this.onExpireMonthChange()}.bind(this)),this._$scope.$watch("creditCard.cardFields.expireYear.value",function(){this.onExpireYearChange()}.bind(this)),this._$scope.$watch("creditCard.cardFields.useAddress.value",function(){if(this._$scope.creditCard.cardFields.useAddress){var a=this._$scope.storedAddresses&&this._$scope.storedAddresses.length;this._$scope.creditCard.cardFields.useAddress.setVisibility(a)}}.bind(this)),this._$scope.$watch("purchase.purchaseModel.paymentOption",this._onAddressesChange.bind(this)),this._scrollService.go("top",{duration:0});var n=this._$scope.creditCard;if(this._$scope.purchase.purchaseModel.paymentOption){var o=this._$scope.purchase.purchaseModel.paymentOption.serialize("edit");n.cardData=o,n.isCardReadonly=!0,"number"==typeof n.cardData.address?n.addressData=this._getAddressBySequenceNum(n.cardData.address):n.addressData=n.cardData.address}else this._$scope.purchase.visaCoCardInfo.callid&&(n.addressData=a.copy(this._$scope.purchase.visaCoCardInfo.addressInfo)),n.isCardReadonly=!1;var p=this._purchaseService.getApiErrorField();p&&(this._$scope.creditCard.cardData[p]=null,this._$singleTimeout(function(){var a=this._$scope.creditCard.cardFields[p];a.validateValue(null)}.bind(this)),this._purchaseService.setApiErrorField(null))};return e.$inject=["$scope","$singleTimeout","$modal","$configApi","ResourceBundle","purchaseService","elevateService","scrollService","pubSubService"],e.prototype._getAddressBySequenceNum=function(a){var b,c=this._$scope.creditCard.storedAddresses;for(var d in c)if(a===c[d].sequenceNum){b=c[d];break}return b},e.prototype._validateExpireDate=function(a,c){var d=a&&a.value?a.value.value:void 0,e=c&&c.value?c.value.value:void 0;if(d&&e){var f=b([d,e,"31"].join("-"));f.isBefore(b())?(a.isValid=!1,c.isValid=!1):(a.isValid=!0,c.isValid=!0)}},e.prototype.onExpireMonthChange=function(){this._validateExpireDate(this._$scope.creditCard.cardFields.expireYear,this._$scope.creditCard.cardFields.expireMonth)},e.prototype.onExpireYearChange=function(){this._validateExpireDate(this._$scope.creditCard.cardFields.expireYear,this._$scope.creditCard.cardFields.expireMonth)},e.prototype.selectAddressOption=function(a){this._$scope.creditCard.addressOption=a},e.prototype.updateSelectedAddress=function(a){var b=this;b._$singleTimeout(function(){b._$scope.creditCard.selectedAddress=a})},e.prototype.onAddCard=function(){"add-new-address"===this._$scope.creditCard.addressOption?(this._$scope.creditCard.view="billing-address",this._scrollService.go("top",{duration:0})):this._saveCreditCard()},e.prototype.saveBillingAddress=function(){var a=this._$scope.creditCard.addressFields,b="";this._elevateService.isLoggedIn()&&(b=a.addressName.value),this._$scope.creditCard.selectedAddress=new d({title:"",addressOne:a.addressOne.value,addressTwo:a.addressTwo.value,city:a.city.value,state:this._$scope.creditCard.stateValue,zipCode:a.zipCode.value,country:a.country.value.value,addressName:b,type:"HOME"}),this._saveCreditCard()},e.prototype._saveCreditCard=function(){this._$scope.purchase.visaCoCardInfo.callid?this._saveVisaCoCard():this._saveAddedCreditCard()},e.prototype._saveVisaCoCard=function(){var a=this._$scope.purchase.visaCoCardInfo.callid,b=this._$scope.purchase.visaCoCardInfo.creditCard,d=new c;d.deserialize({ccNumber:b.ccNumber,type:b.cardType,address:this._$scope.creditCard.selectedAddress,callid:a},"visaCheckout"),this._$scope.purchase.setPaymentOption(d)},e.prototype._saveAddedCreditCard=function(){var a=this._$scope.creditCard,b=a.cardData.ccType||a.cardData.type,d=new c({ccNumber:a.cardFields.ccNumber.value,securityCode:a.cardFields.securityNumber.value,cardHolderName:a.cardFields.cardholderName.value,type:b.toUpperCase(),expireYear:a.cardFields.expireYear.value.value,expireMonth:a.cardFields.expireMonth.value.value,address:this._$scope.creditCard.selectedAddress,nickname:this._getNickname(b.toLowerCase(),a.cardFields.ccNumber.value),shouldSave:a.cardFields.shouldSave.value,sequenceNum:a.cardData.sequenceNum});if(this._$scope.purchase.isEditingPayment){var e=this._$scope.purchase.purchaseModel.paymentOption;d.isEditingPayment=!0,this._purchaseService.editCreditCard(d,e.guid),this._$scope.purchase.changePaymentView("select")}else this._purchaseService.addCreditCard(d),this._$scope.purchase.setPaymentOption(d)},e.prototype._getNickname=function(a,b){var c;return c=b.toString().substr(-4),a+" "+c},e.prototype.showCVVInfo=function(){var a=this._resourceBundle.modal.cvv;this._$modal.open({size:a.SIZE,type:a.TYPE,title:a.TITLE,templateUrl:a.TEMPLATE_URL})},e.prototype._onAddressesChange=function(a){if(!a)return void(this._$scope.creditCard.addressOption="add-new-address");this._$scope.storedAddresses=a.addressList;var b=Array.isArray(this._$scope.storedAddresses);this._$scope.creditCard.cardFields.useAddress&&this._$scope.creditCard.cardFields.useAddress.setVisibility(b),b?(this._$scope.storedAddress=this._$scope.storedAddresses[0],this.updateSelectedAddress(this._$scope.storedAddresses[0])):this._$scope.creditCard.addressOption="add-new-address"},e}),c("purchase/controllers/purchase-travel-bank",[],function(){"use strict";var a=function(a,b,c,d,e,f,g,h){this._$scope=a,this._$modal=b,this._$q=c,this._purchaseService=d,this._statusService=e,this._elevateService=f,this._loadingService=g,this._purchaseModel=d.getPaymentView(),a.travelBank={applyCredit:this.applyCredit.bind(this),changeView:this.changeView.bind(this),login:this.login.bind(this),info:{},credentials:{},getRemainingValue:this.getRemainingValue.bind(this),onConfirmed:this.onConfirmed.bind(this),getActualTravelBankAmount:d.getActualTravelBankAmount.bind(d),view:"select",learnMoreModal:this.learnMoreModal.bind(this),paymentBlocked:this.paymentBlocked.bind(this),goBack:this.goBack.bind(this),shouldAddCreditCard:this.shouldAddCreditCard.bind(this)};var i=h.getPrivateModel();if(this._elevateService.isLoggedIn()&&h&&i.travelBankAuthToken){var j=this._purchaseService.retrieveTravelBankInfo();this._loadingService.setLoading(j),j.then(this.onLoginResponse.bind(this))}};return a.$inject=["$scope","$modal","$q","purchaseService","statusService","elevateService","loadingService","persistenceService"],a.prototype.goBack=function(){this.changeView("select")},a.prototype.login=function(){var a={username:this._$scope.travelBank.credentials.username.value,password:this._$scope.travelBank.credentials.password.value};return this._purchaseService.setTravelBankCredentials(a),this.loadingPromise=this._purchaseService.retrieveTravelBankInfo(),this.loadingPromise.then(this.onLoginResponse.bind(this),this.onLoginResponse.bind(this)),this.loadingPromise},a.prototype.onLoginResponse=function(a){a.trappedError?this._$scope.travelBank.credentials.password.setValidation(!1,"wrong password"):(this._$scope.travelBank.info=this._purchaseModel.travelBank,this._$scope.travelBank.view="redeem-points")},a.prototype.getRemainingValue=function(){return this._$scope.travelBank.info.balance-this._purchaseService.getActualTravelBankAmount()},a.prototype.applyCredit=function(){this._purchaseService.setAppliedTravelBank(!0),this._$scope.travelBank.view="confirmation"},a.prototype.onConfirmed=function(){this.shouldAddCreditCard()?this.changeView("select"):this.changeView("selected")},a.prototype.paymentBlocked=function(){var a="POINTS"===this._purchaseService.getCurrency(),b=this._$scope.travelBank.info.balance>=this._purchaseService.data().totalTaxes;return!!a&&!b},a.prototype.shouldAddCreditCard=function(){return this._purchaseService.getRemainingValue()>0},a.prototype.changeView=function(a){this._$scope.purchase.changePaymentView(a)},a.prototype.learnMoreModal=function(){this._$modal.open({size:"small",title:"Learn More",templateUrl:"/app/purchase/templates/modals/learn-more.tpl.html"})},a}),function(a){function b(a,b,c){var d,k,l,m,n,o,p,q,r,s=0,t=[],w=0,x=!1,y=[],z=[],A=!1;if(c=c||{},d=c.encoding||"UTF8",r=c.numRounds||1,r!==parseInt(r,10)||1>r)throw Error("numRounds must a integer >= 1");if(0!==a.lastIndexOf("SHA-",0))throw Error("Chosen SHA variant is not supported");if(o=function(b,c){return v(b,c,a)},p=function(b,c,d,e){var f,g;if("SHA-224"!==a&&"SHA-256"!==a)throw Error("Unexpected error in SHA-2 implementation");for(f=(c+65>>>9<<4)+15,g=16;b.length<=f;)b.push(0);for(b[c>>>5]|=128<<24-c%32,c+=d,b[f]=4294967295&c,b[f-1]=c/4294967296|0,d=b.length,c=0;c<d;c+=g)e=v(b.slice(c,c+g),e,a);if("SHA-224"===a)b=[e[0],e[1],e[2],e[3],e[4],e[5],e[6]];else{if("SHA-256"!==a)throw Error("Unexpected error in SHA-2 implementation");b=e}return b},q=function(a){return a.slice()},"SHA-224"===a)n=512,m=224;else{if("SHA-256"!==a)throw Error("Chosen SHA variant is not supported");n=512,m=256}l=j(b,d),k=u(a),this.setHMACKey=function(b,c,e){var f;if(!0===x)throw Error("HMAC key already set");if(!0===A)throw Error("Cannot set HMAC key after calling update");if(d=(e||{}).encoding||"UTF8",c=j(c,d)(b),b=c.binLen,c=c.value,f=n>>>3,e=f/4-1,f<b/8){for(c=p(c,b,0,u(a));c.length<=e;)c.push(0);c[e]&=4294967040}else if(f>b/8){for(;c.length<=e;)c.push(0);c[e]&=4294967040}for(b=0;b<=e;b+=1)y[b]=909522486^c[b],z[b]=1549556828^c[b];k=o(y,k),s=n,x=!0},this.update=function(a){var b,c,d,e=0,f=n>>>5;for(b=l(a,t,w),a=b.binLen,c=b.value,b=a>>>5,d=0;d<b;d+=f)e+n<=a&&(k=o(c.slice(d,d+f),k),e+=n);s+=e,t=c.slice(e>>>5),w=a%n,A=!0},this.getHash=function(b,c){var d,j,l,n;if(!0===x)throw Error("Cannot call getHash after setting HMAC key");switch(l=i(c),b){case"HEX":d=function(a){return e(a,m,l)};break;case"B64":d=function(a){return f(a,m,l)};break;case"BYTES":d=function(a){return g(a,m)};break;case"ARRAYBUFFER":try{j=new ArrayBuffer(0)}catch(a){throw Error("ARRAYBUFFER not supported by this environment")}d=function(a){return h(a,m)};break;default:throw Error("format must be HEX, B64, BYTES, or ARRAYBUFFER")}for(n=p(t.slice(),w,s,q(k)),j=1;j<r;j+=1)n=p(n,m,0,u(a));return d(n)},this.getHMAC=function(b,c){var d,j,l,r;if(!1===x)throw Error("Cannot call getHMAC without first setting HMAC key");switch(l=i(c),b){case"HEX":d=function(a){return e(a,m,l)};break;case"B64":d=function(a){return f(a,m,l)};break;case"BYTES":d=function(a){return g(a,m)};break;case"ARRAYBUFFER":try{d=new ArrayBuffer(0)}catch(a){throw Error("ARRAYBUFFER not supported by this environment")}d=function(a){return h(a,m)};break;default:throw Error("outputFormat must be HEX, B64, BYTES, or ARRAYBUFFER")}return j=p(t.slice(),w,s,q(k)),r=o(z,u(a)),r=p(j,m,n,r),d(r)}}function d(){}function e(a,b,c){var d="";b/=8;var e,f;for(e=0;e<b;e+=1)f=a[e>>>2]>>>8*(3+e%4*-1),d+="0123456789abcdef".charAt(f>>>4&15)+"0123456789abcdef".charAt(15&f);return c.outputUpper?d.toUpperCase():d}function f(a,b,c){var d,e,f,g="",h=b/8;for(d=0;d<h;d+=3)for(e=d+1<h?a[d+1>>>2]:0,f=d+2<h?a[d+2>>>2]:0,f=(a[d>>>2]>>>8*(3+d%4*-1)&255)<<16|(e>>>8*(3+(d+1)%4*-1)&255)<<8|f>>>8*(3+(d+2)%4*-1)&255,e=0;4>e;e+=1)g+=8*d+6*e<=b?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(f>>>6*(3-e)&63):c.b64Pad;return g}function g(a,b){var c,d,e="",f=b/8;for(c=0;c<f;c+=1)d=a[c>>>2]>>>8*(3+c%4*-1)&255,e+=String.fromCharCode(d);return e}function h(a,b){var c,d,e=b/8,f=new ArrayBuffer(e);for(d=new Uint8Array(f),c=0;c<e;c+=1)d[c]=a[c>>>2]>>>8*(3+c%4*-1)&255;return f}function i(a){var b={outputUpper:!1,b64Pad:"=",shakeLen:-1};if(a=a||{},b.outputUpper=a.outputUpper||!1,!0===a.hasOwnProperty("b64Pad")&&(b.b64Pad=a.b64Pad),"boolean"!=typeof b.outputUpper)throw Error("Invalid outputUpper formatting option");if("string"!=typeof b.b64Pad)throw Error("Invalid b64Pad formatting option");return b}function j(a,b){var c;switch(b){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(a){case"HEX":c=function(a,b,c){var d,e,f,g,h,i=a.length;if(0!==i%2)throw Error("String of HEX type must be in byte increments");for(b=b||[0],c=c||0,h=c>>>3,d=0;d<i;d+=2){if(e=parseInt(a.substr(d,2),16),isNaN(e))throw Error("String of HEX type contains invalid characters");for(g=(d>>>1)+h,f=g>>>2;b.length<=f;)b.push(0);b[f]|=e<<8*(3+g%4*-1)}return{value:b,binLen:4*i+c}};break;case"TEXT":c=function(a,c,d){var e,f,g,h,i,j,k,l,m=0;if(c=c||[0],d=d||0,i=d>>>3,"UTF8"===b)for(l=3,g=0;g<a.length;g+=1)for(e=a.charCodeAt(g),f=[],128>e?f.push(e):2048>e?(f.push(192|e>>>6),f.push(128|63&e)):55296>e||57344<=e?f.push(224|e>>>12,128|e>>>6&63,128|63&e):(g+=1,e=65536+((1023&e)<<10|1023&a.charCodeAt(g)),f.push(240|e>>>18,128|e>>>12&63,128|e>>>6&63,128|63&e)),h=0;h<f.length;h+=1){for(k=m+i,j=k>>>2;c.length<=j;)c.push(0);c[j]|=f[h]<<8*(l+k%4*-1),m+=1}else if("UTF16BE"===b||"UTF16LE"===b)for(l=2,f="UTF16LE"===b&&!0||"UTF16LE"!==b&&!1,g=0;g<a.length;g+=1){for(e=a.charCodeAt(g),!0===f&&(h=255&e,e=h<<8|e>>>8),k=m+i,j=k>>>2;c.length<=j;)c.push(0);c[j]|=e<<8*(l+k%4*-1),m+=2}return{value:c,binLen:8*m+d}};break;case"B64":c=function(a,b,c){var d,e,f,g,h,i,j,k=0;if(-1===a.search(/^[a-zA-Z0-9=+\/]+$/))throw Error("Invalid character in base-64 string");if(e=a.indexOf("="),a=a.replace(/\=/g,""),-1!==e&&e<a.length)throw Error("Invalid '=' found in base-64 string");for(b=b||[0],c=c||0,i=c>>>3,e=0;e<a.length;e+=4){for(h=a.substr(e,4),f=g=0;f<h.length;f+=1)d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(h[f]),g|=d<<18-6*f;for(f=0;f<h.length-1;f+=1){for(j=k+i,d=j>>>2;b.length<=d;)b.push(0);b[d]|=(g>>>16-8*f&255)<<8*(3+j%4*-1),k+=1}}return{value:b,binLen:8*k+c}};break;case"BYTES":c=function(a,b,c){var d,e,f,g,h;for(b=b||[0],c=c||0,f=c>>>3,e=0;e<a.length;e+=1)d=a.charCodeAt(e),h=e+f,g=h>>>2,b.length<=g&&b.push(0),b[g]|=d<<8*(3+h%4*-1);return{value:b,binLen:8*a.length+c}};break;case"ARRAYBUFFER":try{c=new ArrayBuffer(0)}catch(a){throw Error("ARRAYBUFFER not supported by this environment")}c=function(a,b,c){var d,e,f,g,h;for(b=b||[0],c=c||0,e=c>>>3,h=new Uint8Array(a),d=0;d<a.byteLength;d+=1)g=d+e,f=g>>>2,b.length<=f&&b.push(0),b[f]|=h[d]<<8*(3+g%4*-1);return{value:b,binLen:8*a.byteLength+c}};break;default:throw Error("format must be HEX, TEXT, B64, BYTES, or ARRAYBUFFER")}return c}function k(a,b){return a>>>b|a<<32-b}function l(a,b,c){return a&b^~a&c}function m(a,b,c){return a&b^a&c^b&c}function n(a){return k(a,2)^k(a,13)^k(a,22)}function o(a){return k(a,6)^k(a,11)^k(a,25)}function p(a){return k(a,7)^k(a,18)^a>>>3}function q(a){return k(a,17)^k(a,19)^a>>>10}function r(a,b){var c=(65535&a)+(65535&b);return((a>>>16)+(b>>>16)+(c>>>16)&65535)<<16|65535&c}function s(a,b,c,d){var e=(65535&a)+(65535&b)+(65535&c)+(65535&d);return((a>>>16)+(b>>>16)+(c>>>16)+(d>>>16)+(e>>>16)&65535)<<16|65535&e}function t(a,b,c,d,e){var f=(65535&a)+(65535&b)+(65535&c)+(65535&d)+(65535&e);return((a>>>16)+(b>>>16)+(c>>>16)+(d>>>16)+(e>>>16)+(f>>>16)&65535)<<16|65535&f}function u(a){var b,c=[];if(0!==a.lastIndexOf("SHA-",0))throw Error("No SHA variants supported");switch(c=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],b=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],a){case"SHA-224":break;case"SHA-256":c=b;break;case"SHA-384":c=[new d,new d,new d,new d,new d,new d,new d,new d];break;case"SHA-512":c=[new d,new d,new d,new d,new d,new d,new d,new d];break;default:throw Error("Unknown SHA variant")}return c}function v(a,b,c){var d,e,f,g,h,i,j,k,u,v,x,y,z,A,B,C,D,E,F,G,H,I,J,K=[];if("SHA-224"!==c&&"SHA-256"!==c)throw Error("Unexpected error in SHA-2 implementation");for(v=64,y=1,I=Number,z=r,A=s,B=t,C=p,D=q,E=n,F=o,H=m,G=l,J=w,c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],x=0;x<v;x+=1)16>x?(u=x*y,k=a.length<=u?0:a[u],u=a.length<=u+1?0:a[u+1],K[x]=new I(k,u)):K[x]=A(D(K[x-2]),K[x-7],C(K[x-15]),K[x-16]),k=B(j,F(g),G(g,h,i),J[x],K[x]),u=z(E(c),H(c,d,e)),j=i,i=h,h=g,g=z(f,k),f=e,e=d,d=c,c=z(k,u);return b[0]=z(c,b[0]),b[1]=z(d,b[1]),b[2]=z(e,b[2]),b[3]=z(f,b[3]),b[4]=z(g,b[4]),b[5]=z(h,b[5]),b[6]=z(i,b[6]),b[7]=z(j,b[7]),b}var w;w=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],"function"==typeof c&&c.amd?c("sha256",[],function(){return b}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(module.exports=b),exports=b):a.jsSHA=b}(this),c("purchase/directives/purchase-card-promo",["sha256","moment"],function(a,b){"use strict";var c=function(){return{controller:d,restrict:"A",scope:{total:"=",credit:"="},replace:!0,templateUrl:"/app/purchase/directives/purchase-card-promo.tpl.html"}},d=function(c,d,e,f,g,h){function i(){var a=e.getPrimaryTraveler(),b=g.getByPath(f.getAccountInfo(),"addressInfo.0")||{},c="";return"ALASKA_AIRLINES"===a.frequentFlyer.program&&(c=a.frequentFlyer.number),'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><instantCreditContainer><applicants><applicant><firstName>'+a.name.first+"</firstName><lastName>"+a.name.last+"</lastName><suffix></suffix><applicantAddress><addressLines><addressLine>"+(b.addressOne||"")+"</addressLine><addressLine>"+(b.addressTwo||"")+"</addressLine></addressLines><city>"+(b.city||"")+"</city><postalCode>"+(b.zipCode||"")+"</postalCode><state>"+(b.state||"")+"</state></applicantAddress></applicant></applicants><genericVariables><genericVariable><code>374</code><value>"+c+"</value></genericVariable></genericVariables></instantCreditContainer>"}function j(){var b=new a("SHA-256","TEXT");return b.update(i()),b.getHash("HEX")}this._$scope=c,this._pubSubService=h,this.applyData={action:"https://secure.bankofamerica.com/applynow/initialize-workflow.go?requesttype=ICAO&campaignid=4025197",requestpayload:i(),requesthashvalue:j()},d.info.get(function(a){var c=g.getByPath(a,"alaskaSetup.purchaseCardPromo");c&&Object.size(c)&&(this._$scope.purchaseCardPromo={todayDate:b().format("MM/DD/YYYY"),image:c.image,items:c.items,link:c.link,linkText:c.linkText,onClick:this.onClick.bind(this)})}.bind(this))};return d.prototype.onClick=function(){this._pubSubService.publish("adobeAnalytics.alaskaCardPromo",[{pageName:"booking funnel:checkout: AS Bank Card Link FCF"}]);var a=$('<form method="post" target="_blank" />').attr("action",this.applyData.action).appendTo(document.body);$('<input type="hidden" name="requestpayload" id="requestpayload" />').val(this.applyData.requestpayload).appendTo(a),$('<input type="hidden" name="requesthashvalue" id="requesthashvalue" />').val(this.applyData.requesthashvalue).appendTo(a),a.submit(),a.remove()},d.$inject=["$scope","cms","travelerService","elevateService","utilsService","pubSubService"],c}),c("purchase/directives/purchase-travelguard",[],function(){"use strict";var a=function(){return{restrict:"A",controller:b,templateUrl:"/app/purchase/directives/purchase-travelguard.tpl.html"}},b=function(a,b,c,d,e){this._$scope=a,this._$modal=b,this._purchaseService=c,this._fareService=d,this._$window=e,a.travelguard={isInternational:this._fareService.getIsInternational(),insuranceValue:!1,current:null,openLearnMoreModal:this.openLearnMoreModal.bind(this),setCurrent:this.setCurrent.bind(this),hasBeenClicked:this.hasBeenClicked.bind(this)},a.travelguard.isInternational?a.travelguard.insuranceLink="https://webservices.travelguard.com/Product/FileRetrieval.aspx?CountryCode=US&StateCode=NW&ProductCode=101126&PlanCode=P1&FileType=PROD_PLAN_DOC":a.travelguard.insuranceLink="https://webservices.travelguard.com/Product/FileRetrieval.aspx?CountryCode=US&StateCode=NW&ProductCode=008180&PlanCode=P1&FileType=PROD_PLAN_DOC",this._$scope.$watch(this._purchaseService.getTravelInsuranceAmount,function(a){this._$scope.travelguard.insuranceValue=a}.bind(this)),this._$scope.$watch(this._purchaseService.getTravelInsuranceAvailability,function(a){a?(void 0!==this._$scope.$$childTail.radio&&(this._$scope.$$childTail.radio.isValid=!1),this.setCurrent("")):(this._$scope.$$childTail.radio.validateValue("no"),this.setCurrent("no"))}.bind(this))};return b.prototype.setCurrent=function(a){this._$scope.travelguard.current=a,this._purchaseService.setTravelInsurance("yes"===a)},b.prototype.hasBeenClicked=function(a){this._$scope.travelguard.setCurrent(a)},b.prototype.openLearnMoreModal=function(){var a="http://www.travelguard.com/product-info/008180/";this._$scope.travelguard.isInternational&&(a="http://www.travelguard.com/product-info/101126/"),this._$window.open(a,"_blank")},b.$inject=["$scope","$modal","purchaseService","fareService","$window"],a}),c("purchase/directives/purchase-upgrade",["content/constants/content-bundle"],function(a){"use strict";var b=function(){return{restrict:"A",controller:c,templateUrl:"/app/purchase/directives/purchase-upgrade.tpl.html"}},c=function(a,b,c){this._$scope=a,this._$modal=b,this._purchaseService=c,a.upgrade={onSelect:this.onSelect.bind(this),openResponsibilitiesModal:this.openResponsibilitiesModal.bind(this)}};return c.prototype.onSelect=function(a){this._purchaseService.setOptIn(a)},c.prototype.openResponsibilitiesModal=function(){this._$modal.open(a.contentMap.RESPONSIBILITIES)},c.$inject=["$scope","$modal","purchaseService"],b}),c("purchase/controllers/purchase-details",["angular","common/models/payment-option-model","content/constants/content-bundle"],function(a,b,c){"use strict";var d=function(a,d,e,f,g,h,i,j,k,l,m,n,o,p){this._$scope=a,this._$modal=e,this._purchaseService=f,this._tripService=g,this._workflowService=h,this._statusService=i,this._windowService=j,this._pubSubService=k,this._resourceBundle=m,this._ancillariesService=n,this._locationService=o,this._loadingService=l,this._$singleTimeout=p,this._$scope.purchaseDetails=this._$scope.purchaseDetails||{},this._$scope.purchaseDetails.viewTight=!1,this._$scope.purchaseDetails.needsCVV=!this._$scope.purchase.visaCoCardInfo.callid,this._$scope.purchaseDetails.formFields={},this._$scope.purchaseDetails.totalCost=this._$scope.purchaseDetails.totalCost?this._$scope.purchaseDetails.totalCost:0,this.showCVVInfo=function(){var a=this._resourceBundle.modal.cvv;this._$modal.open({size:a.SIZE,type:a.TYPE,title:a.TITLE,templateUrl:a.TEMPLATE_URL})},this.showTaxesAndFeesModal=function(){this._$modal.open(c.contentMap.TAXES)},this.purchase=function(){if(this._purchaseService.hasDollarOrRefundAmounts()&&this._$scope.purchaseDetails.needsCVV&&this._$scope.purchaseDetails.formFields.cvv.value&&""!==this._$scope.purchaseDetails.formFields.cvv.value&&this._purchaseService.setCVV(this._$scope.purchaseDetails.formFields.cvv.value),this.purchaseCallSetup){var a=this.purchaseCallSetup;this[a.service][a.method](a.param)}var b="this"===this.purchaseCall.service?this[this.purchaseCall.method](this._purchaseService.data()):this[this.purchaseCall.service][this.purchaseCall.method](this._purchaseService.data());return b.then(this.onPurchaseResponse.bind(this),this.onPurchaseError.bind(this)),this._loadingService.setLoading(b),this._pubSubService.publish("adobeAnalytics.purchaseTicketsClick"),b},this.onPurchaseResponse=function(){this._windowService.setYtsVisible(!1),this._workflowService.transition("PURCHASE_STATE")},this.onPurchaseError=function(a){var b=this._statusService.message.PURCHASE_DECLINED;this._statusService.setStatus({format:this._statusService.format.ERROR,copy:b});var c=a.trappedError,d=c&&c.code;d&&(d.match(/(103114|113972)/)&&this._$scope.$emit("goBackToPurchaseSelectView"),d.match(/(110802|110803)/)&&this._pubSubService.publish("creditCard.invalidCVV"))},this._updateCVV=function(a){if(a){if(this._$scope.purchase.visaCoCardInfo.callid)return this._$scope.purchaseDetails.needsCVV=!1,void(this._$scope.purchaseDetails.formFields.cvv&&this._$scope.purchaseDetails.formFields.cvv.setVisibility(!1));var c=a.paymentOption,d=c&&void 0!==c&&(c.type!==b.TRAVELBANK.toUpperCase()||c.type!==b.VXPREMIUM.toUpperCase()||c.type!==b.VXBASE.toUpperCase())&&void 0===c.securityCode;this._$scope.purchase.purchaseModel.paymentOption&&"uatp"===this._$scope.purchase.purchaseModel.paymentOption.type&&(d=!1),
a.paymentOption&&"UATP"===a.paymentOption.type&&(d=!1),this._$scope.purchaseDetails.needsCVV=d,this._$singleTimeout(function(){var a=this._$scope.purchaseDetails.formFields.cvv;a&&(a.setVisibility(d),c&&(c.type.toLowerCase()===b.AMEX.toLowerCase()?(a.setMaxLength(4),a.setValidationRules("required,securityFourDigit")):(a.setMaxLength(3),a.setValidationRules("required,securityThreeDigit"))))}.bind(this))}},this._$scope.purchaseDetails.showCVVInfo=this.showCVVInfo.bind(this),this._$scope.purchaseDetails.showTaxesAndFeesModal=this.showTaxesAndFeesModal.bind(this),this._$scope.purchaseDetails.purchase=this.purchase.bind(this),this._$scope.purchaseDetails.ancillarySummaryList=[],this._locationService.contextIs(this._locationService.contexts.CHECKIN)||(this._$scope.purchaseDetails.ancillarySummaryList=this._ancillariesService.getAncillarySummaryList(),this._$scope.purchaseDetails.refundedAncillarySummaryList=this._ancillariesService.getRefundedAncillarySummaryList(),this._pubSubService.publish("adobeAnalytics.ancillarySummary",[this._$scope.purchaseDetails.ancillarySummaryList]))};return d.$inject=["$scope","$filter","$modal","purchaseService","tripService","workflowService","statusService","windowService","pubSubService","loadingService","ResourceBundle","ancillariesService","locationService","$singleTimeout"],d}),c("purchase/directives/book/purchase-details",["angular","purchase/controllers/purchase-details"],function(a,b){"use strict";var c=function(){return{restrict:"A",controller:d,templateUrl:"/app/purchase/directives/book/purchase-details.tpl.html",link:e}},d=function(c,d,e,f,g,h,i,j,k,l,m,n,o,p){this._$scope=c,this._$modal=f,this._purchaseService=g,this._tripService=h,this._workflowService=i,this._statusService=j,this._elevateService=k,this._travelerService=o,this._fareService=l,this._resourceBundle=p;var q=!0,r=l.getSelectedFares();for(var s in l.getSelectedFares())if("mcs"!==r[s].tier&&"mcsRefundable"!==r[s].tier&&r[s].tier.indexOf("first")===-1){q=!1;break}this.purchaseCallSetup=null,this.purchaseCall={service:"_purchaseService",method:"purchase"},this._isPaymentPoints=!1,this._$scope.purchaseDetails={isPaymentPoints:this._isPaymentPoints,baseCost:0,totalTaxes:0,travelBankAmount:0,showTravelguard:!1,showOptIn:!1,openFareRulesModal:this.openFareRulesModal.bind(this),contractofCarriagePdf:this.contractofCarriagePdf.bind(this)},d.invoke(b,this,{$scope:c,$injector:d,$filter:e,$modal:f,purchaseService:g,tripService:h,workflowService:i,statusService:j,windowService:m,resourceBundle:p});var t=this;this._$scope.$watch(this._purchaseService.getFares,this._updateFares.bind(this),!0),this._$scope.$watch(this._purchaseService.getCurrency,this._updateCurrency.bind(this),!0),this._$scope.$watch(this._purchaseService.data,this._updateCVV.bind(this),!0),this._$scope.$watch(this._purchaseService.getTravelInsuranceAvailability,this._updateInsurance.bind(this),!0),this._$scope.$watch(this._purchaseService.getAppliedTravelBank,function(a){t._updateTravelBank(a),t._updateFares()},!0),this._$scope.$watch(this._purchaseService.getTotalTaxes,this._updateFares.bind(this),!0),this._ccStateIsMontana=!1,this._$scope.$watch(function(){return this._purchaseService.data().paymentOption}.bind(this),function(a){this._ccStateIsMontana=!(!a||!a.address)&&"MT"===a.address.state,this._updateInsurance(this._purchaseService.getTravelInsuranceAvailability())}.bind(this)),this._$scope.$watch(this._travelerService.getAllTravelers,function(b){if(!q){var c=[];a.forEach(b,function(a){c.push(a.serialize("frequentFlyer"))}),this._elevateService.MCSOptInEligibility(c).then(function(){this._$scope.purchaseDetails.showOptIn=!0}.bind(this),function(){this._$scope.purchaseDetails.showOptIn=!1}.bind(this))}}.bind(this)),this._$scope.$watch(this._purchaseService.getTravelInsurance,function(a,b){if(a!==b){var c=this._purchaseService.getPaymentView(),d=this._purchaseService.getAppliedTravelBank();if(d&&!(d&&c.paymentOption&&"TRAVELBANK"!==c.paymentOption.type.toUpperCase()&&this._purchaseService.getRemainingValue())){if(a){var e={format:this._statusService.format.GUIDER,copy:this._statusService.message.PURCHASE_INSURANCE,sticky:!0,backdrop:{append:!0,callback:"destroyCallback"},controls:{dismiss:"Got It"},dismissCallBack:function(){c.paymentOption=null,this._$scope.purchase.changePaymentView("select")}.bind(this)};this._statusService.setAlert(e)}else c.paymentOption=null;this._updateFares()}}}.bind(this))};d.$inject=["$scope","$injector","$filter","$modal","purchaseService","tripService","workflowService","statusService","elevateService","fareService","windowService","seatService","travelerService","ResourceBundle"],d.prototype._updateFares=function(){var a=this._$scope.purchaseDetails,b=this._purchaseService.data();this._isPaymentPoints?a.totalCost=b.totalPoints:(a.baseCost=b.baseDollars,a.totalCost=b.totalDollars,a.totalUpgradeCosts=b.totalUpgradeCosts,a.totalPetsCosts=b.petcTax,a.petsAmount=b.paidPets),a.totalFares=this._tripService.getPayingTravelerAmount(),a.totalExtras=b.totalExtras,a.totalTaxes=b.totalTaxes,a.remainingValue=this._purchaseService.getRemainingValue(a.activeCurrency)},d.prototype._updateCurrency=function(a){this._activeCurrency=this._$scope.purchaseDetails.activeCurrency=a,this._isPaymentPoints=this._$scope.purchaseDetails.isPaymentPoints="DOLLAR"!==a,this._updateFares()},d.prototype._updateInsurance=function(a){this._$scope.purchaseDetails.showTravelguard=a&&!this._ccStateIsMontana,this._$scope.$$childTail.formHandler&&this._$scope.$$childTail.formHandler.fields.travelguard&&this._$scope.$$childTail.formHandler.fields.travelguard.setVisibility(this._$scope.purchaseDetails.showTravelguard)},d.prototype._updateTravelBank=function(a){var b=this._$scope.purchaseDetails,c=this._purchaseService.getActualTravelBankAmount(this._$scope.purchaseDetails.activeCurrency);a?b.travelBankAmount=c:b.travelBankAmount=0},d.prototype.openFareRulesModal=function(){this._purchaseService.loadDynamicFareRules().then(function(a){var b=this._resourceBundle.modal.dynamicFareRules,c=this._$scope.$new();c.rules=a.data.response,this._$modal.open({scope:c,size:b.SIZE,type:b.TYPE,title:b.TITLE,templateUrl:b.TEMPLATE_URL})}.bind(this))},d.prototype.contractofCarriagePdf=function(){return this._tripService.getIsInternational()?"/cms/intl-contract-of-carriage":"/cms/contract-of-carriage"};var e=function(a,b,c,d){c.viewTight&&(d._$scope.purchaseDetails.viewTight=c.viewTight)};return c}),c("purchase/directives/check-in/purchase-details",["angular","purchase/controllers/purchase-details"],function(a,b){"use strict";var c=function(){return{restrict:"A",controller:d,templateUrl:"/app/purchase/directives/check-in/purchase-details.tpl.html",link:e}},d=function(a,c,d,e,f,g,h,i,j,k,l,m,n){this._$scope=a,this._$modal=e,this._$q=f,this._purchaseService=g,this._pnrService=h,this._checkInService=i,this._tripService=j,this._workflowService=k,this._statusService=l,this._fareService=m,this._resourceBundle=n,this.purchaseCallSetup={service:"_pnrService",method:"setPNRType",param:"checkin"},this.purchaseCall={service:"this",method:"doCompleteCheckIn"},this._$scope.purchaseDetails={upgradeItems:i.getUpgradeItemsForPayment(),totalTravellers:i.getTravelers().length,totalCost:i.extraPaymentAmount(),openFareRulesModal:this.openFareRulesModal.bind(this),contractofCarriagePdf:this.contractofCarriagePdf.bind(this)},c.invoke(b,this,{$scope:a,$injector:c,$filter:d,$modal:e,purchaseService:g,tripService:j,workflowService:k,statusService:l,resourceBundle:n}),this._$scope.travelBankAmount=0,this._$scope.$watch(this._purchaseService.data,this._updateCVV.bind(this),!0),this._$scope.$watch(this._purchaseService.getAppliedTravelBank,this._updateTravelBank.bind(this),!0),this._$scope.$emit("goBackToPurchaseSelectView")};d.$inject=["$scope","$injector","$filter","$modal","$q","purchaseService","pnrService","checkInService","tripService","workflowService","statusService","fareService","ResourceBundle"],d.prototype.openFareRulesModal=function(){this._purchaseService.loadDynamicFareRules().then(function(a){var b=this._resourceBundle.modal.dynamicFareRules,c=this._$scope.$new();c.rules=a.data.response,this._$modal.open({scope:c,size:b.SIZE,type:b.TYPE,title:b.TITLE,templateUrl:b.TEMPLATE_URL})}.bind(this))},d.prototype._updateTravelBank=function(a){var b=this._$scope.purchaseDetails,c=this._purchaseService.getActualTravelBankAmount(b.activeCurrency);a?b.travelBankAmount=c:b.travelBankAmount=0},d.prototype.contractofCarriagePdf=function(){return this._pnrService.model()[0].international?"/cms/intl-contract-of-carriage":"/cms/contract-of-carriage"},d.prototype.doCompleteCheckIn=function(a){var b=this._$q.defer(),c=function(){b.resolve()},d=function(){b.reject()},e=this._checkInService.doCompleteCheckIn(a);return e.then(c,d),b.promise};var e=function(a,b,c,d){c.viewTight&&(d._$scope.purchaseDetails.viewTight=c.viewTight)};return c}),c("purchase/directives/change/purchase-details",["angular","purchase/controllers/purchase-details"],function(a,b){"use strict";var c=function(){return{restrict:"A",controller:d,templateUrl:"/app/purchase/directives/change/purchase-details.tpl.html",link:e}},d=function(a,c,d,e,f,g,h,i,j,k,l,m,n){this._$scope=a,this._$modal=e,this._purchaseService=f,this._tripService=g,this._workflowService=h,this._statusService=i,this._elevateService=j,this._resourceBundle=k,this._changeService=l,this._pnrService=m,this.purchaseCallSetup={service:"_pnrService",method:"setPNRType",param:"change"},this.purchaseCall={service:"this",method:"changeComplete"},this._$scope.purchaseDetails={isPaymentPoints:!1,baseCost:0,totalTaxes:0,isInsuranceSelected:!1,travelBankAmount:0,hasRefundDue:!1,typeOfChange:"NEW",openFareRulesModal:this.openFareRulesModal.bind(this),contractofCarriagePdf:this.contractofCarriagePdf.bind(this)},c.invoke(b,this,{$scope:a,$injector:c,$filter:d,$modal:e,purchaseService:f,tripService:g,workflowService:h,statusService:i,windowService:n,resourceBundle:k}),this._$scope.$watch(this._purchaseService.getFares,this._updateFares.bind(this),!0),this._$scope.$watch(this._purchaseService.getTotalTaxes,this._updateFares.bind(this),!0),this._$scope.$watch(this._purchaseService.getCurrency,this._updateCurrency.bind(this),!0),this._$scope.$watch(this._purchaseService.data,this._updateCVV.bind(this),!0),this._$scope.$watch(this._purchaseService.getTravelInsurance,this._updateInsurance.bind(this),!0),this._$scope.$watch(this._purchaseService.getAppliedTravelBank,function(a){this._updateTravelBank(a),this._updateFares()}.bind(this),!0),this._$scope.$emit("goBackToPurchaseSelectView")};d.$inject=["$scope","$injector","$filter","$modal","purchaseService","tripService","workflowService","statusService","elevateService","ResourceBundle","changeService","pnrService","windowService"],d.prototype._updateTravelBank=function(a){var b=this._$scope.purchaseDetails,c=this._purchaseService.getActualTravelBankAmount(this._$scope.purchaseDetails.activeCurrency);b.travelBankAmount=a?c:0},d.prototype._updateFares=function(){var a=this._$scope.purchaseDetails,b=this._purchaseService.data(),c=this._changeService.getQuoteModel();a.baseCost=b.baseDollars,a.totalFares=b.totalFares,a.totalTaxes=b.totalTaxes,a.originalFare=this._changeService.getPnrModel().fareInfo.totalCost,a.changeFee=b.changeFee?b.changeFee:0,a.typeOfChange=this._changeService.isNewOrExisting(),a.remainingValue=this._changeService.isChangeType(this._changeService.CHANGE_TYPES.NEW)?c.paymentAmount:c.totalAmount,a.paymentAmount=c.paymentAmount,a.refundAmount=Math.abs(c.refundAmount),a.hasRefundDue=!!c.refundAmount,a.remainingValue-=a.travelBankAmount},d.prototype._updateCurrency=function(a){this._activeCurrency=this._$scope.purchaseDetails.activeCurrency=a,this._updateFares()},d.prototype._updateInsurance=function(a){this._$scope.purchaseDetails.isInsuranceSelected=void 0!==a},d.prototype.openFareRulesModal=function(){this._purchaseService.loadDynamicFareRules().then(function(a){var b=this._resourceBundle.modal.dynamicFareRules,c=this._$scope.$new();c.rules=a.data.response,this._$modal.open({scope:c,size:b.SIZE,type:b.TYPE,title:b.TITLE,templateUrl:b.TEMPLATE_URL})}.bind(this))},d.prototype.contractofCarriagePdf=function(){return this._changeService.getIsInternational()?"/cms/intl-contract-of-carriage":"/cms/contract-of-carriage"},d.prototype.changeComplete=function(a){var b=this._changeService.getQuoteModel(),c=this._purchaseService.buildPaymentInfoRequest(a.paymentOption);return"EXISTING"===b.typeOfChange?this._changeService.manageComplete(c):this._changeService.complete(c)};var e=function(a,b,c,d){c.viewTight&&(d._$scope.purchaseDetails.viewTight=c.viewTight)};return c}),c("purchase/directives/cancel/purchase-details",["angular","purchase/controllers/purchase-details"],function(a,b){"use strict";var c=function(){return{restrict:"A",controller:d,templateUrl:"/app/purchase/directives/cancel/purchase-details.tpl.html",link:e}},d=function(a,c,d,e,f,g,h,i,j,k,l,m,n,o){this._$scope=a,this._$modal=e,this._purchaseService=f,this._tripService=g,this._workflowService=h,this._statusService=i,this._elevateService=j,this._fareService=k,this._resourceBundle=l,this._cancelService=m,this._pnrService=n,this.purchaseCall={service:"this",method:"_cancelComplete"},this._$scope.purchaseDetails={isPaymentPoints:!1,taxList:[],baseCost:0,totalTaxes:0,isInsuranceSelected:!1,travelBankAmount:0,hasRefundDue:!1,openFareRulesModal:this.openFareRulesModal.bind(this),contractofCarriagePdf:this.contractofCarriagePdf.bind(this)},c.invoke(b,this,{$scope:a,$injector:c,$filter:d,$modal:e,purchaseService:f,tripService:g,workflowService:h,statusService:i,windowService:o,resourceBundle:l}),this._$scope.$watch(this._purchaseService.data,this._updateFares.bind(this),!0),this._$scope.$watch(this._purchaseService.data,this._updateCVV.bind(this),!0)};d.$inject=["$scope","$injector","$filter","$modal","purchaseService","tripService","workflowService","statusService","elevateService","fareService","ResourceBundle","cancelService","pnrService","windowService"],d.prototype._updateFares=function(){var a=this._$scope.purchaseDetails,b=this._purchaseService.data();a.baseCost=b.baseDollars,a.totalFares=b.totalFares,a.cancelFee=b.cancelFee,a.totalFare=b.totalFare,a.mceTotalFares=b.mceTotalFares,a.mceUpgradeValue=b.mceUpgradeValue,a.pointsAmount=b.pointsAmount,a.refundAmount=b.refundAmount},d.prototype.openFareRulesModal=function(){this._purchaseService.loadDynamicFareRules().then(function(a){var b=this._resourceBundle.modal.dynamicFareRules,c=this._$scope.$new();c.rules=a.data.response,this._$modal.open({scope:c,size:b.SIZE,type:b.TYPE,title:b.TITLE,templateUrl:b.TEMPLATE_URL})}.bind(this))},d.prototype.contractofCarriagePdf=function(){return this._cancelService.getPnrModel().international?"/cms/intl-contract-of-carriage":"/cms/contract-of-carriage"},d.prototype._cancelComplete=function(a){var b=this._purchaseService.buildPaymentInfoRequest(a.paymentOption);return this._cancelService.cancelFlight(b)};var e=function(a,b,c,d){c.viewTight&&(d._$scope.purchaseDetails.viewTight=c.viewTight)};return c}),c("purchase/vx-purchase-app",["angular","purchase/controllers/purchase","purchase/controllers/purchase-credit-card","purchase/controllers/purchase-travel-bank","purchase/directives/purchase-card-promo","purchase/directives/purchase-travelguard","purchase/directives/purchase-upgrade","purchase/directives/book/purchase-details","purchase/directives/check-in/purchase-details","purchase/directives/change/purchase-details","purchase/directives/cancel/purchase-details"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";return a.module("vxPurchaseApp",[]).controller("PurchaseCtrl",b).controller("PurchaseCreditCardCtrl",c).controller("PurchaseTravelBankCtrl",d).directive("vxPurchaseCardPromo",e).directive("vxPurchaseTravelguard",f).directive("vxPurchaseUpgrade",g).directive("vxBookPurchaseDetails",h).directive("vxCheckInPurchaseDetails",i).directive("vxChangePurchaseDetails",j).directive("vxCancelPurchaseDetails",k)}),c("success/controllers/success",["angular"],function(a){"use strict";var b=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){this._$rootScope=a,this._$scope=b,this._$window=c,this._$detection=d,this._resourceBundle=e,this._scrollService=f,this._windowService=g,this._pnrService=h,this._locationService=i,this._pubSubService=j,this._statusService=k,this._manageService=l,this._cancelService=m,this._elevateService=n,this._envService=o,this._fareService=p,this._seatService=q,this._tripService=r,this._purchaseService=s,this._travelerService=t,this._adobeAnalyticsService=u,this._checkInService=v,this._changeService=w,this._api=x,this._resourceBundle=e,this._accessibleService=y,this._utilsService=z,this._elevateService.setModelDirty(),this._$scope.success={cancelData:{},context:this._locationService.getContext(),flyWithUs:this.flyWithUs.bind(this),isPaxCheckedIn:this.isPaxCheckedIn.bind(this),getPrintReceiptUrl:this.getPrintReceiptUrl.bind(this),goToCheckIn:this.goToCheckIn.bind(this),goToChangeSeats:this.goToChangeSeats.bind(this),resendEmail:this.resendEmail.bind(this),openBoardingPass:this.openBoardingPass.bind(this),openPassbook:this.openPassbook.bind(this),getLoungePassUrl:this.getLoungePassUrl.bind(this),showPassbook:this.showPassbook.bind(this),passbookMode:this.passbookMode.bind(this),userRecognized:n.getUserData(),isUserLoggedIn:n.isLoggedIn(),hasChanged:this._changeService.isNewOrExisting(),segmentArray:["First Leg:","Second Leg:","Third Leg:","Fourth Leg:"]},"cancel"===this._$scope.success.context?(this._$scope.success.cancelData=m.getSuccessPageData(),this._pnr=this._cancelService.getPnrModel()):this._pnr=this._pnrService.model()[0],"check-in"===this._$scope.success.context&&(this._statusService.setStatus([]),this._checkInService.getTripList()&&(this._pnr=this._checkInService.getTripList())),this._pnrService.setModel(this._pnr);try{this._pnrService.getFlights(null,!0).then(function(a){if(this._pnr.flightList=a,"check-in"===this._$scope.success.context){var b=this._checkInService.getFlightList();a.forEach(function(a){a.origin===b.origin&&a.departureDateTime===b.departureDateTime&&(this._$scope.success.showLoungeOptions=a.hasLoungePass)},this)}this._$scope.success.pnr=this._pnrService.getMorePnrInfo(this._pnr),this._accessibleService.setMostCurrentFocus()}.bind(this))}catch(a){i.resetApp()}if(void 0===this._pnr&&i.resetApp(),this._windowService.setHeaderVisible(!0),this._windowService.setAdvisoryHidden(!0),this._$scope.success.paxList=this._pnr.paxList,this._$scope.success.flightList=this._checkInService.getFlightList(),this._$scope.$watch(this._windowService.breakpoint,this.onBreakpointChange.bind(this)),"cancel"===b.success.context&&!n.isLoggedIn()&&h.setPNRFound(!1),"cancel"!==b.success.context&&this._pnr.canJoinAlaskaMileagePlan()){var A={book:"VX_booking funnel:payment confirmed:MP Join","check-in":"VX_manage:check-in:completed:MP Join",change:"VX_manage:change:completed:MP Join"}[this._$scope.success.context];this._pubSubService.publish("core.openModal",["openAlaskaMileagePlan",this._pnr,{linkCid:A}])}this._$scope.$on("$destroy",function(){this._fareService.reset(),this._seatService.resetService(),this._tripService.reset(),this._purchaseService.reset(),this._travelerService.reset(),this._windowService.setAdvisoryHidden(!1),this._windowService.setHeaderFixed(!1),this._$rootScope.$broadcast("ytsAlt",{isAlt:!1})}.bind(this))};return b.$inject=["$rootScope","$scope","$window","$detection","ResourceBundle","scrollService","windowService","pnrService","locationService","pubSubService","statusService","manageService","cancelService","elevateService","envService","fareService","seatService","tripService","purchaseService","travelerService","adobeAnalyticsService","checkInService","changeService","api","accessibleService","utilsService"],b.prototype.showPassbook=function(){return this._$detection.isiPhone()||this._$detection.isAndroid()},b.prototype.passbookMode=function(){return this.showPassbook()?1===this._$scope.success.paxList.length&&1===this._$scope.success.flightList.segments.length?"single":"list":null},b.prototype.onBreakpointChange=function(b){a.extend(this._$scope.success,{bpSmall:"small"===b,breakpoint:b})},b.prototype.isPaxCheckedIn=function(a){for(var b=this._pnr.flightList[0].paxCheckInInfo,c=0;c<b.length;c++)if(b[c].guestId===a&&"CHECKED_IN"===b[c].status)return!0;return!1},b.prototype.flyWithUs=function(){this._scrollService.go("promotions-accordion")},b.prototype.resendEmail=function(a){this._manageService.setLastName(this._pnr.paxList[0].lastName),this._manageService.setPnr(this._pnr.pnr),this._pubSubService.publish("core.openModal",["openWrongEmailModal",{email:a}])},b.prototype.openBoardingPass=function(){var a=this._$scope.success.pnr,b=this._checkInService.getFlightList();this._adobeAnalyticsService.UIEvent(this._adobeAnalyticsService.EVENTS.BOARDING_PASS,{accessType:"PRINT_URL"}),this._$window.open(a.getBoardingPassUrl(this._envService,b),"_blank")},b.prototype.getLoungePassUrl=function(){var a=this._$scope.success.pnr,b=this._checkInService.getFlightList(),c={evt:this._envService.context("api").resourceURL,flightId:b.flightId,flightNum:b.flightNum,firstName:a.paxList[0].firstName,lastName:a.paxList[0].lastName,guestId:a.paxList[0].guestId,pnr:a.pnr};return c.evt+"/v2/checkin/loungepass-all?flightId="+c.flightId+"&flightNum="+c.flightNum+"&lastName="+c.lastName+"&guestId="+c.guestId+"&firstName="+c.firstName+"&pnr="+c.pnr},b.prototype.openPassbook=function(a,b){this._adobeAnalyticsService.UIEvent(this._adobeAnalyticsService.EVENTS.BOARDING_PASS,{accessType:"PASSBOOK"}),this._$window.open(this._getPassbookUrl(a,b),"_self")},b.prototype._getPassbookUrl=function(a,b){var c=this._$scope.success.pnr,d=this._checkInService.getFlightList(),e={evt:this._envService.context("api").resourceURL,flightId:d.segments[b].flightId,flightNum:d.segments[b].flightNum,firstName:c.paxList[a].firstName,lastName:c.paxList[a].lastName,guestId:c.paxList[a].guestId,pnr:c.pnr};return e.evt+"/v2/checkin/passbookpass?flightId="+e.flightId+"&flightNum="+e.flightNum+"&lastName="+e.lastName+"&guestId="+e.guestId+"&firstName="+e.firstName+"&pnr="+e.pnr},b.prototype.getPrintReceiptUrl=function(){var a=this._$scope.success.pnr,b="";a.contact&&(b=a.contact.email);var c={evt:this._envService.context("api").resourceURL,email:b,lastName:a.paxList[0].lastName,pnr:a.pnr};return c.evt+"/v2/manage/print-changed-itinerary?pnr="+c.pnr+"&emailAddress="+c.email+"&includeBillingInfo=true&lastName="+c.lastName},b.prototype.goToCheckIn=function(a){if(a){var b="/flight-check-in/"+this._pnr.pnr+"/"+this._pnr.paxList[0].lastName;this._locationService.go({target:b})}},b.prototype.goToChangeSeats=function(){this._changeService.setPnrModel(this._$scope.success.pnr),this._changeService.setChangeType(this._changeService.CHANGE_TYPES.EXISTING,this._changeService.EXISTING_CHANGE_TYPES.SEATS),this._locationService.setContext(this._locationService.contexts.CHANGE),this._locationService.go({target:"/change/seats"})},b}),c("success/controllers/promotions",[],function(){"use strict";var a=function(a,b){this._$scope=a,b.flightInfo.get(function(b){a.promotions={flyingWithUs:b.flyingWithUs,onboardEntertainment:b.entertainment,foodAndDrink:b.foodDrinks}})};return a.$inject=["$scope","cms"],a}),c("success/controllers/entertainment",["angular"],function(a){"use strict";var b=function(a){this._$scope=a,this._$scope.entertainment={category:0,changeCategory:this.changeCategory.bind(this),items:[],template:"standard"},this.changeCategory(0)};return b.$inject=["$scope"],b.prototype.changeCategory=function(b){this._$scope.entertainment.category=b;var c=this._$scope.accordion.content;if(c)for(var d=0;d<c.length;d++)c[d].id===b&&a.extend(this._$scope.entertainment,{items:c[d].items,template:c[d].template})},b}),c("success/controllers/food-and-drink",["angular"],function(a){"use strict";var b=function(a){this._$scope=a,this._$scope.food={allFlights:[],longHaul:[],category:0,changeCategory:this.changeCategory.bind(this),template:"standard"},this.changeCategory(0)};return b.$inject=["$scope"],b.prototype.changeCategory=function(b){var c=this._$scope.accordion.content,d=[],e=[];this._$scope.food.category=b;for(var f=0;f<c.length;f++)if(c[f].id===b){for(var g=0;g<c[f].items.length;g++)c[f].items[g].availableOnLongerThan2H?d.push(c[f].items[g]):e.push(c[f].items[g]);a.extend(this._$scope.food,{allFlights:d,longHaul:e,template:c[f].template})}},b}),c("success/controllers/modals/alaska-mileage-plan",[],function(){"use strict";var a=function(a,b,c,d){this._$scope=a,this._$modalInstance=b,this._$timeout=c,this._pubSubService=d,this._$scope.alaskaMileagePlan={openFrequentFlierModal:this.openFrequentFlierModal.bind(this)}};return a.prototype.openFrequentFlierModal=function(){this._pubSubService.publish("core.openModal",["openFrequentFlierModal",{traveler:this._$scope.pnr.paxList[0],pnr:this._$scope.pnr}]),this._$timeout(function(){this._$modalInstance.close()}.bind(this),500)},a.$inject=["$scope","$modalInstance","$timeout","pubSubService"],a}),c("success/vx-success-app",["angular","success/controllers/success","success/controllers/promotions","success/controllers/entertainment","success/controllers/food-and-drink","success/controllers/modals/alaska-mileage-plan"],function(a,b,c,d,e,f){"use strict";return a.module("vxSuccessApp",[]).controller("SuccessCtrl",b).controller("PromotionsCtrl",c).controller("EntertainmentCtrl",d).controller("FoodAndDrinkCtrl",e).controller("AlaskaMileagePlanModalCtrl",f)}),c("check-in/controllers/check-in",[],function(){"use strict";var a=function(a,b,c,d,e,f,g,h,i,j,k,l,m){this._$scope=a,this._checkInService=d,this._elevateService=b,this._pnrService=c,this._windowService=e,this._$location=f,this._locationService=g,this._checkInService=d,this._loadingService=i,this._statusService=j,this._$scope.checkin={setView:this.setView.bind(this)},this._$scope.FAQ=l.siteMap.FAQ,this._$scope.checkin.view=this._checkInService.viewConstants.LOGIN,e.setNinjaMode(!0),a.$on("$destroy",function(){e.setNinjaMode(!1)}),this._windowService.setHeaderVisible(!0),this._windowService.setChromeHidden(!1),this._statusService.setChangeGuider([]),this._windowService.setChangeFlow(!1),this._$scope.$watch(d.getView,function(b){a.checkin.setView(b),"LOGIN"!==b&&e.setAdvisoryHidden(!0),h.go("top",{duration:0})}.bind(this));var n=this._$location.url().indexOf("add-passport-info")!==-1||this._$location.url().indexOf("upgrade-options")!==-1||this._$location.url().indexOf("lounge-options")!==-1||this._$location.url().indexOf("seats/")!==-1||this._$location.url().indexOf("extras")!==-1||this._$location.url().indexOf("bags")!==-1;if(!n||!c.getPNRFound()){var o=c.getPNRFound();if(!b.isLoggedIn()||o)if(o){var p=c.model(),q=p[0].lastName,r=p[0].pnr,s=c.findPNR("",q,r);s.then(function(){var a=this._isFlightCancelled();a||(g.update(d.urlConstants.FLIGHTS),d.setView(d.viewConstants.FLIGHTS))}.bind(this))}else this._$scope.$watch(c.getPNRFound,function(a,b){if(a!==b&&a){var c=this._isFlightCancelled();c||(g.update(d.urlConstants.FLIGHTS),d.setView(d.viewConstants.FLIGHTS))}}.bind(this));else m(this._elevateStateHandler.bind(this));this._$scope.$watch(b.isLoggedIn,function(a,b){a&&a!==b&&this._elevateStateHandler()}.bind(this))}};return a.prototype._elevateStateHandler=function(){this._pnrService.reset(),this._locationService.update(this._checkInService.urlConstants.FLIGHTS),this._checkInService.setView(this._checkInService.viewConstants.FLIGHTS);var a=this._elevateService.retrieveAccountInfo({context:"checkin"});this._loadingService.setLoading(a),a.then(function(){var a=this._elevateService.getAccountInfo().checkinPNRList;a&&this._pnrService.setModel(a)}.bind(this))},a.prototype._isFlightCancelled=function(){var a=this._pnrService.model();if(a&&1===a.length&&a[0]&&a[0].irop&&"CANCELLED"===a[0].iropType){var b={format:this._statusService.format.ALERT,copy:this._statusService.message.IROP_FLIGHT_CANCELLED,recoverable:!0,controls:{close:!1,dismiss:"manage flights"},dismissCallBack:function(){this._$location.path("/manage-itinerary")}.bind(this)};return this._statusService.setAlert(b),!0}return!1},a.$inject=["$scope","elevateService","pnrService","checkInService","windowService","$location","locationService","scrollService","loadingService","statusService","pubSubService","SiteMapBundle","$timeout"],a.prototype.setView=function(a){this._$scope.checkin.view=a,"LOGIN"===a||"FLIGHTS"===a?this._windowService.setHeaderVisible(!0):this._windowService.setHeaderVisible(!1)},a}),c("check-in/controllers/choose-flight",["angular","moment","jquery"],function(a,b,c){"use strict";var d=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=this;this._$window=a,this._$scope=b,this._pnrService=d,this._checkInService=e,this._travelerService=f,this._locationService=g,this._loadingService=h,this._pubSubService=i,this._utilsService=k,this._statusService=l,this._$scope.storedPartner={},this._$scope.comboPartners=d.getFFPrograms(),this._flightTravelers=[],this._flightInfants=[],this._envService=n,this._$scope.flights={trips:[],flightTravelers:[],updateTravelers:this.updateTravelers.bind(this),openFrequentFlierModal:this.openFrequentFlierModal.bind(this)},this._statusService.setStatus([]),this._$scope.$watchCollection(function(){return d.model()},function(a){if(a.length){for(var b in a)a[b].flightList=o._pnrService.getFlights(b,!1);o.setData(a)}}),g.getContext()===g.contexts.CHECKIN&&(j.setNinjaMode(!0),j.setHeaderFixed(!0)),b.checkInIsDisabled=function(a){return o.checkInIsDisabled(a)},b.formatTime=function(a){return o.formatTime(a)},b.formatDate=function(a){return o.formatDate(a)},b.checkIn=function(a,b){return o.checkIn(a,b)},b.expressCheckIn=function(a,b){return o.expressCheckIn(a,b)},b.isCutoff=function(a){return o.isCutoff(a)},b.isOutsideEligibilityWindow=function(a){return o.isOutsideEligibilityWindow(a)},b.isFlightEligible=function(a){return o.isFlightEligible(a)},b.isPartnerOperated=function(a){return o.isPartnerOperated(a)},b.isCheckedIn=function(a){return o.isCheckedIn(a)},b.getBoardingPass=function(a,b){return o.getBoardingPass(a,b)},b.dateDifference=function(a){return o.dateDifference(a)}};return d.$inject=["$window","$scope","flightsService","pnrService","checkInService","travelerService","locationService","loadingService","pubSubService","windowService","utilsService","statusService","ResourceBundle","envService"],d.prototype.dateDifference=function(a){var c=b(),d=b(a.segments[0].departureDateTime),e=(d-c)/864e5;return Math.ceil(e)},d.prototype.isCutoff=function(a){return"NOT_ELIGIBLE_CUTOFF"===a.checkInEligibility},d.prototype.isOutsideEligibilityWindow=function(a){return"NOT_ELIGIBLE_NOT_OPEN"===a.checkInEligibility},d.prototype.isFlightEligible=function(a){return"ELIGIBLE"===a.checkInEligibility},d.prototype.isPartnerOperated=function(a){return"NOT_ELIGIBLE_FIRST_SEG_PARTNER_AIRLINE"===a.checkInEligibility},d.prototype.isCheckedIn=function(a){if(!this._$scope.flights.flightTravelers||!this._$scope.flights.flightTravelers[a.flightNum])return!1;var b=this._$scope.flights.flightTravelers[a.flightNum],c=b.length>0,d=[];for(var e in b){var f=b[e];if(f.checkedIn&&!a.passengersToCheckIn)return!0;c=c&&f.checkedIn,f.checkIn&&d.push(f)}if(d.length>0){var g=!1;for(var h in this._flightTravelers[a.flightNum]){var i=this._flightTravelers[a.flightNum][h];for(var j in d){var k=d[j];k.guestId===i.guestId&&(g=!0)}}if(g===!1)return!0}return c},d.prototype.checkInIsDisabled=function(a){return"undefined"==typeof this._flightTravelers[a.flightNum]||0===this._flightTravelers[a.flightNum].length},d.prototype.formatDate=function(a){var c=b(a,"YYYY-MM-DD HH:mm Z"),d=c.zone(a);return d.format("ddd").toString()+", "+d.format("MM/DD/YY").toString()},d.prototype.formatTime=function(a){var c=b(a,"YYYY-MM-DD HH:mm Z"),d=c.zone(a);return d.format("h:mma").toString()},d.prototype._initializeAllTravelers=function(b,c,d){a.forEach(c,function(a){this._initTravelers(b,a,d)}.bind(this))},d.prototype.setData=function(b){
this._$scope.flights.trips=b;var c=this;a.forEach(this._$scope.flights.trips,function(b){a.forEach(b.paxList,function(a){"INFANT"===a.paxType&&c._flightInfants.push(a),a.fullName=a.firstName+" "+a.lastName,a.loyaltyProgramName=c._utilsService.getFFProgramName(a.loyaltyProgram,!0)}),a.forEach(b.paxList,function(a){"ADULT_WITH_INFANT"===a.paxType&&(a.infant=c._flightInfants[0],c._flightInfants.shift())});var d=b.pnr;a.forEach(b.flightList,function(a){this._flightTravelers[a.flightNum]?(a.flightNum=d+"_"+a.flightNum,this._flightTravelers[a.flightNum]):this._flightTravelers[a.flightNum],this._flightTravelers[a.flightNum]=[],this._$scope.flights.flightTravelers[a.flightNum]=[],a.passengersToCheckIn=!0,this._initializeAllTravelers(a.flightNum,b.paxList,a.paxCheckInInfo)}.bind(this))}.bind(this))},d.prototype.getBoardingPass=function(a,b){a.isDestinationFlag=this._pnrService.setDestinationFlag(a,b.origin,b.destination),this._checkInService.setFlightList(b),this._checkInService.setTripList(a),this._locationService.go({target:this._checkInService.urlConstants.SUCCESS})},d.prototype.checkIn=function(b,d){var e=[],f=this;this._checkInService.setCheckInType(this._checkInService.checkInType.COMPLETE_CHECKIN),this._checkInService.setFlightList(d);var g=[],h=!1;if(a.forEach(this._flightTravelers[d.flightNum],function(a){a.checkIn&&g.push(a)}.bind(this)),"undefined"!=typeof g&&g.length>0){this._travelerService.reset(),e=this._travelerService.createTravelersFromPaxList(g),a.forEach(e,function(a){(!a.hasOwnProperty("international")||""===a.international.passportNum)&&b.international&&(h=!0)}.bind(this));var i=this._checkInService.doCheckIn(b,d,e);this._loadingService.setLoading(i),i.then(function(){var a=h?f._checkInService.urlConstants.PASSPORT:f._checkInService.urlConstants.UPGRADE,b=h?f._checkInService.viewConstants.PASSPORT:f._checkInService.viewConstants.UPGRADE;f._locationService.update(a),f._checkInService.setView(b)})}else{var j=c(".choose-flight-box__check-in");j.addClass("is-disabled-animation"),setTimeout(function(){j.removeClass("is-disabled-animation")},350)}},d.prototype.passportInfoIsValid=function(a){var b=a.international,c=a.emergencyContactInfo;return b.citizenship&&b.dateOfBirth&&b.gender&&b.issuingCountry&&b.passportExpiry&&b.passportNumber&&c},d.prototype.expressCheckIn=function(b,c){var d=[],e=[];a.forEach(this._flightTravelers[c.flightNum],function(a){a.checkIn&&e.push(a)}.bind(this)),this._checkInService.setFlightList(c),this._checkInService.setCheckInType(this._checkInService.checkInType.EXPRESS_CHECKIN);var f=!1;if("undefined"!=typeof e&&e.length>0){if(d=this._travelerService.createTravelersFromPaxList(e),a.forEach(d,function(a){(!a.hasOwnProperty("international")||""===a.international.passportNum)&&b.international&&(f=!0)}.bind(this)),f){var g={trip:b,flightInfo:c,travelerModels:d};this._checkInService.setExpressCheckInData(g);var h=this._checkInService.urlConstants.PASSPORT,i=this._checkInService.viewConstants.PASSPORT;return this._locationService.update(h),void this._checkInService.setView(i)}var j=this._checkInService.doExpressCheckIn(b,c,d);this._loadingService.setLoading(j),j.then(function(){this._locationService.go({target:this._checkInService.urlConstants.SUCCESS})}.bind(this))}},d.prototype.updateTravelers=function(a,b){b.checkIn=!b.checkIn;var c=!1,d=this._$scope.flights.flightTravelers[a.flightNum];for(var e in d){var f=d[e];b.infant&&f.guestId===b.infant.guestId&&(f.checkIn=b.checkIn),f.checkIn&&"INFANT"!==f.paxType&&(c=!0)}a.passengersToCheckIn=c},d.prototype.openFrequentFlierModal=function(a,b){this._pubSubService.publish("core.openModal",["openFrequentFlierModal",{traveler:b,pnr:a}])},d.prototype._initTravelers=function(b,c,d){var e=a.copy(c),f=["CHECKED_IN","NON_REV_PRIORITY_LIST","OVERSOLD"];e.checkIn=!0;for(var g in d)d[g].guestId===e.guestId&&(e.checkedIn=f.indexOf(d[g].status)>=0,e.checkIn=!e.checkedIn);e.checkIn&&"INFANT"!==e.paxType&&this._flightTravelers[b].push(e),this._$scope.flights.flightTravelers[b].push(e)},d}),c("check-in/controllers/add-passport-info",["angular","moment"],function(a,b){"use strict";var c=function(a,c,d,e,f,g,h,i,j,k){this._$scope=a,this._checkInService=c,this._pnrService=d,this._locationService=e,this._statusService=f,this._loadingService=h,this._travelerService=k,this._optionalFieldsForInfantPassport=["emergencyName","emergencyPhone"],a.passportInfo={travelers:k.getAllTravelers(),countries:j.countries,currentTraveler:null,expiryDateStart:b(),expiryDateEnd:b().add("years",100),storeTravelerModel:this.storeTravelerModel.bind(this),currentTravelerIndex:0,travelerData:{}},this._initInfantDetails();var l=Object.keys(a.passportInfo.travelers)[0];a.passportInfo.currentTraveler=a.passportInfo.travelers[l],a.ResourceBundle=i,g.setNinjaMode(!0),this._status={format:this._statusService.format.GUIDER,copy:this._statusService.message.ADD_PASSPORT_INFO,controls:{},data:{balance:"$"+this._checkInService.extraPaymentAmount(),checkin:!0,name:a.passportInfo.currentTraveler.name.first},sticky:!0},this._statusService.setStatus(this._status),a.passportInfo.currentTraveler.hasOwnProperty("international")&&""!==this._$scope.passportInfo.currentTraveler.international.passportNum&&this.nextStep()};return c.$inject=["$scope","checkInService","pnrService","locationService","statusService","windowService","loadingService","ResourceBundle","GeoBundle","travelerService"],c.prototype._initInfantDetails=function(){a.forEach(this._$scope.passportInfo.travelers,function(a){"infant"===a.travelerType&&a.international&&delete a.international.emergencyContact}.bind(this))},c.prototype._resetFieldValidation=function(){var a,b,c=this._formHandler,d="infant"===this._$scope.passportInfo.currentTraveler.travelerType?"optional":"required";c&&c.fields&&(a=c.fields,this._optionalFieldsForInfantPassport.forEach(function(c){a[c]&&(b=a[c].validate&&a[c].validate.length>1,b?a[c].toggleRequiredValidation(d):a[c].setValidationRules(d,!0))}))},c.prototype.storeTravelerModel=function(a){this._formHandler=a;var b={paxPassportInfoList:[{paxDocUpdateInfo:{emergencyContactName:a.fields.emergencyName?a.fields.emergencyName.value.replace(/[^a-zA-Z\s]/g,"").trim():"",emergencyContactNumber:a.fields.emergencyPhone?a.fields.emergencyPhone.value.replace(/\D/g,""):"",guestId:this._$scope.passportInfo.currentTraveler.guestId,lastName:this._$scope.passportInfo.currentTraveler.name.last,firstName:this._$scope.passportInfo.currentTraveler.name.first},passportInfo:{docNumber:a.fields.passport.value,issueCountry:a.fields.issuingCountry.value.value,countryOfResidence:a.fields.countryOfResidence.value.value,expiryDate:a.fields.expirationDate.value,nationality:a.fields.citizenship.value.value,lastName:this._$scope.passportInfo.currentTraveler.name.last,firstName:this._$scope.passportInfo.currentTraveler.name.first}}]};a.clear();var c=this._checkInService.updatePassport(this._pnrService.model()[0],b);this._loadingService.setLoading(c),c.then(function(){this.nextStep()}.bind(this))},c.prototype.nextStep=function(){var a=Object.keys(this._$scope.passportInfo.travelers),b=a.length;if(this._$scope.passportInfo.currentTravelerIndex===b-1)this.goToNextStep();else{this._$scope.passportInfo.currentTravelerIndex++;var c=a[this._$scope.passportInfo.currentTravelerIndex];this._$scope.passportInfo.currentTraveler=this._$scope.passportInfo.travelers[c],this._$scope.passportInfo.currentTraveler.hasOwnProperty("international")&&""!==this._$scope.passportInfo.currentTraveler.international.passportNum&&this.nextStep(),this._$scope.passportInfo.travelerFields={},this._$scope.passportInfo.travelerData=this._$scope.passportInfo.currentTraveler.serialize("travelerInfo"),this._resetFieldValidation(),this._status={format:this._statusService.format.GUIDER,copy:this._statusService.message.ADD_PASSPORT_INFO,controls:{},data:{balance:"$"+this._checkInService.extraPaymentAmount(),checkin:!0,name:this._$scope.passportInfo.currentTraveler.name.first},sticky:!0},this._statusService.setStatus(this._status)}},c.prototype.goToNextStep=function(){var a=this._checkInService.getCheckInType();if(a===this._checkInService.checkInType.COMPLETE_CHECKIN){var b=this._checkInService.urlConstants.UPGRADE,c=this._checkInService.viewConstants.UPGRADE;this._locationService.update(b),this._checkInService.setView(c)}else{var d=this._checkInService.getExpressCheckInData(),e=this._checkInService.doExpressCheckIn(d.trip,d.flightInfo,d.travelerModels);this._loadingService.setLoading(e),e.then(function(){this._locationService.go({target:this._checkInService.urlConstants.SUCCESS})}.bind(this))}},c}),c("check-in/controllers/upgrade-options",["angular","jquery"],function(a,b){"use strict";var c=function(a,c,d,e,f,g,h,i,j,k,l){var m=this;this._$scope=a,this._$modal=c,this._$window=d,this._checkInService=e,this._locationService=f,this._statusService=g,this._travelerService=k,this._loadingService=l,a.upgradeOptions=[],a.numberOfLegs=0,a.currentLeg=0,a.ResourceBundle=i,this.FareInfoBundle=j,a.availableUpgradeOptions=0,this._checkInService.purgeUpgradeOptions(),this._checkInService.getUpgradeOptions()[0]||(this._locationService.isBackStepping(this._locationService.getPath(),this._locationService.getLastPath())?this._$window.history.go(-1):this.goToNextStep()),this._$scope.$watchCollection(e.getExtraOptions,function(c){b.isEmptyObject(c)||(a.numberOfLegs=e.getNumberOfLegs(),m.nextUpgradeStep())}),h.setNinjaMode(!0),a.selectUpgradeOption=function(a){return m.selectUpgradeOption(a)},a.openFareInfoModal=function(a){return m.openFareInfoModal(a)},a.continueLabel=function(){return this._$scope.availableUpgradeOptions?"No Thanks":"Continue"}.bind(this),a.continueText=function(){return this._$scope.availableUpgradeOptions?"Continue without upgrade":"Sorry, no upgrades available."}.bind(this),this._status={format:this._statusService.format.GUIDER,copy:this._statusService.message.UPGRADE_YOUR_SEAT,controls:{},data:{balance:"$"+this._checkInService.extraPaymentAmount(),checkin:!0},sticky:!0},this._statusService.setStatus(this._status),this._origCopy=this._status.copy.DESC};return c.$inject=["$scope","$modal","$window","checkInService","locationService","statusService","windowService","ResourceBundle","FareInfoBundle","travelerService","loadingService"],c.prototype.selectUpgradeOption=function(a){var b=this._$scope.currentLeg-1;null===a?this.nextUpgradeStep():a.available&&(this._checkInService.setCurrentTier(b,a.name),this._checkInService.setUpgradedClass(a.flightId,a.classOfService),this._checkInService.setSelectedUpgradeOption(a,b),this.nextUpgradeStep())},c.prototype.openFareInfoModal=function(a){var b=this._$scope.$new();b.fareInfo=this.FareInfoBundle[a];var c=this._$scope.ResourceBundle.modal.fareInfo;this._$modal.open({contentType:c.TYPE,size:c.SIZE,title:c.TITLE,templateUrl:c.TEMPLATE_URL,scope:b})},c.prototype.nextUpgradeStep=function(){if(this._$scope.currentLeg<this._$scope.numberOfLegs){var b=this._$scope.upgradeOptions=this._checkInService.getUpgradeOptions(this._$scope.currentLeg),c=0;for(var d in b)b[d].available&&c++;this._$scope.availableUpgradeOptions=c,this._$scope.flight=this._checkInService.getFlightList().segments[this._$scope.currentLeg];var e=a.copy(this._status),f=1===this._$scope.numberOfLegs?"UPGRADE_YOUR_SEAT":"UPGRADE_YOUR_SEAT_CONNECTING";a.extend(e,{copy:this._statusService.message[f],data:{departure:this._$scope.flight.departure,arrival:this._$scope.flight.arrival}}),this._statusService.setStatus(e),this._$scope.currentLeg++}else if(this._checkInService.commitUpgradeOptions(),this._checkInService.hasSelectedUpgradeOption()){var g=this._checkInService.searchForLoungeOptions();g.then(function(){this.goToNextStep()}.bind(this)),this._loadingService.setLoading(g)}else this.goToNextStep()},c.prototype.goToNextStep=function(){var a=this._checkInService.getLoungeOptions(),b=a.length;b?(this._locationService.update(this._checkInService.urlConstants.LOUNGE),this._checkInService.setView(this._checkInService.viewConstants.LOUNGE)):this._checkInService.areAnySegmentsUpgraded()?(this._locationService.update(this._checkInService.urlConstants.SEATS_SELECT),this._checkInService.setView(this._checkInService.viewConstants.SEATS_SELECT)):(this._locationService.update(this._checkInService.urlConstants.SEATS_CHANGE),this._checkInService.setView(this._checkInService.viewConstants.SEATS_CHANGE))},c}),c("check-in/controllers/lounge-options",["angular"],function(a){"use strict";var b=function(b,c,d,e,f,g,h,i){this._$scope=b,this._checkInService=c,this._locationService=d,this._statusService=e,this._accessibleService=g,this._utilsService=h,this._resourceBundle=i,this._checkInService.purgeLoungeOptions(),this._$scope.$watchCollection(this._checkInService.getExtraOptions,function(b){a.equals(b,{})||(this._$scope.loungeOptions.numberOfLegs=this._checkInService.getNumberOfLegs(),this.nextLoungeStep())}.bind(this)),f.setNinjaMode(!0),a.extend(this._$scope,{loungeOptions:{numberOfLegs:0,currentLeg:null,lounges:[],selectedLounges:[],updateStatusBar:this.updateStatusBar.bind(this),select:this.selectLoungeOption.bind(this),nextLoungeStep:this.nextLoungeStep.bind(this),labelFor:this.labelFor.bind(this),getLoungePrice:this.getLoungePrice.bind(this),loungeExtendedInfo:this.loungeExtendedInfo.bind(this)}}),this.updateStatusBar()};return b.prototype.loungeExtendedInfo=function(a){return this._resourceBundle.checkIn.loungeOptions[a.airport]},b.prototype._loungesSummary=function(){return this._$scope.loungeOptions.lounges.reduce(function(a,b){return b.selected&&a.selected++,b.available&&a.available++,a},{selected:0,available:0})},b.prototype.labelFor=function(a){var b=this._resourceBundle.checkIn.loungeOptions[a],c=this._loungesSummary();return c.available?c.selected?b.selected.replace("{number}",c.selected):b.none:b.unavailable},b.prototype.updateStatusBar=function(){var a=this._$scope.loungeOptions,b="SELECT_LOUNGE_OPTIONS";a.numberOfLegs>1&&(b="SELECT_LOUNGE_OPTIONS_CONNECTING");var c={};null!==a.currentLeg&&(c=this._checkInService.getFlightSegmentByIndex(a.currentLeg)),this._statusService.setStatus({format:this._statusService.format.GUIDER,copy:this._statusService.message[b],controls:{},data:{balance:"$"+this._checkInService.extraPaymentAmount(),checkin:!0,departure:c.departure,arrival:c.arrival},sticky:!0})},b.prototype.selectLoungeOption=function(a){if(a.available){var b=this._$scope.loungeOptions.selectedLounges.indexOf(a);b===-1?this._$scope.loungeOptions.selectedLounges.push(a):this._$scope.loungeOptions.selectedLounges.splice(b,1),a.selected=!a.selected,this._accessibleService.setText(a.airport+" lounge "+(a.selected?"selected":"deselected")),this._checkInService.setSelectedLoungeOptions(this._$scope.loungeOptions.selectedLounges),this.updateStatusBar()}},b.prototype.nextLoungeStep=function(){var a=this._$scope.loungeOptions;null===a.currentLeg?a.currentLeg=0:a.currentLeg++,a.currentLeg<a.numberOfLegs?(a.lounges=this._checkInService.getLoungeOptions(a.currentLeg),this.updateStatusBar()):this._checkInService.areAnySegmentsUpgraded()?(this._locationService.update(this._checkInService.urlConstants.SEATS_SELECT),this._checkInService.setView(this._checkInService.viewConstants.SEATS_SELECT)):(this._locationService.update(this._checkInService.urlConstants.SEATS_CHANGE),this._checkInService.setView(this._checkInService.viewConstants.SEATS_CHANGE))},b.prototype.getLoungePrice=function(a){return a.closed?this._resourceBundle.checkIn.status.CLOSED:a.available?"$"+a.totalFee:this._resourceBundle.checkIn.status.NOT_AVAILABLE},b.$inject=["$scope","checkInService","locationService","statusService","windowService","accessibleService","utilsService","ResourceBundle"],b}),c("check-in/controllers/baggage-selection",[],function(){"use strict";var a=function(a,b,c,d,e,f,g,h,i,j){this._$scope=a,this._$singleTimeout=b,this._checkInService=c,this._statusService=d,this._locationService=e,this._loadingService=f,this._$scope.ResourceBundle=g,this._travelerService=h,this._$scope.travelers=c.getNonInfantTravelers(),this._$modalStack=i,this._$q=j,this._$scope.baggagePicker={saveBaggagePreference:this.saveBaggagePreference.bind(this)},this._setStatus();var k=this._$modalStack.getTop();k&&k.key.close()};return a.prototype._setStatus=function(){var a={format:this._statusService.format.GUIDER,controls:{},copy:this._statusService.message.NUMBER_OF_BAGS,data:{balance:"$"+this._checkInService.extraPaymentAmount(),checkin:!0},sticky:!0};this._$singleTimeout(this._statusService.setStatus.bind(this,a))},a.prototype.saveBaggagePreference=function(){var a=this._$q.defer();this._loadingService.setLoading(a.promise),this._statusService.setStatus([]),this._checkInService.doBaggageFeeCall(this._$scope.travelers).then(function(){var b=this._checkInService.extraPaymentAmount(),c=0===b,d=c?this._checkInService.urlConstants.SUCCESS:this._checkInService.urlConstants.PURCHASE,e=c?[]:{format:this._statusService.format.GUIDER,copy:this._statusService.message.PAYMENT,controls:{},data:{balance:"$"+b,checkin:!0},sticky:!0},f=function(){this._statusService.setStatus(e),this._locationService.go({target:d}),a.resolve()}.bind(this),g=function(){this._checkInService.doCompleteCheckIn().then(function(){a.resolve(),f()})}.bind(this);c?g():f()}.bind(this))},a.$inject=["$scope","$singleTimeout","checkInService","statusService","locationService","loadingService","ResourceBundle","travelerService","$modalStack","$q"],a}),c("check-in/controllers/ancillaries-selector",["angular"],function(a){"use strict";var b=function(b,c,d,e,f,g,h,i){this._$scope=b,this._$q=c,this._pubSubService=d,this._checkInService=e,this._statusService=f,this._locationService=g,this._ancillariesService=h,this._resourceBundle=i,this._travelerInfo={},this.travelers=this._checkInService.getNonInfantTravelers(),this._availableAncillaries=this._checkInService.getAvailableAncillaries(),this._currentAncillaryIndex=-1,a.extend(this._$scope,{ancSelector:{getCurrentAncillary:this.getCurrentAncillary.bind(this),getTravelerInfo:this.getTravelerInfo.bind(this),goToNext:this.goToNext.bind(this),toggleAncillaryForTraveler:this.toggleAncillaryForTraveler.bind(this),toggleForAllTravelers:this.toggleForAllTravelers.bind(this),getStatusForCurrentAncillary:this.getStatusForCurrentAncillary.bind(this),travelers:this.travelers},getContinueBoxSettings:this.getContinueBoxSettings.bind(this)}),this._setLevelData(),this.goToNext()};return b.prototype.goToNext=function(){this._currentAncillaryIndex++,this.getCurrentAncillary()?(this._updateStatus(),this._updateTravelerInfo(),!this.getStatusForCurrentAncillary().available&&this.goToNext()):(this._locationService.update(this._checkInService.urlConstants.BAGGAGE),this._checkInService.setView(this._checkInService.viewConstants.BAGGAGE)),this._checkInService.getView()!==this._checkInService.viewConstants.ANCILLARIES_SELECTOR&&this._ancillariesService.publishAnalyticsData()},b.prototype.getTravelerInfo=function(){return this._travelerInfo},b.prototype._updateStatus=function(){this._statusService.setStatus({format:this._statusService.format.GUIDER,controls:{},copy:this._statusService.message.ADD_EXTRA,data:{balance:"$"+this._checkInService.extraPaymentAmount(),ancillaryTitle:this.getCurrentAncillary().title.toLowerCase(),checkin:!0},sticky:!0})},b.prototype.getCurrentAncillary=function(){return this._availableAncillaries[this._currentAncillaryIndex]},b.prototype._updateTravelerInfo=function(){this._travelerInfo=this._ancillariesService.getCheckInTravelerInfoForAncillary(this.getCurrentAncillary(),this._levelData),this._refreshView()},b.prototype._refreshView=function(){this._$scope.$broadcast("ancSelector.refreshView")},b.prototype._setLevelData=function(){this._levelData={oAndDId:this._checkInService.getOAndDId()}},b.prototype.toggleAncillaryForTraveler=function(a){if(!a.isUnavailable&&!a.isIncluded){var b=a.traveler;this._travelerInfo[b.guestId].isSelected?this.getCurrentAncillary().remove(b.guestId,this._levelData):this.getCurrentAncillary().add(b.guestId,this._levelData),this._travelerInfo[b.guestId].isSelected=!this._travelerInfo[b.guestId].isSelected,this._checkInService.updateSelectedAncillarySummaryList(),this._refreshView(),this._updateStatus()}},b.prototype.toggleForAllTravelers=function(){var b=!this.getStatusForCurrentAncillary().selected;a.forEach(this._travelerInfo,function(a){b!==a.isSelected&&this.toggleAncillaryForTraveler(a)}.bind(this))},b.prototype.getContinueBoxSettings=function(){var a=this._resourceBundle.checkIn.ancillaryOptions,b=this.getStatusForCurrentAncillary();return b.selected?{button:a.continueButton.SELECTED,text:a.continueText.SELECTED+b.selected}:b.included?{button:a.continueButton.INCLUDED,text:a.continueText.INCLUDED}:{button:a.continueButton.NONE,text:a.continueText.NONE}},b.prototype.getStatusForCurrentAncillary=function(){var b=0,c=0,d=0;return a.forEach(this._travelerInfo,function(a){a.isSelected&&b++,a.isIncluded&&c++,a.isAvailable&&d++}),{included:c,selected:b,available:d}},b.$inject=["$scope","$q","pubSubService","checkInService","statusService","locationService","ancillariesService","ResourceBundle"],b}),c("check-in/controllers/seat-selector",["angular","jquery"],function(a,b){"use strict";var c=function(a,b,c,d,e,f,g){this.$scope=a,this.$scope.seatSelector={},this._checkInService=b,this._seatService=c,this._travelerService=d,this._pnrService=e,this._fareService=f,this._tripService=g,this._pnr=this._pnrService.model()[0];var h=b.getFlightList(),i=d.getAllTravelers(),j=e.getSeatsByLeg(h.segments,i);this._seatService.resetSelectedSeatModel();for(var k in j){var l=j[k],m=this._checkInService.getSelectedUpgradeOption(parseInt(k,10)+1);m&&l.cabinType!==m.name&&(j[k].seats=[])}for(var n in j){var o=[];for(var p in j[n].seats){var q=j[n].seats[p];for(var r in i){var s=i[r];if(s.guestId===q.guestId){o.push(q);break}}}j[n].seats=o}b.setCurrentSeats(j),this._initialize(),a.$on("seatSelector.complete",this.onComplete.bind(this))};return c.$inject=["$scope","checkInService","seatService","travelerService","pnrService","fareService","tripService"],c.prototype._initialize=function(){var a=this._checkInService.getCurrentSeats(),c=this._travelerService.getTravelerAmounts();this._tripService.setTravelerAmount(c);var d=this._checkInService.buildCheckInSeatMapRequestModels(),e=this._checkInService.getUpgradeTierExclusions(),f=this._checkInService.getUpgradeOptions(),g={};for(var h in f){var i=f[h];g[i.name]=i.fee}this.$scope.seatSelector.totalSegments=d.length;for(var j=0;j<this.$scope.seatSelector.totalSegments;j++){var k=this._checkInService.getFlightSegmentByIndex(j);k.selectedSeatsCount=0}this._seatService.getSeatMapForCheckIn(d,a,e,g),b(".status-bar").addClass("is-ninja-light"),this.$scope.$on("$destroy",function(){b(".status-bar").removeClass("is-ninja-light")})},c.prototype._storeSeatSelections=function(){var b=this._seatService.getSelectedSeatModel(),c=[];a.forEach(b.flightList,function(b){var d,e=[];b&&(a.forEach(b.paxSeatList,function(a){d=this._travelerService.getTravelerByGuid(a.travelerGuid),e.push({seatNum:a.seatNumber,traveler:d.serialize("pax")})},this),b.paxSeatList=e,c.push(b))},this),this._checkInService.setSelectedSeats(c)},c.prototype.onComplete=function(){this._storeSeatSelections(),this._checkInService.skipToAncillariesOrBaggage()},c}),c("check-in/controllers/seats-change",["angular"],function(a){"use strict";var b=function(b,c,d,e,f,g,h,i,j){this._$scope=b,this._pnrService=d,this._windowService=c,this._checkInService=e,this._travelerService=f,this._statusService=g,this._locationService=h,this._loadingService=i,this._resourceBundle=j,this._windowService.setNinjaMode(!0);var k=this._checkInService.getFlightList(),l=this._travelerService.getAllTravelers();this._$scope.travelers=l,this._$scope.resourceBundle=this._resourceBundle;var m=a.copy(this._pnrService.getSeatsByLeg(k.segments,l));for(var n in m){var o=[];for(var p in m[n].seats){var q=m[n].seats[p];for(var r in l){var s=l[r];if(s.guestId===q.guestId){o.push(q);break}}}m[n].seats=o}var t=this._checkInService.setCurrentSeats(m);this._$scope.currentSeats=t,this._$scope.changeSeats={getTravelerName:this.getTravelerName.bind(this)};var u={format:this._statusService.format.GUIDER,copy:this._statusService.message.CHANGE_YOUR_SEAT,controls:{},data:{balance:"$"+this._checkInService.extraPaymentAmount(),checkin:!0},sticky:!0};this._statusService.setStatus(u),this._$scope.$on("destroy",this._destroy.bind(this)),this._$scope.selectSeats=this.selectSeats.bind(this),this._$scope.skipToAncillariesOrBaggage=this.skipToAncillariesOrBaggage.bind(this),this._$scope.seatsAreAvailableToChange=function(){var a=this._checkInService.getSeatChangeAvailability(),b=!1;for(var c in a)if("ELIGIBLE"===a[c].seatChangeEligibility)return!0;return b}.bind(this)};return b.$inject=["$scope","windowService","pnrService","checkInService","travelerService","statusService","locationService","loadingService","ResourceBundle"],b.prototype.selectSeats=function(){this._locationService.update(this._checkInService.urlConstants.SEATS_SELECT),this._checkInService.setView(this._checkInService.viewConstants.SEATS_SELECT)},b.prototype.skipToAncillariesOrBaggage=function(){this._checkInService.skipToAncillariesOrBaggage()},b.prototype.getTravelerName=function(a){var b=this._travelerService.getTravelersByKey("guestId",a)[0];return b?b.name.first+" "+b.name.last:""},b.prototype._destroy=function(){this._windowService.setNinjaMode(!1)},b}),c("check-in/vx-check-in-app",["angular","check-in/controllers/check-in","check-in/controllers/choose-flight","check-in/controllers/add-passport-info","check-in/controllers/upgrade-options","check-in/controllers/lounge-options","check-in/controllers/baggage-selection","check-in/controllers/ancillaries-selector","check-in/controllers/seat-selector","check-in/controllers/seats-change"],function(a,b,c,d,e,f,g,h,i,j){"use strict";return a.module("vxCheckInApp",[]).controller("CheckInCtrl",b).controller("CheckInSeatSelectorCtrl",i).controller("CheckInChooseFlightsCtrl",c).controller("CheckInAddPassportInfoCtrl",d).controller("CheckInUpgradeOptionsCtrl",e).controller("CheckInLoungeOptionsCtrl",f).controller("CheckInSeatsChangeCtrl",j).controller("CheckInBaggageSelectionCtrl",g).controller("CheckInAncillariesSelectorCtrl",h)}),c("manage/controllers/manage",["angular","common/models/account-info-model"],function(a,b){"use strict";var c=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){if(this._$scope=a,this._$routeParams=b,this._pnrService=c,this._elevateService=i,this._fareService=d,this._seatService=e,this._manageService=f,this._changeService=g,this._windowService=h,this._scrollService=j,this._loadingService=k,this.isElevateWithoutFlights=!1,this._pubSubService=m,this._statusService=n,this._changeService.reset(),this._fareService.reset(),this._seatService.resetService(),this._$scope.manage={checkData:this.checkData.bind(this),setView:this.setView.bind(this)},this._windowService.setHeaderVisible(!0),this._windowService.setChromeHidden(!1),this._statusService.setChangeGuider([]),this._windowService.setChangeFlow(!1),this._windowService.setYtsVisible(!1),this._$scope.FAQ=l.siteMap.FAQ,this._$scope.manage.setView("LOGIN"),!i.isLoggedIn()||c.pnrIsFromTripFinder()){var o,p;if(c.getPNRFound()){var q=c.model();p=q[0].lastName,o=q[0].pnr,this._publishPnr(p,o)}else this._$routeParams.lastName&&this._$routeParams.pnrCode?(o=this._$routeParams.pnrCode,p=this._$routeParams.lastName,this._publishPnr(p,o)):this._$scope.$watch(i.isLoggedIn,function(a){a&&this._elevateStateHandler()}.bind(this))}else this._elevateService.verifyIfLoggedIn().then(this._elevateStateHandler.bind(this));this._pubSubService.subscribe("pnr.found",function(){a.manage.checkData(c.model(),!1)}.bind(this)),this._pubSubService.subscribe("elevate.loggedIn",this._elevateStateHandler.bind(this))};return c.prototype._publishPnr=function(a,b){this._pnrService.reset();var c=this._pnrService.findPNR("",a,b);c.then(function(){this._$scope.manage.checkData(this._pnrService.model(),!1)}.bind(this))},c.prototype._elevateStateHandler=function(){if(!this._$routeParams.lastName&&!this._$routeParams.pnrCode){var c=this;this._pnrService.reset();var d=this._elevateService.retrieveAccountInfo({context:"manage"});this._loadingService.setLoading(d),d.then(function(d){var e=new b(a.copy(d)),f=e.managePNRList;c.setView("FLIGHTS"),c.checkData(f,!0)}.bind(this))}},c.$inject=["$scope","$routeParams","pnrService","fareService","seatService","manageService","changeService","windowService","elevateService","scrollService","loadingService","SiteMapBundle","pubSubService","statusService","tripService"],c.prototype.setView=function(a){this._$scope.manage.view=a,this._scrollService.go("top",{duration:0})},c.prototype.checkData=function(a,b){var c=this;if(a){0===a.length&&b&&(this.isElevateWithoutFlights=!0),this._$scope.manage.view=0!==a.length||b?"FLIGHTS":"LOGIN";var d=this._manageService.getPnrModel();if(a[0]&&a[0].pnr&&a[0].paxList&&(!d||d.pnr!==a[0].pnr)){this._manageService.setPnr(a[0].pnr),this._manageService.setLastName(a[0].paxList[0].lastName);var e=[];for(var f in a[0].paxList){var g={name:a[0].paxList[f].firstName+" "+a[0].paxList[f].lastName,firstName:a[0].paxList[f].firstName,lastName:a[0].paxList[f].lastName,guestId:a[0].paxList[f].guestId};e.push(g)}this._manageService.setTravelers(e),c._manageService.savePnrModel(a)}}},c}),c("manage/controllers/manage-flights",[],function(){"use strict";var a=function(a,b,c,d,e,f,g,h,i,j,k){this._$scope=a,this._$rootScope=b,this._$q=c,this._$singleTimeout=d,this._manageService=e,this._api=j,this._resourceBundle=h,this._elevateService=i,this._utilsService=k,this._$scope.isLoggedIn=this._elevateService.isLoggedIn,this._$scope.flights={breakpoint:f.breakpoint(),trips:[],loadPNR:this.loadPNR.bind(this),total:0},this._$scope.$watch(function(){return e.getPnrModel()},function(a){this._$scope.flights.trips=a,this.refreshTrips()}.bind(this),!0),g.subscribe("windowService.breakpoint",this.onBreakpointChange.bind(this))};return a.$inject=["$scope","$rootScope","$q","$singleTimeout","manageService","windowService","pubSubService","ResourceBundle","elevateService","api","utilsService"],a.prototype.refreshTrips=function(){this._$singleTimeout(function(){this._$rootScope.$broadcast("manageFlights.trips")}.bind(this))},a.prototype.onBreakpointChange=function(a){this._$scope.flights.breakpoint=a},a.prototype.loadPNR=function(a,b){var c=this._$q.defer();return this._manageService.getPNRFromSummary(a,b).then(function(){this._$singleTimeout(function(){this._$scope.flights.trips=this._manageService.getPnrModel(),c.resolve(this._$scope.flights.trips[b])}.bind(this))}.bind(this),function(a){c.reject(a)}),c.promise},a}),c("manage/controllers/modals/manage-mcs-opt-in",[],function(){"use strict";var a=function(a,b,c,d){this._$scope=a,this._$modalInstance=b,this._manageService=c,this._loadingService=d,this._$scope.manageMCSOptIn={responsibilitiesVisible:!1,showResponsibilities:this.showResponsibilities.bind(this),applyOptIn:this.applyOptIn.bind(this)}};return a.$inject=["$scope","$modalInstance","manageService","loadingService"],a.prototype.applyOptIn=function(){this._$scope.pnr.optInAlreadyApplied=!0;var a=this._manageService.applyMCSOptIn(this._$scope.pnr);this._loadingService.setLoading(a),this._$modalInstance.close()},a.prototype.showResponsibilities=function(){this._$scope.manageMCSOptIn.responsibilitiesVisible=!0,setTimeout(function(){this._$scope.modal.resize(!0)}.bind(this),200)},a}),c("manage/directives/manage-trip",["jquery","angular"],function(a,b){"use strict";var c=function(){return{restrict:"A",replace:!0,scope:{trip:"=",index:"@"},controller:d,link:e,templateUrl:"/app/manage/templates/manage-trip.tpl.html"}},d=function(a,b,c,d,e,f,g,h,i,j,k,l,m){this._$scope=a,this._$parse=b,this._$modal=c,this._windowService=d,this._pnrService=e,this._manageService=f,this._changeService=g,this._cancelService=h,this._locationService=i,this._utilsService=j,this._envService=k,this._scrollService=l,this._pubSubService=m,a.manageTrip={bp:"",openModal:this.openModal.bind(this),
openKnownTravelerModal:this.openKnownTravelerModal.bind(this),openCancelAwardsBookings:this.openCancelAwardsBookings.bind(this),getPrintReceiptUrl:this.getPrintReceiptUrl.bind(this),cancelFlight:this.cancelFlight.bind(this),changeItinerary:this.changeItinerary.bind(this),changeFlight:this.changeFlight.bind(this),changeSeats:this.changeSeats.bind(this),changeExtras:this.changeExtras.bind(this),checkIn:this.checkIn.bind(this),setPnr:this.setPnr.bind(this),setManagePnr:this.setManagePnr.bind(this)},a.$watch(this._windowService.breakpoint,this.onBreakpointChange.bind(this)),a.$watch("index",function(a){"0"!==a&&(this._scrollService.setOffsetType("nav"),this._scrollService.go("pnr-"+(a-1)))}.bind(this)),this._changeService.setIsReturningFlight(!1)};d.$inject=["$scope","$parse","$modal","windowService","pnrService","manageService","changeService","cancelService","locationService","utilsService","envService","scrollService","pubSubService"],d.prototype.changeFlight=function(a,c,d){if(d&&("ELIGIBLE"===d.changeEligibility||"ELIGIBLE"===d.changeSeatEligibility)){var e,f,g,h=b.copy(a);h.tripType="ONE_WAY",h.tripTypeLabel="One Way",h.isOneWay=!0,h.isRoundTrip=!1,h.isMultiCity=!1,this._changeService.setIsReturningFlight(!!c),h.flightList=a.flightList.slice(c,c+1);var i=h.flightList[0].oAndDId;h.ancillaryDetails&&h.ancillaryDetails.ancillaryList.forEach(function(a){"O_AND_D"===a.level&&b.forEach(a.levelMap,function(b,c){c!==i&&delete a.levelMap[c]})}),this._changeService.setExceptions(a),f=h.flightList[0].flightId,g=[];for(var j in h.seatList)e=h.seatList[j],e.flightId===f&&g.push(e);h.seatList=g,this.changeItinerary(h)}},d.prototype.setPnr=function(a){this._changeService.setPnrModel(a)},d.prototype.setManagePnr=function(a){this._manageService.setPnr(a)},d.prototype.changeItinerary=function(a){a&&!a.tripAvailableForChange||(this.setPnr(a),this._locationService.go({target:"/change"}))},d.prototype.checkIn=function(a){a&&a.availableForCheckIn&&(this.setPnr(a),this._locationService.go({target:"/flight-check-in"}))},d.prototype.changeExtras=function(a){a&&a.tripAvailableForManageExtras&&(this.setPnr(a),this._changeService.setChangeType(this._changeService.CHANGE_TYPES.EXISTING,this._changeService.EXISTING_CHANGE_TYPES.EXTRAS_AND_SEATS),this._locationService.setContext(this._locationService.contexts.CHANGE),this._locationService.go({target:"/change/extras"}))},d.prototype.changeSeats=function(a){a&&a.tripAvailableForChangeSeat&&(this.setPnr(a),this._changeService.setChangeType(this._changeService.CHANGE_TYPES.EXISTING,this._changeService.EXISTING_CHANGE_TYPES.SEATS),this._locationService.setContext(this._locationService.contexts.CHANGE),this._locationService.go({target:"/change/seats"}))},d.prototype.cancelFlight=function(a){a&&a.tripAvailableForCancel&&(this.setPnr(a),this._cancelService.setPnrModel(a),this._locationService.go({target:"/cancel"}))},d.prototype.getPrintReceiptUrl=function(){var a=this._$scope.trip,b={evt:this._envService.context("api").resourceURL,email:a.contact?a.contact.email:"",lastName:a.paxList&&a.paxList[0]?a.paxList[0].lastName:"",pnr:a?a.pnr:""};return b.evt+"/v2/manage/print-changed-itinerary?pnr="+b.pnr+"&emailAddress="+b.email+"&includeBillingInfo=true&lastName="+b.lastName},d.prototype.onBreakpointChange=function(a){this._$scope.manageTrip.bp=a},d.prototype.openModal=function(a){this._manageService.setPnr(this._$scope.trip.pnr),this._manageService.setTravelers(this._$scope.trip.paxList),this._pubSubService.publish("core.openModal",[a])},d.prototype.openKnownTravelerModal=function(a,b){this._pubSubService.publish("core.openModal",["openKnownTravelerModal",a,b])},d.prototype.openCancelAwardsBookings=function(){this._pubSubService.publish("core.openModal",["openCancelAwardsBookings"])};var e=function(){a("section.manage a").on("click",function(){a(this).hasClass("btn")&&a(this).hasClass("btn-disabled")&&(a(this).addClass("is-disabled-animation"),setTimeout(function(){a(this).removeClass("is-disabled-animation")}.bind(this),350))})};return c}),c("manage/directives/manage-mcs-opt-in",[],function(){"use strict";var a=function(){return{restrict:"A",replace:!0,scope:{trip:"=",index:"@"},controller:b,templateUrl:"/app/manage/templates/manage-mcs-opt-in.tpl.html"}},b=function(a,b,c){this._$scope=a,this._elevateService=b,this._pubSubService=c,this._$scope.manageMCSOptIn={showOptIn:!1,openManageMCSOptInModal:this.openManageMCSOptInModal.bind(this)},this._$scope.$watch("trip.optInAlreadyApplied",this.setupShowOptIn.bind(this))};return b.prototype.setupShowOptIn=function(){this._$scope.manageMCSOptIn.showOptIn=!1;var a="MC"!==this._$scope.trip.flightList[0].cabinType,b=this._$scope.trip.pointsBooking,c=this._$scope.trip.optInAlreadyApplied;if(!c&&!b&&!a){var d=this._$scope.trip.serialize("paxfrequentFlyer");this._elevateService.MCSOptInEligibility(d).then(function(){this._$scope.manageMCSOptIn.showOptIn=!0}.bind(this))}},b.prototype.openManageMCSOptInModal=function(){this._pubSubService.publish("core.openModal",["openManageMCSOptIn",this._$scope.trip])},b.$inject=["$scope","elevateService","pubSubService"],a}),c("manage/vx-manage-app",["angular","manage/controllers/manage","manage/controllers/manage-flights","manage/controllers/modals/manage-mcs-opt-in","manage/directives/manage-trip","manage/directives/manage-mcs-opt-in"],function(a,b,c,d,e,f){"use strict";return a.module("vxManageApp",[]).controller("ManageCtrl",b).controller("ManageFlightsCtrl",c).controller("ManageMCSOptInModalCtrl",d).directive("vxCommonManageTrip",e).directive("vxManageMcsOptIn",f)}),c("flights/services/flights",["angular"],function(a){"use strict";var b=function(a,b,c,d,e,f){this._$rootScope=a,this._pnrService=b,this._elevateService=c,this._statusService=e,this._loadingService=d,this._tripService=f,this._tripsData=[],this._TripModel={pnr:"",tripType:"",flightList:[],paxList:[],paymentInfo:{cardHolderName:"",cardType:"",ccNumber:"",transactionTime:""}},this._FlightModel={flightId:"",flightNum:"",aircraftType:"",arrival:"",arrivalDateTime:"",classOfService:"",departure:"",departureDateTime:"",flownSegment:"",marketingAirline:"",segNum:"",status:"",withinACSWindow:""},this._PaxModel={guestId:"01.01",ticketNum:"",firstName:"",lastName:"",loyaltyId:"",loyaltyProgram:"",tierLevel:""};var g=this;return this._$rootScope.$watch(function(){return c.getUserData()},function(a){"undefined"!=typeof a&&g.parseElevateData(a)}),{parseElevateData:this.parseElevateData.bind(this)}};return b.$inject=["$rootScope","pnrService","elevateService","loadingService","statusService","tripService"],b.prototype.parseElevateData=function(b){if(b.bookingDetailsList)for(var c in b.bookingDetailsList){var d=b.bookingDetailsList[c],e=a.copy(this._TripModel,{});e.pnr=d.pnr;var f=a.copy(this._FlightModel,{});f.arrival=d.dest,f.arrivalDateTime=d.arrivalDateTime,f.classOfService=d.classOfService,f.departure=d.origin,f.departureDateTime=d.depatureDateTime,f.flightNum=d.flightNum,f.status=d.status,e.flightList.push(f);var g=b.elevateAccount,h=a.copy(this._PaxModel,{});h.firstName=g.firstName,h.lastName=g.lastName,h.loyaltyId=g.elevateID,h.loyaltyProgram="VX",h.tierLevel="GOLD",e.paxList.push(h),this._tripsData.push(e)}},b}),c("flights/vx-flights-app",["angular","flights/services/flights"],function(a,b){"use strict";return a.module("vxFlightsApp",[]).service("flightsService",b)}),c("elevate/controllers/elevate",[],function(){"use strict";var a=function(a,b){b.setElevateMode(!0),b.setAdvisoryHidden(!0),a.$on("$destroy",function(){b.setElevateMode(!1),b.setAdvisoryHidden(!1)})};return a.$inject=["$scope","windowService"],a}),c("elevate/controllers/elevate-login",["angular"],function(a){"use strict";var b=function(b,c,d,e,f){var g=this;this._$scope=b,this._windowService=c,this._elevateService=d,this._utilsService=e,this._locationService=f,this._windowService.setHeaderVisible(!0),this._windowService.setYtsVisible(!1),this._windowService.setChromeHidden(!0),this._windowService.setElevateLogin(!0),this._$scope.elevateLogin={fullPage:this.fullPage.bind(this),destroyRecognized:this.destroyRecognized.bind(this),isRecognizedUser:!1},"shop-login"!==f.getContext()&&c.setElevateMode(!1),b.$watch(this._elevateService.isRecognizedOrLoggedIn,function(c){a.extend(b.elevateLogin,{isRecognizedUser:c,elevateUser:this._elevateService.getUserData(),avatar:this._elevateService.getUserData().avatar})}.bind(this)),b.$watch(this._elevateService.isLoggedIn,function(a){a&&"shop-login"!==f.getContext()&&this._locationService.go({target:"/elevate-frequent-flyer/landing-logged"}),a&&c.setElevateMode(!0)}.bind(this)),this._$scope.$on("$destroy",function(){g._windowService.setElevateLogin(!1),g._windowService.setChromeHidden(!1)})};return b.$inject=["$scope","windowService","elevateService","utilsService","locationService"],b.prototype.fullPage=function(){return{"min-height":this._windowService.getDeviceWindowHeight()-54+"px"}},b.prototype.destroyRecognized=function(){this._elevateService.destroyRecognizedUser()},b}),c("elevate/controllers/account-info",[],function(){"use strict";var a=function(a,b,c,d,e,f,g,h,i,j,k,l,m){this._$scope=a,this._resourceBundle=b,this._$modal=d,this._elevateService=e,this._statusService=f,this._persistenceService=g,this._locationService=h,this._loadingService=i,this._utilsService=j,this._adobeAnalyticsService=k,this._cms=l,this._$q=m,this._openModal,this._dataCache={},this._lastFormName,this._lastFormData,this._lastSubmitData,this._cmsPromise=m.defer(),a.accInfo={user:null,isLoaded:!1,openModal:this.openModal.bind(this),formatPhoneNum:this.formatPhoneNum.bind(this),goToAlerts:this.goToAlerts.bind(this)},this._modalsInfo={"personal-info":{title:"Personal Information"},"contact-info":{title:"Contact Information"},address:{title:"Addresses"},password:{title:"Password",submitFunc:e.resetElevatePassword.bind(e)},"credit-card":{title:"Credit Cards"},alerts:{title:"Flight Alerts"},preferences:{title:"Travel Preferences"}},a.$watch(g.isLoaded,this._onPersistenceIsLoaded.bind(this)),a.$watch("accInfo.user.accountInfo.guestPreference.homeAirPort",function(a,b){a!==b&&this._updateHomeAirportName()}.bind(this)),a.$on("elevate-avatar-selected",function(a,b){this._avatarSelected=b}.bind(this)),this._cms.config.get(function(a){this._airports=a.airports,this._cmsPromise.resolve()}.bind(this))};return a.$inject=["$scope","ResourceBundle","GeoBundle","$modal","elevateService","statusService","persistenceService","locationService","loadingService","utilsService","adobeAnalyticsService","cms","$q"],a.prototype._onPersistenceIsLoaded=function(a,b){if(a||a!==b)if(a&&this._elevateService.isLoggedIn()){var c=this._elevateService.retrieveAccountInfo({context:"accountInfo"});this._loadingService.setLoading(c),c.then(this._onRetrieveAccInfo.bind(this))}else this._adobeAnalyticsService.UIEvent(this._adobeAnalyticsService.EVENTS.RESTRICTED_PAGE,{page:"/elevate-frequent-flyer/account-info"}),this._locationService.go({target:"/elevate-frequent-flyer"})},a.prototype._updateHomeAirportName=function(){var a=this._user.accountInfo.guestPreference,b=this._airports[a.homeAirPort],c=b.name+", "+(b.international?this._utilsService.capitilizeWords(b.country):b.state);a.homeAirPortName=c},a.prototype._onRetrieveAccInfo=function(){this._cmsPromise.promise.then(function(){this._user=this._$scope.accInfo.user=this._elevateService.getUserData(),this._$scope.accInfo.isLoaded=!0}.bind(this))},a.prototype.openModal=function(a){this._currentModalOpened=a;var b=this._$scope.$new(),c=this._user.accountInfo.addressInfo[0].addressName,d="PENDING_SIGNUP_ADDRESS"===c||void 0===c?"edit":"list";b.accInfoModal={page:d,data:this._user,elevateProperties:this._elevateService.PROPERTIES,fields:{},name:a,submit:this.onModalSubmit.bind(this),submitDeletion:this.onModalSubmitDeletion.bind(this)},this._openModal=this._$modal.open({contentType:"form",size:"small",scope:b,title:this._modalsInfo[a].title,templateUrl:"/app/elevate/templates/modals/accinfo-"+a+".tpl.html"})},a.prototype.onModalSubmit=function(a){var b=this._currentModalOpened,c=this._modalsInfo[b].submitFunc?this._modalsInfo[b].submitFunc(a):this._elevateService.handleProfileModify(a);return c.then(function(){this._openModal&&this._openModal.close(),this._avatarSelected&&(this._$scope.accInfo.user.accountInfo.avatar=this._avatarSelected,this._$scope.accInfo.user.avatar=this._avatarSelected,delete this._avatarSelected),this._openModal=null}.bind(this)).catch(function(){this._openModal&&(this._openModal.close(),this._openModal=null)}.bind(this)),c},a.prototype.onModalSubmitDeletion=function(a,b){var c=this._$q.defer(),d=this._elevateService.handleProfileDelete(a);return d.then(function(){b(a[0].object[0].sequenceNum),this._openModal&&(this._openModal.close(),this._openModal=null),c.resolve()}.bind(this)).catch(function(){this._openModal&&(this._openModal.close(),this._openModal=null),c.reject()}.bind(this)),c.promise},a.prototype.formatPhoneNum=function(a){return this._utilsService.formatPhoneNum(a)},a.prototype.goToAlerts=function(){this._locationService.go({target:"/get-flight-alerts"})},a}),c("elevate/controllers/reset-password",[],function(){"use strict";var a=function(a,b,c,d,e,f,g){this._$scope=a,this._resourceBundle=c,this._elevateService=d,this._loadingService=e,this._locationService=f,this._statusService=g,this._pages={PHONE:"phone",RESET:"reset",SUCCESS:"success"},a.reset={page:null,phoneFields:{},resetFields:{},phone:null,checkPhone:this.checkPhone.bind(this),reset:this.reset.bind(this),signIn:this.signIn.bind(this)},a.$watch("reset.resetFields.password.value",this._validatePassword.bind(this)),a.$watch("reset.resetFields.confirmPassword.value",this._validatePassword.bind(this));var h=this._$scope.$watch(function(){return b.search()},function(a){a&&a.id&&(this._hash=a.id,h(),this._getResetData())}.bind(this));this._hash=b.search().id};return a.$inject=["$scope","$location","ResourceBundle","elevateService","loadingService","locationService","statusService"],a.prototype.checkPhone=function(){this._$scope.reset.page=this._pages.RESET},a.prototype.reset=function(){var a=this._elevateService.resetElevatePasswordByIDPhone(this._hash,this._$scope.reset.phoneFields.phone.value.slice(-4),this._$scope.reset.resetFields.password.value);return a.then(this._onSuccess.bind(this),this._onError.bind(this)),a},a.prototype._onSuccess=function(){this._$scope.reset.page=this._pages.SUCCESS},a.prototype._onError=function(){var a=this._statusService.message.OOPS;this._statusService.setStatus({format:this._statusService.format.ERROR,copy:a}),this._$scope.reset.page=this._pages.PHONE},a.prototype.signIn=function(){this._locationService.go({target:"/elevate-frequent-flyer"})},a.prototype._validatePassword=function(a,b){if(a!==b){var c=this._$scope.reset.resetFields.password,d=this._$scope.reset.resetFields.confirmPassword;""!==c.value&&""!==d.value&&c.value!==d.value&&d.setValidation(!1,"passwords don't match")}},a.prototype._getResetData=function(){var a=this._elevateService.retrieveForgotPasswordData(this._hash);this._loadingService.setLoading(a),a.then(function(a){this._$scope.reset.phone=a,this._$scope.reset.page=this._pages.PHONE}.bind(this))},a}),c("elevate/controllers/elevate-landing",["angular"],function(a){"use strict";var b=function(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){this._$scope=b,this._$window=c,this._$timeout=d,this._elevateService=e,this._loadingService=f,this._locationService=g,this._persistenceService=h,this._purchaseService=i,this._adobeAnalyticsService=l,this._resourceBundle=m,this._pubSubService=o,this._pnrService=p,this._cms=q,this._envService=n;var r=this._landedFirstTime();b.landingPage={user:null,isLoaded:!1,landedFirstTime:r,memberAvatar:null,earnPoints:m.elevateLanding.earnPoints,redeemPoints:m.elevateLanding.redeemPoints,logOut:this.logOut.bind(this),openPrintCard:this.openPrintCard.bind(this),nextFlight:null},b.$watch(h.isLoaded,this._onPersistenceIsLoaded.bind(this)),b.$watch(i.getTravelBankInfo,function(a){a&&a.balance&&(b.landingPage.travelBankBalance=a.balance)}),b.$watch(e.isLoggedIn,function(c){a.extend(b.landingPage,{elevateLoggedIn:c,memberAvatar:this._elevateService.getUserData().avatar})}.bind(this)),k.setElevateMode(!0),b.$on("$destroy",function(){k.setElevateMode(!1)}),this._pubSubService.subscribe("pnr.found",function(){this._pnrService.setPnrIsFromTripFinder(!0),this._locationService.go({target:"/manage-itinerary"})}.bind(this)),b.$watch("landingPage.isLoaded",function(a){a&&this._$timeout(this._onPageLoaded.bind(this))}.bind(this))};return b.$inject=["$scope","$window","$timeout","elevateService","loadingService","locationService","persistenceService","purchaseService","utilsService","windowService","adobeAnalyticsService","ResourceBundle","envService","pubSubService","pnrService","cms"],b.prototype._onPageLoaded=function(){location.pathname.indexOf("landing-logged")!==-1&&this._cms.info.get(function(a){var b=a.alaskaSetup.elevateTurnDown;b&&b.headline&&b.bodyCopy&&this._pubSubService.publish("core.openModal",["openElevateTurnDownModal"])}.bind(this))},b.prototype._onPersistenceIsLoaded=function(a,b){if(a||a!==b)if(a&&this._elevateService.isLoggedIn()){var c=this._elevateService.retrieveAccountInfo({context:"elevateLanding"});this._loadingService.setLoading(c),c.then(this._onRetrieveAccInfo.bind(this))}else this._adobeAnalyticsService.UIEvent(this._adobeAnalyticsService.EVENTS.RESTRICTED_PAGE,{page:"/elevate-frequent-flyer/landing"}),this._locationService.go({target:"/elevate-frequent-flyer"})},b.prototype._onRetrieveAccInfo=function(){this._user=this._$scope.landingPage.user=this._elevateService.getUserData(),this._$scope.landingPage.elevateAccount=this._user.accountInfo.elevateAccount;var a=this._persistenceService.getPrivateModel();a&&a.travelBankAuthToken&&this._purchaseService.retrieveTravelBankInfo(),this._$scope.landingPage.user.creditCardHolder="VXBC"===this._$scope.landingPage.user.accountInfo.tierDetail.adsProdStatus||"VXPC"===this._$scope.landingPage.user.accountInfo.tierDetail.adsProdStatus,this._emptyActivity(),this._$scope.landingPage.isCheckinEnabled=this._user.accountInfo.checkinPNRList&&this._user.accountInfo.checkinPNRList[0];var b=this._user.accountInfo.managePNRList[0];this._$scope.landingPage.nextFlight=b&&b.flightList?{origin:b.flightList[0].origin,destination:b.flightList[0].destination,departureDateTime:b.flightList[0].departureDateTime,pnr:b.pnr}:null,this._$scope.landingPage.isLoaded=!0},b.prototype._emptyActivity=function(){for(var a=this._user.accountInfo.pointDetailList,b=5-a.length,c={},d=0;d<b;d++)c[d]=d;this._$scope.emptyActivity=c},b.prototype.logOut=function(a){a.preventDefault();var b=a.target.href,c=this._persistenceService.clear().then(function(){return this._elevateService.doLogout().then(function(){return window.location.href=b,new Promise(function(){})}.bind(this))}.bind(this));this._loadingService.setLoading(c)},b.prototype.openPrintCard=function(){this._$window.open(this._getPrintCardUrl(),"_blank")},b.prototype._landedFirstTime=function(){return location.pathname.indexOf("landing-first-time")!==-1},b.prototype._getPrintCardUrl=function(){var a={evt:this._envService.context("api").resourceURL,token:this._elevateService.getAuthToken()};return a.evt+"/v2/elevate/elevate-card?authToken="+a.token},b}),c("elevate/controllers/elevate-activity",[],function(){"use strict";var a=function(a,b,c,d,e,f,g,h,i){this._$scope=a,this._elevateService=b,this._loadingService=c,this._locationService=d,this._persistenceService=e,this._adobeAnalyticsService=g,this._resourceBundle=h,this._$q=i,this._transactionMap={POINTS_EARNED:"Earned",POINTS_REDEEMED:"Redeemed"},this._activityLimit=8,a.elevateActivity={user:null,transactionMap:this._transactionMap,activityLimit:this._activityLimit,loadMore:this.loadMore.bind(this),missingPointsFields:{},missingPointsData:{}},a.$watch(e.isLoaded,this._onPersistenceIsLoaded.bind(this)),f.setElevateMode(!0),a.$on("$destroy",function(){f.setElevateMode(!1)})};return a.$inject=["$scope","elevateService","loadingService","locationService","persistenceService","windowService","adobeAnalyticsService","ResourceBundle","$q"],a.prototype._onPersistenceIsLoaded=function(a,b){if(a!==b||a!==!1)if(a&&this._elevateService.isLoggedIn()){var c=this._elevateService.retrieveAccountInfo({context:"elevateLanding"});this._loadingService.setLoading(c),c.then(this._onRetrieveAccInfo.bind(this))}else this._adobeAnalyticsService.UIEvent(this._adobeAnalyticsService.EVENTS.RESTRICTED_PAGE,{page:"/elevate-frequent-flyer/activity"}),this._locationService.go({target:"/elevate-frequent-flyer"})},a.prototype._onRetrieveAccInfo=function(){this._user=this._$scope.elevateActivity.user=this._elevateService.getUserData(),this._activity=this._$scope.elevateActivity.activity=this._user.accountInfo.pointDetailList,this._$scope.elevateActivity.isLoaded=!0},a.prototype.loadMore=function(){this._$scope.elevateActivity.activityLimit=this._$scope.elevateActivity.activityLimit+=this._activityLimit},a}),c("elevate/controllers/elevate-credit-card",["jquery"],function(a){"use strict";var b=function(a,b,c,d,e,f,g){this._$scope=a,this._$modal=b,this._$timeout=c,this._elevateService=d,this._loadingService=e,this._$location=f,this._resourceBundle=g,this._feedIndicatorMap={BASIC:1,PREMIUM:2},a.creditCard={loggedIn:!1,applyForCard:this.applyForCard.bind(this),viewTAndCModal:this.viewTAndCModal.bind(this)},a.$watch(d.isLoggedIn,function(b){a.creditCard.loggedIn=b}.bind(this))};return b.$inject=["$scope","$modal","$timeout","elevateService","loadingService","$location","ResourceBundle"],b.prototype._getInstantCredit=function(b){var c=this._elevateService.getCreditCardData(b);this._loadingService.setLoading(c);var d=function(b){var c=b.data.response;this._$scope.creditCard.form={custId:c.elevateId,feedIndicator:c.feeIndicator,firstName:c.firstName,lastName:c.lastName,address:c.address,city:c.city,state:c.state,zipCode:c.zipCode,email:c.email,authCode:c.authCode},this._$timeout(function(){var b={},d=this._$location.search();for(var e in d)b[e.toLowerCase()]=d[e];a("#applyForm").attr("action",[c.url,"?campaign=",b.cid?b.cid:"","&ElevateID=",c.elevateId].join("")),a("#applyForm").submit()}.bind(this))}.bind(this),e=function(){};c.then(d,e)},b.prototype.applyForCard=function(a){if(this._$scope.creditCard.loggedIn)this._getInstantCredit(a);else{var b=this._resourceBundle.modal.fareSignIn,c=this._$scope.$new();c.creditCard=!0,this._$modal.open({size:b.SIZE,type:b.TYPE,title:b.TITLE,templateUrl:b.TEMPLATE_URL,scope:c,controller:"SignInCtrl",contentType:"form"}).result.then(function(){this._getInstantCredit(a)}.bind(this))}},b.prototype.viewTAndCModal=function(){var a=this._resourceBundle.modal.elevateTAndCs;this._$modal.open({size:a.SIZE,type:a.TYPE,title:a.TITLE,templateUrl:a.TEMPLATE_URL})},b}),c("elevate/controllers/elevate-logout",[],function(){"use strict";var a=function(a,b,c,d,e){var f=b.doLogout();c.setLoading(f);var g=function(){e.clear(),a(function(){d.go({target:"/book"})},1e3)};f.then(g,g)};return a.$inject=["$timeout","elevateService","loadingService","locationService","persistenceService"],a}),c("elevate/controllers/modals/password",[],function(){"use strict";var a=function(a){this._$scope=a,this._$scope.accInfoPassword={data:{},fields:{}},a.$watch("accInfoPassword.fields.newPassword.value",this._validatePassword.bind(this)),a.$watch("accInfoPassword.fields.confirmPassword.value",this._validatePassword.bind(this))};return a.$inject=["$scope"],a.prototype._validatePassword=function(a,b){if(a!==b){var c=this._$scope.accInfoPassword.fields.newPassword,d=this._$scope.accInfoPassword.fields.confirmPassword;""!==c.value&&""!==d.value&&c.value!==d.value&&d.setValidation(!1,"passwords don't match")}},a}),c("elevate/controllers/modals/address",["common/models/account-info-model"],function(a){"use strict";var b=function(a,b,c){this._$scope=a,this._$singleTimeout=b,this._resourceBundle=c,this._$scope.accInfoAddress={submit:this.submit.bind(this),data:{},fields:{},onFormValid:this.checkFormsAreValid.bind(this),isValid:!1,isLoading:!1,invalidMessage:"No changes to save",submitButtonMessage:"Submit",page:a.accInfoModal.page,addresses:a.accInfoModal.data.accountInfo.addressInfo,selectedIndex:null,edit:this.edit.bind(this),delete:this.delete.bind(this),setDefault:this.setDefault.bind(this),add:this.add.bind(this),onAddAddress:this.onAddAddress.bind(this)}};return b.$inject=["$scope","$singleTimeout","ResourceBundle"],b.prototype.onAddressDeserialize=function(b){var c=new a;c.deserialize(b,"accAddress");var d=[{property:this._$scope.accInfoModal.elevateProperties.addressInfoList,object:c.addressInfo}];return d},b.prototype.submit=function(){var a=this._$scope.accInfoAddress;a.isLoading=!0,a.submitButtonMessage="Loading";var b=[];for(var c in a.addresses){var d=a.addresses[c];d.sequenceNum===a.selectedIndex+1&&(d.state=a.stateValue||d.state),d.state=d.state||"",b.push(d)}return this._$scope.accInfoModal.submit(this.onAddressDeserialize(b))},b.prototype.onAddressDeleteSerializer=function(a){var b=[{property:this._$scope.accInfoModal.elevateProperties.addressInfoList,object:[a]}];return b},b.prototype.deletionCb=function(a){for(var b=this._$scope.accInfoModal.data.accountInfo.addressInfo,c=0;c<b.length;c++)if(b[c].sequenceNum===a){b.splice(c,1);break}},b.prototype.delete=function(a){var b=this._$scope.accInfoAddress;b.selectedIndex=a;var c=b.addresses[a];return b.isLoading=!0,this._$scope.accInfoModal.submitDeletion(this.onAddressDeleteSerializer(c),this.deletionCb.bind(this))},b.prototype.setDefault=function(a){var b=this._$scope.accInfoAddress;b.selectedIndex=a;for(var c=b.addresses,d=0;d<c.length;d++)c[d].primary=!1;c[a].primary=!0,this.submit()},b.prototype.edit=function(a){var b=this._$scope.accInfoAddress;b.selectedIndex=a,b.data=b.addresses[b.selectedIndex],b.page="edit",this._$singleTimeout(function(){b.fields.addressOne&&b.fields.addressOne.focus()}.bind(this))},b.prototype.add=function(a){var b=this._$scope.accInfoAddress;a||(a={addressType:"HOME"},a.sequenceNum=b.addresses.length+1),b.selectedIndex=b.addresses.length,b.data=a,b.page="edit"},b.prototype.onAddAddress=function(){var a,b=this._$scope.accInfoAddress;"PENDING_SIGNUP_ADDRESS"===b.addresses[0].addressName&&(b.addresses=[]),b.data.state=b.data.state||b.data.stateSelect,b.data.sequenceNum=b.data.sequenceNum||b.addresses.length+1;for(var c=0;c<b.addresses.length;c++)if(b.addresses[c].sequenceNum===b.data.sequenceNum){a=c;break}void 0!==a?b.addresses[c]=b.data:b.addresses.push(b.data),this.submit()},b.prototype.checkFormsAreValid=function(a,b){var c=this._$scope.accInfoAddress;c.isValid=b.valid,b.valid||(c.invalidMessage=b.submitButtonMessage)},b}),c("elevate/controllers/modals/preferences",["common/models/account-info-model"],function(a){"use strict";var b=function(a,b,c,d,e){this._$scope=a,this._utilsService=d,this._$timeout=e,this._$scope.accInfoPreferences={fields:{},data:{},onFormValid:this.onFormValid.bind(this),invalidMessage:"No changes to save",isValid:!1,submit:this.submit.bind(this)};var f=[{name:"Window",value:"Window"},{name:"Other",value:"Other"},{name:"Aisle",value:"Aisle"}],g=a.accInfoModal.data.accountInfo.guestPreference;this._$scope.accInfoPreferences.seatingPreference=f,b.config.get(function(a){var b=[],d=[];for(var e in a.airports){var f=a.airports[e],h=f.name+", "+(f.international?this._utilsService.capitilizeWords(f.country):f.state);b[e]={name:h,value:e}}var i=c.elevate.favoriteDestinations;for(var j in i)d.push({name:i[j],value:i[j]});this._$timeout(function(){this._$scope.accInfoPreferences.fields.homeAirPort.options=b,this._$scope.accInfoPreferences.fields.favoriteDestination.options=d,g&&(this._$scope.accInfoPreferences.fields.homeAirPort.setValue(g.homeAirPort),this._$scope.accInfoPreferences.fields.seatingPreference.setValue(g.seatingPreference),this._$scope.accInfoPreferences.fields.favoriteDestination.setValue(g.favoriteDestination))}.bind(this))}.bind(this))};return b.prototype.onPreferencesDeserialize=function(b){var c=new a;return c.deserialize(b,"accGuestPreference"),[{property:this._$scope.accInfoModal.elevateProperties.guestPreference,object:c.guestPreference}]},b.prototype.submit=function(){return this._$scope.accInfoModal.submit(this.onPreferencesDeserialize(this._$scope.accInfoPreferences.data))},b.prototype.onFormValid=function(a){a.valid||(this._$scope.accInfoPreferences.invalidMessage=a.submitButtonMessage),this._$scope.accInfoPreferences.isValid=a.valid},b.$inject=["$scope","cms","ResourceBundle","utilsService","$timeout"],b}),c("elevate/controllers/modals/communication",[],function(){"use strict";var a=function(a){this._$scope=a,this._$scope.accInfoCommunication={fields:{},data:{},submit:this.onSubmit.bind(this)}};return a.prototype.onSubmit=function(){},a.$inject=["$scope"],a}),c("elevate/controllers/elevate-buy-points",["jquery"],function(a){"use strict";var b=function(a,b,c,d,e){this._$scope=a,this._$modal=b,this._elevateService=c,this._loadingService=d,this._resourceBundle=e,this._forms=["buy","gift","transfer"],a.buyPoints={loggedIn:!1,pointsLogin:this.pointsLogin.bind(this)},a.$watch(c.isLoggedIn,function(b){a.buyPoints.loggedIn=b,b&&this._getSSOData()}.bind(this))};return b.$inject=["$scope","$modal","elevateService","loadingService","ResourceBundle"],b.prototype._getSSOData=function(b,c){this._$scope.buyPoints.btnsDisabled=!0;var d=this._elevateService.getSSOData();b&&this._loadingService.setLoading(d);var e=function(d){this._$scope.buyPoints.authToken=d.data.response.ssoData;for(var e in this._forms)a("#"+this._forms[e]).attr("action",d.data.response.url);this._$scope.buyPoints.btnsDisabled=!1,b&&a("#"+c).submit()}.bind(this),f=function(){};d.then(e,f)},b.prototype.pointsLogin=function(a){var b=this._resourceBundle.modal.fareSignIn,c=this._$scope.$new();c.buyPoints=!0,c.buyPointsAction=a,this._$modal.open({size:b.SIZE,type:b.TYPE,title:b.TITLE,templateUrl:b.TEMPLATE_URL,scope:c,controller:"SignInCtrl",contentType:"form"}).result.then(function(){this._getSSOData(!0,a)}.bind(this))},b}),c("elevate/controllers/modals/credit-card",["moment","jquery","angular","common/models/address-model","common/models/account-info-model"],function(a,b,c,d,e){"use strict";var f=function(b,c,d,e){this._$scope=b,this._resourceBundle=c,this._accessibleService=d,this._$singleTimeout=e,this._$scope.accInfoCreditCard={page:"list",cards:b.accInfoModal.data.accountInfo.creditCardInfo.slice(0),selectedIndex:null,edit:this.edit.bind(this),delete:this.delete.bind(this),setDefault:this.setDefault.bind(this),add:this.add.bind(this),onEditCard:this.onEditCard.bind(this),creditCardType:void 0,isCardReadonly:!1,cardData:{},cardFields:{},cardIsValid:!1,accountAddresses:[],addressData:{},addressFields:{},addressIsValid:!1,addressOption:"use-stored-address",setAddressOption:this.setAddressOption.bind(this),onFormValid:this.checkFormsAreValid.bind(this),isValid:!1,invalidMessage:"No changes to save",submit:this.submitOnAddOrEdit.bind(this),submitButtonMessage:"Submit"};var f=0;for(this._$scope.accInfoCreditCard.months=[],f=0;f<12;f++)this._$scope.accInfoCreditCard.months.push({name:a().month(f).format("MMMM"),value:f+1});for(this._$scope.accInfoCreditCard.years=[],f=0;f<12;f++){var g=a().year()+f;this._$scope.accInfoCreditCard.years.push({name:g,value:g})}this._$scope.$watch("accInfoCreditCard.cardFields.storedAddress.value",this._verifyAddress.bind(this)),this._$scope.$watch("accInfoCreditCard.addressOption",function(a,b){if(a!==b){var c=this._$scope.accInfoCreditCard;c.cardFields.storedAddress.setVisibility("use-stored-address"===a)}}.bind(this))};return f.$inject=["$scope","ResourceBundle","accessibleService","$singleTimeout"],f.prototype._getAddressBySequenceNum=function(a){var b,c=this._$scope.accInfoCreditCard.accountAddresses;for(var d in c)if(a===c[d].sequenceNum){b=c[d];break}return b},f.prototype.setAddressOption=function(a){this._$scope.accInfoCreditCard.addressOption=a,this._accessibleService.setText("Credit card address type "+a+" selected")},f.prototype.add=function(){
this._$scope.accInfoCreditCard.isCardReadonly=!1,this._$scope.accInfoCreditCard.cards.push({}),this._$scope.accInfoCreditCard.selectedIndex=this._$scope.accInfoCreditCard.cards.length-1,this._resetAddressList(),this._$scope.accInfoCreditCard.page="edit"},f.prototype.deletionCb=function(a){for(var b=this._$scope.accInfoModal.data.accountInfo.creditCardInfo,c=0;c<b.length;c++)if(b[c].sequenceNum===a){b.splice(c,1);break}},f.prototype.delete=function(a){var b=this._$scope.accInfoCreditCard;b.selectedIndex=a;var c=this._$scope.accInfoCreditCard.cards[a];return c.identifiedName=c.nickname,c.cardType=c.type,c.changed=!0,this._$scope.accInfoCreditCard.isLoading=!0,this._$scope.accInfoModal.submitDeletion(this.onCreditCardDeleteDeserializer({creditCardInfo:[c]}),this.deletionCb.bind(this))},f.prototype.setDefault=function(a){var b=this._$scope.accInfoCreditCard;b.selectedIndex=a;for(var c=b.cards,d=0;d<c.length;d++)c[d].primary===!0&&(c[d].primary=!1,c[d].sequenceNum=d+1,c[d].identifiedName=c[d].nickname,c[d].cardType=c[d].type,c[d].changed=!0,"number"==typeof c[d].address&&(c[d].address=this._getAddressBySequenceNum(c[d].address)));c[a].primary=!0,c[a].sequenceNum=a+1,c[a].identifiedName=c[a].nickname,c[a].cardType=c[a].type,c[a].changed=!0,this.submit()},f.prototype.edit=function(a){var b=this._$scope.accInfoCreditCard;b.selectedIndex=a,b.isCardReadonly=!0,b.cardData=b.cards[b.selectedIndex].serialize("edit"),b.cardData.storedAddress=b.cardData.mapAddressId;var c=b.cards[b.selectedIndex].addressList[0];this._resetAddressList(c),c&&this._$scope.accInfoCreditCard.accountAddresses.unshift({name:c.addressName,value:c.sequenceNum}),b.addressData=this._getAddressBySequenceNum(b.cardData.mapAddressId),b.page="edit",this._$singleTimeout(function(){b.cardFields.cardholderName&&b.cardFields.cardholderName.focus()}.bind(this))},f.prototype._resetAddressList=function(a){var b=[];this._$scope.accInfoModal.data.accountInfo.addressInfo.forEach(function(d){c.equals(d,a)||b.push({name:d.addressName,value:d.sequenceNum})}),this._$scope.accInfoCreditCard.accountAddresses=b},f.prototype.onEditCard=function(){var a=this._$scope.accInfoCreditCard;a.isCardReadonly=!1;var d,e=a.cardData;"use-stored-address"===a.addressOption?d=a.cardData.storedAddress:(a.addressData.state=a.stateValue,d=0,a.addressData.cardNumber=e.ccNumber,a.billingAddressInfoList=[a.addressData]);var f={ccNumber:e.ccNumber,cardHolderName:e.cardholderName,cardType:(e.ccType||e.type).toUpperCase(),changed:!0,expireMonth:e.expireMonth,expireYear:e.expireYear,identifiedName:e.nickname,mapAddressId:d,sequenceNum:0,primary:!1};b.isPlainObject(a.cards[a.selectedIndex])?a.cards[a.selectedIndex]=f:(c.extend(f,{sequenceNum:a.selectedIndex+1,primary:a.cards[a.selectedIndex].primary}),a.cards[a.selectedIndex].deserialize(f,"edit")),this.submitOnAddOrEdit()},f.prototype.checkFormsAreValid=function(a,b){var c=this._$scope.accInfoCreditCard;this._verifyAddress(),c[a+"IsValid"]=b.valid,c.isValid=c.cardIsValid&&c.addressIsValid,b.isValid||(c.invalidMessage=b.submitButtonMessage)},f.prototype.onCreditCardDeleteDeserializer=function(a){var b=new e;b.deserialize(a,"accCreditCards");var c=[{property:this._$scope.accInfoModal.elevateProperties.creditCardInfoList,object:b.creditCardInfo}];return c},f.prototype.onCreditCardDeserialize=function(a){var b=new e;b.deserialize(a,"accCreditCards");var c=[{property:this._$scope.accInfoModal.elevateProperties.creditCardInfoList,object:b.creditCardInfo},{property:this._$scope.accInfoModal.elevateProperties.billingAddressInfoList,object:b.billingAddressInfo}];return c},f.prototype.submitOnAddOrEdit=function(){var a=this._$scope.accInfoCreditCard;a.isLoading=!0,a.submitButtonMessage="Loading";var b={creditCardInfo:a.cards,billingAddressInfo:a.billingAddressInfoList};this._$scope.accInfoModal.submit(this.onCreditCardDeserialize(b))},f.prototype._verifyAddress=function(){var a=this._$scope.accInfoCreditCard,b="use-stored-address"===a.addressOption,c=a.cardFields.storedAddress;b&&c&&c.value&&c.value.value&&this.updateStoredAddress(this._getAddressBySequenceNum(c.value.value))},f.prototype.updateStoredAddress=function(a){var b=this._$scope.accInfoCreditCard;b.addressData=a||{},b.addressIsValid=!0,b.isValid=b.cardIsValid&&b.addressIsValid},f}),c("elevate/controllers/modals/alerts",["common/models/account-info-model"],function(a){"use strict";var b=function(a,b,c){this._$scope=a,this._$window=b,this._resourceBundle=c,this._$scope.accInfoAlerts={notificationFrequency:this._resourceBundle.flightAlerts.notificationFrequency,isValid:!1,invalidMessage:"No changes to save",isLoading:!1,submitButtonMessage:"Submit",onFormValid:this.checkFormsAreValid.bind(this),unsubscribe:this.unsubscribe.bind(this),submit:this.submit.bind(this),data:a.accInfoModal.data.accountInfo.flightAlert,fields:{}}};return b.$inject=["$scope","$window","ResourceBundle"],b.prototype.onAlertsDeserialize=function(b){var c=new a;c.deserialize(b,"accFlightAlerts");var d=[{property:this._$scope.accInfoModal.elevateProperties.flightAlerts,object:c.flightAlert}];return d},b.prototype.submit=function(a){this._$scope.accInfoAlerts.isLoading=!0,this._$scope.accInfoAlerts.submitButtonMessage="Loading";var b={emailAddress:a.fields.emailAddress.value,smsNumber:a.fields.smsNumber.value,notifyMinutesPriorToEvent:a.fields.notifyMinutesPriorToEvent.value.value,optInValue:!0};this._$scope.accInfoModal.submit(this.onAlertsDeserialize(b))},b.prototype.checkFormsAreValid=function(a){var b=this._$scope.accInfoAlerts;b.isValid=a.valid,a.valid||(b.invalidMessage=a.submitButtonMessage)},b.prototype.unsubscribe=function(){this._$window.location.href="/get-flight-alerts/unsubscribe"},b}),c("elevate/controllers/elevate-shop",[],function(){"use strict";var a=function(a,b){b.setElevateMode(!0),b.setAdvisoryHidden(!0),b.setMinimalLoginUi(!0),a.shopLogin=!0,a.$on("$destroy",function(){b.setElevateMode(!1),b.setAdvisoryHidden(!1),b.setMinimalLoginUi(!1)})};return a.$inject=["$scope","windowService"],a}),c("elevate/directives/accinfo-edit-or-delete",[],function(){"use strict";var a=function(){return{restrict:"A",replace:!0,scope:{isEditable:"=?",isDefault:"=?",onEdit:"&",onDelete:"&",onDefault:"&",labelledby:"="},controller:b,link:c,templateUrl:"/app/elevate/directives/accinfo-edit-or-delete.tpl.html"}},b=function(a,b,c){this._$scope=a,this._$singleTimeout=b,this._resourceBundle=c,this._$scope.editOrDelete={doDelete:this.doDelete.bind(this),cancelDelete:this.cancelDelete.bind(this),isDeleteMode:!1},this._$scope.isAbleToBeDeleted=!0,void 0===this._$scope.isEditable&&(this._$scope.isEditable=!0),void 0===this._$scope.isDefault&&(this._$scope.isDefault=!1),this._$scope.$parent&&this._$scope.$parent.card&&"TRAVELBANK"===this._$scope.$parent.card.type&&(this._$scope.isAbleToBeDeleted=!1),this._$scope.$parent&&this._$scope.$parent.address&&1===this._$scope.$parent.address.sequenceNum&&(this._$scope.isAbleToBeDeleted=!1)};b.$inject=["$scope","$singleTimeout","ResourceBundle"],b.prototype.doDelete=function(){this._$scope.editOrDelete.isDeleteMode=!0,this._$scope.editOrDelete.focusOptions()},b.prototype.cancelDelete=function(){this._$scope.editOrDelete.isDeleteMode=!1,this._$scope.editOrDelete.focusOptions()};var c=function(a,b,c,d){function e(){d._$singleTimeout(function(){var c=a.editOrDelete.isDeleteMode?"delete":"edit",d=b.find(".edit-or-delete__"+c);d.find("a").eq(0).focus()})}a.editOrDelete.focusOptions=e};return a}),c("elevate/controllers/modals/personal-info",["angular","moment","common/models/account-info-model","common/models/elevate-model"],function(a,b,c,d){"use strict";var e=function(a,c,d,e){this._$scope=a,this._$scope.accPersonalInfo={avatarList:e.getRandomAvatarsAll(),genders:d.genders,countries:c.countries,ffPrograms:d.ffPrograms,expiryDateStart:b(),expiryDateEnd:b().add("years",100),fields:{},data:a.accInfoModal.data.serialize("accPersonalInfo"),submit:this.submit.bind(this)}};return e.$inject=["$scope","GeoBundle","ResourceBundle","utilsService"],e.prototype._personalInfoDeserializer=function(a){var b=new d;b.deserialize(a,"accPersonalInfo");var e=new c.AvatarModifyNode({avatar:b.avatar}),f=[];return f.push({property:this._$scope.accInfoModal.elevateProperties.personDetail,object:b.accountInfo.personDetail},{property:this._$scope.accInfoModal.elevateProperties.phoneInfoList,object:b.accountInfo.phoneInfoList},{property:this._$scope.accInfoModal.elevateProperties.emailInfoList,object:b.accountInfo.emailInfoList},{property:this._$scope.accInfoModal.elevateProperties.avatarCode,object:e}),f},e.prototype.submit=function(a){return this._$scope.accInfoModal.submit(this._personalInfoDeserializer(a))},e}),c("elevate/controllers/modals/contact-info",["angular","moment","common/models/elevate-model"],function(a,b,c){"use strict";var d=function(a){this._$scope=a,this._$scope.acctContactInfo={data:a.accInfoModal.data.serialize("accContactInfo"),fields:{},submit:this.submit.bind(this)}};return d.$inject=["$scope"],d.prototype._contactInfoDeserializer=function(a){var b=new c;b.deserialize(a,"accContactInfo");var d=[];return d.push({property:this._$scope.accInfoModal.elevateProperties.phoneInfoList,object:b.accountInfo.phoneInfoList},{property:this._$scope.accInfoModal.elevateProperties.emailInfoList,object:b.accountInfo.emailInfoList}),d},d.prototype.submit=function(a){return this._$scope.accInfoModal.submit(this._contactInfoDeserializer(a))},d}),c("elevate/vx-elevate-app",["angular","elevate/controllers/elevate","elevate/controllers/elevate-login","elevate/controllers/account-info","elevate/controllers/reset-password","elevate/controllers/elevate-landing","elevate/controllers/elevate-activity","elevate/controllers/elevate-credit-card","elevate/controllers/elevate-logout","elevate/controllers/modals/password","elevate/controllers/modals/address","elevate/controllers/modals/preferences","elevate/controllers/modals/communication","elevate/controllers/elevate-buy-points","elevate/controllers/modals/credit-card","elevate/controllers/modals/alerts","elevate/controllers/elevate-shop","elevate/directives/accinfo-edit-or-delete","elevate/controllers/modals/personal-info","elevate/controllers/modals/contact-info"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){"use strict";return a.module("vxElevateApp",[]).controller("ElevateLoginCtrl",c).controller("ElevateCtrl",b).controller("AccountInfoCtrl",d).controller("ResetPasswordCtrl",e).controller("ElevateLandingCtrl",f).controller("ElevateActivityCtrl",g).controller("ElevateCreditCardCtrl",h).controller("ElevateLogoutCtrl",i).controller("AccountInfoPasswordCtrl",j).controller("AccountInfoAddressCtrl",k).controller("AccountInfoPreferencesCtrl",l).controller("AccountInfoCommunicationCtrl",m).controller("ElevateBuyPointsCtrl",n).controller("AccountInfoCreditCardCtrl",o).controller("AccountInfoAlertsCtrl",p).controller("ShopLoginCtrl",q).controller("PersonalInfoCtrl",s).controller("ContactInfoCtrl",t).directive("vxAccinfoEditOrDelete",r)}),c("pnr/directives/pnr-login",[],function(){"use strict";var a=function(){return{restrict:"A",scope:{formContext:"@",isModal:"="},controller:b,templateUrl:"/app/pnr/directives/pnr-login.tpl.html"}},b=function(a,b,c,d,e,f,g,h,i,j,k){this._$scope=a,this._$routeParams=b,this._$modalStack=c,this._$q=d,this._windowService=f,this._pnrService=g,this._statusService=h,this._scrollService=i,this._accessibleService=j,this._pubService=k,this._$scope.pnrService=g,this._$scope.pnrLogin={isModal:!!a.isModal,defaultValues:{lastName:"",ticketNumber:""},lastName:{},submitMessage:"check-in"===a.formContext?"Check In":"View Itinerary",ticketNumber:{},findPNR:this.findPNR.bind(this)},this.validateUrl()};return b.$inject=["$scope","$routeParams","$modalStack","$q","cms","windowService","pnrService","statusService","scrollService","accessibleService","pubSubService"],b.prototype.findPNR=function(){if(this._$scope.pnrLogin.isModal){var a=this._$modalStack.getTop();a&&this._$modalStack.dismiss(a.key,"backdrop click")}var b=this._$scope.pnrLogin.ticketNumber.value,c=this._$scope.pnrLogin.lastName.value,d=this._$scope.pnrLogin.ticketNumber.value;b.length<13&&(b=""),d.length>=13&&(d=""),this._pnrService.findPNR(b,c,d).then(function(){this._pubService.publish("pnr.found"),this._accessibleService.setMostCurrentFocus()}.bind(this))},b.prototype.validateUrl=function(){if(this._$routeParams.pnrCode&&this._$routeParams.lastName){var a=this._$routeParams.pnrCode,b=this._$routeParams.lastName,c=/^[A-Za-z]+$/;c.test(a)&&c.test(b)&&6===a.length&&(this._$scope.pnrLogin.defaultValues.lastName=b,this._$scope.pnrLogin.defaultValues.ticketNumber=a)}},a}),c("pnr/services/pnr",["angular","moment","common/models/pnr-model","common/models/seat-flight-list-model","common/models/selected-fare-model"],function(a,b,c,d,e){"use strict";var f=function(a,b,c,d,e,f,g,h,i,j,k,l,m){this._loginRequestModel={identificationInfo:{ticketNum:"",pnr:"",lastName:""}},this._PNRData=[],this._accountRequestModel={loginID:"",loginPwd:""},this._attachRequestModel={firstName:"",lastName:"",elevatePartner:"",elevateID:"",pnrNumber:""},this._ffProgramsModel={frequentFlyerNum:"",partnerAirline:""},this._checkInBasicRequestModel={checkinInfo:{segList:[],paxList:[]},identificationInfo:null},this._PNRType="",this._currentSection=null,this._$rootScope=a,this._$interpolate=b,this._$q=d,this._api=e,this._cms=f,this._seatService=g,this._$timeout=c,this._statusService=i,this._utilsService=j,this._loadingService=h,this._elevateService=k,this._pubSubService=l,this._resourceBundle=m,this._PNRFound=!1,this._printPNR={};var n={purchase:{path:"purchase",api:"booking"},"check-in":{path:"check-in",api:"checkin"},change:{paths:"change",api:"change"},manage:{path:"change",api:"change"}};return a.$on("$routeChangeSuccess",function(a,b){var c=b.loadedTemplateUrl;if(c)for(var d in n)if(c.indexOf("app/"+d)>-1){this.setPNRType(n[d].api);break}}.bind(this)),this._pnrIsFromTripFinder=!1,{getFFPrograms:this.getFFPrograms.bind(this),getValidFFPrograms:this.getValidFFPrograms.bind(this),getCheckInOpen:this.getCheckInOpen.bind(this),validateFFNumber:this.validateFFNumber.bind(this),setPNRType:this.setPNRType.bind(this),model:this.model.bind(this),attachElevate:this.attachElevate.bind(this),findPNR:this.findPNR.bind(this),setDestinationFlag:this.setDestinationFlag.bind(this),doExpressCheckIn:this.doExpressCheckIn.bind(this),populateWithStubData:this.populateWithStubData.bind(this),getExtraOptions:this.getExtraOptions.bind(this),identificationInfo:this.identificationInfo.bind(this),getAllSegments:this.getAllSegments.bind(this),getFlights:this.getFlights.bind(this),getSeatsByLeg:this.getSeatsByLeg.bind(this),purchase:this.purchase.bind(this),doCompleteCheckIn:this.doCompleteCheckIn.bind(this),doCompleteChange:this.doCompleteChange.bind(this),getPNRFound:this.getPNRFound.bind(this),setPNRFound:this.setPNRFound.bind(this),getTravelers:this.getTravelers.bind(this),setModel:this.setModel.bind(this),getMorePnrInfo:this.pnrHelper.bind(this),retrievePNR:this.retrievePNR.bind(this),reset:this.reset.bind(this),manageComplete:this.manageComplete.bind(this),getTotalSegmentsForPnr:this.getTotalSegmentsForPnr.bind(this),setPnrIsFromTripFinder:this.setPnrIsFromTripFinder.bind(this),pnrIsFromTripFinder:this.pnrIsFromTripFinder.bind(this),getSelectedFares:this.getSelectedFares.bind(this),getFlightList:this.getFlightList.bind(this),setFlightList:this.setFlightList.bind(this)}};return f.$inject=["$rootScope","$interpolate","$timeout","$q","api","cms","seatService","loadingService","statusService","utilsService","elevateService","pubSubService","ResourceBundle"],f.prototype.setFlightList=function(a){this._flightList=a},f.prototype.getFlightList=function(){return this._flightList},f.prototype.getTotalSegmentsForPnr=function(){},f.prototype.setPnrIsFromTripFinder=function(a){this._pnrIsFromTripFinder=a},f.prototype.pnrIsFromTripFinder=function(){return this._pnrIsFromTripFinder},f.prototype.setModel=function(b){a.isArray(b)?this._PNRData=b:this._PNRData=[b],this._loginRequestModel.identificationInfo={pnr:b.pnr,lastName:b.lastName}},f.prototype.identificationInfo=function(){return this._loginRequestModel.identificationInfo},f.prototype.getFFPrograms=function(){return this._resourceBundle.ffPrograms},f.prototype.getValidFFPrograms=function(a){return this._resourceBundle.ffPrograms.filter(function(b){return!b.isElevate||a})},f.prototype.getCheckInOpen=function(){var b=!1;return a.forEach(this.model().flightList,function(a){!b&&a.withinACSWindow&&(b=!0)}),b},f.prototype.getPNRFound=function(){return this._PNRFound},f.prototype.setPNRFound=function(a){this._PNRFound=a},f.prototype.setPNRType=function(a){this._PNRType!==a&&(this._PNRType=a)},f.prototype.model=function(){return this._PNRData},f.prototype.findPNR=function(b,d,e){a.extend(this._loginRequestModel.identificationInfo,{ticketNum:b,lastName:d,pnr:e.toUpperCase()}),""===this._loginRequestModel.identificationInfo.ticketNum?delete this._loginRequestModel.identificationInfo.ticketNum:delete this._loginRequestModel.identificationInfo.pnr;var f=this._$q.defer(),g=this._loginRequestModel;return this._elevateService.isLoggedIn()&&(g.authToken=this._elevateService.getAuthToken()),this._api.manage.findPNR(this._loginRequestModel).then(function(a){var b=a.data.length?a.data[0]:a.data,d=new c;d.deserialize(b.response,"checkin"),this._PNRData=[d],this.setPNRFound(!0),this._pnrIsFromTripFinder=!1,f.resolve(d)}.bind(this)).catch(function(a){this.setPNRFound(!1),f.reject(a)}.bind(this)),this._loadingService.setLoading(f.promise),f.promise},f.prototype.retrievePNR=function(b,d,e){a.extend(this._loginRequestModel.identificationInfo,{ticketNum:b,lastName:d,pnr:e.toUpperCase()}),""===this._loginRequestModel.identificationInfo.ticketNum?delete this._loginRequestModel.identificationInfo.ticketNum:delete this._loginRequestModel.identificationInfo.pnr;var f=this._$q.defer(),g=this._loginRequestModel;return this._elevateService.isLoggedIn()&&(g.authToken=this._elevateService.getAuthToken()),this._api.manage.findPNR(this._loginRequestModel).then(function(a){var b=a.data.length?a.data[0]:a.data,d=new c;d.deserialize(b.response,"checkin"),this.setPNRFound(!0),this._PNRData=[d],this._pnrIsFromTripFinder=!1,f.resolve(d)}.bind(this)).catch(function(a){this.setPNRFound(!1),f.reject(a)}.bind(this)),this._loadingService.setLoading(f.promise),f.promise},f.prototype.getSelectedFares=function(){var b,c=this._PNRData[0],d=[];if(c)return a.forEach(c.flightList,function(a){b=new e,b.deserialize(a,"flightModel",{tier:this._resourceBundle.cabinClassVXToUiMap[a.cabinClass],itineraryType:a.itineraryType}),d.push(b)},this),d},f.prototype.attachElevate=function(a,b,c,d,e){var f=this,g=this._$q.defer();if(this._attachRequestModel.firstName=a,this._attachRequestModel.lastName=b,this._attachRequestModel.ffpAirlineCode=c,this._attachRequestModel.elevateID=d,this._attachRequestModel.pnrNumber=e,this._attachRequestModel.elevateID&&""!==this._attachRequestModel.elevateID){var h=this._api.elevate.attachProfileToPNR(this._attachRequestModel);h.then(function(){for(var c in f._PNRData.paxList){var e=f._PNRData.paxList[c];e.firstName===a&&e.lastName===b&&(e.loyaltyInfo.loyaltyId=d)}var h="Nice! Added "+a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()+"'s Frequent Flyer #.";f.showMessage(h),g.resolve(!0)}),this._loadingService.setLoading(h)}return g.promise},f.prototype.getExtraOptions=function(a){var b=this,c=this._$q.defer();return this._api[b._PNRType].extraOptions(a).then(function(a){c.resolve(a.data.response)}).catch(function(a){c.reject(a)}),c.promise},f.prototype.setDestinationFlag=function(a,b,c){var d;return d="ONE_WAY"!==a.tripType&&(a.flightList[0].destination===b||a.flightList[1].destination===c)},f.prototype.doExpressCheckIn=function(a){var b=this,d=this.getFlightList().origin,e=this.getFlightList().destination,f=this._$q.defer();return this._api[b._PNRType].express(a).then(function(a){var b=new c;b.deserialize(a.data.response,"checkin"),b.isDestinationFlag=this.setDestinationFlag(b,d,e),this._PNRData=[b],f.resolve(a.data.response)}.bind(this)).catch(function(a){f.reject(a)}),f.promise},f.prototype.doCompleteCheckIn=function(a){var b=this._$q.defer(),d=a.oAndDList[0].origin,e=a.oAndDList[0].destination;return this._api[this._PNRType].complete(a).then(function(a){var f=new c;f.deserialize(a.data.response,"checkin"),f.isDestinationFlag=this.setDestinationFlag(f,d,e),this._PNRData=[f],this._pubSubService.publish("newAncillaryDetails",[f.ancillaryDetails]),b.resolve(a.data.response)}.bind(this)).catch(function(a){b.reject(a)}.bind(this)),b.promise},f.prototype.doCompleteChange=function(a){var b=this._$q.defer();return this._api[this._PNRType].complete(a).then(function(a){var d=a.data.response,e=new c;e.deserialize(d,"change"),this._PNRData=[e],this._pubSubService.publish("newAncillaryDetails",[d.ancillaryDetails]),this._pubSubService.publish("refundedAncillaryDetails",[d.origAncillaryDetails]),b.resolve(d)}.bind(this)).catch(function(a){b.reject(a)}.bind(this)),b.promise},f.prototype.validateFFNumber=function(a,b){var c=this._$q.defer();return this._ffProgramsModel.partnerAirline=b,this._ffProgramsModel.frequentFlyerNum=a,this._ffProgramsModel.partnerAirline&&""!==this._ffProgramsModel.partnerAirline&&this._ffProgramsModel.frequentFlyerNum&&""!==this._ffProgramsModel.frequentFlyerNum&&(this._api.elevate.validateFfpNumber(this._ffProgramsModel).then(function(a){a.data.response&&!a.data.response.validFrequentFlyerNum?(c.promise.valid=!1,c.reject(a.data.response)):(c.promise.valid=!0,c.resolve(a.data.response))}).catch(function(a){c.reject(a)}),this._loadingService.setLoading(c.promise)),c.promise},f.prototype.showMessage=function(a,b){this._statusService.setStatus({format:b?b:this._statusService.format.SUCCESS,copy:{DESC:a}})},f.prototype.getAllSegments=function(b){var c=this._PNRData[b||0],d=[];return a.forEach(c.flightList,function(a){d=d.concat(a.segments)}),d},f.prototype.getFlights=function(a,b){var c=this._$q.defer(),d=this._PNRData[a||0];return d?c.resolve(d.flightList):c.reject(),b?c.promise:d.flightList},f.prototype.getSeatsByLeg=function(b,c,d){var e=[],f=this._PNRData[d||0];return a.forEach(b,function(a,b){var c;c="MC"===b.cabinType?"main":b.cabinType.toLowerCase();var d={cabinType:c,departure:b.departure,arrival:b.arrival,seats:[]};if(f&&f.seatList)for(var g=0,h=f.seatList.length;g<h;g++){var i=f.seatList[g];if(b.flightNum===i.flightNum){for(var j in a)a[j].guestId===i.guestId&&(i.travelerGuid=a[j].guid);d.seats.push(i)}}e.push(d)}.bind(this,c)),e},f.prototype.purchase=function(a){var b=this._$q.defer();return this._api[this._PNRType].purchase(a).then(function(a){b.resolve(a.data);var d=new c;d.deserialize(a.data.response,"purchase"),this._pubSubService.publish("newAncillaryDetails",[d.ancillaryDetails]),this._PNRData=[d],this.setPNRFound(!0)}.bind(this)).catch(function(a){b.reject(a),this.setPNRFound(!1)}.bind(this)),b.promise},f.prototype.getTravelers=function(b){this._travelerList=[];var c=this._PNRData[b||0];return a.forEach(c.paxList,function(b){var d={firstName:b.firstName,lastName:b.lastName,name:b.firstName+" "+b.lastName,guestId:b.guestId,ff:b.frequentFlyer,seats:[]};a.forEach(this.getAllSegments(),function(b){a.forEach(c.seatList,function(a){if(a.guestId===d.guestId){var c={flightId:b.flightId,flightNum:b.flightNum,seatType:this._seatService.getSeatType(a),seatNumber:a.seatNum,mce:a.mce};d.seats.push(c)}}.bind(this))}.bind(this)),this._travelerList.push(d)}.bind(this)),this._travelerList},f.prototype.manageComplete=function(a){var b=this._$q.defer();return this._api.manage.complete(a).then(function(a){b.resolve(a.data);var d=a.data.response,e=new c;e.deserialize(d,"change"),this._PNRData=[e],this._pubSubService.publish("newAncillaryDetails",[d.ancillaryDetails]),this._pubSubService.publish("refundedAncillaryDetails",[d.origAncillaryDetails])}.bind(this)).catch(function(a){b.reject(a)}.bind(this)),b.promise},f.prototype.pnrHelper=function(c){var d=this,e=[];a.forEach(c.flightList,function(a){e.push(a.departureDateTime),e.push(a.arrivalDateTime)});var f=d._utilsService.formatDates(e,!0);c.flightList[0].departureDateFormats=f[0],c.flightList[0].arrivalDateFormats=f[1],c.flightList[1]&&(c.flightList[1].departureDateFormats=f[2],c.flightList[1].arrivalDateFormats=f[3]);var g=!1,h=!1,i=!0,j=!1,k=!1,l=!1;if(!c.isSummary){var m=[];a.forEach(c.flightList,function(a){m.push(a.origin),m.push(a.destination)}),d._cms.getAirportNames(m).then(function(a){c.flightList.forEach(function(b){b.originName=a[b.origin],b.destinationName=a[b.destination]})}),a.forEach(c.flightList,function(b){b.segments&&b.segments.length&&(b.cabinType=b.segments[0].cabinType,b.cabinLabel=d._utilsService.getCabinTypeLabel(b.segments[0].cabinType),a.forEach(b.segments,function(a){a.cabinType=a.cabinType,a.cabinLabel=d._utilsService.getCabinTypeLabel(a.cabinType)}))});var n=new Date;a.forEach(c.flightList,function(a){a.shipHasSailed=!!a.departureDateFormats&&b(n).isAfter(a.departureDateFormats.moment),"ELIGIBLE"===a.checkInEligibility&&!a.shipHasSailed&&a.segments&&a.segments.length&&a.segments[0].withinACSWindow&&(h=!0),"NOT_ELIGIBLE_FIRST_SEG_PARTNER_AIRLINE"===a.checkInEligibility&&(h=!0),"ELIGIBLE"!==a.changeEligibility&&(i=!1),"ELIGIBLE"===a.changeSeatEligibility&&(j=!0),"ELIGIBLE"===a.cancelEligibility&&(l=!0),"ELIGIBLE"===a.manageExtrasEligibility&&(k=!0)});var o={};a.forEach(c.paxList,function(a){o[a.guestId]={},a.fullName=a.firstName+" "+a.lastName,a.loyaltyProgramName=d._utilsService.getFFProgramName(a.loyaltyProgram,!0)}),a.forEach(c.seatList,function(a){o[a.guestId][a.flightId]=a.seatNum});var p=[];a.forEach(c.flightList,function(b){var c=[];a.forEach(b.segments,function(a){c.push(a.flightId)}),p.push(c)});var q=function(b,c){var d=[];return a.forEach(p[c],function(a){d.push(o[b.guestId][a]||"NA")}),d};a.forEach(c.paxList,function(a){a.departingSeats=q(a,0),a.returnSeats=q(a,1)});var r=0,s=0;a.forEach(c.paxList,function(a){"ADULT"===a.paxType||"ADULT_WITH_INFANT"===a.paxType||"CHILD"===a.paxType?r++:s++}),c.payingTravelers=r,c.infantsTraveling=s,a.forEach(c.paxList,function(b){var d=0;a.forEach(c.flightList,function(c){a.forEach(c.pointsList,function(a){a.guestId===b.guestId&&(d+=a.points)})}),b.pointsEarned=d})}if(c.extraPaymentInfo&&c.extraPaymentInfo.petFee){var t=c.extraPaymentInfo.petFee;t.oandDList&&t.oandDList.length&&a.extend(c,{petAmount:t.oandDList[0].paxList.length})}return g="ONE_WAY"===c.tripType,a.extend(c,{availableForCheckIn:h,dateString:d._utilsService.getTripDatesString(f,g),isMultiCity:"MULTI_CITY"===c.tripType,isOneWay:g,isRoundTrip:"ROUND_TRIP"===c.tripType,tripAvailableForChange:i,tripAvailableForChangeSeat:j,tripAvailableForCancel:l,tripAvailableForManageExtras:k,tripTypeLabel:d._utilsService.getTripTypeLabel(c.tripType)}),c},f.prototype.reset=function(){this._PNRData=[],this._PNRFound=!1},f.prototype.populateWithStubData=function(){var a={pnrInfo:{lastName:"Larson",pnr:"KVSYNX",international:!1,pnrCreatedWithin24hrs:!0,creationDate:"2015-12-21T11:16:00-06:00",tripType:"ROUND_TRIP",pointsRedeemed:0,adultWihtLapInfantCount:0,petc:!1,pointsBooking:!1,gdsBooking:!1,interlinePnr:!1,outOfSyncPnr:!1,unAccompaniedMinor:!1,irop:!1,nonRevenue:!1,paxList:[{firstName:"JENNY",lastName:"LARSON",guestId:"01.01",paxType:"ADULT",dob:"1971-04-10",gender:"FEMALE",ticketNum:"9842144458797",loyaltyInfo:{loyaltyProgram:"VIRGIN_AMERICA",loyaltyId:"90891234786",tierLevel:"GOLD"},redressNum:"999888777666",freeBagAllowance:3}],pnrFareInfo:{fareInformation:{adultFare:{taxListPerPax:[{taxCode:"US1",taxAmount:37.8},{taxCode:"ZP",taxAmount:12},{taxCode:"XF",taxAmount:13.5},{taxCode:"AY",taxAmount:11.2}],adultBaseFarePerPax:503.96,fareBasisCode:"U7QNR",numOfPax:1,adultTaxPerPax:74.5,adultFarePerPax:578.46,totalAdultFare:578.46},totalBaseFare:503.96,totalTax:74.5,totalFare:578.46},pnrTotalCost:578.46},paymentInfo:{paymentInfo:{ccNumber:"XXXXXXXXXXXX1111",cardType:"VISA",cardHolderName:"JEN",transactionTime:"2015-12-21T00:00:00",amountCharged:578.46}},oAndDList:[{flightSeg:{flightId:1,arrivalDateTime:"2016-04-01T15:35:00-05:00",departureDateTime:"2016-04-01T07:00:00-08:00",flightNum:"0012",classOfService:"U",cabinClass:"MC_NONREFUNDABLE",cabinType:"MC",segNum:1,status:"HK",aircraftType:"A320",marketingAirline:"VIRGIN_AMERICA",departure:"SFO",arrival:"JFK",withinACSWindow:!1,flownSegment:!1,fareBasisCode:"U7QNR",cancelled:!1,thruFlight:!1},origin:"SFO",destination:"JFK",oAndDId:"IP1",itineraryType:"OUTBOUND",hasLoungePass:!1,pointsInfo:{pointsList:[{points:3200,ticketNumber:9842144458797,guestId:"01.01"}]}},{connectingFlightList:[{flightSeg:{flightId:2,arrivalDateTime:"2016-04-08T10:15:00-08:00",departureDateTime:"2016-04-08T07:00:00-05:00",flightNum:"0399",classOfService:"S",cabinClass:"MC_NONREFUNDABLE",cabinType:"MC",segNum:2,status:"HK",aircraftType:"A320",marketingAirline:"VIRGIN_AMERICA",departure:"JFK",arrival:"LAX",withinACSWindow:!1,flownSegment:!1,fareBasisCode:"S21NR",cancelled:!1,thruFlight:!1},origin:"JFK",destination:"LAX",hasLoungePass:!1},{flightSeg:{flightId:3,arrivalDateTime:"2016-04-08T12:25:00-08:00",departureDateTime:"2016-04-08T11:10:00-08:00",flightNum:"0927",classOfService:"S",cabinClass:"MC_NONREFUNDABLE",cabinType:"MC",segNum:3,status:"HK",aircraftType:"A320",marketingAirline:"VIRGIN_AMERICA",departure:"LAX",arrival:"SFO",withinACSWindow:!1,flownSegment:!1,fareBasisCode:"S21NR",cancelled:!1,thruFlight:!1},origin:"LAX",destination:"SFO",hasLoungePass:!1}],origin:"JFK",destination:"SFO",oAndDId:"IP2",itineraryType:"INBOUND",hasLoungePass:!1,pointsInfo:{pointsList:[{points:1710,ticketNumber:9842144458797,guestId:"01.01"}]}}],contact:{email:"JENNYP6@VX.COM",phone:{phoneNumber:"3038679309",phoneType:"HOME"}},addressInfo:{addressOne:"1234 TEST STREETS",city:"SAN FRANCISCO",state:"CA",country:"US",zipCode:"12345"},seatInfoList:[{seat:{seatNumber:"4A",seatLetter:"A",cabinType:"MC",open:!1,exitRow:!1,nonRecline:!1,aisle:!1,window:!0,middle:!1,petAllowed:!0,infantAllowed:!0,paxPriceMap:{}},guestId:"01.01",flightNum:"0012",flightId:1,chargeable:!1},{seat:{seatNumber:"4A",seatLetter:"A",cabinType:"MC",open:!1,exitRow:!1,nonRecline:!1,aisle:!1,window:!0,middle:!1,petAllowed:!0,infantAllowed:!0,paxPriceMap:{}},guestId:"01.01",flightNum:"0399",flightId:2,chargeable:!1},{seat:{seatNumber:"4A",seatLetter:"A",cabinType:"MC",open:!1,exitRow:!1,nonRecline:!1,aisle:!1,window:!0,middle:!1,petAllowed:!0,infantAllowed:!0,paxPriceMap:{}},guestId:"01.01",flightNum:"0927",flightId:3,chargeable:!1}],priceSummaryInfo:{total:578.46,totalExtras:0,totalBaseFareAndExtras:503.96,totalBaseFare:503.96,totalFare:578.46,totalTax:74.5,numOfPax:1}}},b=new c;b.deserialize(a,"checkin"),this._PNRData=[b]},f}),c("pnr/vx-pnr-app",["angular","pnr/directives/pnr-login","pnr/services/pnr"],function(a,b,c){"use strict";return a.module("vxPNRApp",[]).directive("vxPnrLoginForm",b).service("pnrService",c)}),c("cancel/controllers/cancel",["moment"],function(a){"use strict";var b=function(b,c,d,e,f,g,h,i,j,k){this._$scope=b,this._$modal=c,this._resourceBundle=d,this._cancelService=e,this._scrollService=f,this._locationService=g,this._elevateService=h,this._pnrService=i,this._loadingService=k,this._$scope.cancel={pnr:e.getPnrModel(),cancelFlight:this.cancelFlight.bind(this),shouldUserPayForCancel:this.shouldUserPayForCancel.bind(this),totalPassengers:1,trip:null,moment:a},this._$scope.ResourceBundle=d,this._$scope.taxNameByCode=j.taxNameByCode,this._locationService.setContext(this._locationService.contexts.CANCEL),this._scrollService.go("top",{duration:0}),this.requestQuote()};return b.$inject=["$scope","$modal","ResourceBundle","cancelService","scrollService","locationService","elevateService","pnrService","utilsService","loadingService"],b.prototype.requestQuote=function(){var a=[];if(this._$scope.cancel.pnr){var b=this._$scope.cancel.pnr.flightList;for(var c in b)"ELIGIBLE"===b[c].cancelEligibility&&a.push(b[c].flightId);var d=this._cancelService.requestQuote(a);this._loadingService.setLoading(d),
d.then(function(a){this._$scope.cancel.refundData=a,this._$scope.cancel.pnr&&(this._$scope.cancel.totalPassengers=this._$scope.cancel.pnr.payingTravelers)}.bind(this))}},b.prototype.shouldUserPayForCancel=function(){var a=this._$scope.cancel.refundData;if(a){var b=a.cancelFee>0,c=!(a.refundAmount>0),d=a.pointsAmount&&!a.pnrCreatedWithin24hrs;return b&&(c||d)}},b.prototype.cancelFlight=function(){var a=function(){var a=this._cancelService.cancelFlight(),b=this;this._loadingService.setLoading(a),a.then(function(){b._locationService.go({target:"/success"})}.bind(this))}.bind(this);if(this._cancelService.isItInRefundableWindow()&&this._cancelService.isItIropedAndInRefundableWindow()){var b=this._cancelService.isItIropedAndInRefundableWindow()?this._resourceBundle.modal.refundableFaresNotice.TEMPLATE_URL:this._resourceBundle.modal.iropCancelNotice.TEMPLATE_URL,c=this._cancelService.isItIropedAndInRefundableWindow()?this._resourceBundle.modal.refundableFaresNotice.TITLE:this._resourceBundle.modal.iropCancelNotice.TITLE,d=this._$scope.$new();this._pnrService.setModel(this._cancelService.getPnrModel()),d.user={email:this._cancelService.getPnrModel().contact.email,name:this._pnrService.getTravelers()[0].name},this._$modal.open({controller:["$scope",function(b){b.accept=function(){this.$parent.$close("accepted"),a()},b.dismiss=function(){this.$parent.$close("dismissed")}}],size:this._resourceBundle.modal.refundableFaresNotice.SIZE,scope:d,title:c,templateUrl:b})}else this.shouldUserPayForCancel()?this._locationService.go({target:"/purchase"}):a()},b}),c("common/models/change-quote-model",["angular","common/models/quote-model","common/models/fare-model","common/models/seat-flight-list-model"],function(a,b,c,d){"use strict";var e=function(a){this.init(a)};return e.prototype=new b,e.prototype._schema={type:"object",properties:{type:{type:"string"},typeOfChange:{type:"string"},exchangeType:{type:"string",optional:!0},paymentType:{type:"string",optional:!0},changeFee:{type:"number",optional:!0},cancelFee:{type:"number",optional:!0},totalAmount:{type:"number"},pointsAmount:{type:"number"},pnrCreatedWithin24hrs:{type:"boolean"},originalFareInfo:"#/definitions/FareModel",newFareInfo:"#/definitions/FareModel",paxList:{type:"array",items:{firstName:{type:"string"},lastName:{type:"string"},guestId:{type:"string"},ticketNum:{type:"string"}}},extraRefundAmount:{type:"number"},refundAmount:{type:"number"},newFlightSegmentsList:{type:"array",items:{flightNum:{type:"string"},departure:{type:"string"},arrival:{type:"string"},departureDateTime:{type:"string"},aircraftType:{type:"string"},classOfService:{type:"string"}}},seatInfoList:"#/definitions/SeatFlightListModel"}},e.prototype._changeDeserializer=function(b,e){if(e.type=b.exchangeType,e.typeOfChange=b.typeOfChange,b.changeFee?e.changeFee=b.changeFee:b.cancelFee&&(e.cancelFee=b.cancelFee),e.totalAmount=b.totalAmount,e.pnrCreatedWithin24hrs=b.pnrCreatedWithin24hrs,e.originalFareInfo=new c,e.originalFareInfo.deserialize(b.originalFareInfo,"fare"),e.newFareInfo=new c,e.newFareInfo.deserialize(b.newFareInfo,"fare"),e.extraRefundAmount=b.totalMsrRefundAmount,e.refundAmount=b.refundAmount||0,e.paymentAmount=b.paymentAmount||0,e.paxList=[],e.newFlightSegmentsList=[],e.paymentType=b.paymentType,e.exchangeType=b.exchangeType,a.forEach(b.paxList,function(a){e.paxList.push(a)}),a.forEach(b.newFlightSegmentsList,function(a){e.newFlightSegmentsList.push(a)}),b.seatInfoList){var f=new d;f.deserialize(b.seatInfoList,"seatInfoList"),e.seatInfoList=f.seatFlightList}b.pointsAmount&&(e.pointsAmount=b.pointsAmount)},e.prototype._customDeserializers={change:e.prototype._changeDeserializer},e}),c("cancel/services/cancel",["angular","common/models/change-quote-model"],function(a,b){"use strict";var c=function(a,b,c,d){return this._$q=a,this._api=b,this._pnrService=c,this._elevateService=d,this._pnr=null,this._refundTypes={TRAVEL_BANK:"TRAVELBANK",ORIGINAL:"ORIGINAL_FORM_OF_PAYMENT"},this._successPageData={paymentType:null,creditCardNumber:null,refundAmount:null,travelBankAccountNum:null},this._basicCancelRequest={identificationInfo:{pnr:null,lastName:null,elevateId:null},changeAndCancelInfo:{exchangingFlightIdList:[]}},this._quoteModel=null,{cancelFlight:this.cancelFlight.bind(this),requestQuote:this.requestQuote.bind(this),getQuoteModel:this.getQuoteModel.bind(this),setPnrModel:this.setPnrModel.bind(this),getPnrModel:this.getPnrModel.bind(this),setPnr:this.setPnr.bind(this),getPnr:this.getPnr.bind(this),getSuccessPageData:this.getSuccessPageData.bind(this),isItInRefundableWindow:this.isItInRefundableWindow.bind(this),isItIropedAndInRefundableWindow:this.isItIropedAndInRefundableWindow.bind(this)}};return c.$inject=["$q","api","pnrService","elevateService"],c.prototype.getSuccessPageData=function(){return this._successPageData},c.prototype.setPnrModel=function(a){this._pnrModel=a},c.prototype.getPnrModel=function(){return this._pnrModel},c.prototype.setPnr=function(a){this._pnr=a},c.prototype.getPnr=function(){return this._pnr},c.prototype.getQuoteModel=function(){return this._quoteModel},c.prototype._buildRequestQuoteRequest=function(a){return this._basicCancelRequest.identificationInfo={pnr:this._pnrModel.pnr,lastName:this._pnrModel.paxList[0].lastName},this._basicCancelRequest.changeAndCancelInfo={exchangingFlightIdList:a},this._pnrModel.irop?this._basicCancelRequest.changeAndCancelInfo.refundType=this._pnrModel.pnrCreatedWithin24hrs?this._refundTypes.ORIGINAL:this._refundTypes.TRAVEL_BANK:this._basicCancelRequest.changeAndCancelInfo.refundType=this._refundTypes.ORIGINAL,this._elevateService.isLoggedIn()&&(this._basicCancelRequest.authToken=this._elevateService.getAuthToken()),this._basicCancelRequest},c.prototype.requestQuote=function(a){var c=this,d=this._$q.defer();return this._api.cancel.requestQuote(this._buildRequestQuoteRequest(a)).then(function(a){a.data.response?(c._basicCancelRequest.changeAndCancelInfo.totalRefundAmount=a.data.response.refundAmount,a.data.response.paxList&&a.data.response.paxList[0]&&a.data.response.paxList[0].loyaltyInfo&&a.data.response.paxList[0].loyaltyInfo.loyaltyId&&(c._basicCancelRequest.identificationInfo.elevateId=a.data.response.paxList[0].loyaltyInfo.loyaltyId),c._quoteModel=new b,c._quoteModel.deserialize(a.data.response,"change"),d.resolve(a.data.response)):d.reject()},function(){d.reject()}),d.promise},c.prototype.isItIropedAndInRefundableWindow=function(){return!this._pnrModel.pnrCreatedWithin24hrs&&this._pnrModel.irop},c.prototype.isItInRefundableWindow=function(){var a=!1;for(var b in this._pnrModel.flightList)a=a||this._pnrModel.flightList[b].cabinClass.indexOf("_REFUNDABLE")>-1;return!this._pnrModel.pnrCreatedWithin24hrs&&a},c.prototype.cancelFlight=function(b){var c=this._$q.defer(),d=a.copy(this._basicCancelRequest);return b&&(d.paymentInfo=b),this._api.cancel.complete(d).then(function(a){a.data.response?(this._successPageData.refundAmount=a.data.response.refundAmount,this._successPageData.paymentType=a.data.response.paymentType,this._successPageData.creditCardNumber=null,this._successPageData.travelBankAccountNum=null,a.data.response.travelBankAccountNum&&(this._successPageData.travelBankAccountNum=a.data.response.travelBankAccountNum,this._successPageData.tbAmountRefunded=a.data.response.tbAmountRefunded),a.data.response.creditCardNum&&(this._successPageData.creditCardNumber=a.data.response.creditCardNum.replace(new RegExp("X","g"),""),this._successPageData.ccAmountRefunded=a.data.response.ccAmountRefunded),this._successPageData.totalMsrRefundAmount=a.data.response.totalMsrRefundAmount,this._successPageData.pointsAmount=a.data.response.pointsAmount,c.resolve(!0)):c.reject()}.bind(this),function(){c.reject()}),c.promise},c}),c("cancel/vx-cancel-app",["angular","cancel/controllers/cancel","cancel/services/cancel"],function(a,b,c){"use strict";return a.module("vxCancelApp",[]).controller("CancelCtrl",b).service("cancelService",c)}),c("flight-status/controllers/flight-status",["content/constants/content-bundle","angular","jquery","moment"],function(a,b,c,d){"use strict";var e=function(b,c,e,f,g,h,i,j,k,l,m,n,o){this._$scope=b,this._$modal=c,this._$modalStack=e,this._$singleTimeout=f,this._flightStatusService=h,this._scrollService=i,this._loadingService=j,this._utilsService=k,this._flightPerformanceService=l,this._statusService=m,this._accessibleService=n,this._resourceBundle=o,this._contentBundle=a,g.config.get(function(a){this._config=a,this.buildDepartingAirportsList(this._config.airports)}.bind(this)),this._request={cityPairs:{flightDate:"",origin:"",dest:""},flightNumber:{flightDate:"",flightNumber:""}},this._lists={departing:[],arriving:[]},this._statusMap={ON_TIME:"On Time",DELAYED:"Delayed",CANCELLED:"Cancelled",ARRIVED:"Arrived",IN_FLIGHT:"In-flight",EARLY:"Early"},this._days=[{name:"Yesterday",date:d().subtract("days",1).format("MMM Do"),value:d().subtract("days",1).format("YYYY-MM-DD")},{name:"Today",date:d().format("MMM Do"),value:d().format("YYYY-MM-DD")},{name:"Tomorrow",date:d().add("days",1).format("MMM Do"),value:d().add("days",1).format("YYYY-MM-DD")}],this._$scope.flightStatus={days:this._days,dateSelected:this._days[1],departing:[],departingSelected:null,arriving:[],arrivingSelected:null,selectView:"cityPairs",changeView:this.changeView.bind(this),toggleFlightStatus:this.toggleFlightStatus.bind(this),selectDate:this.selectDate.bind(this),selectAirport:this.selectAirport.bind(this),checkStatus:this.checkStatus.bind(this),fields:{},data:{},filter:"all-flights",allFlights:null,fareLabel:this.fareLabel.bind(this),openFlightPerfModal:this.openFlightPerfModal.bind(this),openFlightDetailsModal:this.openFlightDetailsModal.bind(this),tailNumberRequest:this.tailNumberRequest.bind(this),reqArrivingFlightDetails:this.reqArrivingFlightDetails.bind(this),statusMap:this._statusMap},this._scrollService.go("top",{duration:0}),this._$singleTimeout(this.selectDate.bind(this,this._days[1]))};return e.$inject=["$scope","$modal","$modalStack","$singleTimeout","cms","flightStatusService","scrollService","loadingService","utilsService","flightPerformanceService","statusService","accessibleService","ResourceBundle"],e.prototype.buildDepartingAirportsList=function(a){for(var c in a){var d=a[c];d.code=c,d.asCity?delete this._config.airports[c]:this._lists.departing.push(d)}var e=this._utilsService.sortListByName(this._lists.departing);b.extend(this._$scope.flightStatus,{departing:e,arriving:e})},e.prototype._testRequestStatus=function(){var a=this._request[this._$scope.flightStatus.selectView],c=!0;b.forEach(a,function(a){a.length||(c=!1)}),c&&this._sendRequest(a)},e.prototype._sendRequest=function(a){var b=this._flightStatusService.flightStatus(a);this._loadingService.setLoading(b),b.then(function(a){"SUCCESS"===a.status.status?this._successHandler(a):this._errorHandler()}.bind(this),function(){this._errorHandler()}.bind(this))},e.prototype._sendTailNumberRequest=function(a,b){var c=this._flightStatusService.tailNumberInfo(a);this._loadingService.setLoading(c),c.then(function(a){"SUCCESS"===a.status.status?this._successTailNumberHandler(a,b):this._errorHandler()}.bind(this),function(){this._errorHandler()}.bind(this))},e.prototype._successHandler=function(a){var b=a.response.flightStatusList;(0===Object.getOwnPropertyNames(b).length||b==={})&&this._statusService.setAlert({format:this._statusService.format.ERROR,copy:this._resourceBundle.statusMessages.flightStatus.noFlights,sticky:!1,recoverable:!0,controls:{close:!1,hide:"got it"}});var c=b.NON_STOP||[],d=b.THRU||[],e=b.CONNECTING||[],f=e.concat(d),g=c.concat(f);this._$scope.flightStatus.allFlights=g,this._scrollService.go("flight-status-results",{duration:350,offset:-54}),this._$singleTimeout(this._accessibleService.setFocus.bind(this,"#flight-status-results"))},e.prototype._successTailNumberHandler=function(a,b){this.openFlightDetailsModal(a,b)},e.prototype._errorHandler=function(){this._$scope.flightStatus.allFlights=null,this._scrollService.go("top",{duration:350})},e.prototype._sortFlights=function(a){return a.sort(function(a,b){return a.flightInfoList[0].departureInfo.scheduledDeparture>b.flightInfoList[0].departureInfo.scheduledDeparture?1:a.flightInfoList[0].departureInfo.scheduledDeparture<b.flightInfoList[0].departureInfo.scheduledDeparture?-1:0}),a},e.prototype.changeView=function(a){"flightNumber"===a&&b.forEach(this._$scope.flightStatus.fields,function(a){a.isVisible=!0}),this._$scope.flightStatus.selectView=a},e.prototype.toggleFlightStatus=function(a){this._$scope.flightStatus.filter=a,this._accessibleService.setText("Flight status results filtered to "+a)},e.prototype.selectDate=function(a){if(a){if("Yesterday"===a.name)return this._$scope.flightStatus.changeView("flightNumber"),this._$scope.flightStatus.dateSelected=null,this._$scope.flightStatus.fields.dateAlt.isValid=!0,this._$scope.flightStatus.fields.dateAlt.value=this._$scope.flightStatus.days[0],this._$singleTimeout(function(){c(".flight-status-select").trigger("render.customSelect")}),void 0;var b=this._request[this._$scope.flightStatus.selectView];b.flightDate=a.value,this._testRequestStatus()}},e.prototype.selectAirport=function(a,d){var e=d?"arriving":"departing",f=d?"origin":"dest",g=this._request[this._$scope.flightStatus.selectView];if(g[f]=a.code,d){this._request.cityPairs.dest="",this._$scope.flightStatus.arrivingSelected=null,c("#arriving-select").next(".flight-status-select").find(".custom-selectInner").text("To");var h=this._config.airportMapping[a.code];if(this._lists={departing:[],arriving:[]},b.isObject(h)&&b.isObject(h.to)&&b.isObject(h.to))for(var i in h.to){var j=this._config.airports[i];b.isObject(j)&&(j.code=i,this._lists[e].push(j))}this._$scope.flightStatus[e]=this._utilsService.sortListByName(this._lists[e])}else this._testRequestStatus()},e.prototype.checkStatus=function(){var a=this._request[this._$scope.flightStatus.selectView],b=this._$scope.flightStatus.fields;a.flightDate=this._$scope.flightStatus.dateAltSelected=b.dateAlt.value.value,a.flightNumber=this._$scope.flightStatus.flightNumSelected=b.flightNum.value.replace(/\D/g,""),this._sendRequest(a)},e.prototype.fareLabel=function(a,b){var c=0===b?"1st Leg ":"2nd Leg ";return c+"("+a+")"},e.prototype.openFlightPerfModal=function(a,c,d,e){var f=this._$scope.$new(),g=b.copy(this._contentBundle.contentMap.FLIGHT_PERFORMANCE),h=this._contentBundle.contentMap.FLIGHT_PERFORMANCE_ERROR,i=this._flightPerformanceService.getFlightPerformance(a,c,d);i.always(function(c){b.isObject(c)?(g.title=this._$modal.interpolate(g.title,{flightNum:a}),f.perf=c,g.scope=f,g.origin=e.currentTarget,this._$modal.open(g)):this._$modal.open(h)}.bind(this))},e.prototype.tailNumberRequest=function(a){var b={};b.tailNumber=a.tailNumber.trim(),b.flightNumber=a.flightNum,b.flightDate=a.flightDate,""!==b.tailNumber?this._sendTailNumberRequest(b,a):this.openFlightDetailsModal(b,a)},e.prototype.openFlightDetailsModal=function(a,b){var c=this._$scope.$new(),d=a;d.response&&(d=d.response),c.flightDetails={flightNum:b.flightNum,tailNum:d.tailNumber||"TBD",arrivingFrom:d.airportCity,arrivingFlightNum:d.flightNumber,flightDate:d.flightDate};var e=this._resourceBundle.modal.flightDetails,f={contentType:e.TYPE,size:e.SIZE,scope:c,title:e.TITLE,templateUrl:e.TEMPLATE_URL},g=this._$modal.open(f);g.result.then(null,function(a){a.$destroy()}.bind(null,c))},e.prototype.reqArrivingFlightDetails=function(a){var b=this._$modalStack.getTop();b.key.close();var c={flightDate:a.flightDate,flightNumber:a.arrivingFlightNum};this._sendRequest(c)},e}),c("common/models/flightstatus-model",["common/models/serial-model"],function(a){"use strict";var b=function(a){this.init(a)};return b.prototype=new a,b.prototype._flightInfoItemSchema={type:"object",properties:{aircraftType:{type:"string"},arrivalInfo:{actualArrival:{type:"string"},arrivalGate:{type:"string"},arrivalTerminal:{type:"string"},estimatedArrival:{type:"string"},intoGate:{type:"string"},onGround:{type:"string"},scheduledArrival:{type:"string"}},departureInfo:{actualDeparture:{type:"string"},departureGate:{type:"string"},estimatedDeparture:{type:"string"},offGround:{type:"string"},outOfGate:{type:"string"},scheduledDeparture:{type:"string"}},dest:{type:"string"},flifoResultIndex:0,flightDate:{type:"string"},flightNum:{type:"string"},flightStatus:{type:"string"},flightType:{type:"string"},lastUpdateDateTime:{type:"string"},locUpdateDateTime:{type:"string"},nextDayIndicator:!1,origin:{type:"string"}}},b.prototype._schema={type:"object",properties:{connecting:{type:"array",items:{flightInfoList:{type:"array",items:b.prototype._flightInfoItemSchema}},optional:!0},nonStop:{type:"array",items:{flightInfoList:{type:"array",items:b.prototype._flightInfoItemSchema}},optional:!0},thru:{type:"array",items:{flightInfoList:{type:"array",items:b.prototype._flightInfoItemSchema}},optional:!0}}},b.prototype._customDeserializers={flightStatus:function(a,b){var c=a.flightStatusList;c.CONNECTING&&(b.connecting=c.CONNECTING),c.NON_STOP&&(b.nonStop=c.NON_STOP),c.THRU&&(b.thru=c.THRU)}},b}),c("common/models/tailnumberinfo-model",["common/models/serial-model"],function(a){"use strict";var b=function(a){this.init(a)};return b.prototype=new a,b.prototype._schema={type:"object",properties:{tailNumber:{type:"string"},flightNumber:{type:"string"},airportCity:{type:"string"},flightDate:{type:"string"}}},b.prototype._customDeserializers={tailNumberInfo:function(a,b){$.extend(b,{tailNumber:a.tailNumber,flightNumber:a.flightNumber,airportCity:a.airportCity,flightDate:a.flightDate})}},b}),c("flight-status/services/flight-status",["common/models/flightstatus-model","common/models/tailnumberinfo-model"],function(a,b){"use strict";var c=function(c,d){return this._api=d,this._$q=c,this._flightStatusModel=new a,this._tailNumberInfoModel=new b,{flightStatus:this.flightStatus.bind(this),tailNumberInfo:this.tailNumberInfo.bind(this)}};return c.$inject=["$q","api"],c.prototype.flightStatus=function(a){var b=this._$q.defer();return this._api.flightStatus.flightStatus(a).then(function(a){this._flightStatusModel.deserialize(a.data.response,"flightStatus"),b.resolve(a.data)}.bind(this)).catch(function(a){b.reject(a)}),b.promise},c.prototype.tailNumberInfo=function(a){var b=this._$q.defer();return this._api.flightStatus.tailNumberInfo(a).then(function(a){this._tailNumberInfoModel.deserialize(a.data.response,"tailNumberInfo"),b.resolve(a.data)}.bind(this)).catch(function(a){b.reject(a)}),b.promise},c}),c("flight-status/vx-flight-status-app",["angular","flight-status/controllers/flight-status","flight-status/services/flight-status"],function(a,b,c){"use strict";return a.module("vxFlightStatusApp",[]).controller("FlightStatusCtrl",b).service("flightStatusService",c)}),c("flight-alerts/controllers/flight-alerts",["angular","jquery","moment","modernizr"],function(a,b,c,d){"use strict";var e=function(a,b,e,f,g,h,i,j,k,l,m,n,o,p,q,r){this._$scope=a,this._$rootScope=b,this._$window=e,this._$modal=f,this._flightAlertsService=h,this._scrollService=j,this._loadingService=k,this._utilsService=l,this._windowService=m,this._statusService=o,this._resourceBundle=p,this._$singleTimeout=q,this._accessibleService=r,this.keydownEvent="keydown.trapStatusFocus",g.config.get(function(a){this._config=a,this.buildDepartingAirportsList(this._config.airports)}.bind(this)),this._request={retrieveFlightList:{origin:"",dest:"",departureDate:""},subscribe:{email:"",sms:"",notificationMinutes:60,flightInfo:[]},unsubscribe:{emsId:"",emailOrSms:""}},this._flightType={NON_STOP:"NON-STOP",CONNECTING:"CONNECTING",THRU:"THRU"},this._phoneFields=["phone","phoneConfirm"],this._emailFields=["email","emailConfirm"];var s=this._resourceBundle.flightAlerts.notificationFrequency;this._timeOptions=s.map(function(a){return{name:"Notify me "+a.name,value:a.value}}),this._$scope.timeOptions={},s.forEach(function(a){this._$scope.timeOptions[a.value]=a.name}.bind(this)),this._lists={departing:[],arriving:[]},this._currentMoment=c(),this._$scope.flightAlerts={breakpoint:m.breakpoint(),dateSelected:null,departing:[],departingSelected:null,arriving:[],arrivingSelected:null,flightsAvailable:null,flightList:[],flightSelected:null,fields:{},timeSelected:this._timeOptions[0],times:this._timeOptions,selectAirport:this.selectAirport.bind(this),selectFlight:this.selectFlight.bind(this),selectTime:this.selectTime.bind(this),readyToSubmit:!1,isLoading:!1,subscribe:this.subscribe.bind(this),reset:this.reset.bind(this),fieldsUnsub:{},unsubscribe:this.unsubscribe.bind(this),formatPhoneNum:this.formatPhoneNum.bind(this),showDatePicker:!1,displayDatePicker:this.displayDatePicker.bind(this),isTouchDevice:d.touch,flightSelectPlaceholderText:"Select A Flight",originSelectPlaceholderText:"From",destinationSelectPlaceholderText:"To",notificationSelectPlaceholderText:"Notify me"},a.$watch("flightAlerts.fields.date.value",function(){a.flightAlerts.fields.date&&this.inputDate(a.flightAlerts.fields.date.value)}.bind(this)),a.$watch("flightAlerts.fields.email.value",this._validateEmail.bind(this)),a.$watch("flightAlerts.fields.emailConfirm.value",this._validateEmail.bind(this)),a.$watch("flightAlerts.fields.phone.value",this._validatePhone.bind(this)),a.$watch("flightAlerts.fields.phoneConfirm.value",this._validatePhone.bind(this));var t=function(){var b=a.flightAlerts.fields.email,c=a.flightAlerts.fields.emailConfirm,d=a.flightAlerts.fields.phone,e=a.flightAlerts.fields.phoneConfirm;return[b&&b.value,c&&c.value,d&&d.value,e&&e.value]};a.$watch(t,this._formValidation.bind(this),!0),a.$on("calWidgetDateSelected",function(a,b){this._$scope.flightAlerts.fields.date.value=b,this._$scope.flightAlerts.fields.date.isValid=!0,this._formValidation(),this.displayDatePicker(!1),this._accessibleService.setFocus(".flight-status-controls__date-picker-trigger")}.bind(this)),a.$on("calWidgetClose",function(){this.displayDatePicker(!1),this._accessibleService.setFocus(".flight-status-controls__date-picker-trigger")}.bind(this)),n.subscribe("windowService.breakpoint",this.onBreakpointChange.bind(this)),j.go("top",{duration:0})};return e.$inject=["$scope","$rootScope","$window","$modal","cms","flightAlertsService","flightStatusService","scrollService","loadingService","utilsService","windowService","pubSubService","statusService","ResourceBundle","$singleTimeout","accessibleService"],e.prototype.onBreakpointChange=function(a){this._$scope.flightAlerts.breakpoint=a,"small"===a&&this._$scope.flightAlerts.showDatePicker?this._windowService.setModalMode(!0):"small"!==a&&this._$scope.flightAlerts.showDatePicker&&this._windowService.setModalMode(!1)},e.prototype.buildDepartingAirportsList=function(b){for(var c in b){var d=b[c];d.code=c,d.asCity?delete this._config.airports[c]:this._lists.departing.push(d)}var e=this._utilsService.sortListByName(this._lists.departing);a.extend(this._$scope.flightAlerts,{departing:e,arriving:e})},e.prototype.selectAirport=function(c,d){var e=d?"origin":"dest";if(this._request.retrieveFlightList[e]=c.code,d){this._request.retrieveFlightList.dest="",this._$scope.flightAlerts.arrivingSelected=null,b("#arriving-select").next(".flight-status-select").find(".custom-selectInner").text("To");var f=this._config.airportMapping[c.code];if(this._lists.arriving=[],a.isObject(f)&&a.isObject(f.to)&&a.isObject(f.to))for(var g in f.to)if(f.to[g]===this._flightType.NON_STOP){var h=this._config.airports[g];a.isObject(h)&&(h.code=g,this._lists.arriving.push(h))}this._$scope.flightAlerts.arriving=this._utilsService.sortListByName(this._lists.arriving)}else this._testRequestStatus()},e.prototype.inputDate=function(a){if(this._$scope.flightAlerts.fields.date.isValid){this.displayDatePicker(!1);var b=c(a),d=b.format("YYYY-MM-DD");b.isBefore(this._currentMoment,"day")&&this._statusService.setAlert({format:this._statusService.format.ERROR,copy:this._resourceBundle.statusMessages.flightAlerts.dateInPast,sticky:!1,recoverable:!0,controls:{close:!1,hide:"got it"}}),this._request.retrieveFlightList.departureDate=d,this._$scope.flightAlerts.dateSelected=!0,this._testRequestStatus()}else this._request.retrieveFlightList.departureDate="",this._$scope.flightAlerts.dateSelected=!1},e.prototype._validateEmail=function(a,b){if(a!==b){var c=this._$scope.flightAlerts.fields.email,d=this._$scope.flightAlerts.fields.emailConfirm;c.value&&""!==c.value&&d.value&&""!==d.value&&c.value!==d.value?d.setValidation(!1,"e-mails don't match"):c.value&&""!==c.value&&d.value&&""!==d.value&&c.value===d.value&&(d.setValidation(!0,c.validMessage),this._toggleRequiredValidation(this._phoneFields,"optional")),c.value||this._toggleRequiredValidation(this._phoneFields,"required")}},e.prototype._toggleRequiredValidation=function(a,b){a.forEach(function(a){this._$scope.flightAlerts.fields[a].toggleRequiredValidation(b)}.bind(this))},e.prototype._validatePhone=function(a,b){if(a!==b){var c=this._$scope.flightAlerts.fields.phone,d=this._$scope.flightAlerts.fields.phoneConfirm;c.value&&""!==c.value&&d.value&&""!==d.value&&c.value!==d.value?d.setValidation(!1,"phones don't match"):c.value&&""!==c.value&&d.value&&""!==d.value&&c.value===d.value&&(d.setValidation(!0,c.validMessage),this._toggleRequiredValidation(this._emailFields,"optional")),c.value||this._toggleRequiredValidation(this._emailFields,"required")}},e.prototype._testRequestStatus=function(){var b=!0;a.forEach(this._request.retrieveFlightList,function(a){a.length||(b=!1)}),b&&this._sendRequest(this._request.retrieveFlightList)},e.prototype._sendRequest=function(c){var d=this._flightAlertsService.retrieveFlightList(c);this._loadingService.setLoading(d),d.then(function(c){this._$scope.flightAlerts.flightList=c.dateDetails,this._$scope.flightAlerts.flightsAvailable=!0,a.forEach(this._$scope.flightAlerts.fields,function(a){a.isVisible=!0}),b(".flight-status-controls__date-picker-trigger").focus()}.bind(this))},e.prototype.selectFlight=function(b){var c={origin:this._$scope.flightAlerts.departingSelected.code,destination:this._$scope.flightAlerts.arrivingSelected.code};a.isObject(b)?(c.flightNumber=b.flightNum,c.departureDateTime=b.flightDateTime,this._$scope.flightSelected=b.flightNum):(c.flightNumber=null,c.departureDateTime=null,this._$scope.flightSelected=null),this._formValidation(),this._request.subscribe.flightInfo=[c]},e.prototype.selectTime=function(a){this._request.subscribe.notificationMinutes=a.value},e.prototype._formValidation=function(){var a=this._$scope.flightAlerts.fields,b=!1,c=this._$scope.flightAlerts.flightSelected,d=a.email&&a.email.isValid&&a.emailConfirm.isValid&&a.email.value===a.emailConfirm.value,e=a.phone&&a.phone.isValid&&a.phoneConfirm.isValid&&a.phone.value===a.phoneConfirm.value;c&&(d||e)&&(b=!0,this._request.subscribe.email=this._$scope.flightAlerts.submitEmail=a.email.isValid&&a.email.value?a.email.value:"",this._request.subscribe.sms=this._$scope.flightAlerts.submitSms=a.phone.isValid&&a.phone.value?a.phone.value:""),this._$scope.flightAlerts.readyToSubmit=b},e.prototype.subscribe=function(){if(!this._$scope.flightAlerts.readyToSubmit){var c=b("#flight-alert-submit-button");return c.addClass("is-disabled-animation"),void setTimeout(function(){c.removeClass("is-disabled-animation")},350)}var d=this._flightAlertsService.subscribe(this._request.subscribe);this._$scope.flightAlerts.isLoading=!0,d.then(function(b){"SUCCESS"===b.status.status&&(a.extend(this._$scope.flightAlerts,{isLoading:!1,subscribeData:{pin:b.response.emsId,email:b.response.email,sms:b.response.sms,mins:b.response.notificationMinutes,flightInfo:b.response.flightInfo[0]}}),this._$rootScope.$broadcast("flightAlerts.subscribeSuccess"),this._scrollService.go("top",{duration:0}),this._accessibleService.setFocus(".flight-status__header h1"))}.bind(this))},e.prototype.reset=function(){this._$window.location.reload()},e.prototype.unsubscribe=function(){this._request.unsubscribe={emsId:this._$scope.flightAlerts.fieldsUnsub.emsId.value,emailOrSms:this._$scope.flightAlerts.fieldsUnsub.emailOrSms.value};var a=this._flightAlertsService.unsubscribe(this._request.unsubscribe);a.then(function(a){"SUCCESS"===a.status.status&&(this._$scope.flightAlerts.unsubscribeData={emailOrSms:a.response.emailOrSms},this._scrollService.go("top",{duration:0}),this._$singleTimeout(function(){this._accessibleService.setFocus(".flight-status__header h1")}.bind(this)))}.bind(this))},e.prototype.formatPhoneNum=function(a){return this._utilsService.formatPhoneNum(a)},e.prototype.displayDatePicker=function(a){var c=this._$scope.flightAlerts.departingSelected,d=a&&c;this._$scope.flightAlerts.showDatePicker=d,d?this._$singleTimeout(function(){var a=b(".calendar-widget__close").eq(0),c=b(".widget-month__widget-days").eq(0);this._accessibleService.setFocus(".calendar-widget__close"),b("body").on(this.keydownEvent,this._accessibleService.trapFocus.bind(this,a,c))}.bind(this)):b("body").off(this.keydownEvent),"small"===this._$scope.flightAlerts.breakpoint&&this._windowService.setModalMode(a)},e}),c("flight-alerts/vx-flight-alerts-app",["angular","flight-alerts/controllers/flight-alerts"],function(a,b){"use strict";return a.module("vxFlightAlertsApp",[]).controller("FlightAlertsCtrl",b)}),c("change/controllers/change-base",["moment"],function(a){"use strict";var b=function(b,c,d,e,f,g,h,i,j,k){this._$scope=b,this._$timeout=c,this._changeService=d,this._fareService=e,this._locationService=f,this._elevateService=g,this._travelerService=h,this._tripService=i,this._URLParser=k,this._pubSubService=j,this._fareService.setContext("CHANGE"),this._locationService.setContext(this._locationService.contexts.CHANGE),this._URLParser.setContext("CHANGE"),this._pnr=d.getPnrModel();var l=null;this._pnr&&(l=this._elevateService.isLoggedIn()?this._elevateService.getAccountInfo().personDetail.firstName:d.getPnrModel().paxList[0].firstName),this._$scope.changeValues={firstName:l},this._auth=function(){var a=!0;return this._pnr||(this._locationService.go({target:"/manage-itinerary"}),a=!1),a},this._buildTripFromPnr=function(b){var c,d,e,f,g,h,i;if(this._pnr){c=this._pnr.tripType,h=this._pnr.flightList[0],i=this._pnr.flightList[1],d=h.origin,e=h.destination,c&&this._changeService.setTripType(c),this._travelerService.createTravelersFromPaxList(this._pnr.paxList);var j=this._travelerService.getTravelerAmounts();this._tripService.setTravelerAmount(j),this._changeService.setTravelerAmount(j);var k=this._changeService.getCityPairs(),l="undefined"==typeof k[0].dep,m="undefined"==typeof k[0].des;if(c===this._changeService.MULTI_CITY?(l&&this._changeService.setAirport(this._pnr.flightList[0].origin,0,"dep"),l&&this._changeService.setAirport(this._pnr.flightList[0].destination,0,"des"),m&&this._changeService.setAirport(this._pnr.flightList[1].origin,1,"dep"),m&&this._changeService.setAirport(this._pnr.flightList[1].destination,1,"des")):(d&&l&&this._changeService.setAirport(d,0,"dep"),e&&m&&this._changeService.setAirport(e,0,"des")),b)return void this._$timeout(function(){this._pubSubService.publish("setTripBookerSectionComplete")}.bind(this));var n=a(h.departureDateTime,"YYYY-MM-DD HH:mm Z"),o=n.zone(h.departureDateTime);f=o.format("YYYY-MM-DD"),this._changeService.setDate(f),i&&(n=a(i.departureDateTime,"YYYY-MM-DD HH:mm Z"),o=n.zone(i.departureDateTime),g=o.format("YYYY-MM-DD"),this._changeService.setDate(g))}},this._getRequestQuoteFlightIds=function(){var a=this._fareService.getSelectedFares(),b=this._changeService.getRequestQuoteFlightIds(a);return b}};return b.$inject=["$scope","$timeout","changeService","fareService","locationService","elevateService","travelerService","tripService","pubSubService","URLParser"],b}),c("change/controllers/change-options",["angular","moment"],function(a,b){"use strict";var c=function(a,b,c,d,e){this._$scope=a,this._changeService=b,this._locationService=c,this._windowService=d,this._URLParser=e,this._flights=[],this._tripTypeCodes={ONE_WAY:"ow",ROUND_TRIP:"rt",MULTI_CITY:"mc"},this._pnr=this._changeService.getPnrModel(),this._auth()&&(this._$scope.changeOptions={isIrop:!!this._pnr.irop,iropInfo:this._pnr.iropInfo,
flights:this._flights,changeTrip:this.changeTrip.bind(this),changeSeats:this.changeSeats.bind(this),changeExtras:this.changeExtras.bind(this),cancel:this.cancel.bind(this)},this._createFlightData(),this._locationService.setContext(this._locationService.contexts.CHANGE),this._URLParser.setContext("CHANGE"),this._verifyChangeEligibilities(),this._windowService.setChangeFlow(!0))};return c.prototype._verifyChangeEligibilities=function(){var b=!0,c=!0;a.forEach(this._pnr.flightList,function(a){b&&"ELIGIBLE"!==a.changeEligibility&&(b=!1),c&&"ELIGIBLE"!==a.changeSeatEligibility&&(c=!1)}),a.extend(this._$scope.changeOptions,{changeEligibility:b,changeSeatEligibility:c,manageExtrasEligibility:this._pnr.tripAvailableForManageExtras})},c.prototype.cancel=function(){this._changeService.reset(),this._locationService.setContext(this._locationService.contexts.MANAGE),this._windowService.setChangeFlow(!1),this._locationService.go({target:"/manage-itinerary"})},c.prototype._createFlightData=function(){var a,c,d,e,f,g,h=[];for(var i in this._pnr.flightList){if(i=parseInt(i,10),this._pnr.isRoundTrip&&1===i)break;a=this._pnr.flightList[i],c=this._pnr.flightList[i+1],d={origin:a.origin,destination:a.destination,flightId:a.flightId,isRoundTrip:this._pnr.isRoundTrip},e=b(a.departureDateTime).zone(a.departureDateTime).format("MMM D"),f=this._pnr.isRoundTrip?b(c.departureDateTime).zone(c.departureDateTime):b(a.departureDateTime).zone(a.departureDateTime),g=f.format("MMM D"),d.dateRange=e!==g?[e,"-",g].join(" "):e,h.push(d)}this._$scope.changeOptions.flights=h},c.prototype._auth=function(){return!!this._pnr||(this._locationService.go({target:"/manage-itinerary"}),!1)},c.prototype._createTravelersUrlFragment=function(){var b={ADULT:0,CHILD:0,INFANT:0},c="",d=this._pnr.paxList;return a.forEach(d,function(a){b[a.paxType]++}),b.ADULT>0&&(c+="a"+b.ADULT),b.CHILD>0&&(c+="c"+b.CHILD),b.INFANT>0&&(c+="i"+b.INFANT),c},c.prototype._createCitiesUrlFragment=function(){var b=[],c="";a.forEach(this._pnr.flightList,function(a,c){(!this._pnr.isRoundTrip||this._pnr.isRoundTrip&&0===c)&&(b.push(a.origin),b.push(a.destination)),!this._pnr.isRoundTrip&&!this._pnr.isMultiCity&&1===c&&(b.push(a.origin),b.push(a.destination))},this);for(var d in b)d=parseInt(d,10),c+=b[d].toLowerCase(),(0===d||!Boolean(d%2))&&d<b.length-1&&(c+="_"),Boolean(d%2)&&d<b.length-1&&(c+="/");return c},c.prototype._createDatesUrlFragment=function(){var c=[];return a.forEach(this._pnr.flightList,function(a){c.push(b(a.departureDateTime).zone(a.departureDateTime).format("YYYYMMDD")),1===this._pnr.flightList.length&&!this._pnr.isOneWay&&c.push(c[0])},this),c.join("_")},c.prototype.changeTrip=function(a){var b="";this._$scope.changeOptions.changeEligibility&&(b+=[this._tripTypeCodes[this._pnr.tripType],"/",this._createTravelersUrlFragment()].join(""),"cities"!==a&&(b+="/"+this._createCitiesUrlFragment()),"cities"!==a&&"dates"!==a&&(b+="/"+this._createDatesUrlFragment()),this._locationService.go({target:"/change/trip/"+b}))},c.prototype.changeSeats=function(){this._$scope.changeOptions.changeSeatEligibility&&(this._changeService.setChangeType(this._changeService.CHANGE_TYPES.EXISTING,this._changeService.EXISTING_CHANGE_TYPES.SEATS),this._locationService.go({target:"/change/seats"}))},c.prototype.changeExtras=function(){this._$scope.changeOptions.manageExtrasEligibility&&(this._changeService.setChangeType(this._changeService.CHANGE_TYPES.EXISTING,this._changeService.EXISTING_CHANGE_TYPES.EXTRAS_AND_SEATS),this._locationService.go({target:"/change/extras"}))},c.$inject=["$scope","changeService","locationService","windowService","URLParser"],c}),c("change/controllers/change-trip",["change/controllers/change-base"],function(a){"use strict";var b=function(b,c,d,e,f,g,h,i,j){this._$scope=b,this._$injector=c,this._$location=d,this._URLParser=e,this._scrollService=f,this._windowService=g,this._statusService=h,this._seatService=i,this._ancillariesService=j,this._windowService.setChangeFlow(!0),this._$injector.invoke(a,this,{$scope:this._$scope}),this._auth()&&(this._ancillariesService.useUISelections(),this._pubSubService.publish("ancillaries.newUIAmount",[0]),this._pubSubService.publish("setBaseAndTotal"),this._isUrlParsable()?this._buildTripFromModel(this._getModelFromUrl()):(this._statusService.setChangeGuider(this._statusService.message.CHANGE_CITIES),this._buildTripFromPnr(!1)),this._travelerService.createTravelersFromPaxList(this._pnr.paxList),this._$scope.trip={openFareInfoModal:this.openFareInfoModal.bind(this)},this._changeService.setChangeType(this._changeService.CHANGE_TYPES.NEW),this._$scope.$watch(this._changeService.areCitiesSelected,function(a){a&&(this._windowService.setYtsVisible(!0),this._windowService.setYtsFixed(!0))}.bind(this)))};return b.prototype.openFareInfoModal=function(a){this._pubSubService.publish("core.openModal",["openFareInfoModal",a])},b.prototype._isUrlParsable=function(){return null!==this._getModelFromUrl()},b.prototype._getModelFromUrl=function(){var a=this._$location.url(),b=this._URLParser.getModel(a);return b?b.parsed:null},b.prototype._buildTripFromModel=function(a){if(null!==a){this._pubSubService.publish("yts.collapseYts",[!0]);var b=this._statusService.message.CHANGE_CITIES;if(this._changeService.setTripType(a.tripType),a.cityPairs&&a.cityPairs.length>0)for(var c in a.cityPairs){var d=a.cityPairs[c];if(null!==d&&"undefined"!=typeof d.dep&&"undefined"!=typeof d.des)for(var e in d)this._changeService.setAirport(d[e],c,e)}else this._buildTripFromPnr(!0);if(a.travelers&&a.cityPairs&&a.cityPairs.length>0&&(this._tripService.setTravelerAmount(a.travelers),this._changeService.setTravelerAmount(a.travelers),this._changeService.setVisibleSection({section:"CALENDAR",isVisible:!0}),b=this._statusService.message.CHANGE_DATES,(!a.dates||0===a.dates.length)&&this._scrollService.scroll({target:"DATE_PICKER_STATE",delay:1e3}).then(function(){this._pubSubService.publish("collapseTripBooker")}.bind(this))),a.dates.length>0){for(var f in a.dates)this._changeService.setDate(a.dates[f]);b=this._statusService.message.CHANGE_FARES;var g=this._fareService.loadFares();g.then(function(){this._pubSubService.publish("collapseTripBooker"),this._pubSubService.publish("collapseCalendar"),this._scrollService.scroll({target:"FARE_SELECTOR_STATE",delay:1e3})}.bind(this))}(a.travelers&&a.cityPairs&&a.cityPairs.length>0)===!1&&a.dates.length>0==0&&this._pubSubService.publish("yts.detectState",[!1]),this._statusService.setChangeGuider(b),a.promoCode&&this._changeService.setPromoCode(a.promoCode)}},b.$inject=["$scope","$injector","$location","URLParser","scrollService","windowService","statusService","seatService","ancillariesService"],b}),c("change/controllers/change-existing",["jquery","angular","change/controllers/change-base"],function(a,b,c){"use strict";var d=function(a,b,d,e,f,g,h,i,j,k,l,m,n,o,p){this._seatService=e,this._locationService=f,this._windowService=i,this._statusService=l,this._scrollService=j,this._pnrService=n,this._pubSubService=o,this._ancillariesService=p,b.invoke(c,this,{$scope:a,tripService:h,changeService:d,fareService:g,locationService:f,elevateService:k,travelerService:m}),this._$scope.seatSelector={},this._auth()&&(this._pnrService.setModel(this._pnr),this._buildTripFromPnr(),this._scrollService.go("top",{duration:0}),this._windowService.setHeaderVisible(!1),this._windowService.setChangeFlow(!0),this._$scope.$on("$destroy",function(){this._windowService.setHeaderVisible(!0),this._windowService.setChromeHidden(!1),this._scrollService.go("top",{duration:0}),this._statusService.setChangeGuider([]),this._windowService.setChangeFlow(!1)}.bind(this)),this._windowService.setYtsVisible(!0),this._windowService.setYtsFixed(!0),this._isExistingChange()?(this._pubSubService.publish("changeExistingCtrl.selectedFares",[this._pnrService.getSelectedFares()]),this._shouldShowExtras()?this._setUpExtras():this._getSeatMaps()):this._getSeatMaps(),this._pubSubService.subscribe("changeExistingCtrl.changeSeats",this._getSeatMapsFromExtras.bind(this)))};return d.$inject=["$scope","$injector","changeService","seatService","locationService","fareService","tripService","windowService","scrollService","elevateService","statusService","travelerService","pnrService","pubSubService","ancillariesService"],d.prototype._isExistingChange=function(){return this._changeService.isChangeType(this._changeService.CHANGE_TYPES.EXISTING)},d.prototype._shouldShowExtras=function(){return this._locationService.getPath().indexOf("change/extras")!==-1},d.prototype._setUpExtras=function(){this._ancillariesService.useUISelections(),this._ancillariesService.requestAvailableAncillaries().then(function(){this._statusService.setChangeGuider(this._statusService.message.CHANGE_EXTRAS),this._pubSubService.publish("ancillariesSelector.setVisibility",[!0]),this._pubSubService.publish("yts.detectState",[!1])}.bind(this))},d.prototype._getSeatMapsFromExtras=function(){this._statusService.setChangeGuider(this._statusService.message.CHANGE_SEATS),this._buildSeatmapQuery(),this._seatService.getSeatMaps(!0).then(function(a){this._$scope.seatSelector.segmentsData=a,this._scrollService.scroll({target:"SEAT_SELECTOR_STATE"}).then(function(){this._seatService.onScrollComplete(),this._pubSubService.publish("ancillariesSelector.collapse")}.bind(this))}.bind(this))},d.prototype._getSeatMaps=function(){this._statusService.setChangeGuider(this._statusService.message.CHANGE_SEATS),this._buildSeatmapQuery(),this._seatService.getSeatMaps(this._isExistingChange()).then(function(a){this._$scope.seatSelector.segmentsData=a}.bind(this))},d.prototype._buildSeatmapQuery=function(){var a,c=this._changeService.getTripTypeLegs(),d=this._changeService.getPnrModel(),e={infants:d.infantsTraveling||0,pets:d.petAmount||0,adults:0,children:0};for(var f in d.paxList){var g=d.paxList[f];"ADULT"===g.paxType||"ADULT_WITH_INFANT"===g.paxType?e.adults++:"CHILD"===g.paxType&&e.children++}this._seatService.updateTravellers(e),this._seatService.clearExistingSeats(),this._isExistingChange()?(b.forEach(this._pnrService.getAllSegments(),this._setExistingSeatsForSegment.bind(this)),a=this._pnrService.getSelectedFares(),b.forEach(a,function(a){a.legs=a.legs.filter(function(a){return"ELIGIBLE"===a.changeSeatOption.eligibility})})):(a=this._fareService.getSelectedFares(),b.forEach(a,function(a){b.forEach(a.legs,function(a,c){b.forEach(this._pnr.flightList,function(a){b.forEach(a.segments,function(a){c.departureDateTime===a.departureDateTime&&c.tiers[c.tier].cabinType===a.cabinType&&a.flightNum.match(c.flightNum)&&this._setExistingSeatsForSegment(a)},this)},this)}.bind(this,a))},this)),this._seatService.setRequestSeatMapModels(c,a)},d.prototype._setExistingSeatsForSegment=function(c){var d=[],e=a.grep(this._pnr.seatList,function(a,b){return a===b.flightNum}.bind(null,c.flightNum));b.forEach(e,function(a,b){var c=this._travelerService.getTravelerByGuestId(b.guestId);c&&a.push({seatNum:b.seatNum,travelerGuid:c.guid})}.bind(this,d)),this._seatService.addToExistingSeats(c.flightNum,d)},d}),c("change/services/change",["angular","moment","common/models/change-quote-model","common/models/trip-model","common/models/traveler-model"],function(a,b,c,d,e){"use strict";var f=function(a,b,c,d,e,f,g,h,i,j){return this._$q=b,this._api=c,this._cms=d,this._pnrService=e,this._travelerService=f,this._elevateService=g,this._latestTimeService=h,this._pubSubService=i,this._seatService=j,this._travelerTypes={adults:{single:"Adult",plural:"Adults"},children:{single:"Child",plural:"Children"},infants:{single:"Infant",plural:"Infants"},pets:{single:"Pet",plural:"Pets"}},this._constants={DEPARTURE:"dep",DESTINATION:"des",MULTI_CITY:"MULTI_CITY",ONE_WAY:"ONE_WAY",ROUND_TRIP:"ROUND_TRIP",TRIP_TYPE_OPTIONS:[{name:"Round Trip",val:"ROUND_TRIP"},{name:"One Way",val:"ONE_WAY"},{name:"Multi City",val:"MULTI_CITY"}],PAYMENT:"AerPayment",REFUND:"AerRefund"},this._changeType=null,this._iropFree=!0,this._selectedAncillaries=[],this._serializedSelectedAncillaries=[],this._uiAncillariesAmount=0,this._apiAncillariesAmountData={},this._changeTypes={NEW:0,EXISTING:1},this._existingChangeTypes={EXTRAS_AND_SEATS:"extrasAndSeats",SEATS:"seats"},this._init(),this._pubSubService.subscribe("ancillaries.refreshAncillariesForChangeFlow",this._setSelectedAncillaries.bind(this)),i.subscribe("ancillaries.newUIAmount",this._setUIAncillariesAmount.bind(this)),i.subscribe("ancillaries.newAPIAmountData",this._setAPIAncillariesAmountData.bind(this)),a.$watch(function(){return this._selectedTripModel.cityPairs}.bind(this),this.onCityPairUpdate.bind(this),!0),this._isReturningFlight=!1,{requestQuote:this.requestQuote.bind(this),complete:this.complete.bind(this),setPnrModel:this.setPnrModel.bind(this),getPnrModel:this.getPnrModel.bind(this),setExceptions:this.setExceptions.bind(this),getExceptions:this.getExceptions.bind(this),DEPARTURE:this._constants.DEPARTURE,DESTINATION:this._constants.DESTINATION,MULTI_CITY:this._constants.MULTI_CITY,ONE_WAY:this._constants.ONE_WAY,ROUND_TRIP:this._constants.ROUND_TRIP,getCityPairs:this.getCityPairs.bind(this),getTripType:this.getTripType.bind(this),getDates:this.getDates.bind(this),getAirport:this.getAirport.bind(this),setAirport:this.setAirport.bind(this),setTripType:this.setTripType.bind(this),setDate:this.setDate.bind(this),setPromoCode:this.setPromoCode.bind(this),setTravelerAmount:this.setTravelerAmount.bind(this),travelerIndividualLabel:this.travelerIndividualLabel.bind(this),travelerTotalLabel:this.getTravelerTotalLabel.bind(this),setVisibleSection:this.setVisibleSection.bind(this),getVisibleSections:this.getVisibleSections.bind(this),getTripTypeLegs:this.getTripTypeLegs.bind(this),getTripLength:this.getTripLength.bind(this),getSelectedTripPublicModel:this.getSelectedTripPublicModel.bind(this),quoteType:this.quoteType.bind(this),setFare:this.setFare.bind(this),setExchangeFlightList:this.setExchangeFlightList.bind(this),reset:this._init.bind(this),areCitiesSelected:this.areCitiesSelected.bind(this),getTravelers:this.getTravelers.bind(this),getTotalTravelers:this.getTotalTravelers.bind(this),getTravelerList:this.getTravelerList.bind(this),getPayingTravelerAmount:this.getPayingTravelerAmount.bind(this),getFares:this.getFares.bind(this),getOriginalCost:this.getOriginalCost.bind(this),getNewFlightCost:this.getNewFlightCost.bind(this),getChangeFee:this.getChangeFee.bind(this),getSelectedFares:this.getSelectedFares.bind(this),getQuoteModel:this.getQuoteModel.bind(this),clearDates:this.clearDates.bind(this),getTravelerData:this.getTravelerData.bind(this),getBalance:this.getBalance.bind(this),setSelectedFares:this.setSelectedFares.bind(this),manageComplete:this.manageComplete.bind(this),getRequestQuoteFlightIds:this.getRequestQuoteFlightIds.bind(this),getIsInternational:this.getIsInternational.bind(this),shouldChangeSeats:this.shouldChangeSeats.bind(this),purgeRequestQuote:this.purgeRequestQuote.bind(this),setChangeType:this.setChangeType.bind(this),isNewOrExisting:this.isNewOrExisting.bind(this),isChangeType:this.isChangeType.bind(this),isExistingChangeType:this.isExistingChangeType.bind(this),clearNewOrExisting:this.clearNewOrExisting.bind(this),CHANGE_TYPES:this._changeTypes,EXISTING_CHANGE_TYPES:this._existingChangeTypes,getDateRestrictions:this.getDateRestrictions.bind(this),validateIropChange:this.validateIropChange.bind(this),isReturningFlight:this.isReturningFlight.bind(this),setIsReturningFlight:this.setIsReturningFlight.bind(this),isIropFree:this.isIropFree.bind(this),getAirportData:this.getAirportData.bind(this),getUIAncillariesAmount:this.getUIAncillariesAmount.bind(this),getExtrasRefund:this.getExtrasRefund.bind(this),setDepartingDate:this.setDepartingDate.bind(this),setReturningDate:this.setReturningDate.bind(this),hasPNRAncillarySummary:this.hasPNRAncillarySummary.bind(this)}};return f.$inject=["$rootScope","$q","api","cms","pnrService","travelerService","elevateService","latestTimeService","pubSubService","seatService"],f.prototype.isIropFree=function(){return this._iropFree},f.prototype.setIsReturningFlight=function(a){this._isReturningFlight=a},f.prototype.isReturningFlight=function(){return this._isReturningFlight},f.prototype.setChangeType=function(a,b){this._changeType=a,this._existingChangeType=b},f.prototype.isNewOrExisting=function(){for(var a in this._changeTypes)if(this._changeTypes[a]===this._changeType)return a},f.prototype.isChangeType=function(a){return this._changeType===a},f.prototype.isExistingChangeType=function(a){return this._changeType===this._changeTypes.EXISTING&&this._existingChangeType===a},f.prototype.clearNewOrExisting=function(){this._changeType=null},f.prototype.getRequestQuoteFlightIds=function(a){var b=[];if(a&&a.length){for(var c in a)if(a[c]&&a[c].legs&&a[c].legs[0]&&this._pnrModel&&this._pnrModel.flightList&&this._pnrModel.flightList[c]){var d=this._pnrModel.flightList[c];b.push(d.flightId)}}else this._pnrModel.flightList.forEach(function(a){for(var c in a.segments)"undefined"==typeof b[a.segments[c].flightId-1]&&"ELIGIBLE"===a.segments[c].changeSeatOption.eligibility&&b.push(a.segments[c].flightId)});return b},f.prototype.hasPNRAncillarySummary=function(){return this._pnrModel.ancillaryDetails&&this._pnrModel.ancillaryDetails.summaryList&&this._pnrModel.ancillaryDetails.summaryList.length>0},f.prototype.validateIropChange=function(a){var c=this._latestTimeService.getTime().zone("-10:00"),d={valid:!0,message:null};if(this._iropFree=!0,!this._pnrModel||!this._pnrModel.irop)return d;var e=c<b(this._pnrModel.iropInfo.rebookEnd,"YYYY-MM-DD");if(!e)return d;if("CITIES"===a){var f=this.getCityPairs();for(var g in this._pnrModel.flightList)if(f[g]){var h=this._pnrModel.flightList[g];h.origin===f[g].dep&&h.destination===f[g].des||(d.valid=!1,d.message="IROP_CHANGED_CITIES")}}else if("DATES"===a){var i=this.getDates(),j=this._pnrModel.iropInfo.segmentStart,k=this._pnrModel.iropInfo.segmentEnd,l=b(j,"YYYY-MM-DD"),m=b(k,"YYYY-MM-DD");for(var n in i)(b(i[n],"YYYY-MM-DD")<l||b(i[n],"YYYY-MM-DD")>m)&&(d.valid=!1,d.message="IROP_OUTSIDE_SEGMENT_RANGE")}return d.valid||(this._iropFree=!1),d},f.prototype.getTravelerData=function(){return this._selectedTripModel.travelers},f.prototype.setSelectedFares=function(a){this._selectedFaresModel=a},f.prototype._init=function(){this._pnrModel=null,this._exceptions=null,this._airportData=[],this._quoteModel=null,this.visibleSections={},this._selectedFaresModel=[],this._areCitiesSelected=!1,this._exchangeFlightList=[],this._selectedTripModel=new d(this._defaultTripModel()),void(this._changeType=null)},f.prototype.getOriginalCost=function(){return this._pnrModel&&this._pnrModel.fareInfo?this._pnrModel.fareInfo.totalCost:0},f.prototype.getNewFlightCost=function(){return this._quoteModel?this._quoteModel.newFareInfo.total:0},f.prototype.getBalance=function(){return this._quoteModel?this._quoteModel.totalAmount:0},f.prototype.getExtrasRefund=function(){return this._quoteModel?this._quoteModel.extraRefundAmount:0},f.prototype._setUIAncillariesAmount=function(a){this._uiAncillariesAmount=a},f.prototype._setAPIAncillariesAmountData=function(a){this._apiAncillariesAmountData=a},f.prototype.getUIAncillariesAmount=function(){return this._uiAncillariesAmount+this._seatService.calculateTotalAncillaryAmount()},f.prototype.clearDates=function(){this._selectedTripModel.dates=[]},f.prototype.getChangeFee=function(){return this._quoteModel&&this._quoteModel.changeFee||0},f.prototype.getTravelers=function(){return this._selectedTripModel.travelers},f.prototype.getSelectedFares=function(){return this._selectedFaresModel},f.prototype.areCitiesSelected=function(){return this._areCitiesSelected},f.prototype.getSelectedTripPublicModel=function(){return this._selectedTripModel},f.prototype.getTripLength=function(){var a=this._selectedTripModel.dates;return b(a[1]).diff(a[0],"days")},f.prototype.getTripTypeLegs=function(){return this.getTripType()===this._constants.ONE_WAY?1:2},f.prototype.setVisibleSection=function(a){this.visibleSections[a.section]=a.isVisible},f.prototype.getVisibleSections=function(){return this.visibleSections},f.prototype.setPnrModel=function(a){this._pnrModel=a,this._pubSubService.publish("ancillaries.reset"),this._pubSubService.publish("setAncillaryDetailsFromPNR",[a.ancillaryDetails])},f.prototype.setExceptions=function(a){this._exceptions=a},f.prototype.getExceptions=function(){return this._exceptions},f.prototype._setSelectedAncillaries=function(a,b){this._selectedAncillaries=b,this._serializedSelectedAncillaries=a},f.prototype.getPnrModel=function(){return this._pnrModel},f.prototype.getPayingTravelerAmount=function(){var a=this._selectedTripModel.travelers;return a.adults+a.children},f.prototype._buildRequestQuote=function(){var b=0,c=[],d=[],e=this.getPayingTravelerAmount(),f=this.isNewOrExisting();a.forEach(this._selectedFaresModel,function(a){a.cost.dollars&&(b+=a.cost.dollars.base*e),c=c.concat(a.getAncillariesSegList())});var g={changeAndCancelInfo:{exchangingFlightIdList:this._exchangeFlightList,newFlightSegList:c},fareInformation:{baseFare:b.toFixed(2)},typeOfChange:f,identificationInfo:{pnr:this._pnrModel.pnr,lastName:this._pnrModel.lastName},ancillaryDetails:{ancillaryList:this._serializedSelectedAncillaries},travelerInfoList:[]};if(this.isChangeType(this._changeTypes.EXISTING)&&this._serializedSelectedAncillaries.length){var h=this._pnrService.getSelectedFares();a.forEach(h,function(a){d.push(a.serialize("ancillaries"))}.bind(this)),g.oAndDList=d}var i=this._travelerService.getAllTravelers();a.forEach(i,function(a){g.travelerInfoList.push(a.serialize("apiStandard"))}.bind(this));var j=this._buildSeatsRequest();return j.length>0&&(g.seatInfo={seatFlightList:j}),g},f.prototype.getDateRestrictions=function(){var b=this._$q.defer();return this._cms.config.get(function(c){var d,e=this.getAirport(0),f=[],g="",h="";e&&e.dep&&e.des&&(g=[e.dep.code,"_",e.des.code].join(""),f.push(g)),this.getTripType()===this._constants.ROUND_TRIP?h=g.split("_").reverse().join("_"):this.getTripType()===this._constants.MULTI_CITY&&(d=this.getAirport(1),d&&(h=[d.dep.code,"_",d.des.code].join(""))),h&&f.push(h);var i=[];a.forEach(f,function(a){i.push({noFlyDates:c.noFlyDates[a]||!1,seasonalAvailability:c.seasonalAvailability[a]||!1})}),b.resolve(i)}.bind(this)),b.promise},f.prototype.requestQuote=function(){var a=this._buildRequestQuote(),b=this._$q.defer();return this._api.change.requestQuote(a).then(function(d){"ERROR"!==d.data.status.status&&(!this.isChangeType(this._changeTypes.EXISTING)||a.changeAndCancelInfo.newFlightSegList.length||a.seatInfo||0!==d.data.response.paymentAmount)?(this._quoteModel=new c,this._quoteModel.deserialize(d.data.response,"change"),this._pubSubService.publish("newAncillaryDetails",[d.data.response.ancillaryDetails]),this._pubSubService.publish("refundedAncillaryDetails",[d.data.response.origAncillaryDetails]),this._pubSubService.publish("ancillaries.setSeatInfo",[this._quoteModel.seatInfoList]),this._pubSubService.publish("setBaseAndTotal"),b.resolve()):b.reject()}.bind(this),function(){b.reject()}),b.promise},f.prototype._buildRequestComplete=function(a){var b=this._buildRequestQuote();if(b.fareInformation.totalFare=this._quoteModel.totalAmount,b.totalExtrasPrice=this._apiAncillariesAmountData.totalExtrasWithoutSeats,b.totalSeatPrice=this._seatService.calculateTotalAncillaryAmount(),a){b.paymentInfo=a;var c=a.travelBankInfo||a.multipleFormInfo&&a.multipleFormInfo.travelBankInfo;c&&(b.authToken=c.authToken)}return this._elevateService.isLoggedIn()&&(b.authToken=this._elevateService.getAuthToken()),b},f.prototype.complete=function(a){var b=this._buildRequestComplete(a);return this._pnrService.doCompleteChange(b)},f.prototype.setTripType=function(a){this._selectedTripModel.tripType=a},f.prototype.getTripType=function(){return this._selectedTripModel.tripType},f.prototype.setAirport=function(a,b,c){if("undefined"==typeof this._selectedTripModel.cityPairs[b]&&(this._selectedTripModel.cityPairs[b]={dep:null,des:null}),this._selectedTripModel.cityPairs[b][c]=a,this.getTripType()===this._constants.ROUND_TRIP){var d=this._selectedTripModel.cityPairs[0];d&&(this._selectedTripModel.cityPairs[1]={dep:d.des,des:d.dep})}this.getTripType()===this._constants.ONE_WAY||this.getTripType()===this._constants.ROUND_TRIP?this._selectedTripModel.cityPairs[0].dep&&this._selectedTripModel.cityPairs[0].des&&(this._areCitiesSelected=!0):this._selectedTripModel.cityPairs[1].dep&&this._selectedTripModel.cityPairs[1].des&&(this._areCitiesSelected=!0)},f.prototype.getAirport=function(a){return this._airportData[a]},f.prototype.getAirportData=function(){return this._airportData},f.prototype.getCityPairs=function(){return this._selectedTripModel.cityPairs},f.prototype.getDates=function(){return this._selectedTripModel.dates},f.prototype.setDate=function(a){this._selectedTripModel.dates.push(a)},f.prototype.setDepartingDate=function(a){this._selectedTripModel.dates[0]=a},f.prototype.setReturningDate=function(a){this._selectedTripModel.dates[1]=a},f.prototype.setPromoCode=function(a){this._selectedTripModel.promoCode=a},f.prototype.onCityPairUpdate=function(){var a,b,c=function(c){var d=[];try{for(var e in this._selectedTripModel.cityPairs)b={},a=this._selectedTripModel.cityPairs[e],a.dep&&(b.dep=c.airports[a.dep],b.dep.code=a.dep),a.des&&(b.des=c.airports[a.des],b.des.code=a.des),d.push(b);this._airportData=d}catch(a){}};this._cms.config.get(c.bind(this))},f.prototype.getIsInternational=function(){var b=!1,c=this._airportData;return a.forEach(c,function(c){a.forEach(c,function(a){a.international&&(b=!0)})}),b},f.prototype.setTravelerAmount=function(a){this._selectedTripModel.travelers=a},f.prototype.travelerIndividualLabel=function(){return this._eachTraveler},f.prototype.getTravelerTotalLabel=function(){var a,b=this._selectedTripModel,c={adults:{singular:"Adult",plural:"Adults"},children:{singular:"Child",plural:"Children"},infants:{singular:"Lap Infant",plural:"Lap Infant"}},d=0,e=[],f="Guests",g=[],h=["Guests"];for(var i in b.travelers)a=b.travelers[i],d+=a,a>0&&$.inArray(i,e)<0&&e.push(i),a>0&&(i=1===a?c[i].singular:c[i].plural,g.push(a+" "+i));1===e.length&&(f=1===d?c[e[0]].singular:c[e[0]].plural);var j=d+" "+f;return this._eachTraveler=1===e.length?h:g,j},f.prototype.setFare=function(b,c,d){var e,f=this._selectedFaresModel[b]={},g={};f.tier=d,f.tiers=c.tiers,f.flightType=c.flightType;var h=c.tiers[d];f.cost={dollars:h.dollarFare?{base:h.dollarFare.baseFare,total:h.dollarFare.totalFare}:null,points:h.pointsFare?{total:h.pointsFare.totalPoints}:null},f.taxes=this.buildTaxObj(h.taxList),a.forEach(c.legs,function(a,b,c){e={arrival:b.arrival,arrivalTime:b.arrivalTime,arrivalDateTime:b.arrivalDateTime,classOfService:a.classOfService,duration:b.duration,departure:b.departure,departureTime:b.departureTime,departureDateTime:b.departureDateTime,flightNum:b.flightNum,aircraftType:b.aircraftType},g[c]=e}.bind(this,h)),f.legs=g,this._pubSubService.publish("ancillaries.reset")},f.prototype.buildTaxObj=function(a){var b,c,d,e={};try{for(b=0,c=a.length;b<c;b++)d=a[b],e[d.taxInfo.code]=d.taxAmount}catch(a){}return e},f.prototype._defaultTripModel=function(){return{bookingType:"DOLLAR",cityPairs:[{},{}],dates:[],promoCode:"",tripType:this._constants.ROUND_TRIP,travelers:{adults:1,children:0,infants:0,pets:0}}},f.prototype.quoteType=function(){if(this._quoteModel)return this._quoteModel.type},f.prototype.setExchangeFlightList=function(a){this._exchangeFlightList=a},f.prototype.getTotalTravelers=function(){var a,b=this._selectedTripModel.travelers,c=0;for(var d in b)a=b[d],c+=a;return c},f.prototype.getTravelerList=function(b,c){var d=[],e=0;return!b&&this._tripSelectedModel&&(b=this._tripSelectedModel.travelers),a.forEach(b,function(a,b){a>0&&(e++,d.push(a+" "+this.pluralizeTravelerType(b,a)))}.bind(this)),!!(e>1||c)&&d.join(", ")},f.prototype.pluralizeTravelerType=function(a,b){return 1===b?this._travelerTypes[a].single:this._travelerTypes[a].plural},f.prototype.getFares=function(){return this._selectedFaresModel},f.prototype.getQuoteModel=function(){return this._quoteModel},f.prototype._buildSeatsRequest=function(){var b={flightId:null,flightNum:null,paxSeatList:[]},c=this.getRequestQuoteFlightIds(),d=[],f=this._travelerService.getTravelers();return a.forEach(f,function(f){a.forEach(f.seats,function(g){var h=this.isChangeType(this._changeTypes.EXISTING)?c[g.flightId-1]:g.flightId;"undefined"==typeof d[h]&&(d[h]=a.copy(b),d[h].flightNum=g.flightNum,d[h].flightId=h);var i={pax:{firstName:f.firstName,lastName:f.lastName,guestId:f.guestId},seatNum:g.seatNumber,mcCostExempt:e.isMcCostExempt(this._selectedAncillaries,g.oAndDId,f.guestId)};d[h].paxSeatList.push(i)},this)},this),d=$.grep(d,function(a){return a})},f.prototype._buildManageCompleteRequest=function(b){var c=[],d=this._buildSeatsRequest(),e={identificationInfo:{pnr:this._pnrModel.pnr,lastName:this._pnrModel.lastName},ancillaryDetails:{ancillaryList:this._serializedSelectedAncillaries},travelerInfoList:[]};if(d.length>0&&(e.seatInfo={seatFlightList:d}),this._serializedSelectedAncillaries.length){var f=this._pnrService.getSelectedFares();a.forEach(f,function(a){c.push(a.serialize("ancillaries"))}.bind(this)),e.oAndDList=c}var g=this._travelerService.getAllTravelers();if(a.forEach(g,function(a){e.travelerInfoList.push(a.serialize("apiStandard"))}.bind(this)),e.totalSeatPrice=this._seatService.calculateTotalAncillaryAmount(),e.totalExtrasPrice=this._apiAncillariesAmountData.totalExtrasWithoutSeats,b){e.paymentInfo=b;var h=b.travelBankInfo||b.multipleFormInfo&&b.multipleFormInfo.travelBankInfo;h&&(e.authToken=h.authToken)}return this._elevateService.isLoggedIn()&&(e.authToken=this._elevateService.getAuthToken()),e},f.prototype.manageComplete=function(a){var b=this._buildManageCompleteRequest(a);return this._pnrService.manageComplete(b)},f.prototype.shouldChangeSeats=function(b){var c=!1,d={MC_NONREFUNDABLE:"main",MC_REFUNDABLE:"main",MCS_NONREFUNDABLE:"mcs",MCS_REFUNDABLE:"mcs",FIRST_NONREFUNDABLE:"first",FIRST_REFUNDABLE:"first"};return this._pnrModel&&this._pnrModel.flightList?(a.forEach(this._pnrModel.flightList,function(a,e){b[e]&&d[a.cabinClass]===b[e].tier&&(c=!0)}),c):c},f.prototype.purgeRequestQuote=function(){this._quoteModel=null},f}),c("change/vx-change-app",["angular","change/controllers/change-base","change/controllers/change-options","change/controllers/change-trip","change/controllers/change-existing","change/services/change"],function(a,b,c,d,e,f){"use strict";return a.module("vxChangeApp",[]).controller("ChangeBaseCtrl",b).controller("ChangeOptionsCtrl",c).controller("ChangeTripCtrl",d).controller("ChangeExistingCtrl",e).service("changeService",f)}),c("core/providers/angular-adaptive-detection",["angular"],function(a){"use strict";return a.module("adaptive.detection",[]).provider("$detection",[function(){this.userAgent=navigator.userAgent,this.setUserAgent=function(a){this.userAgent=a},this.$get=function(){var a=this.userAgent;return{getUserAgent:function(){return a},isiOS:function(){return/(iPad|iPhone|iPod)/gi.test(a)},isiPhone:function(){return/(iPhone)/gi.test(a)},isAndroid:function(){return/(Android)/gi.test(a)},isFirefox:function(){return/(Firefox)/gi.test(a)}}}}])}),c("core/vx-core-app",["core/config/routes","core/config/http","core/controllers/core","core/services/header","core/services/app-dynamics","core/services/window","core/services/scroll","core/services/observer","core/services/ensighten","core/services/url_parser","core/services/workflow","core/services/location","core/services/elevate","core/services/check-in","core/services/manage","core/services/script-loader","core/services/pubsub","core/services/exception-handler","core/services/adobe-analytics-service","core/services/error-handler","core/services/latest-time","core/services/persistence","core/services/stub","core/services/flightalerts","core/services/config","environment","core/constants/resource-bundle","core/constants/geo-bundle","core/constants/site-map-bundle","core/constants/routes-bundle","angular","angular-touch","angular-route","angular-resource","angular-bindonce","angular-slider","api/vx-api-app","cms/vx-cms-app","angular-local-storage","common/vx-common-app","book/vx-book-app","purchase/vx-purchase-app","success/vx-success-app","check-in/vx-check-in-app","manage/vx-manage-app","flights/vx-flights-app","elevate/vx-elevate-app","pnr/vx-pnr-app","cancel/vx-cancel-app","flight-status/vx-flight-status-app","flight-alerts/vx-flight-alerts-app","change/vx-change-app","core/providers/angular-adaptive-detection"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E){
"use strict";return E.module("vxCoreApp",["ngTouch","ngRoute","ngResource","vxApiApp","vxCmsApp","LocalStorageModule","vxBookApp","vxPurchaseApp","vxCommonApp","vxCheckInApp","vxManageApp","vxFlightsApp","vxElevateApp","vxPNRApp","vxPurchaseApp","vxSuccessApp","vxCancelApp","vxFlightStatusApp","vxFlightAlertsApp","vxChangeApp","pasvaz.bindonce","adaptive.detection","vr.directives.slider","vxTemplates"]).config(a).config(b).service("envService",z).constant("ResourceBundle",A).constant("GeoBundle",B).constant("SiteMapBundle",C).constant("RoutesBundle",D).controller("CoreCtrl",c).service("headerService",d).service("locationService",l).service("workflowService",k).service("observerService",h).service("ensightenService",i).service("errorHandlerService",t).service("latestTimeService",u).service("adobeAnalyticsService",s).service("persistenceService",v).service("stubService",w).service("appDynamicsService",e).service("windowService",f).service("scrollService",g).service("elevateService",m).service("URLParser",j).service("checkInService",n).service("flightAlertsService",x).service("manageService",o).service("scriptLoaderService",p).factory("pubSubService",q).factory("$exceptionHandler",r).factory("$configApi",y)}),angular.module("vxTemplates",["/app/common/directives/accordion.tpl.html","/app/common/directives/ancillaries-selector.tpl.html","/app/common/directives/ancillary-toggle.tpl.html","/app/common/directives/app-overlay.tpl.html","/app/common/directives/calendar-widget.tpl.html","/app/common/directives/change-guider.tpl.html","/app/common/directives/city-illustration.tpl.html","/app/common/directives/country-select.tpl.html","/app/common/directives/elevate-login-form.tpl.html","/app/common/directives/exclusive-offer.tpl.html","/app/common/directives/form-address.tpl.html","/app/common/directives/form-checkbox.tpl.html","/app/common/directives/form-creditcard.tpl.html","/app/common/directives/form-date.tpl.html","/app/common/directives/form-dob.tpl.html","/app/common/directives/form-input-facade.tpl.html","/app/common/directives/form-input.tpl.html","/app/common/directives/form-select-array.tpl.html","/app/common/directives/form-select-facade.tpl.html","/app/common/directives/form-select-object.tpl.html","/app/common/directives/form-submit.tpl.html","/app/common/directives/form-textarea.tpl.html","/app/common/directives/loading.tpl.html","/app/common/directives/mobile-nav.tpl.html","/app/common/directives/modal-backdrop.tpl.html","/app/common/directives/modal-window.tpl.html","/app/common/directives/modal.tpl.html","/app/common/directives/number-picker.tpl.html","/app/common/directives/pnr-flight-summary.tpl.html","/app/common/directives/pnr-guest-list.tpl.html","/app/common/directives/pnr-payment-details.tpl.html","/app/common/directives/pnr-trip-summary.tpl.html","/app/common/directives/points-slider.tpl.html","/app/common/directives/promo.tpl.html","/app/common/directives/saved-choices-bar.tpl.html","/app/common/directives/seat-selector.tpl.html","/app/common/directives/select-box.tpl.html","/app/common/directives/social-media-buttons.tpl.html","/app/common/directives/status-bar.tpl.html","/app/common/directives/travel-advisory.tpl.html","/app/common/directives/traveler-docs.tpl.html","/app/common/directives/traveler-form.tpl.html","/app/common/directives/traveler-info.tpl.html","/app/common/directives/yts-module.tpl.html","/app/common/directives/yts.tpl.html","/app/common/templates/modals/add-passport-info.tpl.html","/app/common/templates/modals/cancel-awards-bookings.tpl.html","/app/common/templates/modals/dynamic-fare-rules.tpl.html","/app/common/templates/modals/elevate-points-blocked.tpl.html","/app/common/templates/modals/elevate-turn-down.tpl.html","/app/common/templates/modals/email-itinerary.tpl.html","/app/common/templates/modals/extras-warning.tpl.html","/app/common/templates/modals/flight-alerts.tpl.html","/app/common/templates/modals/footer.tpl.html","/app/common/templates/modals/forgot-password.tpl.html","/app/common/templates/modals/frequent-flier.tpl.html","/app/common/templates/modals/invalid-seven-day-selection.tpl.html","/app/common/templates/modals/join-alaska-mileage-plan.tpl.html","/app/common/templates/modals/known-traveler.tpl.html","/app/common/templates/modals/locate-pnr.tpl.html","/app/common/templates/modals/print-receipt.tpl.html","/app/common/templates/modals/privacy-policy.tpl.html","/app/common/templates/modals/save-to-calendar.tpl.html","/app/common/templates/modals/traveler-info-avatar-picker.tpl.html","/app/common/templates/modals/tsa-notice.tpl.html","/app/common/templates/modals/wrong-email.tpl.html","/app/common/templates/site-map.tpl.html","/app/book/templates/trip.tpl.html","/app/book/templates/trip-booker.tpl.html","/app/book/directives/book-airport-list.tpl.html","/app/book/directives/book-airport-picker.tpl.html","/app/book/directives/book-multi-city.tpl.html","/app/book/directives/book-people-picker.tpl.html","/app/book/directives/trip-type.tpl.html"]),angular.module("/app/common/directives/accordion.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/accordion.tpl.html",'<section bindonce class="accordion" ng-class="{\'is-expanded\': isExpanded, \'is-irop\': accordion.content.irop, \'first-accordion\': accordion.idx === 0,  \'is-multi-city-trip\': accordion.content.isMultiCity}" bo-class="{\'promotion\': accordion.contentType === \'promotion\'}">\n    <header class="promotion__header" bo-class="{{headerClass}}" bo-if="accordion.contentType === \'promotion\'">\n        <h2 ng-switch="isExpandable" class="promotion__header__title">\n            <a href="#" ng-switch-when="true" ng-class="{\'is-active\': isExpanded}" aria-expanded="{{isExpanded ? \'true\' : \'false\'}}" data-vx-common-prevent-default ng-click="accordion.toggleAccordion()">{{title}}</a>\n            <span ng-switch-when="false">{{title}}</span>\n        </h2>\n    </header>\n    <header class="manage-trips__manage-trip-header"\n            data-bo-attr data-bo-attr-id="\'manage-trip-\' + accordion.idx"\n            bo-if="accordion.contentType === \'manage\'"\n            ng-switch="isExpanded">\n        <a href="#" class="manage-trip-header wrap" bo-class="\'manage-trip-header--\' + accordion.content.flightList.length + \'-flights\'" data-vx-common-prevent-default ng-switch-default ng-click="accordion.toggleAccordion()">\n            <ul class="manage-trip-header__image-pair cf">\n                <li>\n                  <div vx-common-city-illustration code="{{accordion.content.flightList[0].origin}}" size="sm"></div>\n                </li>\n                <li>\n                  <div vx-common-city-illustration code="{{accordion.content.flightList[0].destination}}" size="sm"></div>\n                </li>\n            </ul>\n            <h3 class="manage-trip-header__city-pair">\n                <span ng-repeat="flight in accordion.content.flightList">\n                    <span data-bo-text="flight.origin"></span> <span class="icon icon-arrow-right-short-purple">-</span> <span data-bo-text="flight.destination"></span><span bo-if="!$last">, </span>\n                </span>\n            </h3>\n            <div class="manage-trip-header__trip-info">\n                <span data-bo-text="accordion.content.dateString"></span> &bull; <span data-bo-text="accordion.content.pnr"></span>\n            </div>\n        </a>\n        <div class="manage-trip-header manage-trip-header--expanded" ng-switch-when="true">\n            <div class="wrap">\n                <div class="manage-trip-header__city-pair-expanded">\n                    <div class="manage-trip-header__image-pair-expanded">\n                        <ul class="image-pair-expanded cf" ng-class="{\'is-multi-city\': accordion.content.isMultiCity}">\n                            <li>\n                              <div vx-common-city-illustration code="{{accordion.content.flightList[0].origin}}" size="sm"></div>\n                            </li>\n                            <li>\n                              <div vx-common-city-illustration code="{{accordion.content.flightList[0].destination}}" size="lg"></div>\n                            </li>\n                        </ul>\n                    </div>\n                    <div class="city-pair-expanded" ng-class="{\'is-multi-city\': accordion.content.isMultiCity}">\n                        <div>\n                            <ul class="city-pair-expanded__city-pair cf">\n                                <!-- Round trip origin date/time -->\n                                <li>\n                                    <span tabindex="-1">\n                                      {{accordion.content.flightList[0].origin}}\n                                      <span class="accessible-only-text">\n                                        <span ng-if="!accordion.content.isMultiCity">{{accordion.content.tripTypeLabel + \', \'}}</span>\n                                        <span ng-if=accordion.content.flightList[0].originName>{{accordion.content.flightList[0].originName}}</span>\n                                        <span ng-if=!accordion.content.flightList[0].originName>{{accordion.content.flightList[0].origin}}</span> to\n                                        <span ng-if=accordion.content.flightList[0].destinationName>{{accordion.content.flightList[0].destinationName}}</span>\n                                        <span ng-if=!accordion.content.flightList[0].destinationName>{{accordion.content.flightList[0].destination}}</span>\n                                        <span ng-if="accordion.content.isMultiCity">,\n                                          <span ng-if=accordion.content.flightList[1].originName>{{accordion.content.flightList[1].originName}}</span>\n                                          <span ng-if=!accordion.content.flightList[1].originName>{{accordion.content.flightList[1].origin}}</span> to\n                                          <span ng-if=accordion.content.flightList[1].destinationName>{{accordion.content.flightList[1].destinationName}}</span>\n                                          <span ng-if=!accordion.content.flightList[1].destinationName>{{accordion.content.flightList[1].destination}}</span>\n                                        </span>\n                                      </span>\n                                    </span>\n                                    <div class="city-pair--date" ng-if="!accordion.content.isOneWay && !accordion.content.isMultiCity" data-bo-text="accordion.localizeDateTime(accordion.content.flightList[0].departureDateTime, \'ddd, MMM D\')"></div>\n                                    <div class="city-pair--time" ng-if="!accordion.content.isOneWay && !accordion.content.isMultiCity" data-bo-text="accordion.localizeDateTime(accordion.content.flightList[0].departureDateTime, \'h:mma\')"></div>\n                                </li>\n                                <!-- Round trip destination date/time -->\n                                <li>\n                                    <span>{{accordion.content.flightList[0].destination}}</span>\n                                    <div class="city-pair--date" ng-if="!accordion.content.isOneWay && !accordion.content.isMultiCity" data-bo-text="accordion.localizeDateTime(accordion.content.flightList[1].departureDateTime, \'ddd, MMM D\')"></div>\n                                    <div class="city-pair--time" ng-if="!accordion.content.isOneWay && !accordion.content.isMultiCity" data-bo-text="accordion.localizeDateTime(accordion.content.flightList[1].departureDateTime, \'h:mma\')"></div>\n                                    <div class="city-pair-expanded__arrow" ng-class="{\'icon-arrow-right-short-purple\': !accordion.content.isRoundTrip, \'icon-round-trip-purple\': accordion.content.isRoundTrip}"></div>\n\n                                    <div class="city-pair-expanded__arrow" ng-class="{\'icon-arrow-right-short-purple\': !accordion.content.isRoundTrip, \'icon-round-trip-purple\': accordion.content.isRoundTrip}"></div>\n                                </li>\n                            </ul>\n                            <!-- oneWay | multiCity origin date/time -->\n                            <div class="city-pair-expanded__one-way-info" ng-if="accordion.content.isOneWay || accordion.content.isMultiCity">\n                                <div class="city-pair--date" ng-class="{\'is-inline\': accordion.content.isMultiCity}" data-bo-text="accordion.localizeDateTime(accordion.content.flightList[0].departureDateTime, \'ddd, MMM D\')"></div>\n                                <div class="city-pair--time" ng-class="{\'is-inline\': accordion.content.isMultiCity}" data-bo-text="accordion.localizeDateTime(accordion.content.flightList[0].departureDateTime, \'h:mma\')"></div>\n                            </div>\n                        </div>\n                        <!-- multiCity destination dateTime -->\n                        <div class="city-pair-expanded--multi-city" ng-repeat="flight in accordion.content.flightList" ng-if="accordion.content.isMultiCity && !$first">\n                            <ul class="city-pair-expanded__city-pair cf">\n                                <li>\n                                    <span data-bo-text="flight.origin"></span>\n                                </li>\n                                <li>\n                                    <span data-bo-text="flight.destination"></span>\n                                    <div class="city-pair-expanded__arrow icon-arrow-right-short-purple"></div>\n                                </li>\n                            </ul>\n                            <div class="city-pair-expanded__one-way-info">\n                                <div class="city-pair--date is-inline" data-bo-text="accordion.localizeDateTime(flight.departureDateTime, \'ddd, MMM D\')"></div>\n                                <div class="city-pair--time is-inline" data-bo-text="accordion.localizeDateTime(flight.departureDateTime, \'h:mma\')"></div>\n                            </div>\n                        </div>\n                        <div class="manage-trip-header-summary">\n                          <h2 class="manage-trip-header-title">\n                            <span ng-if="!accordion.content.isMultiCity">{{accordion.content.tripTypeLabel}}, </span>\n                            <span>{{accordion.content.flightList[0].originName || accordion.content.flightList[0].origin}}</span> to\n                             <span>{{accordion.content.flightList[0].destinationName || accordion.content.flightList[0].destination}}</span><span ng-repeat="flight in accordion.content.flightList" ng-if="accordion.content.isMultiCity && !$first">,\n                               <span>{{flight.originName || flight.origin}}</span> to\n                               <span>{{flight.destinationName || flight.destination}}</span></span>\n                          </h2>\n                          <div data-bo-text="accordion.content.pnr"></div>\n                        </div>\n                        <div data-vx-common-social-media-buttons data-flight-info="accordion.content.flightList[0]" data-is-cancel="false"></div>\n                    </div>\n                </div>\n                <div class="exclusive-offers exclusive-offers--manage-flight-for-medium-and-large" ng-if="accordion.idx == 0">\n                    <div data-vx-common-exclusive-offer\n                         data-link-type="\'manage\'"\n                         data-metrics-context="\'manage-landing\'"></div>\n                </div>\n            </div>\n            <div ng-if="accordion.content.irop" class="manage-trip-header__irop">\n                <div class="irop wrap">\n                    <p class="irop__message"><strong>Due to conditions impacting our operations this flight MAY be delayed or cancelled.</strong></p>\n                    <p class="irop__message">To change your flight, make sure to rebook online before <strong ng-bind="accordion.content.iropInfo.rebookEnd | date:\'MMM d yyyy h:mma\'"></strong>.<span ng-if="accordion.moment(accordion.content.iropInfo.rebookEnd) > accordion.moment()"> You may change your flight free of charge and we will waive the difference in fare for travel between <strong ng-bind="accordion.content.iropInfo.segmentStart | date:\'MMM d yyyy\'"></strong> and <strong ng-bind="accordion.content.iropInfo.segmentEnd | date:\'MMM d yyyy\'"></strong> on the same route as your original itinerary.</span> To find out the status of your flight <a href="/check-flight-status" class="link-underline">click here</a>.</p>\n                </div>\n            </div>\n        </div>\n    </header>\n    <section class="accordion__main" ng-class="{\'is-active\': isExpanded}" bo-class="{\'promotion__main wrap\': accordion.contentType === \'promotion\', \'manage-trip__accordion-main\': accordion.contentType === \'manage\'}">\n    </section>\n</section>')}]),angular.module("/app/common/directives/ancillaries-selector.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/ancillaries-selector.tpl.html",'<section bindonce refresh-on="\'ancSelector.refreshView\'" id="anc-selector" class="anc-selector" bo-show="ancSelector.isVisible && ancSelector.shouldDisplayAncillaries()">\n  <div class="collapse-container">\n    <div class="wrap" data-vx-common-collapsible-section collapsed="ancSelector.isCollapsed">\n      <div class="collapsed-overlay" ng-show="ancSelector.isCollapsed">\n        <h1>Extras</h1>\n        <ul class="collapse-overlay-info--list" bo-if="ancSelector.collapsedAncillaryList.length > 0">\n          <li ng-repeat="ancillary in ancSelector.collapsedAncillaryList" bo-text="ancillary"></li>\n        </ul>\n        <a href="#" data-vx-common-prevent-default class="cta-button btn btn-third" ng-click="collapsible.expand(ancSelector.changeSection, null, true)">Change <span class="accessible-only-text">Ancillaries</span></a>\n      </div>\n\n      <div class="anc-selector__detail anc-selector__content" ng-show="!ancSelector.isCollapsed">\n        <div class="anc-selector__header">\n          <h1 class="anc-selector__title" tabindex="-1">Select Extras to Customize Your Trip</h1>\n          <a class="anc-selector__skip" href="#" data-vx-common-prevent-default ng-click="ancSelector.skipSection()">Skip this Step</a>\n          <a class="anc-selector__fees" href="/cms/vx-fees" target="_blank">Fees</a>\n        </div>\n\n        <div ng-repeat="ancillary in ancSelector.accordionAncillaryList track by $index"\n             class="anc-selector-accordion-wrapper"\n             bo-show="!ancillary.isFreeForAllPax && ancillary.isEligibleForActiveCurrency"\n             bo-class="{\n               \'anc-selector-accordion-wrapper--hidden\': ancSelector.hasFullySelectedParent(ancillary.bundleId)\n             }">\n\n          <div class="anc-selector-accordion"\n               vx-common-ally-click="ancSelector.toggleAccordion(ancillary, $event)"\n               ng-class="{\n                 \'anc-selector-accordion--open\': ancSelector.isAccordionVisible(ancillary.ancillaryId),\n                 \'anc-selector-accordion--bundle\': ancillary.isBundle\n               }">\n\n            <div class="anc-selector-accordion__trigger">\n              <div class="cf">\n                <h4 class="anc-selector-accordion__title" bo-text="ancillary.title"></h4>\n                <div class="anc-selector-accordion__price-details">\n                  <div class="anc-selector-accordion__price-label"\n                       ng-if="ancSelector.getGroupPriceLabel(ancillary)">\n                       {{ancSelector.getGroupPriceLabel(ancillary)}}</div>\n                  <div class="anc-selector-accordion__max-percent-off"\n                       bo-if="ancillary.callToAction"\n                       bo-text="ancillary.callToAction"></div>\n                  <div class="anc-selector-accordion__no-thanks">\n                    <a href="#" vx-common-ally-click="ancSelector.onNoThanksClick(ancillary.ancillaryId)"\n                       ng-attr-tabindex="{{ancSelector.isAccordionVisible(ancillary.ancillaryId) ? 0 : -1}}">No Thanks</a>\n                  </div>\n                </div>\n              </div>\n              <div class="anc-selector-accordion__sub-wrap">\n                <p class="anc-selector-accordion__desc">\n                  <span bo-text="ancillary.description"></span>\n                </p>\n                <ul class="anc-selector-accordion__check-list" bo-if="ancillary.bundleFeatures">\n                  <li class="anc-selector-accordion__check-list-item" ng-repeat="feature in ancillary.bundleFeatures">\n                    <span class="ancillary-included-check icon-check"></span><span bo-html="feature"></span>\n                  </li>\n                </ul>\n                <ul class="anc-selector-accordion__check-list"\n                    bo-if="ancSelector.showIncludedListFor(ancillary)">\n                  <li class="anc-selector-accordion__check-list-item" ng-repeat="includedData in ancillary.includedListData">\n                    <span class="anc-selector-accordion__check-list-item--inner"\n                          bo-if="ancSelector.getIncludedTextFor(ancillary, includedData)">\n                      <span class="ancillary-included-check icon-check"></span>\n                      <span bo-html="ancSelector.getIncludedTextFor(ancillary, includedData)"></span>\n                    </span>\n                  </li>\n                </ul>\n              </div>\n            </div>\n            <div class="anc-selector-accordion__content" ng-class="{\'anc-selector-accordion__content--visible\': ancSelector.isAccordionVisible(ancillary.ancillaryId)}" bo-if="!ancSelector.isCollapsed" ng-attr-aria-hidden="{{!ancSelector.isAccordionVisible(ancillary.ancillaryId)}}">\n              <ul class="anc-selector-travelers"\n                  ng-class="{\'anc-selector-travelers--single-quantity\': ancillary.maxQuantity === 1}">\n                <li ng-repeat="traveler in ancSelector.travelers" class="anc-selector-travelers__item cf">\n                  <p class="anc-selector-travelers__name" bo-text="traveler.name"></p>\n                  <div class="anc-selector-travelers__toggle-list anc-selector-travelers__toggle-list--double cf">\n                    <div\n                    ng-repeat="level in ancillary.levelList"\n                    data-vx-common-ancillary-toggle\n                    airport-codes="ancSelector.fareLevelData[level.id].airportCodes"\n                    ancillary="ancillary"\n                    accordion-is-collapsed="!ancSelector.isAccordionVisible(ancillary.ancillaryId)"\n                    level="{{level.id}}"\n                    included-in-tier="level.includedInTier"\n                    not-eligible="level.notEligible"\n                    guest-id="{{traveler.guestId}}"\n                    is-primary-traveler="traveler.isPrimary"\n                    trip-type="{{ancSelector.fareLevelData[\'PNR\'].tripType}}"\n                    tier-name="ancSelector.formatTierName(ancSelector.fareLevelData[level.id].tier)"\n                    tier-baggage-count="ancSelector.getTierBaggageCount(\n                      ancillary,\n                      ancSelector.fareLevelData[level.id].tier,\n                      level.id,\n                      traveler.guestId)"\n                    is-last-level="$last"></div>\n                  </div>\n                </li>\n              </ul>\n              <p class="anc-selector__note" bo-if="ancillary.isBag">\n                <strong>Alaska MVP, MVP Gold and MVP Gold 75k</strong> Mileage Plan members will receive up to two free checked bags at check-in for you and your companions traveling on the same reservation. Bags purchased during booking will be in addition to your member baggage allowance. To receive your baggage fee waivers, add all eligible bags during check-in for your flight.\n              </p>\n              <p class="anc-selector__note" bo-if="ancillary.isBag">\n                <strong>Credit Cardholders</strong> When you use an Alaska Airlines Visa Signature® Card or Alaska Airlines Visa® Business Card to purchase your ticket, you will receive one free checked bag for yourself and up to 6 guests traveling in the same reservation. Bags purchased during booking will be in addition to your cardholder baggage allowance. To receive your baggage fee waivers, add all eligible bags during check-in for your flight.\n              </p>\n            </div>\n          </div><!-- /accordion -->\n        </div><!-- /accordion wrapper -->\n        <a href="#"\n           class="anc-selector__btn btn btn-primary btn-xl btn-block"\n           vx-common-ally-click="ancSelector.continue()"\n           bo-text="ancSelector.getButtonText()"></a>\n        <p class="anc-selector__fees-info">View a full list of our fees, services, and terms and conditions <a href="/cms/vx-fees" target="_blank" class="link-underline">here</a>.</p>\n      </div>\n    </div>\n  </div>\n</section>')}]),angular.module("/app/common/directives/ancillary-toggle.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/ancillary-toggle.tpl.html",'<div\nbindonce\nrefresh-on="\'ancToggle.refreshView\'"\nclass="anc-selector-toggle"\nbo-show="ancToggle.showToggle()"\nbo-class="{\n  \'anc-selector-toggle--single\': !ancToggle.isMultiQuantity,\n  \'anc-selector-toggle--multiple\': ancToggle.isMultiQuantity,\n  \'anc-selector-toggle--selected\': ancToggle.isSelected && !ancToggle.isIncluded,\n  \'anc-selector-toggle--disabled\': !ancToggle.isEligible,\n  \'anc-selector-toggle--included\': ancToggle.isIncluded,\n  \'anc-selector-toggle--bundle\': ancillary.isBundle,\n  \'anc-selector-toggle--full-width\': ancToggle.isFullWidth(),\n  \'anc-selector-toggle--baggage-count\': tierBaggageCount,\n  \'anc-selector-toggle--is-pnr-ancillary\': ancToggle.isPnrAncillary(),\n  \'anc-selector-toggle--on-seat-map\': ancToggle.isOnSeatMap(),\n}">\n  <label>\n    <span bo-if="ancToggle.isAvailable() && !ancToggle.isMultiQuantity && !accordionIsCollapsed">\n      <input class="input-checkbox anc-selector-toggle__checkbox"\n             type="checkbox" ng-checked="ancToggle.isSelected" vx-common-ally-click="ancToggle.onToggle()">\n    </span>\n    <span class="ancillary-included-check icon-check"\n          ng-if="ancToggle.shouldShowCheckIcon()"></span>\n    <span class="anc-selector-toggle__city-pair" bo-if="ancToggle.isOAndDAncillary()">\n      <span bo-text="ancToggle.airportCodes[0]"></span>\n      &rarr;\n      <span bo-text="ancToggle.airportCodes[1]"></span><span\n            bo-if="tierName" bo-text="\', \' + tierName"></span>\n    <span class="anc-selector-toggle__city-pair" bo-if="ancToggle.isPnrAncillary()">\n      <span bo-text="ancToggle.airportCodes[0]"></span> <span bo-if="ancToggle.isRoundTrip()" class="anc-selector-toggle__icon-round-trip icon-round-trip-2"></span><span bo-if="ancToggle.isOneWayTrip()">&rarr;</span> <span bo-text="ancToggle.airportCodes[1]"></span>\n    </span>\n    <span class="anc-selector-toggle__city-pair" bo-if="ancToggle.isMultiCityTrip()">\n      <span bo-text="ancToggle.airportCodes[0]"></span> &rarr;&larr;\n      <span bo-text="ancToggle.airportCodes[1]"></span><span\n            bo-if="tierName" bo-text="\', \' + tierName"></span>\n    </span>\n    </span>\n\n    <!-- labels and prices -->\n    <p class="anc-selector-toggle__label"\n       bo-if="ancToggle.getLabel() && !ancToggle.isOnSeatMap()"\n       bo-text="ancToggle.getLabel()"/>\n    <span bo-if="!ancToggle.isMultiQuantity && ancToggle.isAvailable() && !ancToggle.isOnSeatMap()"\n          class="anc-selector-toggle__price"\n          bo-text="ancToggle.price"/>\n    <span bo-if="ancToggle.isOnSeatMap()"\n          class="anc-selector-toggle__seat-map-label"\n          bo-class="{\'anc-selector-toggle__seat-map-label--available\': ancToggle.isAvailable()}"\n          bo-text="ancToggle.getLabel()"/>\n    <span bo-if="!ancToggle.isAvailable() && ancToggle.isOnSeatMap()" class="anc-selector-toggle__seat-map-label"></span>\n\n    <div class="anc-selector-toggle__sub" bo-if="ancToggle.isEligible">\n      <div bo-if="ancToggle.isMultiQuantity" class="number-picker--ancillary">\n        <ul class="number-picker__controls" bo-if="!accordionIsCollapsed"\n            bo-class="{\'anc-selector-toggle--notier-name\': !tierName}">\n            <li class="number-picker__add" vx-common-ally-click="ancToggle.increment()">\n              <a href="#"\n                 tabindex="-1"\n                 data-vx-common-prevent-default\n                 class="icon-plus">ADD</a>\n            </li>\n            <li class="number-picker__minus" vx-common-ally-click="ancToggle.decrement()">\n              <a href="#"\n                 tabindex="-1"\n                 data-vx-common-prevent-default\n                 class="icon-minus">SUBTRACT</a>\n            </li>\n        </ul>\n      </div>\n    </div>\n  </label>\n  <span class="anc-selector-toggle__baggage-count" bo-if="tierBaggageCount">\n    <span class="ancillary-included-check icon-check"/><span class="anc-selector-toggle__baggage-count-text"><span bo-text="tierBaggageCount"/> included</span>\n  </span>\n</div>')}]),angular.module("/app/common/directives/app-overlay.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/app-overlay.tpl.html",'<div id="app-overlay" ng-hide="!isVisible"></div>')}]),angular.module("/app/common/directives/calendar-widget.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/calendar-widget.tpl.html",'<section bindonce class="calendar-widget">\n    <div class="modal__header icon-vx-simplified-color-black">\n        <a href="#" class="calendar-widget__close modal__close ir" data-vx-common-hover-class="icon-close" vx-common-ally-click="calWidget.close()" tabindex="0" role="button">Close</a>\n    </div>\n    <header class="calendar-widget__header">\n        <h1 class="calendar-widget__title accessible-only-text">Calendar. Select a date.</h1>\n        <h2>{{calWidget.monthTitle}}</h2>\n        <ul class="calendar-widget-controls" tabindex="-1">\n            <li><a href="#" class="icon-arrow-left" data-vx-common-prevent-default vx-common-ally-click="calWidget.showPrevMonth()" ng-class="{\'is-disabled\': calWidget.noPrevMonths}" data-role="button" tabindex="0">Previous Month</a></li>\n            <li><a href="#" class="icon-arrow-right" data-vx-common-prevent-default vx-common-ally-click="calWidget.showNextMonth()" ng-class="{\'is-disabled\': calWidget.noNextMonths}" data-role="button" tabindex="0">Next Month</a></li>\n        </ul>\n    </header>\n    <div class="calendar-widget__widget-month" vx-common-ally-application role="application">\n        <ul class="widget-month__days-of-week">\n            <li ng-repeat="day in calWidget.days track by $index" bo-class="{\'is-omega\': $last}" bo-text="day | limitTo:2"></li>\n        </ul>\n        \n        <ul class="widget-month__widget-days" role="grid" ng-focus="allyApp.isFocused(\'.widget-days__widget-day\', \'.widget-month__widget-days\')" ng-blur="allyApp.lostFocus()" tabindex="0">\n            <li class="widget-days__widget-day" \n                ng-repeat="day in calWidget.currentMonth"                \n                ng-class="{\'is-filler is-disabled\': day.isFiller, \'is-disabled\': day.isDisabled}"\n                vx-common-ally-click="calWidget.selectDay(day)" \n                tabindex="-1" \n                role="gridcell">                \n                <span class="accessible-only-text">{{calWidget.days[day.dayOfWeek]}} {{calWidget.monthSpelled}}</span> {{day.day}}            \n                <span class="accessible-only-text">, {{day.year}}</span>            \n            </li>\n        </ul>\n    </div>\n</section>')}]),angular.module("/app/common/directives/change-guider.tpl.html",[]).run(["$templateCache",function(a){
a.put("/app/common/directives/change-guider.tpl.html",'<p class="change-guider" ng-class="{\'is-collapsed\': isNavActive}" bindonce="changeGuider" ng-if="changeGuider.msg" ng-cloak>\n    <span ng-bind="changeGuider.msg"></span>\n    <a ng-click="changeGuider.cancelChange()" class="change-guider__link">Cancel <span>&times;</span></a>\n</p>')}]),angular.module("/app/common/directives/city-illustration.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/city-illustration.tpl.html",'<div\n  class="city-illustration"\n  bo-class="{\n    \'city-illustration--missing\': !cityIllustration.source,\n    \'city-illustration--sm\': cityIllustration.size === \'sm\'\n  }">\n  <img\n    class="city-illustration__image"\n    data-bo-src="cityIllustration.source"\n    bo-alt="cityIllustration.name + \' (\' + cityIllustration.code + \')\'"\n  />\n  <div class="city-illustration__code"><span>{{cityIllustration.code}}</span></div>\n</div>\n')}]),angular.module("/app/common/directives/country-select.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/country-select.tpl.html",'<div ng-class="{\'is-valid\': select.isValid && select.isFocused && select.value, \'is-invalid\': select.isValid === false}" ng-show="select.isVisible">\n    <select class="{{select.selectClass}}"\n            name="{{select.name}}"\n            vx-common-custom-select\n            ng-model="select.value"\n            ng-options="value.name for value in select.options"\n            ng-change="select.validateValue(select.value)"\n            ng-switch="select.hasTitle">\n        <option value="" ng-switch-when="true">{{select.title}}</option>\n    </select>\n</div>')}]),angular.module("/app/common/directives/elevate-login-form.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/elevate-login-form.tpl.html",'<div>\n    <section class="log-in-form">\n        <header class="log-in-form__header log-in-form__header--elevate"  ng-show="contextIsElevate || contextIsElevateShop">\n            <h3>Log in to Virgin America</h3>\n        </header>\n        <header class="log-in-form__header" ng-show="contextIsChange || contextIsCheckIn">\n            <h3>Former Elevate Members</h3>\n            <p class="log-in-form__receipt" ng-show="contextIsChange || contextIsCheckIn">\n                <a href="#" vx-common-ally-click="universalReceipt.openModal()" data-vx-common-universal-receipt>Looking for a receipt?</a>\n            </p>\n        </header>\n        <form method="POST" class="log-in-form__form"\n            data-vx-form-handler\n            data-fields="elevateLoginForm.fields"\n            data-submit-message="Sign in"\n            data-submit-error-message="Sign in"\n            data-on-success="elevateLoginForm.doLogin()"\n        >\n            <div ng-show="!elevateLoginForm.isRecognizedUser">\n              <input data-vx-form-input data-vx-e2e-signin-email data-validate="required,emailOrNumber" name="email" data-input-label="Email" data-is-visible="!elevateLoginForm.isRecognizedUser" autocorrect="off" autocapitalize="off" />\n            </div>\n            <div ng-show="elevateLoginForm.isRecognizedUser">\n                <p class="log-in-form__been-away">You’ve been away for a while. Please enter your password so we know it’s you.</p>\n                <div class="log-in-form__user-card">\n                    <div class="user-card">\n                        <div class="user-card__image" ng-show="elevateLoginForm.avatar">\n                            <span class="icon-avatar-{{elevateLoginForm.avatar}}-sm"></span>\n                        </div>\n                        <div class="user-card__info">\n                            <h3>{{elevateLoginForm.name}}</h3>\n                            <a href="#" class="link-underline" data-vx-common-prevent-default ng-click="elevateLoginForm.destroyRecognized()">Not you?</a>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <input data-vx-form-input data-vx-e2e-signin-password data-validate="required" name="password" type="password" data-input-label="Password" />\n            <div class="log-in-form__extra cf" ng-class="{\'is-tight\': elevateLoginForm.isRecognizedUser}">\n                <a href="#" class="link-underline log-in-form__link" data-vx-common-prevent-default vx-common-ally-click="elevateLoginForm.showForgotPassword()">Forgot?</a>\n            </div>\n            <div ng-switch="formContext">\n                <button data-vx-form-submit ng-switch-when="change"/>\n                <button data-vx-form-submit data-alt-classes="btn-check-in-primary" ng-switch-when="check-in" />\n                <button data-vx-form-submit data-alt-classes="btn-primary" ng-switch-when="elevate" />\n                <button data-vx-form-submit data-alt-classes="btn-alt-primary" ng-switch-when="elevate-shop" />\n                <button data-vx-form-submit data-alt-classes="btn-primary" ng-switch-default />\n            </div>\n        </form>\n    </section>\n    <div ng-if="contextIsElevateShop" class="is-vishidden">\n        <form id="transfer" name="SSOGatewayForm" method="post" action="#">\n            <input type="hidden" name="ssoSource" value="vx">\n            <input type="hidden" name="ssoProduct" value="earn">\n            <input type="hidden" name="ssodata" ng-value="elevateLoginForm.authToken">\n            <input type="submit" value="Submit" />\n        </form>\n    </div>\n</div>')}]),angular.module("/app/common/directives/exclusive-offer.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/exclusive-offer.tpl.html",'<div class="exclusive-offer" ng-if="exclusiveOffer" ng-class="{\'exclusive-offer--ninja-mode\': ninjaMode}">\n\n  <!-- subhead -->\n  <img class="exclusive-offer__logo" alt="{{exclusiveOffer.subheadText}}"\n    ng-if="exclusiveOffer.subheadImage"\n    ng-src="{{exclusiveOffer.subheadImage}}">\n\n  <div class="exclusive-offer__subhead"\n    ng-if="!exclusiveOffer.subheadImage && exclusiveOffer.subheadText">\n    {{exclusiveOffer.subheadText}}\n  </div>\n\n  <!-- headline & text -->\n  <h2 class="exclusive-offer__headline">{{exclusiveOffer.headline}}</h2>\n  <p class="exclusive-offer__text">{{exclusiveOffer.text}}</p>\n\n  <!-- image -->\n  <img class="exclusive-offer__image" alt="{{exclusiveOffer.headline}}"\n    ng-if="exclusiveOffer.image"\n    ng-src="{{exclusiveOffer.image}}">\n\n  <!-- link -->\n  <a ng-href="{{exclusiveOffer.link}}" class="exclusive-offer__link btn"\n    ng-click="exclusiveOffer.onClick()" target="_blank"\n    ng-class="{\'btn-primary btn-alaska\': !ninjaMode, \'btn-secondary\': ninjaMode}" vx-common-link>\n    {{exclusiveOffer.linkText}}\n  </a>\n\n  <!-- legal -->\n  <p class="exclusive-offer__legal" ng-if="exclusiveOffer.legal">\n    {{exclusiveOffer.legal}}\n  </div>\n</div>')}]),angular.module("/app/common/directives/form-address.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/form-address.tpl.html",'<!-- address 1 -->\n<input data-vx-form-input\n       data-input-autocompletetype="street-address"\n       data-input-autocomplete="on"\n       type="text"\n       name="addressOne"\n       placeholder="Address 1"\n       data-use-placeholder-polyfill="true"\n       data-input-label="Address 1"\n       data-has-inner-label="hasInnerLabel"\n       data-validate="required,address"\n       data-vx-address-auto-complete\n       data-address-auto-complete-form="on"\n       data-field-group="{{fieldGroup}}"\n       data-autocomplete-address-field\n       role="combobox" />\n\n<!-- address 2 -->\n<input data-vx-form-input\n       type="text"\n       name="addressTwo"\n       data-input-label="Address 2"\n       data-has-inner-label="hasInnerLabel"\n       data-validate="optional,address"\n       data-field-group="{{fieldGroup}}"\n       placeholder="Address 2"\n       data-use-placeholder-polyfill="true"\n       data-autocomplete-address-field />\n\n<!-- city -->\n<input data-vx-form-input\n       data-input-autocompletetype="city"\n       data-input-autocomplete="on"\n       type="text"\n       name="city"\n       data-has-inner-label="hasInnerLabel"\n       data-input-label="City"\n       data-validate="required,city"\n       data-field-group="{{fieldGroup}}"\n       placeholder="City"\n       data-use-placeholder-polyfill="true"\n       data-autocomplete-address-field />\n\n<!-- state -->\n<!-- state text-box -->\n<div ng-if="addressForm.stateIsDisabled" ng-hide="addressForm.stateIsDisabled || !addressForm.stateListIsEmpty">\n  <input data-vx-form-input\n         type="text"\n         name="state"\n         data-input-label="State or Province"\n         data-has-inner-label="hasInnerLabel"\n         placeholder="State or Province"\n         data-validate="optional,address"\n         autocorrect="off"\n         data-field-group="{{fieldGroup}}"\n         data-use-placeholder-polyfill="true"\n         data-autocomplete-address-field />\n</div>\n\n<!-- state drop-down -->\n<div class="form__input form__input--block form__input--inner-label"\n     ng-hide="addressForm.stateListIsEmpty"\n     ng-if="!addressForm.stateIsDisabled && !addressForm.stateListIsEmpty">\n  <div data-vx-form-select-array\n       data-select-class="select select--block"\n       data-select-name="stateSelect"\n       data-select-title="State or Province"\n       data-select-options="addressForm.states"\n       data-validate="required"\n       data-field-group="{{fieldGroup}}"\n       data-autocomplete-address-field></div>\n  <span class="label dropdown__label extended"><span class="label__content">State or Province</span></span>\n</div>\n\n<!-- state list loading -->\n<div class="form__input form__input--block form__input--inner-label"\n     ng-if="addressForm.stateIsDisabled">\n  <div class="select select--block">\n    State or Province\n    <span class="loading__ellipsis">\n      <span>&bull;</span><span>&bull;</span><span>&bull;</span>\n    </span>\n  </div>\n</div>\n\n<div class="cf">\n  <!-- zip code -->\n  <div class="input-inline is-one-half hide-input-messages">\n    <input data-vx-form-input\n           data-input-autocompletetype="postal-code"\n           data-input-autocomplete="on"\n           type="text"\n           name="zipCode"\n           maxlength="5"\n           data-has-inner-label="hasInnerLabel"\n           placeholder="ZIP Code"\n           data-input-label="ZIP Code"\n           data-validate="required,usZip"\n           data-field-group="{{fieldGroup}}"\n           placeholder="Zip Code"\n           data-use-placeholder-polyfill="true"\n           data-autocomplete-address-field />\n  </div>\n\n  <!-- country -->\n  <div ng-if="!addressForm.isDisabled(\'country\')"\n       class="form__input select-inline form__input--inner-label is-one-half is-last-child">\n    <div data-vx-form-select-array\n         data-select-class="select select--block"\n         data-select-name="country"\n         data-select-title="Country"\n         data-select-options="addressForm.countries"\n         data-validate="required"\n         data-field-group="{{fieldGroup}}"\n         data-autocomplete-address-field ></div>\n    <span class="label dropdown__label"><span class="label__content">Country</span></span>\n  </div>\n\n  <!-- state list loading -->\n  <div class="form__input cf"\n       ng-if="addressForm.stateIsDisabled">\n    <span class="label">State or Province</span>\n    <div class="select select--block">\n      Select State or Province\n      <span class="loading__ellipsis">\n        <span>&bull;</span><span>&bull;</span><span>&bull;</span>\n      </span>\n    </div>\n  </div>\n</div>\n\n<!-- nickname -->\n<input data-vx-form-input\n       type="text"\n       name="addressName"\n       data-input-label="Address\' nickname"\n       placeholder="Address\' nickname"\n       data-validate="optional"\n       autocorrect="off"\n       ng-if="isElevateUser && !addressForm.isDisabled(\'addressName\')"\n       data-field-group="{{fieldGroup}}" />')}]),angular.module("/app/common/directives/form-checkbox.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/form-checkbox.tpl.html",'<div class="form__checkbox {{checkbox.class}}" ng-show="checkbox.isVisible">\n  <label class="label" ng-class="{\'is-invalid\': checkbox.isInputValid() === false && !checkbox.isOptional}">\n      <input\n        class="input-checkbox"\n        type="checkbox"\n        ng-model="checkbox.value"\n        ng-change="checkbox.validateValue(checkbox.value)"\n        ng-required="!checkbox.isOptional"\n      />\n      {{checkbox.label}}\n      <span class="extra" ng-transclude></span>\n  </label>\n</div>')}]),angular.module("/app/common/directives/form-creditcard.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/form-creditcard.tpl.html",'<div class="form__credit-card">\n  <input data-vx-form-input data-id="cardNumber" type="text" name="{{name}}" data-input-label="{{inputLabel}}" data-validate="required,creditCardNumber,creditCard" autocorrect="off" maxlength="16" pattern="\\d*" data-input-readonly="{{inputReadonly}}" data-input-autocompletetype="cc-number" data-input-autocomplete="on" data-input-class="{{inputClass}}" placeholder="{{placeholder}}" data-has-inner-label="{{hasInnerLabel}}" data-field-group="{{fieldGroup}}" />\n  <ul class="card-list cf" ng-hide="inputReadonly">\n      <li class="card-list__amex" ng-class="{\'is-inactive\': cc.creditCardEntered && cc.creditCardType !== \'amex\'}">American Express</li>\n      <li class="card-list__discover" ng-class="{\'is-inactive\': cc.creditCardEntered && cc.creditCardType !== \'discover\'}">Discover</li>\n      <li class="card-list__mastercard" ng-class="{\'is-inactive\': cc.creditCardEntered && cc.creditCardType !== \'mastercard\'}">Mastercard</li>\n      <li class="card-list__visa" ng-class="{\'is-inactive\': cc.creditCardEntered && cc.creditCardType !== \'visa\'}">Visa</li>\n      <li class="card-list__uatp" ng-class="{\'is-inactive\': cc.creditCardEntered && cc.creditCardType !== \'uatp\'}">UATP</li>\n  </ul>\n</div>')}]),angular.module("/app/common/directives/form-date.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/form-date.tpl.html",'<div class="form__date form__input--tight">\n    <div class="input-wrap--date-inline">\n        <span class="label" ng-if="!date.inline">{{label}}</span>\n        <div class="date-inline cf">\n            <span class="label" ng-if="date.inline">{{label}}</span>\n            <div class="select-inline" ng-class="{\'is-valid\': date.isValid, \'is-invalid\': date.isValid === false && !month}">\n                <select vx-common-custom-select\n                        class="select select--date-month"\n                        data-placeholder-text="date.innerPlaceholderArray[0]"\n                        ng-class="{\'select--optional\': date.isOptional}"\n                        ng-change="date.dateChanged(month)"\n                        ng-model="month"\n                        ng-options="m.name for m in months">\n                    <option value="">Month</option>\n                </select>\n                <span class="label dropdown__label"><span class="label__content">Month</span></span>\n            </div>\n            <div class="select-inline" ng-class="{\'is-valid\': date.isValid, \'is-invalid\': date.isValid === false && !day}">\n                <select vx-common-custom-select\n                        class="select select--date-day"\n                        data-placeholder-text="date.innerPlaceholderArray[1]"\n                        ng-model="day"\n                        ng-class="{\'select--optional\': date.isOptional}"\n                        ng-change="date.dateChanged()"\n                        ng-options="option as option for option in days">\n                    <option value="">Day</option>\n                </select>\n                <span class="label dropdown__label"><span class="label__content">Day</span></span>\n            </div>\n            <div class="select-inline is-last-child" ng-class="{\'is-valid\': date.isValid, \'is-invalid\': date.isValid === false && !year}">\n                <select vx-common-custom-select\n                        class="select select--date-year"\n                        data-placeholder-text="date.innerPlaceholderArray[2]"\n                        ng-model="year"\n                        ng-class="{\'select--optional\': date.isOptional}"\n                        ng-change="date.dateChanged()"\n                        ng-options="options as options for options in years">\n                    <option value="">Year</option>\n                </select>\n                <span class="label dropdown__label"><span class="label__content">Year</span></span>\n            </div>\n        </div>\n    </div>\n</div>')}]),angular.module("/app/common/directives/form-dob.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/form-dob.tpl.html",'<div class="form__dob form__input" ng-class="dob.inputClass">\n    <div class="input-wrap--date-inline">\n        <fieldset>\n            <legend class="label" ng-if="!dob.inline">Born on:</legend>\n            <div class="date-inline cf">\n                <legend class="label" ng-if="dob.inline">Born on:</legend>\n                <div class="select-inline {{dob.selectInlineClass}}" ng-class="{\'is-valid\': dob.isValid, \'is-invalid\': dob.isValid === false && !month}">\n                    <label class="accessible-hidden-label" for="select--date-month">Born on Month. This field is required.</label>\n                    <select vx-common-custom-select\n                            required\n                            class="select select--date-month"\n                            id="select--date-month"\n                            data-placeholder-text="dob.innerPlaceholderArray[0]"\n                            ng-change="dateChanged(month)"\n                            ng-model="month"\n                            ng-options="m.name for m in months"\n                            ng-class="{\'is-eyebrow\': dob.eyebrowArray[0]}">\n                        <option value="">Month</option>\n                    </select>\n                    <span class="label dropdown__label"><span class="label__content">Month</span></span>\n                    <span class="input-message-eyebrow" ng-bind="dob.eyebrowArray[0]"></span>\n                </div>\n                <div class="select-inline {{dob.selectInlineClass}}" ng-class="{\'is-valid\': dob.isValid, \'is-invalid\': dob.isValid === false && !day}">\n                    <label class="accessible-hidden-label" for="select--date-day">Born on Day. This field is required.</label>\n                    <select vx-common-custom-select\n                            required\n                            ng-model="day"\n                            class="select select--date-day"\n                            id="select--date-day"\n                            data-placeholder-text="dob.innerPlaceholderArray[1]"\n                            ng-change="dateChanged()"\n                            ng-options="option as option for option in days"\n                            ng-class="{\'is-eyebrow\': dob.eyebrowArray[1]}">\n                        <option value="">Day</option>\n                    </select>\n                    <span class="label dropdown__label"><span class="label__content">Day</span></span>\n                    <span class="input-message-eyebrow" ng-bind="dob.eyebrowArray[1]"></span>\n                </div>\n                <div class="select-inline is-last-child {{dob.selectInlineClass}}" ng-class="{\'is-valid\': dob.isValid, \'is-invalid\': dob.isValid === false && !year}">\n                    <label class="accessible-hidden-label" for="select--date-year">Born on Year. This field is required.</label>\n                    <select vx-common-custom-select\n                            required\n                            ng-model="year"\n                            class="select select--date-year"\n                            id="select--date-year"\n                            data-placeholder-text="dob.innerPlaceholderArray[2]"\n                            ng-change="dateChanged()"\n                            ng-options="options as options for options in years"\n                            ng-class="{\'is-eyebrow\': dob.eyebrowArray[2]}">\n                        <option value="">Year</option>\n                    </select>\n                    <span class="label dropdown__label"><span class="label__content">Year</span></span>\n                    <span class="input-message-eyebrow" ng-bind="dob.eyebrowArray[2]"></span>\n                </div>\n            </div>\n        </fieldset>\n    </div>\n</div>')}]),angular.module("/app/common/directives/form-input-facade.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/form-input-facade.tpl.html",'<div bindonce="facadeInput.inputClass"\n     class="form__input facade-form-input"\n     bo-class="facadeInput.inputClass">\n  <label class="label">\n    <div class="input-wrap">\n      <div class="input-text facade-form-input__input-text"\n           ng-click="facadeInput.ngClick && facadeInput.ngClick()"\n           ng-focus="facadeInput.ngFocus && facadeInput.ngFocus()"\n           ng-blur="facadeInput.ngBlur && facadeInput.ngBlur()"\n           ng-class="{\n               \'is-label\': facadeInput.label,\n               \'is-disabled\': facadeInput.disabled,\n               \'is-placeholder\': facadeInput.isPlaceholder()\n           }">\n        <span class="facade-form-input__value">\n          {{facadeInput.getValue()}}\n        </span>\n      </div>\n      <span class="label__content">{{facadeInput.label}}</span>\n\n      <span class="input-message-validate is-valid"\n            bo-text="facadeInput.validMessage"></span>\n\n      <span class="input-message-validate is-invalid">\n        {{facadeInput.getInvalidMessage()}}\n      </span>\n    </div>\n  </label>\n</div>')}]),angular.module("/app/common/directives/form-input.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/form-input.tpl.html",'<div class="form__input {{input.inputClass}}"\n     ng-show="input.isVisible"\n     ng-class="{\'form__input--empty\': input.isEmpty(), \'form__input--readonly\': input.readonly}">\n    <label class="label {{input.labelClass}}">\n        <span class="label__content">\n          <span aria-hidden="true">{{input.placeholder || input.label}}</span>\n          <span class="accessible-only-text">\n            This field is <span ng-bind="input.isOptional ? \'optional\' : \'required\'"></span>.\n            <span ng-if="input.inputHint">Hint: {{input.inputHint}}</span>\n          </span>\n        </span>\n        <span ng-show="!input.label && !input.placeholderSupport && input.showFakePlaceholder" ng-bind="input.placeholder || input.label"></span>\n        <div class="input-wrap">\n            <input\n                placeholder="{{input.placeholder || input.label}}"\n                maxlength="{{input.maxLength}}"\n                autocomplete="{{input.autocomplete}}"\n                class="input-text"\n                ng-required="!input.isOptional"\n                ng-readonly="input.readonly"\n                ng-model="input.value"\n                ng-change="input.validateValue(input.value)"\n                ng-focus="input.readValidationOnFocus($event); input.ngFocus && input.ngFocus()"\n                ng-blur="input.ngBlur && input.ngBlur()"\n                autocompletetype="{{input.autocompletetype}}"\n                ng-class="{\n                    \'is-valid\': input.isInputValid() === true && input.isMessagingVisible,\n                    \'is-invalid\': input.isInputValid() === false && input.isMessagingVisible,\n                    \'input-text-optional\': input.isOptional\n                }" />\n            <span ng-show="input.isMessagingVisible" ng-attr-aria-hidden="{{input.isInputValid() === true ? \'true\' : \'false\'}}" class="input-message-validate" ng-class="{\n                    \'is-valid\': input.isInputValid() === true,\n                    \'is-invalid\': input.isInputValid() === false,\n                    \'input-message-optional\': input.isOptional && input.isInputValid() !== false\n                }">{{input.message}}</span>\n        </div>\n    </label>\n</div>')}]),angular.module("/app/common/directives/form-select-array.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/form-select-array.tpl.html",'<div class="select-container" ng-class="{\n  \'is-valid\': select.isValid && select.isFocused && select.value,\n  \'is-complete\': select.isValid,\n  \'is-invalid\': select.isValid === false,\n  \'select--optional\': select.isOptional,\n  \'select--single-option\': select.options.length === 1,\n  \'is-clean\': select.isClean\n}" ng-show="select.isVisible">\n\n    <span ng-show="select.isOptional" class="select-message-validate select-message-optional">Optional</span>\n    <label class="accessible-hidden-label" for="{{select.name}}">\n      {{select.title || select.name}}\n      This field is <span ng-bind="select.isOptional ? \'optional\' : \'required\'"></span>.\n    </label>\n    <select title="{{select.title}}" class="{{select.selectClass}}"\n        name="{{select.name}}"\n        id="{{select.name}}"\n        vx-common-custom-select\n        ng-model="select.value"\n        ng-options="option.name for option in select.options"\n        ng-change="select.validateValue(select.value)"\n        ng-required="!select.isOptional">\n        <option value="" ng-if="select.hasTitle" ng-bind="select.title"></option>\n    </select>\n</div>')}]),angular.module("/app/common/directives/form-select-facade.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/form-select-facade.tpl.html",'<div class="form-select-facade"\n     ng-class="{\'is-open\': facade.isOpen, \'multi-option\': facade.formattedOptions.length > 1}">\n  <ul class="form-select-facade__list">\n    <li class="form-select-facade__option cf" ng-repeat="option in facade.formattedOptions"\n        ng-click="facade.onClick(option)"\n        ng-class="{\'is-selected\': option.id === facade.selectedId}">\n      <h5 class="form-select-facade__title" ng-bind="option.type"></h5>\n      <div class="form-select-facade__nickname" ng-bind="option.nickname"></div>\n      <div ng-if="facade.config.showCCIcon" class="form-select-facade__icon card-list__{{option.type|lowercase}}"></div>\n    </li>\n  </ul>\n\n  <div ng-if="facade.hiddenOptions.length" vx-form-select-array\n       data-select-name="{{facade.selectName}}"\n       data-default-select="0" data-validate="required"\n       data-select-options="facade.hiddenOptions" data-is-visible="false"></div>\n</div>')}]),angular.module("/app/common/directives/form-select-object.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/form-select-object.tpl.html",'<div ng-class="{\'is-valid\': select.isValid && select.isFocused && select.value, \'is-invalid\': select.isValid === false, \'select--optional\': select.isOptional}" ng-show="select.isVisible">\n\t\t<label class="accessible-hidden-label" for="{{select.name}}">\n\t\t\t{{select.title || select.name}}\n\t\t\tThis field is <span ng-bind="select.isOptional ? \'optional\' : \'required\'"></span>.\n\t\t</label>\n    <select class="{{select.selectClass}}"\n        name="{{select.name}}"\n        id="{{select.name}}"\n        vx-common-custom-select\n        ng-model="select.value"\n        ng-options="option.name for ($index, option) in select.options"\n        ng-change="select.validateValue(select.value)"\n        ng-switch="select.hasTitle">\n        <option value="" ng-switch-when="true">{{select.title}}</option>\n    </select>\n</div>')}]),angular.module("/app/common/directives/form-submit.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/form-submit.tpl.html",'<button\n  id="{{submit.id}}"\n  class="btn btn-lg btn-block {{submit.altClasses}}"\n  ng-class="{\'btn-primary\': !submit.altClasses, \'btn-disabled\': !formHandler.valid || formHandler.isLoading}">\n    {{formHandler.submitButtonMessage}}\n    <span class="loading__ellipsis" ng-show="formHandler.isLoading">\n        <span>&bull;</span><span>&bull;</span><span>&bull;</span>\n    </span>\n</button>')}]),angular.module("/app/common/directives/form-textarea.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/form-textarea.tpl.html",'<div class="form__input">\n    <label class="label">\n        {{textarea.label}}\n        <span class="accessible-only-text" ng-bind="textarea.hiddenLabel"></span>\n        <div class="input-wrap">\n            <textarea name="{{textarea.name}}" class="input-textarea" ng-class="{\'is-valid\': textarea.isValid === true && textarea.isMessagingVisible, \'is-invalid\': textarea.isValid === false && textarea.isMessagingVisible}" ng-model="textarea.value" ng-change="textarea.validateValue(textarea.value)" />\n        </div>\n    </label>\n</div>')}]),angular.module("/app/common/directives/loading.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/loading.tpl.html",'<div class="loading" ng-show="loading.visible" ng-class="{\'is-visible\': loading.visible, \'is-on-top\':loading.isOnTop}">\n    <div class="status-bar is-success" tabindex="-1" ng-class="loading.visibleClass">\n        <div class="status-bar__copy">\n            <span>Loading</span>\n            <span class="loading__ellipsis">\n                <span>&bull;</span><span>&bull;</span><span>&bull;</span>\n            </span>\n        </div>\n    </div>\n</div>')}]),angular.module("/app/common/directives/mobile-nav.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/mobile-nav.tpl.html",'<nav class="nav-mobile" ng-show="mobileNav.breakpoint === \'small\'">\n    <ul class="nav-mobile__list cf">\n        <li><a href="/flight-check-in">Check In</a></li>\n        <li><a href="/manage-itinerary">Manage</a></li>\n    </ul>\n</nav>')}]),angular.module("/app/common/directives/modal-backdrop.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/modal-backdrop.tpl.html",'<div class="modal__backdrop" ng-style="{\'z-index\': 3000 + index * 10}"></div>')}]),angular.module("/app/common/directives/modal-window.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/modal-window.tpl.html",'<div tabindex="-1" class="modal__window" ng-class="[windowClass, windowSize]" ng-style="{\'z-index\': 6002 + index*10, display: \'block\'}">\n    <div class="modal__dialog" ng-class="{\'has-disclaimer\': footerDisclaimer}" role="dialog" aria-labelledby="modal-label" aria-describedby="modal-content">\n        <div class="modal__header icon-vx-simplified-color-black" ng-class="{\'no-header\': !showHeader}">\n            <h2 ng-show="title" id="modal-label" class="modal__title">{{title}}</h2>\n        </div>\n        <div id="modal-content" class="modal__content" tabindex="0" ng-class="{\'is-modal-footer\': showFooter}" ng-transclude></div>\n        <div class="modal__footer" ng-if="showFooter">\n            <div ng-if=\'footerDisclaimer\' class="footer-disclaimer"><p>By clicking on the button below you are accepting that you have reviewed our pet transportation policies. Additional information can be found at out <a href="http://virginamerica.custhelp.com/" target="_blank" class="link-underline">FAQ<span class="accessible-only-text"> (link opens in new window)</span></a>\'s and <a href="/cms/contract-of-carriage" target="_self" class="link-underline">Contract of Carriage</a>.</p></div>\n            <button class="btn btn-primary btn-normal btn-centered" data-vx-common-prevent-default ng-click="footerLinkFn($event)">{{footerLinkText}}</button>\n        </div>\n        <button class="modal__close ir" ng-class="{\'no-header\': !showHeader}" data-vx-common-prevent-default data-vx-common-hover-class="icon-close" ng-click="close($event)">Close</button>\n    </div>\n</div>');
}]),angular.module("/app/common/directives/modal.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/modal.tpl.html",'<div class="modal" ng-class="{\'modal--is-small\': modal.breakpoint.small, \'modal--is-large\': !modal.breakpoint.small, \'modal--is-open\': modal.show, \'modal--is-closed\': !modal.show}">\n    <div class="modal__header">\n        <div class="modal__logo icon-vx-simplified-color-black"></div>\n        <button class="modal__close" ng-click="closeModal()">Close</button>\n    </div>\n    <div class="modal__content" ng-transclude></div>\n</div>')}]),angular.module("/app/common/directives/number-picker.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/number-picker.tpl.html",'<div class="number-picker">\n\t<div class="number-picker__title--new">\n    \t<p class="number-picker__title"><span>{{value}}</span> {{title}} <span ng-bind="numberPicker.getSubTitle()"></span></p>\n    </div>\n    <div class="number-picker__title--original">\n        <p class="number-picker__title">{{title}} <span ng-bind="numberPicker.getSubTitle()"></span></p>\n        <a href="#" class="number-picker__value" data-vx-common-prevent-default>{{value}}</a>\n    </div>\n    <ul class="number-picker__controls">\n        <li class="number-picker__add"\n            vx-common-ally-click="numberPicker.add()"\n            vx-common-e2e-testing\n            testing-prefix="number-picker-{{e2eVal}}-add">\n          <a href="#"\n             data-vx-common-prevent-default\n             tabindex="-1"\n             class="icon-plus">Add {{title}}</a>\n        </li>\n        <li class="number-picker__minus"\n            vx-common-ally-click="numberPicker.subtract()"\n            vx-common-e2e-testing\n            testing-prefix="number-picker-{{e2eVal}}-remove">\n          <a href="#"\n             data-vx-common-prevent-default\n             tabindex="-1"\n             class="icon-minus">Subtract {{title}}</a></li>\n    </ul>\n</div>')}]),angular.module("/app/common/directives/pnr-flight-summary.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/pnr-flight-summary.tpl.html",'<section bindonce class="cf" ng-class="{\'manage-trip__flight-summary\': flightSummary.isManage, \'cancel-confirm__flight-summary\': flightSummary.isCancel}">\n    <section class="flight-summary cf" ng-class="{\'is-multi-leg\': flight.segments[1], \'is-disabled\': flightSummary.isCancel && flight.cancelEligibility !== \'ELIGIBLE\'}" ng-repeat="flight in flightSummary.pnr.flightList" ng-hide="flightSummary.isOneWay && $index > 0">\n        <div class="flight-summary__segment cf">\n            <header class="flight-summary__header">\n                <h3 class="flight-summary__title">\n                    <strong bo-if="!flightSummary.isMultiCity"\n                            bo-attr bo-attr-id="\'direction-\' + parentIndex + \'-\' + $index"\n                            bo-text="($first) ? \'DEPARTING\' : \'RETURNING\'"></strong>\n                    <strong bo-if="flightSummary.isMultiCity"\n                            bo-attr bo-attr-id="\'direction-\' + parentIndex + \'-\' + $index">\n                            <span bo-text="($index + 1) | ordinal | capitalize"></span> Segment\n                    </strong>\n                </h3>\n                <a href="#" class="flight-summary__date-link" vx-common-ally-click="flightSummary.openCalendarModal($index, flightSummary.pnr)">\n                  <span class="flight-summary__date"\n                        bo-attr bo-attr-id="\'date-\' + parentIndex + \'-\' + $index"\n                        bo-text="flightSummary.formatDateTime(flight.departureDateTime, \'dddd, MMM D YYYY\')"> </span>\n                  <!-- Note: We use successContext to get success context as isCancel returns context based on path -->\n                  <div class="flight-summary__calendar" bo-if="flightSummary.successContext !== \'cancel\'">\n                      <span>Add to Calendar</span>\n                      <span class="icon-calendar-purple"> Open Calendar </span>\n                  </div>\n                </a>\n            </header>\n            <ul class="flight-summary-cities cf">\n                <li>\n                    <div class="flight-summary-cities__city" bo-text="flight.segments[0].departure"></div>\n                    <div bo-text="flightSummary.formatDateTime(flight.segments[0].departureDateTime, \'h:mma\')"></div>\n                    <span class="icon icon-arrow-right-short-purple">-</span>\n                </li>\n                <li>\n                    <div class="flight-summary-cities__city" bo-text="flight.segments[0].arrival"></div>\n                    <div bo-text="flightSummary.formatDateTime(flight.segments[0].arrivalDateTime, \'h:mma\')"></div>\n                </li>\n            </ul>\n            <ul class="flight-summary-meta cf">\n                <li>\n                    <p class="heading--x-small">Flight</p>\n                    Flight <span bo-text="flight.segments[0].flightNum"></span><sup bo-if="flightSummary.partnerFlightsNonVX.indexOf(flight.segments[0]) !== -1">\n                      <span ng-repeat="i in flightSummary.range(flightSummary.getPartnerFlightIndex(flightSummary.pnr.flightList, flight.segments[0]) + 1)">*</span>\n                    </sup>\n                </li>\n                <li>\n                    <p class="heading--x-small">Cabin</p>\n                    <div>\n                        <span bo-text="flight.segments[0].cabinLabel | capitalize"></span>\n                        <span bo-if="(flight.segments[0].cabinClass.indexOf(\'NONREFUNDABLE\') === -1)">(Refundable)</span>\n                    </div>\n                </li>\n            </ul>\n            <ul class="flight-summary-meta flight-summary-meta--operator cf">\n              <li bo-if="flightSummary.isOperatedByAlaska(flight.segments[0].operatingAirline)">\n                <img class="flight-summary-meta__logo" src="/images/partners/alaska.png" alt="Alaska Airlines">\n              </li>\n            </ul>\n        </div>\n        <div class="flight-summary__segment cf" bo-show="flight.segments[1]">\n            <ul class="flight-summary-cities cf">\n                <li>\n                    <div class="flight-summary-cities__city" bo-text="flight.segments[1].departure"></div>\n                    <div bo-text="flightSummary.formatDateTime(flight.segments[1].departureDateTime, \'h:mma\') | date:\'h:mm\' + \'a\'"></div>\n                    <span class="icon icon-arrow-right-short-purple">-</span>\n                </li>\n                <li>\n                    <div class="flight-summary-cities__city" bo-text="flight.segments[1].arrival"></div>\n                    <div bo-text="flightSummary.formatDateTime(flight.segments[1].arrivalDateTime, \'h:mma\')"></div>\n                </li>\n            </ul>\n            <ul class="flight-summary-meta cf">\n                <li>\n                    <p class="heading--x-small">Flight</p>\n                    Flight <span bo-text="flight.segments[1].flightNum"></span><sup bo-if="flightSummary.partnerFlightsNonVX.indexOf(flight.segments[1]) !== -1">\n                      <span ng-repeat="i in flightSummary.range(flightSummary.getPartnerFlightIndex(flightSummary.pnr.flightList, flight.segments[1]) + 1)">*</span>\n                    </sup>\n                </li>\n                <li>\n                    <p class="heading--x-small">Cabin</p>\n                    <div>\n                        <span bo-text="flight.segments[1].cabinLabel | capitalize"></span>\n                        <span bo-if="(flight.segments[1].cabinClass.indexOf(\'NONREFUNDABLE\') === -1)">(Refundable)</span>\n                    </div>\n                </li>\n            </ul>\n            <ul class="flight-summary-meta flight-summary-meta--operator cf">\n              <li bo-if="flightSummary.isOperatedByAlaska(flight.segments[1].operatingAirline)">\n                <img class="flight-summary-meta__logo" src="/images/partners/alaska.png" alt="Alaska Airlines">\n              </li>\n            </ul>\n        </div>\n        <div class="flight-summary__segment cf" bo-show="flight.segments[2]">\n\n            <ul class="flight-summary-cities cf">\n                <li>\n                    <div class="flight-summary-cities__city" bo-text="flight.segments[2].departure"></div>\n                    <div bo-text="flightSummary.formatDateTime(flight.segments[2].departureDateTime, \'h:mma\') | date:\'h:mm\' + \'a\'"></div>\n                    <span class="icon icon-arrow-right-short-purple">-</span>\n                </li>\n                <li>\n                    <div class="flight-summary-cities__city" bo-text="flight.segments[2].arrival"></div>\n                    <div bo-text="flightSummary.formatDateTime(flight.segments[2].arrivalDateTime, \'h:mma\')"></div>\n                </li>\n            </ul>\n            <ul class="flight-summary-meta cf">\n                <li>\n                    <p class="heading--x-small">Flight</p>\n                    Flight <span bo-text="flight.segments[2].flightNum"></span><sup bo-if="flightSummary.partnerFlightsNonVX.indexOf(flight.segments[2]) !== -1">\n                      <span ng-repeat="i in flightSummary.range(flightSummary.getPartnerFlightIndex(flightSummary.pnr.flightList, flight.segments[2]) + 1)">*</span>\n                    </sup>\n                </li>\n                <li>\n                    <p class="heading--x-small">Cabin</p>\n                    <div>\n                        <span bo-text="flight.segments[2].cabinLabel | capitalize"></span>\n                        <span bo-if="(flight.segments[2].cabinClass.indexOf(\'NONREFUNDABLE\') === -1)">(Refundable)</span>\n                    </div>\n                </li>\n            </ul>\n            <ul class="flight-summary-meta flight-summary-meta--operator cf">\n              <li bo-if="flightSummary.isOperatedByAlaska(flight.segments[2].operatingAirline)">\n                <img class="flight-summary-meta__logo" src="/images/partners/alaska.png" alt="Alaska Airlines">\n              </li>\n            </ul>\n        </div>\n\n        <div class="flight-summary__alerts" ng-hide="flightSummary.elevateUser.accountInfo.flightAlert.optInValue" ng-if="openFlightAlertModal && (flightSummary.isSuccess || flightSummary.isManage)" ng-class="{\'flight-summary__refundable\': ((flight.segments[0].cabinClass.indexOf(\'NONREFUNDABLE\') === -1) && $index === 0 )}">\n            <a class="link-underline" vx-common-ally-click="openFlightAlertModal(flight, flightSummary.pnr.contact.email)">Sign-up for flight alerts</a>\n        </div>\n\n        <div class="flight-summary__change" ng-if="flightSummary.contextType === \'manage\'">\n            <a href="#"\n              class="link-underline"\n              bo-attr\n              bo-attr-aria-labelledby="\'direction-\' + parentIndex + \'-\' + $index + \' date-\' + parentIndex + \'-\' + $index"\n              bo-attr-tabindex="{{flightSummary.isEligibleForChange(flight) ? -1 : 0}}"\n              bo-class="{\'is-disabled\': flightSummary.isEligibleForChange(flight)}"\n              ng-click="changeFlight(flightSummary.pnr, $index, flight)">Change</a>\n        </div>\n    </section>\n\n    <div class="flight-carrier" ng-if="flightSummary.partnerFlightsNonVX">\n      <p ng-repeat="(index, partner) in flightSummary.partnerFlightsNonVX">\n        <span ng-repeat="i in flightSummary.range(index + 1)">*</span>\n         Flight\n        <span bo-text="partner.flightNum"></span>\n        Operated By\n        <span bo-text="flightSummary.formatOperatorString(partner.operatingAirline)"></span>\n      </p>\n      <p>All other flights operated by Virgin America.</p>\n    </div>\n</section>\n')}]),angular.module("/app/common/directives/pnr-guest-list.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/pnr-guest-list.tpl.html",'<section bindonce ng-class="{\'manage-trip__guest-list\': guestList.context === \'manage\', \'success-trip__guest-list\': guestList.context === \'success\'}">\n    <div class="collapsible-table-container guest-list" data-vx-common-collapsible-table>\n        <div ng-class="{\'collapsible-table-wrapper\': collapsibleTable.isCollapsed}">\n            <div ng-class="{\'collapsible-table--scrollable\': collapsibleTable.isCollapsed}">\n                <table class="collapsible-table guest-list-table">\n                    <thead>\n                        <tr>\n                            <!-- all -->\n                            <th scope="col"><p class="heading--x-small">Guest(s)</p></th>\n\n                            <!-- success/manage -->\n                            <th scope="col" ng-hide="guestList.bp === \'small\'">\n                                <p class="heading--x-small" ng-switch="guestList.pnr.tripType">\n                                    <span ng-switch-default>Departing Seat<span bo-show="guestList.pnr.flightList[0].segments[1]">s</span></span>\n                                    <span ng-switch-when="\'MULTI_CITY\'"><span bo-text="guestList.pnr.flightList[0].origin"></span>-<span bo-text="guestList.pnr.flightList[0].destination"></span> Seats</span>\n                                </p>\n                            </th>\n                            <th scope="col" ng-hide="guestList.bp === \'small\' || guestList.isOneWay">\n                                <p class="heading--x-small" ng-switch="guestList.pnr.tripType">\n                                    <span ng-switch-default>Returning Seat<span bo-show="guestList.pnr.flightList[1].segments[1]">s</span></span>\n                                    <span ng-switch-when="\'MULTI_CITY\'"><span bo-text="guestList.pnr.flightList[1].origin"></span>-<span bo-text="guestList.pnr.flightList[1].destination"></span> Seats</span>\n                                </p>\n                            </th>\n                            <th scope="col" ng-show="guestList.bp === \'small\'"><p class="heading--x-small guest-list-table__seats">Seats</p></th>\n\n                            <th scope="col"><p class="heading--x-small guest-list-table__ffn">Frequent Flyer #</p></th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr ng-repeat="(key, traveler) in guestList.pnr.paxList">\n                            <!-- all -->\n                            <td scope="row">\n                                <span bo-text="traveler.fullName|capitalize"></span>\n                                <span class="guest-list-table__info" ng-show="traveler.knownTravelerNum">Known Traveler #{{traveler.knownTravelerNum | uppercase}}</span>\n                            </td>\n\n                            <!-- success/manage -->\n                            <td ng-hide="guestList.bp === \'small\'">\n                                <span bo-text="traveler.departingSeats[0] || \'NA\'"></span>\n                                <span ng-if="traveler.departingSeats[1]">, <span bo-text="traveler.departingSeats[1]"></span></span>\n                                <span ng-if="traveler.departingSeats[2]">, <span bo-text="traveler.departingSeats[2]"></span></span>\n                                <span ng-if="traveler.departingSeats[3]">, <span bo-text="traveler.departingSeats[3]"></span></span>\n                            </td>\n                            <td ng-hide="guestList.bp === \'small\' || guestList.isOneWay">\n                                <span bo-text="traveler.returnSeats[0] || \'NA\'"></span>\n                                <span ng-if="traveler.returnSeats[1]">, <span bo-text="traveler.returnSeats[1]"></span></span>\n                                <span ng-if="traveler.returnSeats[2]">, <span bo-text="traveler.returnSeats[2]"></span></span>\n                                <span ng-if="traveler.returnSeats[3]">, <span bo-text="traveler.returnSeats[3]"></span></span>\n                            </td>\n                            <td ng-if="guestList.bp === \'small\'">\n                                <span bo-text="traveler.departingSeats[0] || \'NA\'"></span>\n                                <span ng-if="traveler.departingSeats[1]">, <span bo-text="traveler.departingSeats[1]"></span></span>\n                                <span ng-if="traveler.departingSeats[2]">, <span bo-text="traveler.departingSeats[2]"></span></span>\n                                <span ng-if="traveler.departingSeats[3]">, <span bo-text="traveler.departingSeats[3]"></span></span>\n                                <span ng-if="traveler.returnSeats[0]">, <span bo-text="traveler.returnSeats[0]"></span></span>\n                                <span ng-if="traveler.returnSeats[1]">, <span bo-text="traveler.returnSeats[1]"></span></span>\n                                <span ng-if="traveler.returnSeats[2]">, <span bo-text="traveler.returnSeats[2]"></span></span>\n                                <span ng-if="traveler.returnSeats[3]">, <span bo-text="traveler.returnSeats[3]"></span></span>\n                            </td>\n\n                            <td>\n                                <div ng-if="traveler.paxType !== \'INFANT\'">\n                                    <!-- NOTE: we are not using bindonce for FF info, as it can be updated on the page via the FF modal -->\n                                    <span ng-show="traveler.loyaltyId">{{traveler.loyaltyId}}</span>\n                                    <span ng-show="!traveler.loyaltyId && !(guestList.successContext === \'cancel\' || (guestList.context === \'success\' && guestList.successContext === \'cancel\'))">\n                                      <a href="#" class="link-underline" data-vx-common-prevent-default vx-common-ally-click="guestList.openFrequentFlierModal(traveler)">Add</a>\n                                      or\n                                      <a href="#" class="link-underline" data-vx-common-prevent-default vx-common-ally-click="guestList.openJoinAlaskaMileagePlan()">Join</a>\n                                    </span>\n                                    <span class="guest-list-table__info" ng-show="traveler.loyaltyProgramName">\n                                        {{traveler.loyaltyProgramName !== \'Elevate\' ? traveler.loyaltyProgramName : \'\'}}\n                                        <span ng-show="traveler.tierLevel">\n                                            {{traveler.tierLevel | capitalize}}\n                                        </span>\n                                    </span>\n                                </div>\n                            </td>\n                        </tr>\n                        <tr ng-if="guestList.pnr.petAmount">\n                            <td scope="row">\n                                <span bo-text="\'Furry Friend\' | capitalize"></span>\n                                <span bo-if="guestList.pnr.petAmount > 1">(x{{guestList.pnr.petAmount}})</span>\n                            </td>\n                            <td ng-hide="guestList.bp === \'small\'">\n                                <span bo-text="\'NA\'"></span>\n                            </td>\n                            <td ng-hide="guestList.bp === \'small\' || guestList.isOneWay">\n                                <span bo-text="\'NA\'"></span>\n                            </td>\n                            <td ng-show="guestList.bp === \'small\'">\n                                <span bo-text="\'NA\'"></span>\n                            </td>\n                            <!-- all -->\n                            <td>\n                                <span>-</span>\n                            </td>\n                            <td>\n                                <span>-</span>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n            <div class="collapsible-table--pinned" ng-show="collapsibleTable.isCollapsed">\n                <table class="collapsible-table guest-list-table">\n                    <thead>\n                        <tr>\n                            <!-- all -->\n                            <th scope="col"><p class="heading--x-small">Guest(s)</p></th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr ng-repeat="traveler in guestList.pnr.paxList">\n                            <!-- all -->\n                            <td scope="row">\n                                <span bo-text="traveler.fullName|capitalize"></span>\n                                <span class="guest-list-table__info" ng-show="traveler.knownTravelerNum">Known Traveler #{{traveler.knownTravelerNum | uppercase}}</span>\n                            </td>\n                        </tr>\n                        <tr ng-if="guestList.pnr.petAmount">\n                            <td scope="row">\n                                <span bo-text="\'Furry Friend\' | capitalize"</span>\n                                <span bo-if="guestList.pnr.petAmount > 1">(x{{guestList.pnr.petAmount}})</span>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    </div>\n</section>')}]),angular.module("/app/common/directives/pnr-payment-details.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/pnr-payment-details.tpl.html",'<section bindonce="paymentDetails.pnr" refresh-on="\'paymentDetails.update\'" class="success-trip--payment cf" bo-class="{\'is-change\': paymentDetails.context === \'change\'}" bo-show="paymentDetails.context === \'book\' || paymentDetails.context === \'change\' || paymentDetails.pnr.extraPaymentInfo">\n    <div>\n        <section class="payment-info--payment-types">\n            <header class="payment-info__header">\n                <h1 class="heading--small">Payment Information</h1>\n            </header>\n\n            <ul class="payment-types" bo-show="paymentDetails.context === \'check-in\'">\n                <li class="payment-type" bo-show="paymentDetails.pnr.extraPaymentInfo && paymentDetails.pnr.extraPaymentInfo.travelBankNumber">\n                    <h3 class="payment-info-title">Travel Bank Credit</h3>\n                    <ul class="payment-info-details">\n                        <li>Travel Bank Id: {{paymentDetails.pnr.extraPaymentInfo.travelBankNumber}}</li>\n                    </ul>\n                </li>\n                <li class="payment-type" bo-if="paymentDetails.pnr.extraPaymentInfo && paymentDetails.pnr.extraPaymentInfo.creditCardUsed">\n                    <h3 class="payment-info-title">Credit Card</h3>\n                    <ul class="payment-info-details">\n                        <li>Card Type: <span bo-bind="paymentDetails.pnr.extraPaymentInfo.creditCardUsed.cardType | capitalize"></span></li>\n                        <li>Cardholder Name: <span bo-bind="paymentDetails.pnr.extraPaymentInfo.creditCardUsed.cardHolderName"></span></li>\n                        <li>Card Number: <span bo-bind="paymentDetails.pnr.extraPaymentInfo.creditCardUsed.ccNumber"></span></li>\n                    </ul>\n                </li>\n            </ul>\n\n            <ul class="payment-types" bo-show="paymentDetails.shouldShowMainCardAndTBInfo()">\n                <li class="payment-type" ng-repeat="paymentInfo in paymentDetails.pnr.paymentInfo" bo-hide="paymentInfo.type === \'LP\' || (paymentDetails.pnr.extraPaymentInfo && paymentDetails.pnr.extraPaymentInfo.creditCardUsed && paymentInfo.type !== \'TRAVELBANK\')">\n                    <h3 class="payment-info-title" bo-show="paymentInfo.type !== \'TRAVELBANK\'">Credit Card</h3>\n                    <h3 class="payment-info-title" bo-show="paymentInfo.type === \'TRAVELBANK\'">Travel Bank Credit</h3>\n                    <ul class="payment-info-details">\n                        <li bo-show="paymentInfo.type !== \'TRAVELBANK\'">Card Type: <span bo-bind="((paymentDetails.pnr.extraPaymentInfo && paymentDetails.pnr.extraPaymentInfo.creditCardUsed) ? paymentDetails.pnr.extraPaymentInfo.creditCardUsed.cardType : paymentInfo.type) | capitalize"></span></li>\n                        <li bo-show="paymentInfo.type !== \'TRAVELBANK\'">Cardholder Name: <span bo-bind="(paymentDetails.pnr.extraPaymentInfo && paymentDetails.pnr.extraPaymentInfo.creditCardUsed) ? paymentDetails.pnr.extraPaymentInfo.creditCardUsed.cardHolderName : paymentInfo.nameOnCard"></span></li>\n                        <li bo-show="paymentInfo.type !== \'TRAVELBANK\'">Card Number: <span bo-bind="(paymentDetails.pnr.extraPaymentInfo && paymentDetails.pnr.extraPaymentInfo.creditCardUsed) ? paymentDetails.pnr.extraPaymentInfo.creditCardUsed.ccNumber : paymentInfo.ccNumber"></span></li>\n                        <li bo-show="paymentInfo.type === \'TRAVELBANK\'">Travel Bank Id: {{paymentInfo.tbNumber}}</li>\n                        <li bo-show="paymentDetails.context === \'book\'">Payment Amount: $<span>{{paymentInfo.amountCharged | number:2}}</span></li>\n                        <li bo-show="paymentDetails.context === \'check-in\'">Payment Amount: $<span>{{paymentDetails.pnr.pnrTotalExtras | number:2}}</span></li>\n                    </ul>\n                </li>\n                <li class="payment-type" bo-if="paymentDetails.pnr.extraPaymentInfo && paymentDetails.pnr.extraPaymentInfo.creditCardUsed">\n                    <h3 class="payment-info-title">Credit Card</h3>\n                    <ul class="payment-info-details">\n                        <li>Card Type: <span bo-bind="((paymentDetails.pnr.extraPaymentInfo) ? paymentDetails.pnr.extraPaymentInfo.creditCardUsed.cardType : paymentInfo.type) | capitalize"></span></li>\n                        <li>Cardholder Name: <span bo-bind="(paymentDetails.pnr.extraPaymentInfo) ? paymentDetails.pnr.extraPaymentInfo.creditCardUsed.cardHolderName : paymentInfo.nameOnCard"></span></li>\n                        <li>Card Number: <span bo-bind="(paymentDetails.pnr.extraPaymentInfo) ? paymentDetails.pnr.extraPaymentInfo.creditCardUsed.ccNumber : paymentInfo.ccNumber"></span></li>\n                        <li bo-show="paymentDetails.context === \'book\' && !paymentDetails.pnr.pointsBooking && !(paymentDetails.totalExtras || paymentDetails.extrasRefund || paymentDetails.pnr.extras.petc)">Payment Amount: $<span>{{paymentDetails.pnr.fareInfo.totalCost | number:2}}</span></li>\n                        <li bo-show="paymentDetails.pnr.paymentInfo[0].type === \'TRAVELBANK\'">\n                          Payment Amount: $<span bo-if="!paymentDetails.pnr.pointsBooking">{{paymentDetails.pnr.pnrTotalAmount - paymentDetails.pnr.paymentInfo[0].amountCharged | number:2}}</span><span bo-if="paymentDetails.pnr.pointsBooking">${{((paymentDetails.pnr.fareInfo.totalCost + paymentDetails.pnr.extras.insurance + paymentDetails.pnr.extras.mce + paymentDetails.pnr.extras.petc) - (paymentDetails.pnr.fareInfo.fareDetails.totalBaseFare))|number:2}}</span>\n                        </li>\n                    </ul>\n                </li>\n            </ul>\n            <ul class="payment-types" bo-show="paymentDetails.context === \'change\'">\n                <li class="payment-type" bo-show="paymentDetails.pnr.extraPaymentInfo.creditCardUsed">\n                    <h3 class="payment-info-title">Credit Card</h3>\n                    <ul class="payment-info-details">\n                        <li>Card Type: {{paymentDetails.pnr.extraPaymentInfo.creditCardUsed.cardType}}</li>\n                        <li>Cardholder Name: {{paymentDetails.pnr.extraPaymentInfo.creditCardUsed.cardHolderName}}</li>\n                        <li>Card Number: {{paymentDetails.pnr.extraPaymentInfo.creditCardUsed.ccNumber}}</li>\n                        <li bo-show="paymentDetails.pnr.ccAmountCharged">Payment Amount: $<span>{{paymentDetails.pnr.ccAmountCharged | number:2}}</span></li>\n                        <li bo-show="paymentDetails.pnr.amountRefunded">Payment Refunded: -$<span>{{paymentDetails.pnr.amountRefunded | number:2}}</span></li>\n                    </ul>\n                </li>\n            </ul>\n            <ul class="payment-types" bo-show="paymentDetails.context === \'check-in\' && paymentDetails.pnr.extraPaymentInfo.upgradeFee && paymentDetails.pnr.extraPaymentInfo.upgradeFee.totalFee">\n                <li class="payment-type">\n                    <div>\n                        <h3 class="payment-info-title">Upgrade Fees</h3>\n                        <span class="extra-total-fare">${{paymentDetails.pnr.extraPaymentInfo.upgradeFee.totalFee | number:2}}</span>\n                    </div>\n                </li>\n            </ul>\n            <ul class="payment-types">\n                <li class="payment-type" bo-show="paymentDetails.totalExtras || paymentDetails.extrasRefund || paymentDetails.pnr.extras.petc">\n                    <div bo-show="paymentDetails.context === \'book\'">\n                        <h3 class="payment-info-title">Fare</h3>\n                        <span class="extra-total-fare" bo-hide="paymentDetails.pnr.pointsBooking">\n                          Total Fare: ${{paymentDetails.pnr.fareInfo.fareDetails.totalFare | number:2}}\n                        </span>\n                        <span class="extra-total-fare" bo-show="paymentDetails.pnr.pointsBooking">\n                          Total Taxes: ${{paymentDetails.pnr.fareInfo.fareDetails.totalTax | number:2}}\n                        </span>\n                    </div>\n                    <h3 class="payment-info-title">Extras</h3>\n                    <ul class="payment-info-details">\n                        <li bo-show="paymentDetails.totalExtras">Extras Amount: ${{paymentDetails.totalExtras | number:2}}</li>\n                        <li bo-show="paymentDetails.extrasRefund">Extras Refund: -${{paymentDetails.extrasRefund | number:2}}</li>\n                        <li bo-show="paymentDetails.pnr.extras.petc">\n                            <div class="payment-info-details">\n                                <div class="fare-details-list__label">Furry Friend <span bo-if="paymentDetails.pnr.petAmount > 1">(x{{paymentDetails.pnr.petAmount}})</span>: ${{paymentDetails.pnr.extras.petc|number:2}}</div>\n                            </div>\n                        </li>\n                    </ul>\n                </li>\n            </ul>\n        </section>\n        <section class="payment-info--billing-address">\n            <header class="payment-info__header">\n                <h1 class="heading--small">Billing Address</h1>\n            </header>\n            <div class="payment-billing-address">\n                <h3 class="payment-info-title">{{paymentDetails.pnr.paymentInfo[0].nameOnCard | capitalize}}</h3>\n                <ul class="payment-info-details">\n                    <li>{{paymentDetails.pnr.addressInfo.addressOne | capitalize}}</li>\n                    <li bo-show="paymentDetails.pnr.addressInfo.addressTwo && paymentDetails.pnr.addressInfo.addressTwo !== paymentDetails.pnr.addressInfo.addressOne">{{paymentDetails.pnr.addressInfo.addressTwo | capitalize}}</li>\n                    <li>\n                        <span>{{paymentDetails.pnr.addressInfo.city | capitalize}}</span>,\n                        <span>{{paymentDetails.pnr.addressInfo.state}}</span>\n                        <span>{{paymentDetails.pnr.addressInfo.zipCode}}</span>\n                    </li>\n                    <li>{{paymentDetails.pnr.addressInfo.country}}</li>\n                </ul>\n            </div>\n        </section>\n    </div>\n    <div>\n        <section class="payment-info--spacer"></section>\n        <section class="payment-info--price-details">\n            <header class="payment-info__header">\n                <h1 class="heading--small">\n                    Price Details\n                    <span bo-if="paymentDetails.isNewFlight()">\n                      for new flight\n                    </span>\n                </h1>\n            </header>\n            <!-- Book and Change -->\n            <div class="fare-details fare-details--is-tight" bo-show="paymentDetails.context === \'book\' || paymentDetails.context === \'change\'">\n                <!-- fare breakdown -->\n                <div class="fare-details__section" ng-switch="paymentDetails.pnr.pointsBooking">\n                    <div class="fare-details-list" ng-switch-when="true">\n                        <div class="fare-details-list__label">Fare <span bo-if="paymentDetails.pnr.payingTravelers > 1">(x{{paymentDetails.pnr.payingTravelers}})</span></div>\n                        <div class="fare-details-list__amount">{{paymentDetails.pnr.pointsRedeemed | number:0}} pts</div>\n                    </div>\n                    <div class="fare-details-list" ng-switch-when="false">\n                        <div class="fare-details-list__label">Base Fare <span bo-if="paymentDetails.pnr.payingTravelers > 1">(x{{paymentDetails.pnr.payingTravelers}})</span></div>\n                        <div class="fare-details-list__amount">${{paymentDetails.pnr.fareInfo.fareDetails.totalBaseFare|number:2}}</div>\n                    </div>\n                </div>\n                <!--ancillary summary list -->\n                <div class="fare-details__section" bo-show="paymentDetails.context !== \'change\' && paymentDetails.shouldShowAncSummaryList()">\n                    <div class="fare-details-list">\n                        <div class="fare-details-list__label" ng-repeat-start="summary in paymentDetails.ancillarySummaryList">\n                          <span bo-bind="summary.title"></span> (x<span bo-bind="summary.totalNumPurchased"></span>)\n                        </div>\n                        <div class="fare-details-list__amount" ng-repeat-end>${{summary.totalAmount|number:2}}</div>\n                    </div>\n                </div>\n                <ul class="fare-details__section--list" bo-show="paymentDetails.pnr.fareInfo.taxes">\n                    <li ng-repeat="tax in paymentDetails.pnr.fareInfo.taxes">\n                        <div class="fare-details-list">\n                            <div class="fare-details-list__label">{{tax.name}} <span bo-if="paymentDetails.pnr.payingTravelers > 1">(x{{paymentDetails.pnr.payingTravelers}})</span></div>\n                            <div class="fare-details-list__amount">${{tax.amt|number:2}}</div>\n                        </div>\n                    </li>\n                    <li bo-show="paymentDetails.pnr.fareInfo.intInfantTaxes">\n                        <div class="fare-details-list">\n                            <div class="fare-details-list__label">International Infant Tax <span bo-if="paymentDetails.pnr.infantsTraveling > 1">(x{{paymentDetails.pnr.infantsTraveling}})</span></div>\n                            <div class="fare-details-list__amount">${{paymentDetails.pnr.fareInfo.intInfantTaxes|number:2}}</div>\n                        </div>\n                    </li>\n                </ul>\n                <ul class="fare-details__section--list" bo-show="paymentDetails.hasInsuranceOrPet()">\n                    <li bo-show="paymentDetails.pnr.extras.insurance">\n                        <div class="fare-details-list">\n                            <div class="fare-details-list__label">Travel Insurance by Travelguard <span bo-if="paymentDetails.pnr.payingTravelers > 1">(x{{paymentDetails.pnr.payingTravelers}})</span></div>\n                            <div class="fare-details-list__amount">${{paymentDetails.pnr.extras.insurance|number:2}}</div>\n                        </div>\n                    </li>\n                    <li bo-show="paymentDetails.pnr.extras.petc">\n                        <div class="fare-details-list">\n                            <div class="fare-details-list__label">Furry Friend <span bo-if="paymentDetails.pnr.petAmount > 1">(x{{paymentDetails.pnr.petAmount}})</span></div>\n                            <div class="fare-details-list__amount">${{paymentDetails.pnr.extras.petc|number:2}}</div>\n                        </div>\n                    </li>\n                </ul>\n                <div class="fare-details__total" ng-switch="paymentDetails.pnr.pointsBooking">\n                    <div class="fare-details-list--total cf" ng-switch-when="true">\n                        <div class="fare-details-list__label">\n                            <span>Total</span>\n                            for {{paymentDetails.pnr.payingTravelers}} {{(paymentDetails.pnr.payingTravelers === 1) ? \'traveler\' : \'travelers\'}}\n                        </div>\n                        <div class="fare-details-list__amount">{{paymentDetails.pnr.pointsRedeemed|number:0}} pts<br>${{(paymentDetails.pnr.fareInfo.fareDetails.totalTax) + paymentDetails.pnr.fareInfo.fareDetails.totalExtras + paymentDetails.pnr.extras.petc|number:2}}</div>\n                    </div>\n                    <div class="fare-details-list--total cf" ng-switch-default>\n                        <div class="fare-details-list__label">\n                            <span>Total</span>\n                            for {{paymentDetails.pnr.payingTravelers}} {{(paymentDetails.pnr.payingTravelers === 1) ? \'traveler\' : \'travelers\'}}\n                        </div>\n                        <div class="fare-details-list__amount">${{(paymentDetails.pnr.fareInfo.total + paymentDetails.pnr.extras.insurance)|number:2}}</div>\n                    </div>\n                </div>\n            </div>\n            <!-- Check In -->\n            <div class="fare-details fare-details--is-tight"\n                 bo-show="paymentDetails.context !== \'book\' && paymentDetails.context !== \'change\'">\n                <ul class="fare-details__section--list" bo-show="paymentDetails.hasCheckInUpgrades()">\n                    <li bo-show="paymentDetails.pnr.extraPaymentInfo.upgradeFee">\n                        <div class="fare-details-list">\n                            <div class="fare-details-list__label">Upgrade Fees</div>\n                            <div class="fare-details-list__amount">${{paymentDetails.pnr.extraPaymentInfo.upgradeFee.totalFee|number:2}}</div>\n                        </div>\n                    </li>\n                    <li bo-show="paymentDetails.pnr.extraPaymentInfo.loungeFee">\n                        <div class="fare-details-list">\n                            <div class="fare-details-list__label">Lounge Fees</div>\n                            <div class="fare-details-list__amount">${{paymentDetails.pnr.extraPaymentInfo.loungeFee.totalFee|number:2}}</div>\n                        </div>\n                    </li>\n                    <li bo-show="paymentDetails.shouldShowAncSummaryList()">\n                        <div class="fare-details-list">\n                            <div class="fare-details-list__label" ng-repeat-start="summary in paymentDetails.ancillarySummaryList">\n                              <span bo-bind="summary.title"></span> (x<span bo-bind="summary.totalNumPurchased"></span>)\n                            </div>\n                            <div class="fare-details-list__amount" ng-repeat-end>${{summary.totalAmount|number:2}}</div>\n                        </div>\n                    </li>\n                </ul>\n                <div class="fare-details__total" ng-switch="paymentDetails.pnr.pointsBooking">\n                    <div class="fare-details-list--total cf" ng-switch-default>\n                        <div class="fare-details-list__label">\n                            <span>Total</span>\n                            for {{paymentDetails.pnr.payingTravelers}} {{(paymentDetails.pnr.payingTravelers === 1) ? \'traveler\' : \'travelers\'}}\n                        </div>\n                        <div class="fare-details-list__amount">${{paymentDetails.pnr.extraPaymentInfo.extraOptionsFee|number:2}}</div>\n                    </div>\n                </div>\n            </div>\n            <div class="payment-info__change-summary" bo-show="paymentDetails.shouldShowChangeSummary()">\n                <header class="payment-info__header">\n                    <h1 class="heading--small">Change Summary</h1>\n                </header>\n                <div class="fare-details fare-details--is-tight">\n                    <div class="fare-details__section" bo-if="paymentDetails.pnr.amountRefunded || paymentDetails.pnr.ccAmountCharged">\n                        <div class="fare-details-list">\n                            <div class="fare-details-list__label">New Flight</div>\n                            <div class="fare-details-list__amount">${{(paymentDetails.pnr.newFareInfo.totalFare) || 0|number:2}}</div>\n                            <div class="fare-details-list__label">Original Flight</div>\n                            <div class="fare-details-list__amount">-${{paymentDetails.pnr.originalFareInfo.totalFare || 0|number:2}}</div>\n                        </div>\n                    </div>\n                    <div class="fare-details__section" bo-show="paymentDetails.shouldShowAncSummaryList()">\n                        <div class="fare-details-list">\n                            <div class="fare-details-list__label" ng-repeat-start="summary in paymentDetails.ancillarySummaryList">\n                              New <span bo-bind="summary.title"></span> (x<span bo-bind="summary.totalNumPurchased"></span>)\n                            </div>\n                            <div class="fare-details-list__amount" ng-repeat-end>${{summary.totalAmount|number:2}}</div>\n                        </div>\n                        <div class="fare-details-list">\n                            <div class="fare-details-list__label" ng-repeat-start="refundedSummary in paymentDetails.refundedAncillarySummaryList">\n                              Original <span bo-bind="refundedSummary.title"></span> (x<span bo-bind="refundedSummary.totalNumPurchased"></span>)*\n                            </div>\n                            <div class="fare-details-list__amount" ng-repeat-end>-${{refundedSummary.totalAmount|number:2}}</div>\n                        </div>\n                    </div>\n                    <div class="fare-details__section" bo-show="paymentDetails.pnr.changeFee">\n                        <div class="fare-details-list">\n                            <div class="fare-details-list__label">Change Fee</div>\n                            <div class="fare-details-list__amount">${{paymentDetails.pnr.changeFee|number:2}}</div>\n                        </div>\n                    </div>\n                    <div class="fare-details__total">\n                        <div class="fare-details-list--total cf" bo-show="paymentDetails.changeSummaryTotal || !paymentDetails.changeSummaryRefund">\n                            <div class="fare-details-list__label"><span>Total</span></div>\n                            <div class="fare-details-list__amount">${{paymentDetails.changeSummaryTotal|number:2}}</div>\n                        </div>\n                        <div class="fare-details-list--total cf" bo-show="paymentDetails.changeSummaryRefund">\n                            <div class="fare-details-list__label"><span>Total Refund</span></div>\n                            <div class="fare-details-list__amount">-${{paymentDetails.changeSummaryRefund|number:2}}</div>\n                        </div>\n                    </div>\n                    <div class="purchase-disclamer" bo-show="paymentDetails.changeSummaryRefund">\n                        *Not all extras can be fully refunded.\n                    </div>\n                </div>\n            </div>\n        </section>\n    </div>\n</section>');
}]),angular.module("/app/common/directives/pnr-trip-summary.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/pnr-trip-summary.tpl.html",'<ul bindonce class="cf" ng-class="{\'manage-trip__trip-itinerary\': tripSummary.isManage, \'success-trip__trip-itinerary\': tripSummary.isSuccess, \'cancel-confirm__trip-itinerary\': tripSummary.isCancel}">\n    <li class="trip-itinerary__item">\n        <h3 class="heading--x-small">Itinerary</h3>\n        <div>\n            <span>{{tripSummary.pnr.tripTypeLabel}}</span>,\n            <span>{{tripSummary.pnr.flightList[0].originName}}</span>\n            to <span>{{tripSummary.pnr.flightList[0].destinationName}}</span>\n            <span ng-show="tripSummary.pnr.isMultiCity">\n                , <span>{{tripSummary.pnr.flightList[1].originName}}</span>\n                to <span>{{tripSummary.pnr.flightList[1].destinationName}}</span>\n            </span>\n        </div>\n    </li>\n    <li class="trip-itinerary__item">\n        <h3 class="heading--x-small">Dates</h3>\n        <div>{{tripSummary.pnr.dateString}}</div>\n    </li>\n    <li class="trip-itinerary__item">\n        <h3 class="heading--x-small">Confirmation #</h3>\n        <div ng-show="tripSummary.isManage || tripSummary.isCancel">\n            {{tripSummary.pnr.pnr}}\n        </div>\n        <div ng-show="tripSummary.isSuccess">{{tripSummary.pnr.pnr}}</div>\n    </li>\n</ul>')}]),angular.module("/app/common/directives/points-slider.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/points-slider.tpl.html",'<div class="wrap">\n    <section class="points-slider">\n        <h2>Go from points to places at the speed of flight.</h2>\n        <p>You can book reward flights on Virgin America for as few as 2,500 points each way (+ Security fee of $5.60 per one-way trip), any day of the year with no blackouts<sup>*</sup>. Try our points calculator to see how quickly your points add up to reward flights.</p>\n\n        <div class="points-slider__points-calc cf">\n            <div class="points-calc__number">\n                <div>{{pointsSlider.value | number}}</div>\n                <span>Elevate Points</span>\n            </div>\n            <div class="points-calc__equals">=</div>\n            <div class="points-calc__number">\n                <div>${{pointsSlider.calcPrice(pointsSlider.value) | number:\'0\'}}</div>\n                <span>Fare Price</span>\n            </div>\n        </div>\n\n        <div class="points-slider__slider-bar">\n            <div class="slider-bar" slider ng-model="pointsSlider.value" floor=\'{{pointsSlider.values.low}}\' ceiling=\'{{pointsSlider.values.high}}\'></div>\n        </div>\n    </section>\n</div>')}]),angular.module("/app/common/directives/promo.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/promo.tpl.html",'<div class="promo">\n  <div class="promo__1up" ng-show="!isMobile()">\n    <div class="promo__1up-wrapper" data-vx-common-slider opts="firstSlider">\n      <div class="promo__1up-container">\n        <div class="promo__1up-slide" ng-repeat="promotion in promotions[\'1up\']" ng-class="[getSlideClass(promotion.variant), hasDescription(promotion.description)]">\n          <div class="promo__1up-slide-container">\n            <div class="promo__picture-container">\n              <picture>\n                <img src="{{promotion.image}}" alt="img_alt">\n              </picture>\n            </div>\n            <div class="promo__text-container">\n              <span class="promo__1up-saleText" ng-bind-html="getHtmlTitle(promotion.saleText)"></span>\n              <h3 class="promo__1up-title" ng-bind-html="getHtmlTitle(promotion.headline)"></h3>\n              <p class="promo__1up-description" ng-bind-html="getHtmlTitle(promotion.description)"></p>\n              <a href="{{promotion.restrictionsLink}}" vx-common-link class="promo__1up-info" target="_self" ng-bind-html="getHtmlTitle(promotion.restrictionsText)"></a>\n              <a href="{{promotion.link}}" vx-common-link class="promo__1up-link" target="_blank" ng-click="onPromoClick($index, true)">{{promotion.linkText}}</a>\n            </div>\n          </div>\n        </div>\n        <div class="promo__1up-slide promo__3up-slide" ng-repeat="promotionItems in promotions[\'3up\']">\n          <div class="promo__3up-slide-container">\n            <div class="promo__3up-item" ng-repeat="(key, promotionItem) in promotionItems track by key">\n              <picture>\n                <img src="{{promotionItem.image}}" alt="img_alt">\n              </picture>\n              <h3 class="promo__3up-title" ng-bind-html="getHtmlTitle(promotionItem.title)"></h3>\n              <p class="promo__3up-description" ng-bind-html="getHtmlTitle(promotionItem.description)"></p>\n              <a href="{{promotionItem.restrictionsLink}}" vx-common-link class="promo__3up-info" target="_self" ng-bind-html="getHtmlTitle(promotionItem.restrictionsText)"></a>\n              <a href="{{promotionItem.link}}" vx-common-link class="promo__3up-link" target="_self" ng-click="onPromoClick($index, false)">{{promotionItem.linkText}}</a>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class="promo__1up promo__1up--mobile" ng-show="isMobile()">\n    <div class="promo__1up-wrapper">\n      <div class="promo__1up-container">\n        <div class="promo__1up-slide promo__1up-slide--center" ng-repeat="promotion in promotions[\'1up\']" ng-class="[hasDescription(promotion.description)]">\n          <div class="promo__1up-slide-container">\n            <div class="promo__picture-container">\n              <picture>\n                <img src="{{promotion.image}}" alt="img_alt">\n              </picture>\n            </div>\n            <div class="promo__text-container">\n              <span class="promo__1up-saleText" ng-bind-html="getHtmlTitle(promotion.saleText)"></span>\n              <h3 class="promo__1up-title" ng-bind-html="getHtmlTitle(promotion.headline)"></h3>\n              <p class="promo__1up-description" ng-bind-html="getHtmlTitle(promotion.description)"></p>\n              <a href="{{promotion.restrictionsLink}}" vx-common-link class="promo__1up-info" target="_self" ng-bind-html="getHtmlTitle(promotion.restrictionsText)"></a>\n              <a href="{{promotion.link}}" vx-common-link class="promo__1up-link" target="_blank" ng-click="onPromoClick($index, true)">{{promotion.linkText}}</a>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class="promo__3up" ng-show="isMobile()" data-vx-common-slider opts="secondSlider" numItems="promotions[\'3upMobile\'].length" ng-class="[hasSlides(promotions[\'3upMobile\'].length)]">\n    <div class="promo__3up-wrapper">\n      <div class="promo__3up-container">\n        <div class="promo__3up-slide" ng-repeat="promotion in promotions[\'3upMobile\']">\n          <div class="promo__3up-slide-container">\n            <div class="promo__3up-item">\n              <picture>\n                <img src="{{promotion.image}}" alt="img_alt">\n              </picture>\n              <h3 class="promo__3up-title" ng-bind-html="getHtmlTitle(promotion.title)"></h3>\n              <p class="promo__3up-description" ng-bind-html="getHtmlTitle(promotion.description)"></p>\n              <a href="{{promotion.restrictionsLink}}" vx-common-link class="promo__3up-info" target="_self" ng-bind-html="getHtmlTitle(promotion.restrictionsText)"></a>\n              <a href="{{promotion.link}}" vx-common-link class="promo__3up-link" target="_self" ng-click="onPromoClick($index, false)">{{promotion.linkText}}</a>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>')}]),angular.module("/app/common/directives/saved-choices-bar.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/saved-choices-bar.tpl.html",'<div class="saved-choices-bar" ng-show="savedChoicesBar.visible">\n    <div class="wrap">\n        <p class="saved-choices-bar__copy">\n            {{savedChoicesBar.messages.COPY}}\n            <a href="#" class="link-underline" data-vx-common-prevent-default ng-click="savedChoicesBar.load()">{{savedChoicesBar.messages.YES}}</a>\n            <a href="#" class="link-underline" data-vx-common-prevent-default ng-click="savedChoicesBar.dismiss()">{{savedChoicesBar.messages.NO}}</a>\n        </p>\n\n        <a href="#" class="saved-choices-bar__close icon-close-x-light-purple" data-vx-common-prevent-default ng-click="savedChoicesBar.dismiss()">x</a>\n    </div>\n</div>')}]),angular.module("/app/common/directives/seat-selector.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/seat-selector.tpl.html",'<div\n    id="seat-selector-{{$index}}"\n    class="seat-selector cf"\n    ng-class="{\'is-unavailable\': !segment.seatSelectionAvailable, \'is-trip-info-open\': seatSelector.travelerInfoOpen, \'is-change-flow\': context.is(context.type.CHANGE), \'is-first\': $first, \'is-collapsed\': seatSelector.isCollapsed[$index]}"\n    bindonce="segment"\n    ng-repeat="(segmentIndex, segment) in seatSelector.segmentsData track by $index"\n    refresh-on="\'seatSelector.refreshSegment\'+segmentIndex"\n    ng-show="seatSelector.isVisibleSection(segmentIndex)"\n    data-local-scroll-start="seatSelector.onLocalScrollStart(seatSelector.currentSegmentIndex)"\n    data-vx-common-local-scroll="{{$index}}"\n    data-current-section="seatSelector.currentSegmentIndex">\n\n    <span class="accessible-only-text">Screen reader users: the following information is presented in a grid format. Please press tab to enter the grid. Use arrow keys to navigate the grid options and press enter to make selections. Pressing tab will move you between different rows of seats.</span>\n\n    <div class="collapse-container" vx-common-ally-application role="application">\n        <div data-vx-common-collapsible-section data-collapsed="seatSelector.isCollapsed[$index]" class="seat-selector--outter">\n        <div class="seat-selector--inner" ng-class="{\'a321\': segment._rawData.length > 30}">\n            <div class="collapsed-overlay">\n                <h1>{{ seatSelector.typeLabel[$index] }}</h1>\n                <p class="collapse-overlay-info">\n                    <span>{{seatSelector.selectedSeatsString[$index] }}</span>\n                    <span>({{seatSelector.departure[$index]}} </span>\n                    <span class="icon icon-arrow-right-short-grey"></span>\n                    <span>{{seatSelector.arrival[$index]}})</span>\n                </p>\n                <a href="" data-vx-common-prevent-default class="cta-button btn btn-third" ng-click="collapsible.expand(seatSelector.changeSelection, $index, true)">Change <span class="accessible-only-text">Your Seats</span></a>\n            </div>\n\n            <div class="seat-selector--plane" ng-class="{\'a321\': segment._rawData.length > 30}"></div>\n\n            <div class="seat-selector--seats-column" ng-class="{\'a321\': segment._rawData.length > 30}">\n                <header class="section-header--book">\n                    <h1 class="section-header--book__title" bo-text="seatSelector.mapTitleForSegment(segmentIndex)" tabindex="-1"></h1>\n                    <div ng-if="$first" data-vx-common-c2c="seat-map" class="seat-selector__chat"></div>\n                    <section class="seat-selection-unavailable" ng-if="!segment.seatSelectionAvailable">\n                        <h3>Seat selection unavailable,<br/>but you can still be on it</h3>\n                        <p>We may be unable to confirm your seat selection online for certain flights, but not to worry. You can complete your transaction now and confirm your seat assignment later on.</p>\n                        <a href="#" class="btn btn-primary btn-normal" data-vx-common-prevent-default ng-click="seatSelector.skipSeatSelection(segmentIndex)">I understand. Skip seat selection</a>\n                    </section>\n                </header>\n\n                <section class="seat-section" bo-class="{\'is-first\': $first, \'is-last\': $last, \'is-exit\': section.exitRow}" ng-repeat="index in seatSelector.sortRows(segment.seatMap)" ng-init="section = segment.seatMap[index];" ng-focus="allyApp.isFocused(\'.is-selectable-seat\', \'.seat-section\', index)" tabindex=0 ng-blur="allyApp.lostFocus()" aria-role="widget">\n                    <div class="seat-section__seat-row-info" ng-class="{\'is-upgradable\': seatSelector.tierAlterationLabel(section.name, section.cost, segmentIndex), \'is-points\': seatSelector.currency === \'POINTS\'}">\n                        <h2 class="seat-row-info__name" ng-attr-id="{{\'section-id-\' + index}}" bo-text="seatSelector.getTierLabel(section.name, section.exitRow)"></h2>\n                        <div class="seat-row-info__cost" ng-bind="seatSelector.tierAlterationCost(section.name, section.cost, segmentIndex)"></div>\n                        <a href="#" class="seat-row-info__info-link" vx-common-ally-click="seatSelector.openFareInfoModal(section.name, $event)" ng-attr-id="{{ \'info-link-\' +  index }}" ng-attr-aria-labelledby="{{\'info-link-\' +  index + \' section-id-\' + index}}">info</a>\n                    </div>\n\n                    <ul class="seat-section__seat-row" ng-repeat="key in seatSelector.sortRows(section.rows)" ng-init="row = section.rows[key]" bo-class="{\'is-large\': section.name ==\'FIRST\'} ">\n                        <li class="seat-row" bindonce="seat" refresh-on="\'seatSelector.refreshSeats\'+segmentIndex" ng-repeat="seat in row.seats" ng-class="{\'is-invisible\': seat.invisible, \'is-aisle\': seat.isAisle, \'show-ancillary\': seatSelector.shouldSeatShowAncillary(seat, section) && !seatSelector.isAncillaryForFree(seatSelector.getSeatAncillary(segment, seat)) }">\n                            <div class="seat-box cf" ng-class="{\'is-selectable-seat\': !seat.isAisle, \'is-disabled\': seat.invisible}" ng-init="seat.selected && seatSelector.previouslySelectedSeat(seat, segmentIndex, segment.seatMap)">\n\n                                <a href="#" class="seat-box__seat" data-vx-common-prevent-default bo-if="seat.open && !seat.virtual" ng-click="seatSelector.selectSeat(segment, seat, segmentIndex, $event)" bo-class="{\'is-selected\': seatSelector.isSeatSelected(seat)}" tabindex="-1">\n                                  <span class="accessible-only-text">\n                                    <span bo-if="seat.aisle">aisle</span>\n                                    <span bo-if="seat.window">window</span>\n                                    seat\n                                  </span>\n                                  <span bo-text="seat.seatNumber"></span>\n                                </a>\n\n                                <span class="seat-box__ancillary" ng-if="seatSelector.shouldSeatShowAncillary(seat, section) && !seatSelector.isAncillaryForFree(seatSelector.getSeatAncillary(segment, seat))" ng-bind="\'+$\' + seatSelector.getSeatAncillary(segment, seat).finalPrice"></span>\n\n                                <div bo-if="seat.avatar" class="seat-box__avatar">\n                                  <a href="#" class="icon-avatar-{{seat.avatar}}-rect" aria-selected="true" data-vx-common-prevent-default ng-click="seatSelector.selectSeat(segment, seat, segmentIndex, $event)" tabindex="-1">\n                                    <span class="accessible-only-text">\n                                      You currently have\n                                      <span bo-if="seat.aisle">aisle</span>\n                                      <span bo-if="seat.window">window</span>\n                                      seat {{seat.seatNumber}} selected.</span>\n                                  </a>\n                                </div>\n\n                                <div class="seat-box__seat-taken" aria-disabled="true" bo-class="seat.avatarImage | lowercase" bo-if="((!seat.selected && !seat.open) || seatSelector.tierExcluded(segmentIndex, section.name)) && !seat.virtual && !seat.isAisle">\n                                  <span bo-text="seat.seatNumber"></span> is unavailable\n                                </div>\n                            </div>\n                             <div bo-if="row.exitRow && seat.window" class="seat-box__exit-arrow" bo-class="seatSelector.isLastSeatInRow(seat.seatNumber, row.seats) && \'is-right\' || \'is-left\'"></div>\n                        </li>\n                    </ul>\n\n                    <div class="seat-selector--continue-button" ng-class="{\'is-pay-now\' : seatSelector.payNow}">\n                        <a class="btn btn-centered btn-primary btn-lg" ng-click="seatSelector.transitionToPayment()" ng-show="seatSelector.shouldShowContinueButton()">Continue to payment</a>\n                    </div>\n                </section>\n            </div>\n        </div>\n        </div>\n    </div>\n</div>\n')}]),angular.module("/app/common/directives/select-box.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/select-box.tpl.html",'<ul class="select {{data.cssClasses}}">\n    <li class="default-option" ng-bind="data.defaultOption"></li>\n    <li ng-repeat="option in data.options" ng-click="data.itemClickCallback(option)" style="display:none">{{option}}</li>\n</ul>')}]),angular.module("/app/common/directives/social-media-buttons.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/social-media-buttons.tpl.html",'<div>\n    <ul class="city-pair-expanded__social">\n        <li>\n            <a href="#" class="icon-facebook-simplified"\n              data-vx-common-facebook-share\n              data-share-url="shareData.url"><span class="accessible-hidden-label">Facebook</span></a>\n        </li>\n        <li>\n            <a href="https://twitter.com/share?url={{shareData.url}}&amp;text={{shareData.socialButtonsCopy.twitter}}"\n                class="icon-twitter-simplified" target="_blank"><span class="accessible-hidden-label">Twitter</span></a>\n        </li>\n        <li>\n            <a href="#" class="icon-g-plus-hidden" data-share-data="shareData"></a>\n            <a href="#" class="icon-g-plus-simplified"\n                data-vx-common-google-plus-share\n                data-share-data="shareData"><span class="accessible-hidden-label">Google+</span></a>\n        </li>\n        <li>\n            <a href="mailto:?subject={{shareData.socialButtonsCopy.email.subject}}!&body={{shareData.socialButtonsCopy.email.body}}"\n                class="icon-email-simplified"><span class="accessible-hidden-label">Email</span></a>\n        </li>\n    </ul>\n    <div class="city-pair-expanded__social-header" vx-common-link is-external="true">\n      Share\n    </div>\n</div>')}]),angular.module("/app/common/directives/status-bar.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/status-bar.tpl.html",'<section bindonce class="bar-holder">\n    <div class="status-bar {{statusBar.classes}}" aria-hidden="{{statusBar.visible ? \'false\' : \'true\'}}" tabindex="-1">\n        <div class="yts__back-button" ng-if="statusBar.shouldShowBackButton()">\n            <a data-vx-common-prevent-default class="yts-trip__middle back-arrow icon-arrow-back" href="#" ng-click="statusBar.goBack()"></a>\n        </div>\n\n        <a href="{{path.home}}" data-vx-common-prevent-default ng-click="resetFlow()" ng-if="statusBar.shouldShowBackButton()">\n            <span class="checkin-logo icon-vx-simplified-mono"></span>\n        </a>\n\n        <h1 class="status-bar__copy ng-cloak" bo-class="{\'with-back\': statusBar.shouldShowBackButton()}"></h1>\n\n        <ul class="status-bar__opts ng-cloak">\n            <li ng-show="statusBar.controls.close"><a href="#" class="status-bar__close ir" ng-click="statusBar.back()">Close</a></li>\n            <li ng-show="statusBar.controls.back"><a href="#" ng-click="statusBar.back(); statusBar.hide()" class="btn btn-secondary btn-sm status-bar__btn">{{statusBar.controls.back}}</a></li>\n            <li ng-show="statusBar.controls.next"><a href="#" ng-click="statusBar.next()">{{statusBar.controls.next}}</a></li>\n        </ul>\n    </div>\n\n    <div class="alert-bar {{alertBar.classes}}" aria-hidden="{{alertBar.visible ? \'false\' : \'true\'}}" tabindex="-1">\n        <p class="alert-bar__copy ng-cloak"><span class="title" ng-show="alertBar.copy.TITLE">{{alertBar.copy.TITLE}}</span> {{alertBar.message}} <span class="code" ng-show="alertBar.errorCode" ng-bind="\'#\' + alertBar.errorCode"></span></p>\n        <ul class="status-bar__opts ng-cloak">\n            <li ng-show="alertBar.controls.close"><a href="#" class="status-bar__close ir" ng-click="alertBar.hide()" role="button">Close</a></li>\n            <li ng-show="alertBar.controls.hide"><a href="#" ng-click="alertBar.hide()" class="btn btn-secondary btn-sm status-bar__btn status-bar__close-btn" role="button">{{alertBar.controls.hide}}</a></li>\n            <li ng-show="alertBar.controls.dismiss"><a href="#" ng-click="alertBar.dismiss()" class="btn btn-secondary btn-sm status-bar__btn" role="button">{{alertBar.controls.dismiss}}</a></li>\n        </ul>\n    </div>\n</section>')}]),angular.module("/app/common/directives/travel-advisory.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/travel-advisory.tpl.html",'<p class="travel-advisory" ng-class="{\'is-collapsed\': isNavActive}" bindonce="travelAdvisory" ng-show="travelAdvisory.msg" ng-cloak>\n    <span ng-bind-html="travelAdvisory.msgSafe"></span>\n    <a ng-if="travelAdvisory.link" bo-href="travelAdvisory.link" class="travel-advisory__link" target="_self" vx-common-link>More</a>\n</p>\n')}]),angular.module("/app/common/directives/traveler-docs.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/traveler-docs.tpl.html",'<div bindonce ng-if="false">\n    <div class="traveler-info" ng-class="{\'is-open\': travelerDocs.isVisible, \'is-change-flow\': travelerDocs.isChange}">\n        <a href="#" data-vx-common-prevent-default class="traveler-info__reset-seats icon-close-2 link-utility" data-vx-common-hover-class="icon-close" ng-click="travelerDocs.hide()">\n            <span>Close</span>\n        </a>\n        <section class="traveler-info__content" ng-show="travelerDocs.currentView === travelerDocs.views.TILES">\n            <h3 class="traveler-info__title"></h3>\n            <div>\n                <ul class="traveler-info__tile-list cf">\n                    <li bindonce ng-repeat="traveler in travelerDocs.travelerModels" ng-click="travelerDocs.editTravelerInfo(traveler)">\n                        <span class="eyebrow">{{traveler.travelerType}}</span>\n                        <span class="icon icon-avatar-{{traveler.avatar}}-sm"></span>\n                        <p class="title-main">{{traveler.name.first}}<br>{{traveler.name.last}}</p>\n                    </li>\n                </ul>\n                <p class="traveler-info__disclaimer">TSA regulations require that you fill the information below exactly as they appear on the government issued ID you are using to travel. For more information read the <a href="#" ng-click="core.openPrivacyModal()">Privacy Notice</a>.</p>\n            </div>\n        </section>\n\n        <section class="traveler-info__content" ng-show="travelerDocs.currentView === travelerDocs.views.FORM">\n\n            <h3 class="traveler-info__title">Edit {{travelerDocs.currentTraveler.name.first}}\'s Information</h3>\n            <a href="#" data-vx-common-prevent-default class="" ng-click="travelerDocs.closeForm()">Back</a>\n\n                <form method="POST" data-vx-form-handler data="travelerDocs.travelerData" data-fields="travelerDocs.travelerFields" data-on-success="travelerDocs.storeTravelerModel(formHandler)" data-submit-message="Save changes" data-submit-error-message="no changes to save" novalidate>\n\n                    <div class="traveler-info__international" ng-if="travelerDocs.isInternational">\n                        <h2 class="traveler-info__title-sub">International Flight Info</h2>\n                        <input data-vx-form-input type="text" name="passport" placeholder="Passport #" data-input-class="form__input--tight" data-validate="optional,passportLength,alphanumeric" data-input-label="passport" autocorrect="off" data-is-visible="true"/>\n                        <div class="form__input--tight">\n                            <div data-vx-form-select-array data-select-class="select select--block" data-select-name="issuingCountry" data-validate="optional" data-select-title="Passport Issuing Country" data-select-options="travelerDocs.countries" data-is-visible="true"></div>\n                        </div>\n                        <div data-vx-form-date placeholder="Passport Expiration Date" data-form-handler="formHandler" data-name="expirationDate" data-validate="optional" label="Expires:" data-start-date="travelerDocs.expiryDateStart" data-end-date="travelerDocs.expiryDateEnd" data-is-visible="true"></div>\n                        <div class="form__input--tight">\n                            <div data-vx-form-select-array data-select-class="select select--block" data-select-name="citizenship" data-validate="optional" data-select-title="Citizenship" data-select-options="travelerDocs.countries" data-is-visible="true"></div>\n                        </div>\n                        <div class="form__input--tight">\n                            <div id="residence" data-vx-form-select-array data-select-class="select select--block" data-select-name="residence" data-validate="optional" data-select-title="Country of residence" data-select-options="travelerDocs.countries" data-is-visible="true"></div>\n                        </div>\n                        <div ng-if="travelerDocs.currentTraveler.travelerType !== \'infant\'">\n                            <input data-vx-form-input type="text" name="emergencyName" placeholder="Emergency contact name" data-input-class="form__input--tight" data-validate="optional,alphanumeric" autocorrect="off" data-is-visible="true" />\n                            <input data-vx-form-input type="text" name="emergencyPhone" placeholder="Emergency contact phone #" data-input-class="form__input--tight" data-validate="optional,phone" autocorrect="off" data-is-visible="true" />\n                        </div>\n                    </div>\n\n                    <div ng-if="travelerDocs.currentTraveler.travelerType !== \'infant\'">\n                        <div class="traveler-info__optional cf">\n                            <h2 class="traveler-info__title-sub">Optional</h2>\n                            <a href="#" class="link-float" vx-common-ally-click="travelerDocs.showSeatQuestionsModal()" data-vx-common-prevent-default>Questions? <span class="accessible-only-text">about Frequent Flyer Information?</span></a>\n                        </div>\n                        <div class="form__input--tight">\n                            <div data-vx-form-select-array data-select-class="select select--block" data-select-name="frequentFlyer" data-validate="optional" data-select-title="Frequent flyer program" data-select-options="travelerDocs.ffPrograms" data-is-visible="true"></div>\n                        </div>\n                        <input data-vx-form-input type="text" name="frequentFlyerNumber" placeholder="Frequent Flyer #" maxlength="12" data-input-class="form__input--tight" data-validate="optional,number" autocorrect="off" pattern="\\d*" data-is-visible="true"/>\n                        <input data-vx-form-input type="text" name="redressNumber" placeholder="Redress #" data-input-class="form__input--tight" data-validate="optional,alphanumeric" autocorrect="off" pattern="\\d*" data-is-visible="true" maxlength="25"/>\n                        <input data-vx-form-input type="text" name="knownTravelerNumber" placeholder="Known Traveler #" data-input-class="form__input--tight" data-validate="optional,alphanumeric" autocorrect="off" data-is-visible="true" maxlength="25" />\n                    </div>\n\n                    <p class="traveler-info__disclaimer">TSA regulations require that you fill the information below exactly as they appear on the government issued ID you are using to travel. For more information read the <a href="#" vx-common-ally-click="core.openPrivacyModal()">Privacy Notice</a>.</p>\n\n                    <button data-vx-form-submit />\n                </form>\n\n        </section>\n    </div>\n\n    <ul class="traveler-info-closed" ng-class="{\'is-change-flow\': travelerDocs.isChange}">\n        <li>\n            <a href="#" data-vx-common-prevent-default class="link-utility icon-arrow-left" data-vx-common-hover-class="icon-arrow-left-1" ng-click="travelerDocs.show()">\n                <span class="is-small">Edit Guest Information</span>\n                <span class="is-medium is-large">Edit Guest</span>\n                <span class="is-medium is-large">Information</span>\n            </a>\n        </li>\n    </ul>\n</div>\n')}]),angular.module("/app/common/directives/traveler-form.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/traveler-form.tpl.html",'<div class="traveler-info__traveler-form cf">\n    <form method="POST"\n          data-vx-form-handler\n          ng-show="$index === travelerInfo.selectedTravelerModelIndex"\n          data="traveler"\n          data-fields="travelerInfo.travelerFields[$index]"\n          data-on-success="travelerInfo.storeTravelerModel($index);"\n          data-submit-message="{{(travelerInfo.viewIs(travelerInfo.views.EDIT) || travelerInfo.viewIs(travelerInfo.views.LIST)) ? \'save and close\' : \'continue\'}}"\n          data-submit-error-message="complete form to continue"\n          novalidate\n          data-ios-scroll-repaint="true"\n          ng-class="{\'form-is-valid\': formHandler.valid}">\n\n      <div class="traveler-info-form__sidebar">\n        <span class="traveler-info-form__avatar icon-avatar-{{traveler.avatar}}-sm"></span>\n\n        <div data-vx-common-avatar-picker\n             data-form-handler="formHandler"\n             data-avatars="travelerInfo.avatarList"\n             data-custom-toggle-fn="travelerInfo.customAvatarToggle(traveler, avatarPicker)">\n          <div class="traveler-info-form__avatar-picker-container traveler-info-form__avatar-picker-container--overlay"\n               ng-show="avatarPicker.viewAvatarSelector">\n            <div class="avatar-list cf">\n              <span class="avatar-list-close icon-close-light"\n                    ng-click="avatarPicker.toggleAvatars()"></span>\n            </div>\n            <div bindonce refresh-on="\'avatarPicker.traveler\'">\n              <ul class="avatar-list cf">\n                <li ng-repeat="avatar in avatars track by $index">\n                  <span class="traveler-info-form__avatar-option icon-avatar-{{avatar}}-sm"\n                        ng-class="{\n                          \'traveler-info-form__avatar-option--is-current\':\n                          traveler.avatar === avatar\n                        }"\n                        data-vx-common-prevent-default\n                        ng-click="avatarPicker.selectAvatar(avatar, false, true)"></span>\n                  </span>\n                </li>\n              </ul>\n            </div>\n          </div>\n\n          <a href="#"\n             class="traveler-info-form__sidebar-link"\n             data-vx-common-prevent-default\n             ng-click="avatarPicker.toggleAvatars()">\n             Change Avatar\n          </a>\n        </div>\n\n        <p class="traveler-info-form__greeting"\n           ng-if="travelerInfo.getGreeting()"\n           ng-bind="travelerInfo.getGreeting()"></p>\n\n        <div class="traveler-info-form__traveler-list"\n            bindonce="travelerInfo.travelerModels"\n            refresh-on="\'travelerInfo.updatedTraveler\'">\n            <div bo-if="travelerInfo.getFilledInTravelers().length">\n                <p class="traveler-info-form__traveler-list__title">You\'re traveling with:</p>\n                <ul class="traveler-info-form__traveler-list__items cf"\n                    ng-repeat="completeTraveler in travelerInfo.getFilledInTravelers()">\n                    <li>\n                        <a href="#"\n                            class="traveler-info-form__sidebar-link"\n                            data-vx-common-prevent-default\n                            bo-text="completeTraveler.name.first + \' \' + completeTraveler.name.last"\n                            ng-click="travelerInfo.showTraveler(completeTraveler)" />\n                    </li>\n                </ul>\n            </div>\n        </div>\n      </div>\n\n      <div class="traveler-info-form__body">\n        <div class="traveler-info__title-sub-container cf">\n          <div class="traveler-info__title-sub">\n            {{travelerInfo.allPaxTypes[traveler.travelerType].name}}\n          </div>\n        </div>\n\n        <div class="form__input">\n          <div data-vx-form-input-composite\n               data-form-handler="formHandler"\n               data-composite-label="Name"\n               data-composite-invalid-message="full name pls"\n               data-composite-name="fullName"\n               data-composite-placeholder="First Middle Last"\n               data-composite-valid-message="nice name"\n               data-readonly="travelerInfo.elevateBookingForSelf(traveler)">\n            <!-- first name -->\n            <input data-vx-form-input\n                   type="text"\n                   name="firstName"\n                   autocorrect="off"\n                   placeholder="First"\n                   data-validate="required,name"\n                   data-input-label="first name"\n                   data-use-placeholder-polyfill="true"/>\n            <!-- middle name -->\n            <input data-vx-form-input\n                   type="text"\n                   name="middleName"\n                   autocorrect="off"\n                   placeholder="Middle"\n                   data-validate="optional,name"\n                   data-input-label="middle name"\n                   ng-hide="travelerInfo.allPaxTypes[traveler.travelerType].name === \'Lap Infant\'"\n                   data-use-placeholder-polyfill="true"/>\n            <!-- last name -->\n            <input data-vx-form-input\n                   type="text"\n                   name="lastName"\n                   autocorrect="off"\n                   placeholder="Last"\n                   data-validate="required,name"\n                   data-input-label="last name"\n                   data-use-placeholder-polyfill="true"/>\n          </div>\n        </div>\n\n        <!-- email -->\n        <input data-vx-form-input\n               type="email"\n               name="email"\n               placeholder="E-mail"\n               data-validate="required,email"\n               data-input-label="email"\n               autocorrect="off"\n               autocapitalize="off"\n               data-is-visible="$first"\n               data-use-placeholder-polyfill="true"/>\n\n        <!-- phone -->\n        <input data-vx-form-input\n               type="text"\n               name="phone"\n               placeholder="Phone"\n               data-validate="required,phone,phoneLength"\n               data-input-label="phone"\n               pattern="\\d{10,}"\n               data-is-visible="$first"\n               data-use-placeholder-polyfill="true"/>\n\n        <div class="form__input form__input--inline-large cf">\n            <!-- gender -->\n            <div class="select-inline is-position-relative form__input is-gender-form">\n                <div data-vx-form-select-array\n                     data-select-class="select select--month select--full-width-block"\n                     data-select-name="sex"\n                     data-select-title="Gender"\n                     data-select-options="travelerInfo.genders"\n                     data-validate="required"\n                     data-input-label="gender"></div>\n                <span class="label dropdown__label"><span class="label__content">Gender</span></span>\n            </div>\n\n            <!-- DOB -->\n            <div class="cf">\n              <div data-vx-form-dob\n                   placeholder="Date of Birth"\n                   data-compare-date="compareDate"\n                   data-input-label="month,day,year"\n                   data-form-handler="formHandler"\n                   data-inline="true"\n                   data-inner-placeholder="0,00,0000"\n                   data-input-class="form__input--no-padding"\n                   data-select-inline-class="is-position-relative"\n                   data-long-months="true"\n                   data-is-logged-in="travelerInfo.elevateBookingForSelf(traveler)"\n                   data-traveler-type="traveler.travelerType"></div>\n          </div>\n        </div>\n\n        <!-- international -->\n        <div ng-if="travelerInfo.isInternational">\n          <div class="traveler-info__title-sub-container cf">\n            <div class="traveler-info__title-sub">\n              International Flight Info\n            </div>\n          </div>\n\n          <div class="form__input--half-width-field cf">\n            <!-- passport # -->\n            <div class="input-inline">\n              <input data-vx-form-input\n                     type="text"\n                     name="passport"\n                     placeholder="Passport #"\n                     data-validate="optional,passportLength,alphanumeric"\n                     data-input-label="passport"\n                     autocorrect="off"\n                     data-use-placeholder-polyfill="true"/>\n            </div>\n\n            <!-- passport issuing country -->\n            <div class="form__input select-inline is-last-child">\n              <div data-vx-form-select-array\n                   data-select-class="select select--block"\n                   data-select-name="issuingCountry"\n                   data-validate="optional"\n                   data-select-title="Passport Issuing Country"\n                   data-select-options="travelerInfo.countries"></div>\n            <span class="label dropdown__label extended"><span class="label__content">Passport Issuing Country</span></span>\n            </div>\n          </div>\n\n          <div class="form__input cf">\n            <!-- passport expiration date -->\n            <div data-vx-form-date\n                 placeholder="Passport Expiration Date"\n                 label="Expires on:"\n                 data-end-date="travelerInfo.expiryDateEnd"\n                 data-form-handler="formHandler"\n                 data-inline="true"\n                 data-long-months="true"\n                 data-name="expirationDate"\n                 data-start-date="travelerInfo.expiryDateStart"\n                 data-validate="optional"></div>\n          </div>\n\n          <div class="form__input--half-width-field cf">\n            <!-- citizenship -->\n            <div class="form__input select-inline">\n              <div data-vx-form-select-array\n                   data-select-class="select select--block"\n                   data-select-name="citizenship"\n                   data-validate="optional"\n                   data-select-title="Citizenship"\n                   data-select-options="travelerInfo.countries"></div>\n              <span class="label dropdown__label"><span class="label__content">Citizenship</span></span>\n            </div>\n\n            <!-- country of residence -->\n            <div class="form__input select-inline is-last-child">\n              <div id="residence"\n                   data-vx-form-select-array\n                   data-select-class="select select--block"\n                   data-select-name="residence"\n                   data-validate="optional"\n                   data-select-title="Country of residence"\n                   data-select-options="travelerInfo.countries"></div>\n              <span class="label dropdown__label extended"><span class="label__content">Country of residence</span></span>\n            </div>\n          </div>\n\n          <div class="form__input--half-width-field cf"\n          ng-if="travelerInfo.allPaxTypes[traveler.travelerType].name !== \'Lap Infant\'">\n            <!-- emergency contact name -->\n            <div class="input-inline">\n              <input data-vx-form-input\n                     type="text"\n                     name="emergencyName"\n                     placeholder="Emergency contact name"\n                     data-validate="optional,name"\n                     autocorrect="off"\n                     autocomplete="off"\n                     data-use-placeholder-polyfill="true"/>\n            </div>\n\n            <!-- emergency phone -->\n            <div class="input-inline is-last-child">\n              <input data-vx-form-input\n                     type="text"\n                     name="emergencyPhone"\n                     placeholder="Emergency contact phone #"\n                     data-validate="optional,phone,phoneLength"\n                     autocorrect="off"\n                     autocomplete="off"\n                     data-use-placeholder-polyfill="true"/>\n            </div>\n          </div>\n        </div>\n\n        <!-- optional content -->\n        <div class="traveler-info__optional"\n            ng-class="{\'warn-frequent-flyer\': traveler.warnFrequentFlyer}"\n             ng-if="!travelerInfo.isTravelerInfant(traveler)">\n          <div class="traveler-info__title-sub-container cf">\n            <div class="traveler-info__title-sub">\n              Frequent Flyer Information (optional)\n            </div>\n            <a href="#"\n               class="traveler-info__questions link-float"\n               vx-common-ally-click="travelerInfo.showFrequentFlyerQuestionsModal()"\n               data-vx-common-prevent-default>Questions? <span class="accessible-only-text">about Frequent Flyer Information?</span></a>\n          </div>\n\n          <div ng-show="traveler.warnFrequentFlyer" class="traveler-info__elevate-turn-over">\n            To receive elite benefits and earn credit for this flight please enter an Alaska Mileage Plan™ number.\n          </div>\n\n          <div class="form__input--half-width-field cf">\n            <!-- frequent flyer dropdown -->\n            <div class="form__input select-inline is-position-relative is-ff-dropdown">\n              <div data-vx-form-select-array\n                   data-select-class="select select--block"\n                   data-select-name="frequentFlyer"\n                   data-validate="optional"\n                   data-select-title="Frequent flyer program"\n                   data-select-options="travelerInfo.ffPrograms"\n                   data-input-label="program"\n                   data-is-visible="true"></div>\n              <span class="label dropdown__label extended"><span class="label__content">Frequent Flyer Program</span></span>\n            </div>\n\n            <!-- frequent flyer number -->\n            <div class="input-inline is-last-child">\n              <!-- frequent flyer number (elevate booking for self) -->\n              <div ng-if="travelerInfo.elevateBookingForSelf(traveler)">\n                <!-- elevate ff program -->\n                <div ng-if="formHandler.data.frequentFlyer === travelerInfo.constants.VIRGIN_AMERICA_FF">\n                  <div data-vx-form-input-facade\n                       data-label="Frequent Flyer #"\n                       data-value="{{traveler.elevateNumber}}"\n                       data-disabled="true"></div>\n                  <input data-vx-form-input\n                         type="text"\n                         name="elevateNumber"\n                         placeholder="Frequent Flyer #"\n                         maxlength="11"\n                         data-is-visible="false"\n                         data-validate="optional,number"\n                         data-input-label="Frequent Flyer #"\n                         autocorrect="off"\n                         pattern="\\d*"/>\n                </div>\n                <!-- other ff program -->\n                <div ng-if="formHandler.data.frequentFlyer !== travelerInfo.constants.VIRGIN_AMERICA_FF">\n                  <input data-vx-form-input\n                         type="text"\n                         name="frequentFlyerNumber"\n                         placeholder="Frequent Flyer #"\n                         maxlength="12"\n                         autocorrect="off"\n                         pattern="\\d*"\n                         data-input-label="Frequent Flyer #"\n                         data-validate="optional,number"\n                         data-use-placeholder-polyfill="true"/>\n                </div>\n              </div>\n\n              <!-- frequent flyer number (not elevate booking for self) -->\n              <div ng-if="!travelerInfo.elevateBookingForSelf(traveler)">\n                <!-- no selected ff program -->\n                <div ng-if="!formHandler.data.frequentFlyer">\n                  <div data-vx-form-input-facade\n                       data-label="Frequent Flyer #"\n                       data-value="000000000"\n                       data-disabled="true"></div>\n                  <input data-vx-form-input\n                         type="text"\n                         name="elevateNumber"\n                         placeholder="Frequent Flyer #"\n                         maxlength="11"\n                         data-is-visible="false"\n                         data-validate="optional,number"\n                         data-input-label="Frequent Flyer #"\n                         autocorrect="off"\n                         pattern="\\d*"/>\n                </div>\n                <!-- selected ff program -->\n                <div ng-if="formHandler.data.frequentFlyer">\n                  <input data-vx-form-input\n                         type="text"\n                         name="frequentFlyerNumber"\n                         placeholder="Frequent Flyer #"\n                         maxlength="12"\n                         autocorrect="off"\n                         pattern="\\d*"\n                         data-input-label="Frequent Flyer #"\n                         data-validate="optional,number"\n                         data-use-placeholder-polyfill="true"/>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div class="form__input--half-width-field cf">\n            <!-- redress number -->\n            <div class="input-inline">\n              <input data-vx-form-input type="text"\n                     name="userRedressNumber"\n                     placeholder="Redress #"\n                     data-input-label="Redress #"\n                     data-validate="optional,alphanumeric"\n                     autocorrect="off"\n                     pattern="\\d*"\n                     data-is-visible="true"\n                     maxlength="25"\n                     data-use-placeholder-polyfill="true"/>\n            </div>\n\n            <!-- known traveler number -->\n            <div class="input-inline is-last-child">\n              <input data-vx-form-input\n                     type="text"\n                     name="knownTravelerNumber"\n                     placeholder="Known Traveler #"\n                     data-input-label="Known Traveler #"\n                     data-validate="optional,alphanumeric"\n                     autocorrect="off"\n                     data-is-visible="true"\n                     maxlength="25"\n                     data-use-placeholder-polyfill="true"/>\n            </div>\n          </div>\n        </div>\n\n        <p id="traveler-info-disclaimer" class="traveler-info__disclaimer" tabindex="-1">TSA regulations require us to collect your full name as it appears on the valid government-issued I.D. you will be using for travel as well as your date of birth and gender. For more information, please read the <a href="#" ng-click="core.openTSAModal()">Privacy Notice</a>.</p>\n\n        <button aria-describedby="traveler-info-disclaimer" data-vx-form-submit data-vx-e2e-traveler-continue></button>\n      </div>\n    </form>\n\n</div>');
}]),angular.module("/app/common/directives/traveler-info.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/traveler-info.tpl.html",'<div class="traveler-info wrap collapse-container"\n     ng-class="{\'vh-minimum\': travelerInfo.applyMinHeight}">\n\n  <!-- collapsed state -->\n  <div data-vx-common-collapsible-section collapsed="travelerInfo.isCollapsed">\n    <div class="collapsed-overlay" ng-show="travelerInfo.isCollapsed">\n      <h1>Guest Information</h1>\n      <p bindonce\n         refresh-on="\'travelerInfo.setFormattedGuestNames\'"\n         class="collapse-overlay-info">\n        <span bo-bind="travelerInfo.getFormattedGuestNames()"></span>\n      </p>\n      <a data-vx-common-prevent-default\n         href="#"\n         class="cta-button btn btn-third"\n         ng-click="collapsible.expand(travelerInfo.changeSection, null, true)">\n        Change\n      </a>\n    </div>\n  </div>\n\n\n  <div class="traveler-info__inner wrap" ng-show="!travelerInfo.isCollapsed">\n\n    <!-- header -->\n    <header class="section-header--book">\n      <h1 class="section-header--book__title traveler-info__title" tabindex="-1">\n        Complete Guest Information\n      </h1>\n\n      <div class="traveler-info__disclaimer"\n           ng-if="travelerInfo.isDisclaimerVisible()">\n        <p>\n          The purchaser should be listed as a primary traveler.\n          <a href="#"\n             vx-common-ally-click="travelerInfo.openPrimaryTravelerModal()"\n             data-vx-common-prevent-default>Why? <span class="accessible-only-text">The purchaser should be listed as a primary traveler. </span> </a>\n        </p>\n\n        <div ng-if="travelerInfo.selectedTravelerModelIndex === 0">\n          <!-- logged in: continue as guest -->\n          <p ng-if="travelerInfo.isUserLoggedIn()">\n            Not you?\n            <a href="#"\n               data-vx-common-prevent-default\n               ng-click="travelerInfo.signIn()">\n               Sign in</a> or\n            <a href="#"\n               data-vx-common-prevent-default\n               ng-click="travelerInfo.continueAsGuest()">\n               continue as a guest.</a>\n          </p>\n\n          <!-- logging in: continue as guest -->\n          <p ng-if="!travelerInfo.isUserLoggedIn() &&\n            (travelerInfo.viewIs(travelerInfo.views.LOGIN_FORM) ||\n             travelerInfo.viewIs(travelerInfo.views.RECOGNIZED_LOGIN_FORM))">\n            <a href="#"\n               data-vx-common-prevent-default\n               ng-click="travelerInfo.continueAsGuest()">Continue as a guest.</a>\n          </p>\n\n          <!-- filling out form as guest: sign in -->\n          <p ng-if="!travelerInfo.isUserLoggedIn() &&\n            travelerInfo.viewIs(travelerInfo.views.TRAVELER_INFO_FORM)">\n            Already have an Elevate account?\n            <a href="#"\n               data-vx-common-prevent-default\n               ng-click="travelerInfo.signIn()">Sign In</a>\n          </p>\n\n          <!-- booking for someone else -->\n          <p ng-if="travelerInfo.isUserLoggedIn() &&\n            travelerInfo.viewIs(travelerInfo.views.TRAVELER_INFO_FORM) &&\n            travelerInfo.isPrimaryTraveler()">\n            <a href="#" ng-click="travelerInfo.toggleBookingForSomeoneElse()">\n              <span ng-if="travelerInfo.bookingForSomeoneElse">\n                I\'m booking for myself.\n              </span>\n              <span ng-if="!travelerInfo.bookingForSomeoneElse">\n                I\'m booking for someone else.\n              </span>\n            </a>\n          </p>\n        </div>\n      </div>\n    </header>\n\n    <!-- landing page -->\n    <ul class="traveler-info-landing"\n        ng-if="travelerInfo.viewIs(travelerInfo.views.LANDING_PAGE)">\n      <li>\n        <a href="#"\n           class="traveler-info-landing__box"\n           ng-click="travelerInfo.leaveLandingPage(travelerInfo.views.LOGIN_FORM)">\n          <div class="center">\n            <h3 class="traveler-info-landing__header">\n              <span>Sign In</span>\n            </h3>\n            <div class="traveler-info-landing__sub-header">Former Elevate Members</div>\n          </div>\n        </a>\n      </li>\n\n      <li>\n        <a href="#"\n           class="traveler-info-landing__box"\n           ng-click="travelerInfo.leaveLandingPage(travelerInfo.views.TRAVELER_INFO_FORM)">\n          <div class="center">\n            <h3 class="traveler-info-landing__header traveler-info-landing__header--continue-as-guest">\n              <span>Continue</span>\n            </h3>\n            <div class="traveler-info-landing__sub-header">\n              Guests or Alaska Mileage Plan™ Members\n              <span class="icon-info" title="Guest includes Mileage Plan Members who do not have an Elevate login"></span>\n            </div>\n          </div>\n        </a>\n      </li>\n    </ul>\n\n    <!-- login form - not recognized -->\n    <div ng-if="travelerInfo.viewIs(travelerInfo.views.LOGIN_FORM)">\n      <div class="traveler-info-form__body--no-sidebar">\n        <form method="POST" bindonce\n              data-vx-form-handler\n              data="travelerInfo.user"\n              data-fields="travelerInfo.loginForm"\n              data-submit-message="Sign in"\n              data-submit-error-message="Fill the form to sign in"\n              data-on-success="travelerInfo.signInFormSubmit()">\n          <input data-vx-e2e-traveler-email\n                 data-vx-form-input\n                 type="text"\n                 name="loginEmail"\n                 placeholder="Email"\n                 data-input-label="Email"\n                 data-input-class="form__input--big"\n                 data-validate="required,emailOrNumber"\n                 autocorrect="off"\n                 autocapitalize="off"\n                 data-use-placeholder-polyfill="true"/>\n\n          <div class="traveler-info-form__password-container">\n            <input data-vx-form-input\n                   type="password"\n                   name="loginPassword"\n                   placeholder="Password"\n                   data-input-label="Password"\n                   data-input-class="form__input--big"\n                   data-validate="required"\n                   autocorrect="off"\n                   data-use-placeholder-polyfill="true"/>\n\n              <a href="#"\n                 vx-common-ally-click="travelerInfo.openForgotPasswordModal()"\n                 data-vx-common-prevent-default>Forgot?</a>\n          </div>\n\n          <div class="form__btn--tight form__btn--big">\n            <button data-vx-form-submit />\n          </div>\n        </form>\n      </div>\n    </div>\n\n    <!-- login form - user is recognized -->\n    <div ng-if="travelerInfo.viewIs(travelerInfo.views.RECOGNIZED_LOGIN_FORM)">\n      <div class="traveler-info-form__body">\n        <form method="POST" bindonce\n              data-vx-form-handler\n              data="travelerInfo.user"\n              data-fields="travelerInfo.recognizedLoginForm"\n              data-submit-message="Sign in"\n              data-submit-error-message="Fill the form to sign in"\n              data-on-success="travelerInfo.signInFormSubmit()">\n          <input data-vx-e2e-traveler-email\n                 data-vx-form-input\n                 type="text"\n                 name="loginEmail"\n                 placeholder="example@email.com"\n                 data-eyebrow="Email"\n                 data-input-class="form__input--big"\n                 data-validate="required,emailOrNumber"\n                 autocorrect="off"\n                 autocapitalize="off"\n                 data-use-placeholder-polyfill="true"/>\n\n          <div class="traveler-info-form__password-container">\n            <input data-vx-form-input\n                   type="password"\n                   name="loginPassword"\n                   placeholder="Password"\n                   data-eyebrow="Password"\n                   data-input-class="form__input--big"\n                   data-validate="required"\n                   autocorrect="off"\n                   data-use-placeholder-polyfill="true"/>\n\n              <a href="#"\n                 vx-common-ally-click="travelerInfo.openForgotPasswordModal()"\n                 data-vx-common-prevent-default>Forgot?</a>\n          </div>\n\n          <div class="form__btn--tight form__btn--big">\n            <button data-vx-form-submit />\n          </div>\n        </form>\n      </div>\n      <div class="traveler-info-form__sidebar">\n        <div class="traveler-info-form__sidebar-inner">\n          <div ng-if="travelerInfo.matchesRecognizedEmail()">\n            <!-- using email the app remembered -->\n            <span class="traveler-info-form__avatar icon-avatar-{{travelerInfo.user.avatar}}-sm"></span>\n            <div class="traveler-info-form__greeting" aria-live="polite">\n              Hi, {{travelerInfo.user.firstName}}\n            </div>\n          </div>\n\n          <!-- signing in with different email -->\n          <div ng-if="!travelerInfo.matchesRecognizedEmail()">\n            <span class="traveler-info-form__avatar icon-circle"></span>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- traveler info form -->\n    <div class="traveler-info-form" ng-if="travelerInfo.viewIs(travelerInfo.views.TRAVELER_INFO_FORM)">\n      <div ng-repeat="traveler in travelerInfo.travelerData"\n           vx-common-traveler-form></div>\n    </div>\n  </div>\n</div>')}]),angular.module("/app/common/directives/yts-module.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/yts-module.tpl.html",'<div class="yts-module-wrapper">\n    <a ng-if="!yts.alt && changeEnable" href="#" class="yts-module yts-module-scroll" vx-common-prevent-default ng-click="yts.change(changeTarget)">\n        <header class="yts-module__header cf">\n            <h1>{{header}}</h1>\n            <span>Change</span>\n        </header>\n        <div ng-transclude></div>\n    </a>\n\n    <div ng-if="yts.alt || !changeEnable" class="yts-module">\n        <header class="yts-module__header cf">\n            <h1>{{header}}</h1>\n        </header>\n        <div ng-transclude></div>\n    </div>\n</div>')}]),angular.module("/app/common/directives/yts.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/directives/yts.tpl.html",'<div id="yts" class="banner__yts" ng-switch="yts.expanded" ng-if="yts.isVisible" ng-class="{\'banner__yts--expanded\': yts.expanded, \'banner__yts--alt\': yts.alt}">\n    <div class="yts--collapsed" ng-class="{\'is-mouseover\': yts.collapsedHover}" ng-switch-when="false" ng-mouseenter="yts.collapsedHover = true" ng-mouseleave="yts.collapsedHover = false">\n        <!-- COLLAPSED YTS -->\n        <div class="yts__back-button yts--hover" ng-if="!yts.alt && yts.isBackButtonVisible">\n            <a class="yts-trip__middle back-arrow icon-arrow-back" ng-click="yts.back()"></a>\n        </div>\n\n        <h1 class="yts__logo yts--hover">\n            <a href="{{path.home}}" class="icon-vx-simplified-color" data-vx-common-prevent-default ng-click="yts.resetFlow()">Virgin America</a>\n        </h1>\n        <div class="yts__container-wrapper">\n        <div vx-alaska-header-banner banner-type="yts.alaskaBannerType" back-button="yts.back()"></div>\n        <div class="yts__yts-trip" ng-switch="yts.breakpoint" ng-click="yts.expandYts()">\n            <ul class="yts-trip--med cf" ng-class="{\'is-multi-city\': yts.isMultiCity}" ng-switch-when="medium">\n                <li class="cf">\n                    <span class="yts-trip--med__dest">{{yts.cityPairs[0].dep}}</span>\n                    <span class="yts-trip--med__arr" ng-class="{\'is-round-trip\': yts.isRoundTrip}">-</span>\n                    <span class="yts-trip--med__dest">{{yts.cityPairs[0].des}}</span>\n                </li>\n                <li class="cf" ng-if="yts.isMultiCity">\n                    <span class="yts-trip--med__dest">{{yts.cityPairs[1].dep}}</span>\n                    <span class="yts-trip--med__arr" ng-class="{\'is-round-trip\': yts.isRoundTrip}">-</span>\n                    <span class="yts-trip--med__dest">{{yts.cityPairs[1].des}}</span>\n                </li>\n            </ul>\n            <div class="yts-trip--lg cf" ng-switch-when="large">\n                <div class="yts-trip--lg__yts-summary">\n                    <table class="yts-summary">\n                        <tbody>\n                            <tr>\n                                <td colspan="3" class="yts-trip__top" ng-if="yts.isOneWay">&nbsp;</td>\n                                <td colspan="3" class="yts-trip__top" ng-if="!yts.isOneWay">{{yts.dates[0].month}} {{yts.dates[0].date}}</td>\n                            </tr>\n                            <tr>\n                                <td colspan="3" class="yts-trip__middle" ng-if="yts.isOneWay">One way</td>\n                                <!-- Leg 1 -->\n                                <td class="yts-trip__middle is-dest" ng-if="!yts.isOneWay">{{yts.cityPairs[0].dep}}</td>\n                                <td class="yts-trip__middle is-arr" ng-if="!yts.isOneWay">-</td>\n                                <td class="yts-trip__middle is-dest" ng-if="!yts.isOneWay">{{yts.cityPairs[0].des}}</td>\n                            </tr>\n                            <tr>\n                                <td class="yts-trip__bottom" colspan="3" ng-if="yts.isOneWay">&nbsp;</td>\n                                <!-- Leg 1 -->\n                                <td class="yts-trip__bottom" ng-if="!yts.isOneWay">{{yts.flights[0].trip.getDepartureTime()}}</td>\n                                <td class="yts-trip__bottom" ng-if="!yts.isOneWay">&nbsp;</td>\n                                <td class="yts-trip__bottom" ng-if="!yts.isOneWay">{{yts.flights[0].trip.getArrivalTime()}}</td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </div>\n                <div class="yts-trip--lg__yts-summary">\n                    <table class="yts-summary">\n                        <tbody>\n                            <tr>\n                                <td colspan="3" class="yts-trip__top" ng-if="yts.isOneWay">{{yts.dates[0].month}} {{yts.dates[0].date}}</td>\n                                <td colspan="3" class="yts-trip__top" ng-if="!yts.isOneWay">{{yts.dates[1].month}} {{yts.dates[1].date}}</td>\n                            </tr>\n                            <tr>\n                                <!-- Leg 1 -->\n                                <td class="yts-trip__middle is-dest" ng-if="yts.isOneWay">{{yts.cityPairs[0].dep}}</td>\n                                <td class="yts-trip__middle is-arr" ng-if="yts.isOneWay">-</td>\n                                <td class="yts-trip__middle is-dest" ng-if="yts.isOneWay">{{yts.cityPairs[0].des}}</td>\n                                <!-- Leg 2 -->\n                                <td class="yts-trip__middle is-dest" ng-if="!yts.isOneWay">{{yts.cityPairs[1].dep}}</td>\n                                <td class="yts-trip__middle is-arr" ng-if="!yts.isOneWay">-</td>\n                                <td class="yts-trip__middle is-dest" ng-if="!yts.isOneWay">{{yts.cityPairs[1].des}}</td>\n                            </tr>\n                            <tr>\n                                <!-- Leg 1 -->\n                                <td class="yts-trip__bottom" ng-if="yts.isOneWay">{{yts.flights[0].trip.getDepartureTime()}}</td>\n                                <td class="yts-trip__bottom" ng-if="yts.isOneWay">&nbsp;</td>\n                                <td class="yts-trip__bottom" ng-if="yts.isOneWay">{{yts.flights[0].trip.getArrivalTime()}}</td>\n                                <!-- Leg 2 -->\n                                <td class="yts-trip__bottom" ng-if="!yts.isOneWay">{{yts.flights[1].trip.getDepartureTime()}}</td>\n                                <td class="yts-trip__bottom" ng-if="!yts.isOneWay">&nbsp;</td>\n                                <td class="yts-trip__bottom" ng-if="!yts.isOneWay">{{yts.flights[1].trip.getArrivalTime()}}</td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </div>\n                <div class="yts-trip--lg__yts-travellers">\n                    <table class="yts-travellers">\n                        <tbody>\n                            <tr>\n                                <td class="yts-trip__top">&nbsp;</td>\n                            </tr>\n                            <tr>\n                                <td class="yts-trip__middle">{{yts.travelerSummary}}</td>\n                            </tr>\n                            <tr>\n                                <td class="yts-trip__bottom" ng-if="yts.totalTravelers > 1 && yts.travelerList">{{yts.travelerList}}</td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </div>\n                <div class="yts-trip--lg__yts-status">\n                    <table class="yts-status">\n                        <tbody>\n                            <tr>\n                                <td class="yts-trip__top">&nbsp;</td>\n                            </tr>\n                            <tr>\n                                <td class="yts-trip__middle" ng-class="{\'is-small\': yts.topTier === 2}">{{yts.collapsedTierLabel}}</td>\n                            </tr>\n                            <tr>\n                                <td class="yts-trip__bottom">&nbsp;</td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n\n        <div ng-if="yts.context === \'book\'" class="yts__cta yts__total-price" ng-class="{\'is-points\': yts.activeCurrency === \'POINTS\', \'is-pay-now\': yts.payNow }" tabindex="0" vx-common-ally-click="yts.expandYts()" ng-focus="yts.focusYts()">\n            <div class="yts__cta-inner">\n                <div ng-if="!yts.payNow || yts.alt">\n                    <span>{{yts.total}}</span>\n                    <span class="is-taxes" ng-if="yts.activeCurrency === \'POINTS\' && yts.totalTaxes">+ ${{(yts.totalTaxes + yts.extras) | number:\'2\'}}</span>\n                </div>\n                <div ng-if="yts.payNow && !yts.alt" ng-click="yts.goToPayment(); $event.stopPropagation();" class="yts__cta-btn">\n                    <h4> Pay Now </h4>\n                    <span>{{yts.total}}</span>\n                </div>\n            </div>\n        </div>\n\n        <div ng-if="yts.context === \'change\'" class="yts__cta is-change" ng-click="yts.expandYts()">\n            <table>\n                <tr class="only-on-large">\n                    <td class="yts-trip__bottom">Total</td>\n                </tr>\n                <tr>\n                    <td>{{yts.total}}</td>\n                </tr>\n                <tr class="only-on-large">\n                    <td class="yts-trip__bottom">Original fare: {{yts.base}}</td>\n                </tr>\n            </table>\n        </div>\n    </div>\n    </div>\n    <div class="yts cf" bindonce ng-switch-when="true">\n        <!-- EXPANDED YTS -->\n        <div class="yts-header cf">\n            <h1 class="yts__logo">\n                <a bo-href="path.home" class="icon-vx-simplified-color" data-vx-common-prevent-default ng-click="yts.resetFlow()">Virgin America</a>\n            </h1>\n        </div>\n        <div class="yts-expanded cf" ng-style="yts.navStyle()">\n            <div class="yts-expanded-section">\n                <section class="yts-expanded__yts-module yts-expanded__yts-module--one-way" bo-if="yts.isOneWay">\n                    <span class="yts-module yts-module--one-way">\n                        <div class="yts-module__yts-body">\n                            <header class="yts-module__header cf">\n                                <h1>Trip Type</h1>\n                                <span bo-if="yts.dates[0]"></span>\n                            </header>\n                            <div class="yts-body__heading is-upper">One Way</div>\n                        </div>\n                    </span>\n                </section>\n                <section class="yts-expanded__yts-module yts-expanded__yts-module--departure" ng-class="{\'is-one-way\': yts.isOneWay}">\n                    <!-- Departure Cities -->\n                    <div vx-common-yts-module yts="yts"\n                      header="yts.flightLabels.departureLabel + \' Cities\'"\n                      change-enable="yts.isBooking() || yts.isNewChange()"\n                      change-target="\'cities\'">\n                        <div class="yts-module__yts-body">\n                            <div class="yts-body__heading is-upper">{{yts.cityPairs[0].dep}} <span class="icon-arrow-right-short-grey">-</span> {{yts.cityPairs[0].des}}</div>\n                        </div>\n                    </div>\n                    <!-- Departure Date -->\n                    <div vx-common-yts-module yts="yts"\n                      header="yts.flightLabels.departureLabel + \' Date\'"\n                      change-enable="yts.isBooking() || yts.isNewChange()"\n                      change-target="\'calendar\'"\n                      ng-if="yts.dates[0]">\n                        <div class="yts-module__yts-body">\n                            <div class="yts-body__heading is-upper">{{yts.dates[0].month}} {{yts.dates[0].date}}</div>\n                            <div class="yts-body__sub--heading">{{yts.dates[0].year}}, {{yts.dates[0].dayOfWeek}}</div>\n                        </div>\n                    </div>\n                    <!-- Departure Flight -->\n                    <div vx-common-yts-module yts="yts"\n                      header="yts.flightLabels.departureLabel + \' Flight\'"\n                      change-enable="yts.isBooking() || yts.isNewChange()"\n                      change-target="\'fares\'"\n                      ng-if="yts.flights[0]">\n                        <div class="yts-module__yts-body--main">\n                            <div class="yts-body__heading">{{yts.flights[0].legs[0].getDepartureTime()}}</div>\n                            <div class="yts-body__sub--heading">\n                                Flight {{yts.flights[0].trip.flightNum}}, {{yts.flights[0].flightType}}\n                                <span bo-if="yts.flights[0].legs[1]">, {{yts.flights[0].legs[0].departure}} to {{yts.flights[0].legs[0].arrival}}</span>\n                            </div>\n                        </div>\n                        <div class="yts-module__yts-body--supplemental" bo-if="yts.flights[0]">\n                            <div bo-if="!yts.flights[0].legs[1]">\n                                <div class="yts-body__sub">\n                                    Arrives {{yts.flights[0].legs[0].getArrivalTime()}}, {{yts.flights[0].legs[0].getDuration()}}\n                                    <span bo-if="yts.flights[0].legs[0].isRedeye">, +24h</span>\n                                </div>\n                            </div>\n                            <div bo-if="yts.flights[0].legs[1]">\n                                <div class="yts-body__sub">Flight {{yts.flights[0].legs[1].flightNum}}, {{yts.flights[0].legs[1].departure}} to {{yts.flights[0].legs[1].arrival}}</div>\n                                <div class="yts-body__sub">\n                                    Arrives {{yts.flights[0].legs[1].getArrivalTime()}}\n                                    <span bo-if="yts.flights[0].legs[1].isRedeye">, +24h</span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </section>\n                <section class="yts-expanded__yts-module yts-expanded__yts-module--return" bo-if="!yts.isOneWay">\n                    <!-- Return Cities -->\n                    <div vx-common-yts-module yts="yts"\n                      header="yts.flightLabels.returnLabel + \' Cities\'"\n                      change-enable="yts.isBooking() || yts.isNewChange()"\n                      change-target="\'cities\'">\n                        <div class="yts-module__yts-body">\n                            <div class="yts-body__heading is-upper">{{yts.cityPairs[1].dep}} <span class="icon-arrow-right-short-grey">-</span> {{yts.cityPairs[1].des}}</div>\n                        </div>\n                    </div>\n                    <!-- Return Date -->\n                    <div vx-common-yts-module yts="yts"\n                      header="yts.flightLabels.returnLabel + \' Date\'"\n                      change-enable="yts.isBooking() || yts.isNewChange()"\n                      change-target="\'calendar\'"\n                      ng-if="yts.dates[1]">\n                        <div class="yts-module__yts-body">\n                            <div class="yts-body__heading is-upper">{{yts.dates[1].month}} {{yts.dates[1].date}}</div>\n                            <div class="yts-body__sub--heading">{{yts.dates[1].year}}, {{yts.dates[1].dayOfWeek}}</div>\n                        </div>\n                    </div>\n                    <!-- Return Flight -->\n                    <div vx-common-yts-module yts="yts"\n                      header="yts.flightLabels.returnLabel + \' Flight\'"\n                      change-enable="yts.isBooking() || yts.isNewChange()"\n                      change-target="\'fares-1\'"\n                      ng-if="yts.flights[1]">\n                        <div class="yts-module__yts-body--main">\n                            <div class="yts-body__heading">{{yts.flights[1].legs[0].getDepartureTime()}}</div>\n                            <div class="yts-body__sub--heading">\n                                Flight {{yts.flights[1].trip.flightNum}}, {{yts.flights[1].flightType}}\n                                <span bo-if="yts.flights[1].legs[1]">, {{yts.flights[1].legs[0].departure}} to {{yts.flights[1].legs[0].arrival}}</span>\n                            </div>\n                        </div>\n                        <div class="yts-module__yts-body--supplemental" bo-if="yts.flights[1]">\n                            <div bo-if="!yts.flights[1].legs[1]">\n                                <div class="yts-body__sub">Arrives\n                                    {{yts.flights[1].legs[0].getArrivalTime()}}, {{yts.flights[1].legs[0].getDuration()}}\n                                    <span bo-if="yts.flights[1].legs[1].isRedeye">, arrives next day</span>\n                                </div>\n                            </div>\n                            <div bo-if="yts.flights[1].legs[1]">\n                                <div class="yts-body__sub">Flight {{yts.flights[1].legs[1].flightNum}}, {{yts.flights[1].legs[1].departure}} to {{yts.flights[1].legs[1].arrival}}</div>\n                                <div class="yts-body__sub">\n                                    Arrives {{yts.flights[1].legs[1].getArrivalTime()}}\n                                    <span bo-if="yts.flights[1].legs[1].isRedeye">, arrives next day</span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </section>\n            </div>\n            <div class="yts-expanded-section">\n                <section class="yts-expanded__yts-module yts-expanded__yts-module--guests">\n                    <!-- Guests -->\n                    <div vx-common-yts-module yts="yts"\n                      header="\'Guests\'"\n                      change-enable="yts.isBooking() || yts.isNewChange()"\n                      change-target="\'people-picker\'">\n                        <div class="yts-module__yts-body">\n                            <div class="yts-body__heading">{{yts.travelerSummary}}</div>\n                            <div class="yts-body__sub" ng-if="yts.totalTravelers > 1 && yts.travelerList">{{yts.travelerList}}</div>\n                        </div>\n                    </div>\n                    <!-- Departing Seats -->\n                    <div vx-common-yts-module yts="yts"\n                      header="yts.flightLabels.departingLabel + \' Seats\'"\n                      change-enable="true"\n                      change-target="\'seatSelector\'"\n                      ng-if="yts.travelers">\n                        <div class="yts-module__yts-body--main" ng-repeat="traveler in yts.travelers">\n                            <div class="yts-body__title" bo-if="traveler.seatsDescriptions.length === 0">NA Seat</div>\n                            <div class="yts-body__title" bo-if="traveler.travelerType !== \'INFANT\'">{{traveler.seatsDescriptions[0]}}</div>\n                            <div class="yts-body__title" bo-if="yts.flights[0].legs.length > 1 && traveler.travelerType !== \'INFANT\'">{{traveler.seatsDescriptions[1]}}</div>\n                            <div class="yts-body__title" bo-if="traveler.travelerType === \'INFANT\'">Lap Infant</div>\n                            <div class="yts-body__sub">{{traveler.name}}</div>\n                        </div>\n                    </div>\n                    <!-- Traveler info -->\n                    <div vx-common-yts-module yts="yts"\n                      header="\'Traveler Info\'"\n                      change-enable="yts.isBooking()"\n                      change-target="\'travelerInfo\'"\n                      ng-if="yts.travelers[0].firstName.length">\n                        <div class="yts-module__yts-body--main" ng-repeat="traveler in yts.travelers">\n                            <div class="yts-body__title">{{traveler.name}}</div>\n                        </div>\n                    </div>\n                </section>\n                <section class="yts-expanded__yts-module yts-expanded__yts-module--class">\n                    <!-- Class -->\n                    <div vx-common-yts-module yts="yts"\n                      header="\'Class\'"\n                      change-enable="yts.isBooking() || yts.isNewChange()"\n                      change-target="\'fares\'"\n                      ng-if="yts.collapsedTierLabel">\n                        <div class="yts-module__yts-body">\n                            <div class="yts-body__heading" ng-class="{\'is-mcs\': yts.collapsedTierLabel === \'Main Cabin Select\'}">{{yts.collapsedTierLabel}}</div>\n                            <div class="yts-body__sub--heading">{{yts.tierIsRefundable ? \'Refundable\' : \'\'}}</div>\n                        </div>\n                    </div>\n                    <!-- Returning Seats -->\n                    <div vx-common-yts-module yts="yts"\n                      header="yts.flightLabels.returnLabel + \' Seats\'"\n                      change-enable="true"\n                      change-target="\'seat-selector-1\'"\n                      ng-if="!yts.isOneWay && (yts.travelers[0].seatsDescriptions[1] || yts.travelers[0].seatsDescriptions[2] || yts.travelers[0].seatsDescriptions[3])">\n                        <div class="yts-module__yts-body--main" ng-repeat="traveler in yts.travelers">\n                            <div class="yts-body__title" bo-if="yts.flights[0].legs.length === 1 && traveler.travelerType !== \'INFANT\'">{{traveler.seatsDescriptions[1]}}</div>\n                            <div class="yts-body__title" bo-if="((yts.flights[0].legs.length === 1 && yts.flights[1].legs.length > 1) || yts.flights[0].legs.length > 1) && traveler.travelerType !== \'INFANT\'">{{traveler.seatsDescriptions[2]}}</div>\n                            <div class="yts-body__title" bo-if="yts.flights[0].legs.length > 1 && yts.flights[1].legs.length > 1 && traveler.travelerType !== \'INFANT\'">{{traveler.seatsDescriptions[3]}}</div>\n                            <div class="yts-body__title" bo-if="traveler.travelerType === \'INFANT\'">Lap Infant</div>\n                            <div class="yts-body__sub">{{traveler.name}}</div>\n                        </div>\n                    </div>\n                    <!-- Extras -->\n                    <div vx-common-yts-module yts="yts"\n                      header="\'Extras\'"\n                      change-enable="yts.isBooking()  || yts.isNewChange() || yts.isChangeExtra()"\n                      change-target="\'anc-selector\'"\n                      ng-if="yts.ancillaries[0]">\n                        <div class="yts-module__yts-body--main" ng-repeat="ancillary in yts.ancillaries">\n                            <div class="yts-body__title">{{ancillary.ancillary.title}}</div>\n                            <div ng-repeat="pax in ancillary.paxList" class="yts-body__sub">{{pax.pax.getFullName()}} <span bo-if="pax.quantity">x{{pax.quantity}}</span></div>\n                        </div>\n                    </div>\n                </section>\n            </div>\n            <section class="yts-expanded__yts-module yts-expanded__yts-module--summary cf">\n                <div class="yts-summary-section">\n                    <span class="yts-module">\n                        <header class="yts-module__header yts-module__header--summary cf">\n                            <h1>Balance</h1>\n                        </header>\n                        <!-- Balance for booking -->\n                        <div class="yts-module__yts-body--fare is-first" bo-if="yts.context === \'book\'">\n                            <ul class="yts-fare-list">\n                                <li bo-if="yts.base">\n                                  Fare (x{{yts.payingTravelers}})\n                                  <span class="yts-fare-list__price" bo-text="yts.base"></span>\n                                </li>\n                                <li bo-if="yts.extras">\n                                  Extras\n                                  <span class="yts-fare-list__price">${{yts.extras|number:2}}</span>\n                                </li>\n                                <li ng-if="yts.totalTaxes" vx-common-ally-click="yts.showTaxesAndFeesModal()" class="taxes-and-fees-label">\n                                  Taxes &amp; Fees\n                                  <span class="yts-fare-list__price">${{yts.totalTaxes|number:2}}</span>\n                                </li>\n                                <li bo-if="yts.totalUpgradeCosts">\n                                  Express upgrade (x{{yts.paidExpressUpgrades}})\n                                  <span class="yts-fare-list__price">${{yts.totalUpgradeCosts|number:2}}</span>\n                                </li>\n                                <li ng-if="yts.petsAmount">\n                                  Furry Friend\n                                  <span bo-if="yts.petsAmount > 1">(x{{yts.petsAmount}})</span>\n                                  <span class="yts-fare-list__price">${{yts.petsValue|number:2}}</span>\n                                </li>\n                            </ul>\n                            <a href="#" data-vx-common-prevent-default ng-click="yts.showFareRules()">Fare Rules</a>\n                        </div>\n                        <!-- Balance for a new change -->\n                        <div class="yts-module__yts-body--fare" bo-if="yts.context === \'change\' && yts.typeOfChange === \'NEW\'">\n                            <ul class="yts-fare-list">\n                                <li bo-if="yts.base">Original Fare <span>-{{yts.base}}</span></li>\n                                <li bo-if="yts.newFee">New Flight <span bo-text="yts.newFee"></span></li>\n                                <li bo-show="yts.extrasRefund">Original Extras <span bo-text="yts.extrasRefund"></span>*</li>\n                                <li bo-show="yts.extras">New Extras <span bo-text="yts.extras"></span></li>\n                                <li bo-if="yts.changeFee">Change fee <span bo-text="yts.changeFee"></span></li>\n                            </ul>\n                            <a href="#" data-vx-common-prevent-default ng-click="yts.showFareRules()">Fare Rules</a>\n                        </div>\n                        <!-- Balance for a existing change -->\n                        <div class="yts-module__yts-body--fare" bo-if="yts.context === \'change\' && yts.typeOfChange === \'EXISTING\'">\n                            <ul class="yts-fare-list">\n                                <li bo-show="yts.base">Original Fare <span bo-text="yts.base"></span></li>\n                                <li bo-show="yts.extrasRefund">Original Extras <span ng-bind="yts.extrasRefund"></span>*</li>\n                                <li bo-show="yts.extras">New Extras <span bo-text="yts.extras"></span></li>\n                            </ul>\n                            <a href="#" data-vx-common-prevent-default ng-click="yts.showFareRules()">Fare Rules</a>\n                        </div>\n\n                        <div class="yts-module__yts-body--total cf">\n                            <div class="yts-body--total__amt">\n                                <div class="yts-body__heading">{{yts.total}}</div>\n                                <div bo-if="yts.activeCurrency === \'POINTS\' && yts.purchase.data.totalTaxes && yts.context === \'book\'" class="yts-body__heading">+ ${{yts.purchase.data().totalTaxes|number:2}}</div>\n                            </div>\n                            <div class="yts-body--total__btn" bo-hide="yts.breakpoint === \'medium\'">\n                                <a href="#" data-vx-common-prevent-default data-vx-e2e-yts-paynow ng-click="yts.goToPayment();" ng-focus="yts.focusYts()">{{(!yts.alt && yts.totalTaxes === 0 || !yts.totalIsPositive || yts.newFee === yts.base || !yts.payNow) ? \'Continue\' : \'Pay Now\'}}</a>\n                            </div>\n                            <div bo-if="yts.extrasRefund" class="yts-body__sub yts-body__sub--no-ellipsis yts-body__sub--extras">*Not all extras can be fully refunded.</div>\n                            <a bo-if="yts.payNow && yts.alt" class="yts-body__start-over" href="#" ng-click="yts.hardReset()">Start Over</a>\n                        </div>\n                    </span>\n                </div>\n                <div class="yts-summary-section" bo-if="yts.breakpoint === \'medium\'">\n                    <span class="yts-module">\n                        <div class="yts-body--total__btn">\n                            <a href="#" data-vx-common-prevent-default data-vx-e2e-yts-paynow ng-click="yts.goToPayment();" ng-focus="yts.focusYts()">{{(!yts.alt && yts.totalTaxes === 0 || !yts.totalIsPositive || yts.newFee === yts.base || !yts.payNow) ? \'Continue\' : \'Pay Now\'}}</a>\n                        </div>\n                        <div bo-if="yts.extrasRefund" class="yts-body__sub yts-body__sub--no-ellipsis yts-body__sub--extras">*Not all extras can be fully refunded.</div>\n                    </span>\n                </div>\n            </section>\n        </div>\n\n        <a href="#" class="yts__cta yts__cta--expanded" data-yts-collapse data-vx-common-prevent-default ng-click="yts.collapseYts()">Collapse</a>\n    </div>\n</div>');
}]),angular.module("/app/common/templates/modals/add-passport-info.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/add-passport-info.tpl.html",'<div class="form__input--border-spacer select-container no-default-option" ng-show="travelers.length > 0">\n    <select name="choose-traveler" class="select select--block" vx-common-custom-select ng-model="currentTraveler" ng-options="currentTraveler.name for ($index, currentTraveler) in travelers" ng-change="traveler.changeTraveler(currentTraveler)"></select>\n</div>\n\n<div ng-repeat="selectedTraveler in travelers" ng-show="$index === traveler.getCurrentTravelerIndex()">\n    <form method="POST" data-vx-form-handler data-fields="selectedTraveler.fields" data-on-success="traveler.save(formHandler)" data-submit-message="Save" data-submit-error-message="Fill the form to proceed" novalidate class="add-passport-info-form" data="selectedTraveler.data">\n\n        <h2 class="form__title-sub">International Flight Info</h2>\n        <input data-vx-form-input type="text" name="passportNumber" placeholder="Passport #" data-input-class="form__input--tight" data-validate="required,passportLength,alphanumeric" data-input-label="passportNumber" autocorrect="off" data-is-visible="true"/>\n        <div class="form__input--tight">\n            <div data-vx-form-select-array data-select-class="select select--block" data-select-name="issuingCountry" data-select-title="Passport Issuing Country" data-select-options="traveler.countries" data-is-visible="true" data-validate="required"></div>\n            <span class="label dropdown__label"><span class="label__content">Passport Issuing Country</span></span>\n        </div>\n        <div data-vx-form-date placeholder="Passport Expiration Date" data-form-handler="formHandler" data-name="expirationDate" label="Expires:" data-start-date="traveler.expiryDateStart" data-end-date="traveler.expiryDateEnd" data-is-visible="true" class="passport-added-form"></div>\n        <div class="form__input--tight">\n            <div data-vx-form-select-array data-select-class="select select--block" data-select-name="citizenship" data-select-title="Citizenship" data-select-options="traveler.countries" data-is-visible="true" data-validate="required"></div>\n            <span class="label dropdown__label"><span class="label__content">Citizenship</span></span>\n        </div>\n        <div class="form__input--tight">\n            <div id="countryOfResidence" data-vx-form-select-array data-select-class="select select--block" data-select-name="countryOfResidence" data-select-title="Country of residence" data-select-options="traveler.countries" data-is-visible="true" data-validate="required"></div>\n            <span class="label dropdown__label"><span class="label__content">Country of residence</span></span>\n        </div>\n        <input ng-if="selectedTraveler.paxType !== \'INFANT\'" data-vx-form-input type="text" name="emergencyContactName" placeholder="Emergency contact name" data-input-class="form__input--tight" data-validate="required,name" autocorrect="off" data-is-visible="true" />\n        <input ng-if="selectedTraveler.paxType !== \'INFANT\'" data-vx-form-input type="text" name="emergencyNumber" placeholder="Emergency contact phone #" data-input-class="form__input--tight" data-validate="required,phone" autocorrect="off" data-is-visible="true" />\n        <button data-vx-form-submit />\n    </form>\n</div>\n')}]),angular.module("/app/common/templates/modals/cancel-awards-bookings.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/cancel-awards-bookings.tpl.html",'<div class="cancel-awards-bookings-modal">\n    <p class="cancel-awards-bookings-modal__contact">Contact our Virgin America Team at <a href="tel:+18773598474">1-877-359-8474<a/></p>\n\n    <p>Here are some things to know:</p>\n\n    <p>The <a href="https://www.virginamerica.com/cms/elevate-frequent-flyer" target="_self">Elevate program ended</a> on 12/31/17 and Mileage Plan is now the single loyalty program for Virgin America and Alaska Airlines.</p>\n\n    <p>Tickets booked with Elevate points cannot be changed; only cancelled. </p>\n\n    <p>The value of your ticket will be converted from Elevate points to Mileage Plan miles and deposited into your Mileage Plan account. You will receive 1.3 Mileage Plan miles for every 1 Elevate point – a 30% bonus.</p>\n\n    <p>Once the original ticket is cancelled, you can use miles to book Mileage Plan award travel on alaskaair.com</p>\n\n    <p class="cancel-awards-bookings-modal__faq">For more details please visit the <a href="https://www.alaskaair.com/content/travel-info/alaska-virgin/faq" target="_self">FAQ</a></p>\n</div>')}]),angular.module("/app/common/templates/modals/dynamic-fare-rules.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/dynamic-fare-rules.tpl.html",'<div ng-repeat="ruleGroup in rules.eachOAndDAirRules">\n\n    <h2>{{ruleGroup.departure}}</h2>\n\n    <p ng-repeat="rule in ruleGroup.airRulesRes">{{rule.title}} - {{rule.description|capitalize}}</p>\n\n    <br/>\n</div>')}]),angular.module("/app/common/templates/modals/elevate-points-blocked.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/elevate-points-blocked.tpl.html",'<div class="elevate-points-blocked-modal">\n  <h3 class="elevate-points-blocked-modal__headline">\n    Alaska will take you there\n  </h3>\n\n  <p>\n    Alaska Mileage Plan™ is the go-to loyalty program for Virgin America. To book award travel head over to alaskaair.com\n  </p>\n\n  <ul class="elevate-points-blocked-modal__list">\n    <li>\n      <a href="http://alaskaair.com"\n        target="_blank"\n        class="btn btn-primary btn-lg btn-centered btn-alaska">\n        Go to alaskaair.com</a>\n    </li>\n  </ul>\n</div>')}]),angular.module("/app/common/templates/modals/elevate-turn-down.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/elevate-turn-down.tpl.html",'<div class="elevate-turn-down-modal">\n  <img ng-if="elevateTurnDown.image"\n    ng-src="{{elevateTurnDown.image}}"\n    class="elevate-turn-down-modal__image">\n  <h3 class="elevate-turn-down-modal__headline">\n    {{elevateTurnDown.headline}}\n  </h3>\n  <div class="elevate-turn-down-modal__body-copy" ng-bind-html="elevateTurnDown.bodyCopy"></div>\n  <a ng-if="elevateTurnDown.CTACopy && elevateTurnDown.CTALink"\n    ng-href="{{elevateTurnDown.CTALink}}"\n    target="_self"\n    class="btn btn-primary btn-lg btn-centered">\n    {{elevateTurnDown.CTACopy}}\n  </a>\n  <a ng-if="elevateTurnDown.secondaryCTACopy && elevateTurnDown.secondaryCTALink"\n    ng-href="{{elevateTurnDown.secondaryCTALink}}"\n    target="_self"\n    class="link-underline">\n    {{elevateTurnDown.secondaryCTACopy}}\n  </a>\n</div>')}]),angular.module("/app/common/templates/modals/email-itinerary.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/email-itinerary.tpl.html",'<form method="POST" class="add-card" data-vx-form-handler data-fields="emailItinerary.fields" data-submit-message="Send Email" data-on-success="emailItinerary.sendEmails()">\n    <div class="form-instruction">Use commas or line breaks to separate multiple addresses.</div>\n\n    <div data-vx-form-textarea data-input-hidden-label="Email address or list of email addresses" data-input-name="emailList" data-validate="required,emails" />\n\n    <button data-vx-form-submit />\n</form>\n')}]),angular.module("/app/common/templates/modals/extras-warning.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/extras-warning.tpl.html","<div>\n  <p>Just a heads up, if you are making a change to your outbound or return city, there may be an increase in fees.  Please remember, not all extras are refundable.</p>\n\n  <p>To ​make city changes with your extras, please call 1.877.FLY.VIRGIN​.</p>\n</div>")}]),angular.module("/app/common/templates/modals/flight-alerts.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/flight-alerts.tpl.html",'<div>\n    <form\n        data-vx-form-handler\n        method="POST"\n        data="flightAlertModal.data"\n        data-fields="flightAlertModal.fields"\n        data-submit-message="Submit"\n        data-submit-error-message="Complete form to continue"\n        data-on-success="flightAlertModal.submit()">\n\n        <div class="form__input select-container cf">\n            <div data-vx-form-select-array data-select-class="select select--block" data-select-name="notifyMinutesPriorToEvent" data-select-title="Notification moment" data-select-options="flightAlertModal.notificationFrequency" data-validate="required"></div>\n            <span class="label dropdown__label extended"><span class="label__content">Notify me</span></span>\n        </div>\n        <input data-vx-form-input type="text" name="emailAddress" data-input-label="Email Address" data-validate="required,email" autocorrect="off" />\n        <input data-vx-form-input type="text" name="smsNumber" data-input-label="Mobile Phone Number" data-validate="required,phone,phoneLength" autocorrect="off" />\n\n        <button data-vx-form-submit ng-if="!flightAlertModal.responseData.emsId" data-alt-classes="btn-primary" />\n\n        <div class="flight-alerts-response animate-view-opacity"\n             ng-if="flightAlertModal.responseData.emsId">\n            <p class="is-generic">\n              <span><strong>Subscription PIN:</strong> <span ng-bind="flightAlertModal.responseData.emsId"/></span>\n              <small>Please write down this PIN in case you\'d like to cancel this flight alert later.</small>\n            </p>\n\n            <div class="flight-status__links flight-status__links--compact">\n                <ul class="cf">\n                    <li><a href="/get-flight-alerts/unsubscribe" class="link-underline" ng-click="flightAlertModal.close()">Unsubscribe from flight alerts</a></li>\n                    <li><a href="#" class="link-underline" data-vx-common-prevent-default ng-click="core.openFlightAlertRuleModal()">Read the rules for flight alerts</a></li>\n                </ul>\n            </div>\n    </form>\n</div>')}]),angular.module("/app/common/templates/modals/footer.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/footer.tpl.html",'<ul bindonce class="modal-links" ng-repeat="linkGroup in footer.links">\n    <li class="modal-links__item" ng-repeat="link in linkGroup.group">\n        <a bo-href="link.url" target="_self" bo-text="link.name"  vx-common-link></a>\n    </li>\n</ul>\n')}]),angular.module("/app/common/templates/modals/forgot-password.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/forgot-password.tpl.html",'<div ng-controller="ForgotPasswordModalCtrl" ng-switch on="forgot.email === undefined">\n  <div ng-switch-when="true">\n  <p>To get your new password, enter your email address below. We will send you a link to create a new password.</p>\n  <form method="POST" class="log-in-form__form"\n        data-vx-form-handler\n        data-fields="forgot.fields"\n        data-submit-message="Submit"\n        data-on-success="forgot.submit()"\n    >\n    <input data-vx-form-input data-validate="required,email" name="email" data-input-label="Email address" data-readable-label="Enter Email Address" data-override-label-prefix="true" />\n    <button data-vx-form-submit data-alt-classes="btn-primary" />\n  </form>\n  </div>\n  <div ng-switch-when="false">\n    <p>We\'ve sent an email to <strong>{{forgot.email}}</strong>, with instructions on how to reset your password. For your security, click on the link in the email within 5 days to reset it.</p>\n  </div>\n</div>')}]),angular.module("/app/common/templates/modals/frequent-flier.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/frequent-flier.tpl.html",'<p bindonce class="choose-passenger__name">\n  <span class="choose-passenger__number">Traveler:</span><br>\n  <span bo-text="traveler.fullName|capitalize"></span>\n</p>\n\n<form method="POST" class="frequent-flier" data-vx-form-handler data-fields="frequentFlier.fields" data-submit-message="Save" data-submit-error-message="Fill the form to proceed" data-on-success="frequentFlier.save()" novalidate>\n    <div class="form__input">\n        <div data-vx-form-select-array data-select-class="select select--block" data-select-name="ffname" data-select-title="Frequent Flyer Program" data-select-options="programs" data-validate="required" data-default-select="{{defaultProgramIndex}}"></div>\n        <span class="label dropdown__label extended"><span class="label__content">Frequent Flyer Program</span></span>\n    </div>\n\n    <input data-vx-form-input type="text" name="ffn" maxlength="12" placeholder="Frequent Flyer #" input-label="Frequent Flyer #" data-validate="required" autocorrect="off" pattern="\\d*" />\n\n    <div ng-switch="frequentFlier.ninjaMode">\n        <button data-vx-form-submit data-alt-classes="btn-check-in-primary" ng-switch-when="true" />\n        <button data-vx-form-submit ng-switch-default />\n    </div>\n</form>')}]),angular.module("/app/common/templates/modals/invalid-seven-day-selection.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/invalid-seven-day-selection.tpl.html",'<div class="seven-day-selection-modal" bindonce>\n\t<p class="seven-day-selection-modal__copy" bo-if="isBefore">You\'ve selected a return date that\'s prior to your original departure. Do you want to choose a new departure date?</p>\n\t<p class="seven-day-selection-modal__copy" bo-if="!isBefore">Your originally selected return date is prior to your newly selected departure date. Do you want to change both your dates?</p>\n\t<div class="seven-day-selection-modal__link-container">\n\t\t<a href="#" class="btn btn-centered btn-primary btn-lg" ng-click="acceptOtherDays()">Yes, Show Me Other Days</a>\n\t\t<a href="#" class="link-underline seven-day-selection-modal__no-link" ng-click="nevermind()"> No, Nevermind </a>\n\t</div>\n</div>')}]),angular.module("/app/common/templates/modals/join-alaska-mileage-plan.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/join-alaska-mileage-plan.tpl.html",'<div class="join-alaska-mileage-plan-modal">\n  <img class="join-alaska-mileage-plan-modal__logo" alt="Alaska Mileage Plan™"\n    ng-src="{{joinAlaskaMileagePlan.ninjaMode ? \'/images/alaska-mileage-small-white-logo.png\' : \'/images/alaska-mileage-small-logo.png\'}}">\n  <h3 class="join-alaska-mileage-plan-modal__header">\n    Say hello to Mileage Plan™\n  </h3>\n  <p class="join-alaska-mileage-plan-modal__description">\n    Alaska Mileage Plan™ is now the go-to loyalty program for both Virgin America and Alaska Airlines. Join Mileage Plan today, and earn a mile for every mile you fly on Alaska and Virgin America, with award travel starting at just 5,000 miles plus taxes and fees.\n  </p>\n  <a ng-href="{{\'https://www.alaskaair.com/account/join-mileage-plan?cid=\' + linkCid}}"\n    target="_blank"\n    class="btn btn-lg btn-centered"\n    ng-class="{\'btn-primary btn-alaska\': !joinAlaskaMileagePlan.ninjaMode, \'btn-alt-secondary\': joinAlaskaMileagePlan.ninjaMode}">\n    Join Now\n  </a>\n</div>')}]),angular.module("/app/common/templates/modals/known-traveler.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/known-traveler.tpl.html",'<p bindonce class="choose-passenger__name" ng-show="travelers.length == 1">\n  <span class="choose-passenger__number">Traveler:</span><br>\n  <span bo-text="currentTraveler.fullName|capitalize"></span>\n</p>\n\n<div class="form__input--border-spacer select-container no-default-option" ng-show="travelers.length > 1">\n    <select title="Select Traveler" name="choose-traveler" class="select select--block" vx-common-custom-select ng-model="currentTraveler" ng-options="currentTraveler.name for ($index, currentTraveler) in travelers" ng-change="knownTraveler.changeTraveler(currentTraveler)">\n      <option value="">Select Traveler</option>\n    </select>\n</div>\n\n<div ng-repeat="traveler in travelers" ng-show="$index === knownTraveler.getCurrentTravelerIndex()">\n    <form method="POST" class="known-traveler" data-vx-form-handler data-fields="traveler.fields" data-submit-message="Save" data-submit-error-message="Fill the form to proceed" data-on-success="knownTraveler.save(formHandler)" novalidate data="traveler.data">\n        <input data-vx-form-input type="text" name="ktn" placeholder="Known Traveler #" data-validate="required,alphanumeric" autocorrect="off" maxlength="25" />\n\n        <div ng-switch="knownTraveler.ninjaMode">\n            <button data-vx-form-submit data-alt-classes="btn-check-in-primary" ng-switch-when="true" />\n            <button data-vx-form-submit ng-switch-default />\n        </div>\n    </form>\n</div>')}]),angular.module("/app/common/templates/modals/locate-pnr.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/locate-pnr.tpl.html",'<div data-vx-pnr-login-form data-form-context="{{context}}" data-is-modal="true"></div>')}]),angular.module("/app/common/templates/modals/print-receipt.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/print-receipt.tpl.html",'<div>\n  <div>\n  <form method="POST" class="log-in-form__form"\n        data-vx-form-handler\n        data-fields="printReceipt.fields"\n        data-submit-message="Submit"\n        data-on-success="printReceipt.submit()"\n    >\n    <input data-vx-form-input data-validate="required" name="lastName" data-input-label="Last Name" data-readable-label="Enter Last Name" data-override-label-prefix="true" />\n    <input data-vx-form-input data-validate="required,pnrOrTicketNum" name="confirmationCode" maxlength="6" data-input-label="Confirmation Code" data-readable-label="Enter Confirmation Code" data-override-label-prefix="true" />\n    <button data-vx-form-submit data-alt-classes="btn-primary" />\n  </form>\n  </div>\n</div>')}]),angular.module("/app/common/templates/modals/privacy-policy.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/privacy-policy.tpl.html",'<small class="large-align-right">Effective June 1, 2007</small>\n\n<h3>Goal</h3>\n\n<p>Virgin America’s primary goal in collecting information is to use such information to assist us in serving you. We also request information in order to provide and improve our web site, services, features and content, and to administer our relationship with you (together, the “Service”)</p>\n\n<h3>General</h3>\n\n<p>This Privacy Policy is provided to inform you of our policies and procedures regarding the collection, use and disclosure of your personal information, whether that information comes from www.virginamerica.com (our “Site”), our in-flight entertainment (“IFE”) system, purchases you make, travel you book, your registration for our loyalty program, your participation in sweepstakes or promotional activities, or your other communications to us.</p>\n<p>We update this Privacy Policy from time to time, but we will continue to treat information according to the terms of the policy that was in place when the information was collected. We will notify you of any material changes to this policy by posting a new Privacy Policy on our Site and we will provide you with an opportunity to opt out of any new terms.</p>\n\n<p>As used in this policy, the terms “using” and “processing” information include using cookies on a computer, subjecting the information to statistical or other analysis, and using or touching information in any way, including but not limited to collecting, storing, evaluating, modifying, deleting, using, combining, disclosing, and transferring information within the United States or internationally.</p>\n\n<h3>Personally Identifiable Information.</h3>\n\n<p>When you use the Site or the IFE system or when you book a ticket or make a purchase directly through Virgin America, when you participate in our sweepstakes or other promotional activities, and when you register or otherwise communicate with us, we may receive personally identifiable information about you. This refers to information about you that when on its own or in combination with other identifiers can be used to contact or identify you (“Personal Information”). Personal Information includes, without limitation, your name, home or other physical address, an e-mail address, phone number or other contact information, your travel details, credit card number, and billing information. We also collect information that you provide that is not itself Personal Information (including, for example and without limitation, your zip code or individual preferences) (“Non-Identifying Information”).</p>\n\n<p>We will use your Personal Information (in some cases, in conjunction with your Non-Identifying Information) to provide the Service, complete your transactions, and administer your inquiries.</p>\n\n<p>We will also use your Personal Information (in some cases, in conjunction with your Non-Identifying Information) to contact you with Virgin America newsletters, marketing and promotional materials, e-mails, updates, and other information that may be of interest to you. All subscribers will be given the opportunity to opt out of receiving any such communications from us. If you decide at any time that you no longer wish to receive such communications from us, please follow the unsubscribe instructions provided in any of the communications or update your “user preferences” information. (See “Changing or Deleting Information” below.)</p>\n\n<p>Certain Non-Identifying Information will be considered a part of your Personal Information if it is combined with other identifiers (for example, combining your zip code with your street address) in a way that identifies you. But the same pieces of information are considered Non-Identifying Information when they are taken alone or combined only with other Non-Identifying Information. We may combine your Personal Information with Non-Identifying Information and aggregate it with information collected from other users to attempt to provide you with a better experience, to improve the quality and value of the Service, and to analyze and understand how our Site and Service are used. We may also use it combined but not aggregated to serve you specifically, for instance to deliver a meal to you according to your dietary requests.</p>\n\n<p>Log Data. When you visit the Site, whether as a subscriber or a non-registered user just browsing (either of these, a “Virgin America User”), our servers automatically record information that your browser sends whenever you visit a website (“Log Data”). This log data may include information such as your computer’s Internet Protocol (IP) address, browser type or the website from which you are visiting, pages of our site that you visit, the time spent on those pages, information you search for, access times and dates, and other statistics. We may use this information to monitor and analyze use of the Site and the Service and for the Site’s technical administration, to increase the Site’s functionality and user-friendliness, and to better tailor the Site to our visitors’ needs. For example, some of this information is collected so that when you visit the Site again, it will recognize you, and serve advertisements and other information appropriate to you and your interests. We also use this information to verify that visitors to the Site meet the criteria required to process their requests.</p>\n\n<h3>Cookies</h3>\n\n<p>Like many websites, we will use “cookies” to collect information. A cookie is a small data file that we transfer to your computer’s hard disk for record-keeping purposes. We use cookies for two purposes. First, we will utilize persistent cookies to save your registration ID and login password for future logins to the Site. Second, we will utilize session ID cookies to enable certain features of the Site, to better understand how you interact with the Site, and to monitor aggregate usage by Virgin America Users and web traffic routing on the Site. Unlike persistent cookies, session cookies are deleted from your computer when you disconnect from the Site and Service and close your browser. Third party advertisers on the Site may also place or read cookies on your browser. You can instruct your browser,by changing its options, to stop accepting cookies or to prompt you before accepting a cookie from the websites you visit. If you do not accept cookies, however, you may not be able to use all portions of the Site or all functionality of the Service.</p>\n\n<h3>E-mailing</h3>\n\n<p>As part of the Service, we intend to create features to enable you to send e-mails via the Site, the IFE system or our other intermediaries. The e-mail addresses that you provide will be used only for the purpose of sending your e-mails to the recipients. Virgin America will not otherwise e-mail those recipients, unless they have independently opted to receive e-mails from us.</p>\n\n<p>If you would like to continue to receive Virgin America/Elevate marketing and promotion emails and avoid having them be classified as spam, please add <a href="mailto:info@fly.virginamerica.com">info@fly.virginamerica.com</a> to your address book or safe list now.</p>\n\n<h3>Unsubscribe</h3>\n\n<p>We realize you are a VIP and your email inbox might be quite full. If you would like to stop receiving our marketing and promotion emails, click here to update your preferences and simply enter and confirm your email address or you can send an email to <a href="mailto:unsubscribe@virginamerica.com">unsubscribe@virginamerica.com</a>, or contact us via post at Attn: Virgin America Guest Relations, 555 Airport Blvd, Suite 500, Burlingame, CA 94010. We will promptly update your contact preferences. However, please note that any request to update your personal information may take up to 10 days for your electronic request and 6-8 weeks for your postal mail request.</p>\n\n<p>Regardless of your preferences for marketing and promotion emails, when you book a flight on virginamerica.com, you will still receive email notifications of your flight confirmation, schedule changes or other status updates. Please do not reply to the info@fly.virginamerica.com email address because it is an unmonitored alias. If you have web site-related questions, suggestions, or comments, please e-mail us at <a href="mailto:webteam@virginamerica.com">webteam@virginamerica.com</a>.</p>\n\n<h3>Phishing</h3>\n\n<p>Identity theft and the practice currently known as “phishing” are of great concern to Virgin America. Accordingly, safeguarding information to help protect you from identity theft is a top priority. We do not and will not, at any time, request your credit card information, your account ID, login password, or national identification numbers in a non-secure or unsolicited e-mail or telephone communication. For more information about phishing, visit the Federal Trade Commission’s website.</p>\n\n<h3>Information Sharing and Disclosure</h3>\n\n<p>Subscribers. When you register through the Site, contribute to the Site or IFE system, or communicate with other users, Virgin America Users will see your “Screen Name” and sometimes the month and year you first registered with Virgin America (“Required Subscriber Identifiers”). You can choose what other Personal Information you provide as part of your profile (“Other Subscriber Information”), and in some cases you can choose whether to share that information publicly on the Site by making selections via the “user preferences” section of your profile webpage. Providing Other Subscriber Information is voluntary and should correlate with the degree of interaction you want to have with Virgin America Users. We recommend that you guard your anonymity and sensitive information and that you not use your real name as your “Screen Name,” since that would allow others to identify you.</p>\n\n<p>Aggregate Information and Non-Identifying Information. We may share aggregated information that does not include Personal Information and we may otherwise disclose Non-Identifying Information and Log Data with third parties for industry analysis, demographic profiling and other purposes. Any aggregated information shared in these contexts will not contain your Personal Information.</p>\n\n<p>Service Providers. We may employ third party companies and individuals to facilitate our Service, to provide the Service on our behalf, to perform Site-related services (e.g., without limitation, maintenance services, database management, Web analytics, and improvement of the Site’s features), or to assist us in analyzing the use of our Site and Service. These third parties have access to your Personal Information only to perform these tasks on our behalf and are contractually obligated not to disclose or use it for any other purpose.</p>\n\n<p>Compliance with Laws and Law Enforcement. Virgin America cooperates with government and law enforcement officials and private parties to enforce and comply with the law. We will disclose your Personal Information to government or law enforcement officials or private parties as we, in our sole discretion, believe necessary or appropriate to respond to claims and legal process (including but not limited to subpoenas and notice of class certification), to protect the property and rights of Virgin America or a third party, to protect the safety of the public or any person, or to prevent or stop any illegal, unethical, or legally actionable activity.</p>\n\n<p>Business Transfers. Virgin America may sell, transfer, or otherwise share some or all of its assets, including your Personal Information, in connection with a merger, reorganization, or sale of assets, or in the event of bankruptcy. If the new entity wishes to make additional uses of your information different from those described in this Privacy Policy you will have the opportunity to decline such use at that time.</p>\n\n<h3>Changing or Deleting Your Information</h3>\n\n<p>All subscribers may review, update, correct or delete the Personal Information in their registration profile by logging onto your account. If you completely delete all such information, then your account may become deactivated. If you would like us to delete your record in our system, please contact us and we will attempt to accommodate your request if we do not have any legal obligation to retain the record. See below for privacy contact information.</p>\n\n<h3>Security &amp; International Transfer</h3>\n\n<p>Virgin America is very concerned with safeguarding your information. We employ administrative, physical, procedural, and technological measures designed to protect your information from unauthorized access. This includes utilizing Secure Sockets Layer (SSL) software, which encrypts the information you input, and storing your information behind a firewall designed to block access from outside our network. Your information may be transferred to and maintained on computers located outside of your state, province, country or other governmental jurisdiction where the privacy laws may not be as protective as those in your jurisdiction. If you are located outside the United States and choose to provide information to us, Virgin America transfers Personal Information to the United States and processes it there. Your consent to this policy followed by your submission of Personal Information represents your agreement to that transfer.</p>\n\n<p>We will make any legally required disclosures of any breach of the security, confidentiality, or integrity of your unencrypted electronically stored Personal Data (as defined in applicable state statutes on security breach notification) to you via e-mail or conspicuous posting on this Site in the most expedient time possible and without unreasonable delay, insofar as consistent with (i) the legitimate needs of law enforcement or (ii) any measures necessary to determine the scope of the breach and restore the reasonable integrity of the data system.</p>\n\n<h3>Links to Other Sites</h3>\n\n<p>Our Site contains links to other websites. If you choose to visit an advertiser by clicking on a banner ad or other type of advertisement, or click on another third-party link, you will be directed to that third party’s website. The fact that we link to a website or present a banner ad or other type of advertisement is not an endorsement, authorization or representation of our affiliation with that third party, nor is it an endorsement of their privacy or information security policies or practices. We do not exercise control over third party websites. These other websites may place their own cookies or other files on your computer, collect data or solicit personal information from you. Other sites follow different rules regarding the use or disclosure of the personal information you submit to them. We encourage you to read the privacy policies or statements of the other websites you visit.</p>\n\n<h3>Our Policy Toward Children</h3>\n\n<p>Our Site is not directed to children under 18. We will not knowingly collect personally identifiable information from children under the age of 13. If a parent or guardian becomes aware that his or her child has provided us with Personal Information without their consent, he or she should contact us at <a href="mailto:privacy@virginamerica.com">privacy@virginamerica.com</a>. If we become aware that a child under 13 has provided us with Personal Information, we will delete such information from our files.</p>\n\n<h3>Contacting Us</h3>\n\n<p>If you have any questions about this Privacy Policy, please contact us at <a href="mailto:privacy@virginamerica.com">privacy@virginamerica.com</a>.</p>');
}]),angular.module("/app/common/templates/modals/save-to-calendar.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/save-to-calendar.tpl.html",'<div class="form-instruction">Add your trip to your personal calendar.</div>\n\n<ul class="buttons-stacked">\n    <li>\n        <a href="#" class="btn btn-secondary btn-normal btn-block" data-vx-common-prevent-default ng-click="saveToCalendar.saveToIcal()">Save to ICal / Gmail</a>\n    </li>\n    <li>\n        <a href="#" class="btn btn-secondary btn-normal btn-block" data-vx-common-prevent-default ng-click="saveToCalendar.saveToOutlook()">Save to Outlook</a>\n    </li>\n</ul>')}]),angular.module("/app/common/templates/modals/traveler-info-avatar-picker.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/traveler-info-avatar-picker.tpl.html",'<div class="traveler-info-form__avatar-picker-container traveler-info-form__avatar-picker-container--modal">\n  <div>\n    <ul class="avatar-list cf">\n      <li ng-repeat="avatar in avatars track by $index">\n        <span class="traveler-info-form__avatar-option icon-avatar-{{avatar}}-sm"\n              ng-class="{\n                \'traveler-info-form__avatar-option--is-current\':\n                traveler.avatar === avatar\n              }"\n              data-vx-common-prevent-default\n              ng-click="avatarPicker.selectAvatar(avatar, false, true)"></span>\n        </span>\n      </li>\n    </ul>\n  </div>\n</div>\n\n')}]),angular.module("/app/common/templates/modals/tsa-notice.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/tsa-notice.tpl.html",'<p>The Transportation Security Administration (TSA) requires you to provide your full name, date of birth, and gender for the purpose of watch list screening, under the authority of 49 U.S.C. section 114, the Intelligence Reform and Terrorism Prevention Act of 2004 and 49 C.F.R parts 1540 and 1560. You may also provide your Redress Number, if available. Failure to provide your full name, date of birth, and gender may result in denial of transport or denial of authority to enter the boarding area. TSA may share information you provide with law enforcement or intelligence agencies or others under its published system of records notice. For more on TSA privacy policies, or to review the system of records notice and the privacy impact assessment, please see the <a href="http://www.tsa.gov" target="_blank" vx-common-link>TSA website</a>.</p>\n')}]),angular.module("/app/common/templates/modals/wrong-email.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/modals/wrong-email.tpl.html",'<form method="POST" data-vx-form-handler data-fields="wrongEmail.fields" data-submit-message="Send Email" data-submit-error-message="Fill Email To Proceed" data-on-success="wrongEmail.sendEmail()">\n    <div class="form-instruction">If <strong class="is-lowercase">{{wrongEmail.currentEmail}}</strong> is not correct, please fix it below to receive the details of your purchase in your email.</div>\n\n    <input data-vx-form-input data-validate="required,email" name="email" data-input-label="Email address" />\n\n    <button data-vx-form-submit />\n</form>')}]),angular.module("/app/common/templates/site-map.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/common/templates/site-map.tpl.html",'<div bindonce class="site-map cf" ng-controller="SiteMapCtrl">\n    <div class="site-map-col">\n        <section ng-repeat="siteMapSection in siteMap | limitTo: 6">\n            <header class="site-map-list-header">\n                <h1><a bo-href="siteMapSection.path" bo-text="siteMapSection.name" target="_self" vx-common-link></a></h1>\n            </header>\n            <ul class="site-map-list" bo-show="siteMapSection.links">\n                <li ng-repeat="mainLinks in siteMapSection.links">\n                    <a bo-href="mainLinks.path" bo-text="mainLinks.name" target="_self" vx-common-link></a>\n                    <ul class="site-map-list is-indented" bo-show="mainLinks.links">\n                        <li ng-repeat="subLinks in mainLinks.links">\n                            <a bo-href="subLinks.path" bo-text="subLinks.name" target="_self" vx-common-link></a>\n                        </li>\n                    </ul>\n                </li>\n            </ul>\n        </section>\n    </div>\n    <div class="site-map-col">\n        <section ng-repeat="siteMapSection in siteMap | limitTo: 8 | limitTo: -2">\n            <header class="site-map-list-header">\n                <h1><a bo-href="siteMapSection.path" bo-text="siteMapSection.name" target="_self" vx-common-link></a></h1>\n            </header>\n            <ul class="site-map-list" bo-show="siteMapSection.links">\n                <li ng-repeat="mainLinks in siteMapSection.links">\n                    <a bo-href="mainLinks.path" bo-text="mainLinks.name" target="_self" vx-common-link></a>\n                    <ul class="site-map-list is-indented" bo-show="mainLinks.links">\n                        <li ng-repeat="subLinks in mainLinks.links">\n                            <a bo-href="subLinks.path" bo-text="subLinks.name" target="_self" vx-common-link></a>\n                        </li>\n                    </ul>\n                </li>\n            </ul>\n        </section>\n    </div>\n    <div class="site-map-col">\n        <section ng-repeat="siteMapSection in siteMap | limitTo: 10 | limitTo: -2">\n            <header class="site-map-list-header">\n                <h1><a bo-href="siteMapSection.path" bo-text="siteMapSection.name" target="_self" vx-common-link></a></h1>\n            </header>\n            <ul class="site-map-list" bo-show="siteMapSection.links">\n                <li ng-repeat="mainLinks in siteMapSection.links">\n                    <a bo-href="mainLinks.path" bo-text="mainLinks.name" target="_self" vx-common-link></a>\n                    <ul class="site-map-list is-indented" bo-show="mainLinks.links">\n                        <li ng-repeat="subLinks in mainLinks.links">\n                            <a bo-href="subLinks.path" bo-text="subLinks.name" target="_self" vx-common-link></a>\n                        </li>\n                    </ul>\n                </li>\n            </ul>\n        </section>\n    </div>\n    <div class="site-map-col">\n        <section ng-repeat="siteMapSection in siteMap | limitTo: 21 | limitTo: -11">\n            <header class="site-map-list-header">\n                <h1><a bo-href="siteMapSection.path" bo-text="siteMapSection.name" target="_self" vx-common-link></a></h1>\n            </header>\n            <ul class="site-map-list" bo-show="siteMapSection.links">\n                <li ng-repeat="mainLinks in siteMapSection.links">\n                    <a bo-href="mainLinks.path" bo-text="mainLinks.name" target="_self" vx-common-link></a>\n                    <ul class="site-map-list is-indented" bo-show="mainLinks.links">\n                        <li ng-repeat="subLinks in mainLinks.links">\n                            <a bo-href="subLinks.path" bo-text="subLinks.name" target="_self" vx-common-link></a>\n                        </li>\n                    </ul>\n                </li>\n            </ul>\n        </section>\n    </div>\n</div>\n')}]),angular.module("/app/book/templates/trip.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/book/templates/trip.tpl.html",'<div data-vx-common-mobile-nav></div>\n\n<div id="cities" class="section--book is-no-head" ng-class="{\'is-no-border\': !trip.inBookingFlow}" ng-include="\'/app/book/templates/trip-booker.tpl.html\'"></div>\n\n<div ng-if="!trip.inBookingFlow">\n    <div ng-if="!trip.isBookLanding" data-vx-common-promo></div>\n    <div class="section--home" ng-include="\'/app/book/templates/trip-features.tpl.html\'"></div>\n    <div class="section--home is-bottom-border" ng-include="\'/app/book/templates/trip-deals-news.tpl.html\'"></div>\n</div>\n\n<section id="calendar" class="section--book section--calendar" data-vx-trip-calendar ng-show="calendar.isVisible"></section>\n\n<div id="fares" class="section--book is-no-border-padding" ng-include="\'/app/book/templates/trip-fares.tpl.html\'"></div>\n\n<section id="travelerInfo" class="section--book is-no-border-padding" ng-show="travelerInfo.isVisible" data-vx-common-traveler-info></section>\n\n<div ng-if="trip.inBookingFlow" data-vx-common-ancillaries-selector></div>\n\n<section id="seatSelector" class="seat-selector-wrap" data-vx-common-seat-selector data-vx-common-scroll></section>')}]),angular.module("/app/book/templates/trip-booker.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/book/templates/trip-booker.tpl.html",'<section id="booker"\n         class="wrap wrap--narrow booker-inner"\n         ng-class="{\n           \'booker__overlay\': bookIntro.isOverlayMode\n         }">\n\n  <div class="collapse-container" data-vx-book-intro-picker>\n\n    <div data-vx-common-collapsible-section data-collapsed="bookIntro.isCollapsed">\n\n        <div class="collapsed-overlay collapsed--booker" ng-show="bookIntro.isCollapsed">\n            <h1>Guests &amp; Cities</h1>\n            <div class="collapse-overlay-info">\n                <span ng-bind="bookIntro.travelerTotalLabel"></span>,\n                <span class="destination-wrapper is-first" ng-if="!bookIntro.isMultiCity">\n                    <span ng-bind="bookIntro.departingCityCode[0]"></span>\n                    <span class="icon" ng-class="bookIntro.isRoundTrip ? \'icon-round-trip-grey\' : \'icon-arrow-right-short-grey\'"></span>\n                    <span ng-bind="bookIntro.returningCityCode[0]"></span>\n                </span>\n                <span class="destination-wrapper" ng-if="bookIntro.isMultiCity" ng-repeat="cities in bookIntro.departingCityCode" ng-class="{\'is-first\': $first}">\n                    <span ng-bind="bookIntro.departingCityCode[$index]"></span>\n                    <span class="icon icon-arrow-right-short-grey"></span>\n                    <span ng-bind="bookIntro.returningCityCode[$index]"></span>\n                </span>\n            </div>\n            <a href="#" data-vx-collapsible-section-trigger class="cta-button btn btn-third" ng-click="collapsible.expand(bookIntro.startOver)" id="bookResetFlow">Start Over</a>\n        </div>\n\n        <!-- Start trip type picker -->\n        <div ng-show="!bookIntro.isCollapsed" class="booker__trip-type" ng-class="{\n          \'booker__trip-type--is-hidden\': bookIntro.isTripTypeHidden()\n        }">\n            <ul class="trip-type cf" role="radiogroup" data-vx-trip-type data-type-suffix="BOOK" data-e2e-parent-type="booker"></ul>\n        </div>\n\n        <div class="book-people-original" ng-if="bookIntro.isMultiCity && bookIntro.peoplePickerVisible" ng-show="!bookIntro.isCollapsed">\n            <p tabindex="-1" role="heading" class="book-people-original__title booker__trip-origin" ng-if="bookIntro.isOverlayMode" ng-bind="bookIntro.overlayTitle"></p>\n\n            <a href="#" class="booker__close-overlay ir" ng-show="bookIntro.isOverlayMode"\n               vx-common-ally-click="bookIntro.setOverlayMode({enabled: false}); bookIntro.setMCFocus()">Back to City Selection</a>\n\n            <div data-vx-book-people-picker travelers="bookIntro.travelers" visible="bookIntro.peoplePickerVisible" on-complete="bookIntro.setOverlayMode({enabled: false})"></div>\n        </div>\n\n        <!-- Shows only for return trip or one way -->\n        <div ng-show="!bookIntro.isMultiCity && !bookIntro.isCollapsed">\n            <!-- Booking -->\n            <div ng-show="bookIntro.enableAlaskaAirports()">\n              <h2 ng-show="bookIntro.breakpoint === \'small\'" class="booker__trip-header">\n                {{bookIntro.content.headlineForMobile}}\n              </h2>\n              <h2 ng-show="bookIntro.breakpoint !== \'small\'" class="booker__trip-header">\n                {{bookIntro.content.headline}}\n              </h2>\n              <p ng-show="bookIntro.breakpoint !== \'small\'" class="booker__trip-subheader">\n                {{bookIntro.content.subheadline}}\n              </p>\n            </div>\n\n            <!-- Change -->\n            <h2 ng-show="!bookIntro.enableAlaskaAirports()" class="booker__trip-header">\n              Where would you like to go?\n            </h2>\n\n            <span class="accessible-only-text">\n              Searching\n              <span ng-if="bookIntro.isRoundTrip">Round Trip</span>\n              <span ng-if="!bookIntro.isRoundTrip">One Way</span>\n              Flights\n            </span>\n\n            <div class="booker__trip-wrapper">\n                <ul class="booker__trip-container"\n                    ng-class="{\n                      \'booker__trip-container--typeahead\': bookIntro.typeaheadEnabled()\n                    }">\n                    <li class="booker__trip-item-container people-picker" ng-class="{\'is-open\': bookIntro.peoplePickerVisible, \'is-inactive\': !bookIntro.contextIsBook}" data-vx-e2e-peoplepicker-toggle>\n                        <a href="#"\n                           class="booker__trip-item"\n                           ng-click="bookIntro.showPeoplePicker()"\n                           ng-focus="bookIntro.setFocusMessage()"\n                           tabindex="-1">\n                            <p class="eyebrow-note"><span ng-if="bookIntro.travelerIndividual().length>1" ng-repeat="traveler in bookIntro.travelerIndividual()">{{traveler}}<span ng-hide="$index === bookIntro.travelerIndividual().length-1">, </span></span>\n                            <span ng-if="bookIntro.travelerIndividual().length === 1">{{bookIntro.travelerIndividual()[0]}}</span></p>\n                            <h3 class="booker__item-name" ng-bind="bookIntro.travelerSummary()"></h3>\n                            <label class="accessible-hidden-label" for="people-picker--field">Select your guests</label>\n                            <input type="text"\n                                   autocomplete="off"\n                                   id="people-picker--field"\n                                   class="booker__typeahead-field booker__typeahead-field--people"\n                                   maxlength="0"\n                                   ng-if="bookIntro.typeaheadEnabled()">\n                        </a>\n\n                        <ul class="people-picker__pickers pickers--stack" data-vx-book-people-picker travelers="bookIntro.travelers" visible="bookIntro.peoplePickerVisible">\n                        </ul>\n                    </li>\n\n                    <li data-vx-book-airport-picker\n                        picker-type="departing"\n                        airports="bookIntro.depList"\n                        preselected="bookIntro.depSelected"\n                        data-vx-e2e-booker-airportpicker-dep-toggle></li>\n\n                    <li data-vx-book-airport-picker\n                        picker-type="destination"\n                        airports="bookIntro.desList"\n                        preselected="bookIntro.desSelected"\n                        data-vx-e2e-booker-airportpicker-arr-toggle class="booker-name"></li>\n\n                </ul>\n\n                <p class="booker__more-link">\n                    <a href="#" vx-common-ally-click="bookIntro.openBestFaresModal()">Best Fares Guaranteed online</a>\n                </p>\n            </div>\n\n            <a href="#"\n               ng-attr-aria-disabled="{{!bookIntro.sectionComplete}}"\n               vx-common-ally-click="bookIntro.sectionComplete && bookIntro.continue()"\n               data-role="button"\n               ng-class="{\n                 \'btn-disabled btn-secondary\': !bookIntro.sectionComplete,\n                 \'btn-primary\': bookIntro.sectionComplete\n               }"\n               class="btn booker__btn-continue booker-trip-button"\n               ng-bind="bookIntro.continueButtonLabel"\n               data-vx-e2e-booker-btn-continue\n               ng-focus="bookIntro.setSearchFocus()"></a>\n        </div>\n\n        <!-- Shows only for multi-city -->\n        <div ng-if="bookIntro.showMultiCityOpts()"\n             ng-show="!bookIntro.isCollapsed"\n             data-vx-e2e-booker-btn-continue-multicity\n             data-vx-book-multi-city\n             people-picker="bookIntro.showPeoplePicker()"\n             on-select="bookIntro.showMultiCityAirportList(leg, stage)"\n             airport-updated="bookIntro.multiCityAirport"\n             on-complete="bookIntro.continue()"\n             >Multi-city nav</div>\n\n        <div class="multi-city-select-cities-position" data-vx-book-airport-list ng-show="bookIntro.airportListVisible" selected="bookIntro.selectedAirportCode()" airports="bookIntro.airportList" limit="bookIntro.listLimit" on-select="bookIntro.airportSelected(airport, null, callback)" small-modal="bookIntro.airportListSmallModal"></div>\n\n      </div>\n    </div>\n</section>')}]),angular.module("/app/book/directives/book-airport-list.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/book/directives/book-airport-list.tpl.html",'<div>\n  <span class="accessible-only-text">Screen reader users: the following information is presented in a grid format. Please press tab to enter the grid. Use arrow keys to navigate the grid options and press enter to make selections.</span>\n\n  <div vx-common-ally-application role="application">\n    <ul bindonce vx-common-click-bg-gradient class="city-list" role="grid" ng-focus="allyApp.isFocused(\'.city-list__item\', \'.city-list\')" ng-blur="allyApp.lostFocus()" tabindex="0">\n      <li ng-repeat="airport in airports | limitTo: airportList.limit" ng-class="{\'is-omega\': ($index + 2) % 6 === 1}" tabindex="-1" vx-common-ally-click="airportList.selectAirport(airport)" ng-focus="a11y.setText(airport.name)">\n        <a href="#" class="city-list__item" ng-class="{\'is-selected\': selected === airport.code}" vx-common-ally-click="airportList.selectAirport(airport)" tabindex="-1">\n          <div class="city-list__wrap">\n            <span class="city-list__title" bo-text="airport.name"></span>\n            <span class="city-list__sub-title" ng-class="{\'city-list__country\': airport.international}" bo-bind="airport.state || airport.country"></span> (<span bo-text="airport.code"></span>)\n            <span class="city-list__feature-label" bo-if="airport.onSale">SALE!</span>\n          </div>\n        </a>\n      </li>\n      <li class="is-omega is-all-cities" ng-repeat-end ng-if="airportList.allCitiesButtonVisible()">\n        <a class="city-list__item" href="#" ng-click="airportList.showAll()">\n          <div class="city-list__wrap">\n            <span class="city-list__title--all-cities">All Cities</span>\n          </div>\n        </a>\n      </li>\n    </ul>\n  </div>\n</div>')}]),angular.module("/app/book/directives/book-airport-picker.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/book/directives/book-airport-picker.tpl.html",'<li class="booker__trip-item-container" ng-class="{\'is-inactive\' : !airportPicker.isActive, \'is-open\': airportPicker.isVisible}">\n  <span class="booker__trip-item" tabindex="-1">\n\n    <p class="eyebrow-note" ng-cloak>{{airportPicker.pickerType === \'departing\' ? \'from\' : \'to\'}}</p>\n    <h3 class="booker__item-name" ng-class="{\'city-name\' : airportPicker.selectedAirport == \'City\'}">\n      <span ng-bind="airportPicker.typeahead" class="booker__typeahead-entry">\n      </span><span ng-bind="airportPicker.getSuggestion()" class="booker__typeahead-suggestion">\n      </span>{{airportPicker.selectedAirport}}\n    </h3>\n    <label class="accessible-hidden-label"\n           ng-attr-for="{{airportPicker.pickerType === \'departing\' ?\n             \'departing-airport--field\' :\n             \'destination-airport--field\'}}">\n             Select a {{ airportPicker.pickerType === \'departing\' ? \'Departing\' : \'Destination\' }} Location.</label>\n    <input type="text"\n           ng-attr-id="{{airportPicker.pickerType === \'departing\' ?\n              \'departing-airport--field\' :\n              \'destination-airport--field\'}}"\n           class="booker__typeahead-field"\n           ng-class="airportPicker.pickerType === \'departing\' ?\n             \'booker__typeahead-field--departing\' :\n             \'booker__typeahead-field--destination\'"\n           ng-model="airportPicker.typeahead"\n           ng-change="airportPicker.onTypeaheadChange()"\n           ng-focus="airportPicker.setFocusMessage()">\n  </span>\n\n  <div class="trip__list-city" ng-show="airportPicker.isVisible">\n\n    <ul class="trip__list-city-container">\n      <li ng-repeat="airport in airportPicker.getAirportList()"\n          class="trip__list-item"\n          ng-class="{ \'trip__list-item--not-empty\': airportPicker.typeahead }"\n          vx-common-e2e-testing\n          testing-target="airport"\n          testing-prefix="booker-airportpicker"\n          testing-attr="code">\n\n        <a vx-common-prevent-default\n           href="#"\n           tabindex="-1"\n           ng-class="{ \'is-selected\': airportPicker.selectedAirportIndex === $index }"\n           ng-click="airportPicker.selectAirport(airport.code, airport.name)">\n          <span class="list-item__city">{{airport.name}}</span>\n          <span class="list-item__state">{{airport.abv}}</span>\n          <span class="list-item__code">{{airport.code}}</span>\n        </a>\n      </li>\n      <li ng-if="!airportPicker.getAirportList().length"\n          class="trip__list-item">\n          <span class="list-item__city list-item__city--no-results">\n            No results\n          </span>\n      </li>\n    </ul>\n  </div>\n\n</li>')}]),angular.module("/app/book/directives/book-multi-city.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/book/directives/book-multi-city.tpl.html",'<div class="booker__multi-city" bindonce>\n    <div class="multi-city">\n        <ol class="multi-city__city-legs">\n            <li ng-repeat="leg in multiCity.legs"\n                ng-class="{\'is-selecting\': multiCity.legInSelection[$index]}" ng-hide="$index === 1 && multiCity.legInSelection[0]"\n                tabindex="-1"\n                ng-focus="multiCity.setLegFocusMessage($index)">\n                <div bo-class="\'city-leg--\' + multiCity.integerToString($index + 1)" bo-id="\'city-leg--\' + multiCity.integerToString($index + 1)" ng-class="{\'is-disabled\': $index > 0 && !multiCity.legsSelected[0]}">\n                    <span class="city-leg__number" bo-text="$index + 1"></span>\n                    <span bo-text="(multiCity.context.BOOK ? \'Shop\' : \'Change\') + \' from\'"></span>\n                    <a href="#" class="trip-select"\n                       ng-focus="multiCity.setAirportFocusMessage(0, multiCity.getAirport($index).dep, multiCity.getAirport($index).des)"\n                       vx-common-ally-click="multiCity.selectAirport($index, 0, $event)"\n                       ng-class="{\'is-unselected\': !multiCity.getAirport($index).dep, \'is-disabled\': $index > 0 && !multiCity.legsSelected[0]}"><span class="trip-select--content" ng-bind="multiCity.getAirport($index).dep.name || \'Select City\'"></span><span class="trip-select--marker"></span></a>\n\n                    to\n                    <a href="#" class="trip-select"\n                       ng-focus="multiCity.getAirport($index).dep && multiCity.setAirportFocusMessage(1, multiCity.getAirport($index).dep, multiCity.getAirport($index).des)"\n                       vx-common-ally-click="multiCity.getAirport($index).dep && multiCity.selectAirport($index, 1, $event)"\n                       ng-attr-aria-disabled="{{!multiCity.getAirport($index).dep}}"\n                       ng-class="{\n                         \'is-disabled\': !multiCity.getAirport($index).dep,\n                         \'is-unselected\': !multiCity.getAirport($index).des\n                       }"><span class="trip-select--content" ng-bind="multiCity.getAirport($index).des.name || \'Select  City\'"></span><span class="trip-select--marker"></span></a>\n                </div>\n            </li>\n        </ol>\n\n\n        <div class="multi-city__options">\n            <p class="multi-city__people-select" ng-hide="multiCity.isAirportVisible">\n              <a href="#" vx-common-ally-click="showPeoplePicker(); multiCity.setPeoplePickerFocus()" class="trip-select"\n                 ng-focus="setPeoplePickerFocusMessage()"><span class="trip-select--content" ng-bind="multiCity.travelerLabel"></span><span class="trip-select--marker"></span></a>\n            </p>\n\n            <div class="multi-city__multi-city-confirm cf" ng-class="{\'is-disabled\': !multiCity.allLegsSelected}" ng-hide="multiCity.isAirportVisible">\n                <div class="multi-city-confirm">\n                    <a href="#" class="btn btn-primary btn-xl"\n                       ng-focus="multiCity.setContinueButtonFocusMessage()"\n                       ng-class="{\'btn-disabled\': !multiCity.allLegsSelected}"\n                       ng-attr-aria-disabled="{{!multiCity.allLegsSelected}}"\n                       vx-common-ally-click="multiCity.allLegsSelected && continue()"\n                       data-role="button">Continue</a>\n                </div>\n            </div>\n        </div>\n\n    </div>\n</div>')}]),angular.module("/app/book/directives/book-people-picker.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/book/directives/book-people-picker.tpl.html",'<div ng-show="isVisible" class="people-picker wrap wrap--narrow">\n    <ul class="people-picker__pickers">\n        <li>\n            <div data-vx-common-number-picker\n                 data-title="{{titleHolder.adultTitle}}"\n                 data-increment="canIncrement()"\n                 data-sub-title=""\n                 data-sub-title-small="{{ages.MIN_ADULT_AGE_YEARS}}+"\n                 data-e2e-val="{{titleVal.adultVal}}"\n                 data-value="travelers.adults"\n                 data-min="1"\n                 data-max="9"\n                 data-counted-traveler></div>\n        </li>\n        <li>\n            <div data-vx-common-number-picker\n                 data-title="{{titleHolder.childrenTitle}}"\n                 data-increment="canIncrement()"\n                 data-sub-title="Age {{ages.MIN_CHILD_AGE_YEARS}}-{{ages.MIN_ADULT_AGE_YEARS - 1}}"\n                 data-sub-title-small="{{ages.MIN_CHILD_AGE_YEARS}}-{{ages.MIN_ADULT_AGE_YEARS - 1}}"\n                 data-e2e-val="{{titleVal.childrenVal}}"\n                 data-value="travelers.children"\n                 data-max="9"\n                 data-counted-traveler></div>\n        </li>\n        <li>\n            <div data-vx-common-number-picker\n                 data-title="{{titleHolder.lapTitle}}"\n                 data-sub-title="Age 0-{{ages.MIN_CHILD_AGE_YEARS}}"\n                 data-sub-title-small="0-{{ages.MIN_CHILD_AGE_YEARS}}"\n                 data-e2e-val="{{titleVal.lapVal}}"\n                 data-value="travelers.infants"\n                 data-min="0"\n                 data-max="{{travelers.adults}}"></div>\n        </li>\n    </ul>\n    <a href="#" class="btn btn-centered button-label btn-primary btn-lg" vx-common-ally-click="closePicker()" data-role="button">{{buttonLabel}}</a>\n</div>')}]),angular.module("/app/book/directives/trip-type.tpl.html",[]).run(["$templateCache",function(a){a.put("/app/book/directives/trip-type.tpl.html",'<li class="input-radio input-radio--inline" role="radio" ng-class="{\'is-selected\': tripType.current === option.val}" bindonce ng-repeat="option in tripType.options" vx-common-e2e-testing testing-target="option" testing-prefix="triptype" testing-attr="val" ng-attr-aria-checked="{{tripType.current === option.val ? \'true\' : \'false\'}}" vx-common-ally-click="tripType.select(option.val)">\n    <span class="accessible-only-text">Search flights by</span>\n    <label bo-attr bo-attr-for="option.val + \'_\' + typeSuffix">\n        <input type="radio" bo-id="option.val + \'_\' + typeSuffix" name="trip-type" bo-value="option.val" ng-checked="tripType.current === option.val">\n        <span bo-text="option.name"></span>\n    </label>\n</li>')}]),c("templates",["angular"],function(a){return function(){var b;return b||a.angular}}(this)),c("../scripts/bootstrap",["jquery","angular","utils","core/vx-core-app","templates","velocity"],function(a,b){"use strict";b.bootstrap(document,["vxCoreApp"])}),b(["../scripts/bootstrap"])}();